"use strict";(self.webpackChunk_terrestris_shogun_gis_client=self.webpackChunk_terrestris_shogun_gis_client||[]).push([["2662"],{20191:function(e,t,r){var n=r(69843),a=r.n(n),o=r(55482),i=r.n(o),l=r(93884);class u{static getLength(e,t,r=!0,n=6371008.8,a=6){let o=Math.pow(10,a);if(!r)return Math.round(e.getLength()*o)/o;{let r={projection:t.getView().getProjection().getCode(),radius:n};return(0,l.getLength)(e,r)}}static formatLength(e,t,r,n=!0){let a=Math.pow(10,r),o=u.getLength(e,t,n);return o>1e3?Math.round(o/1e3*a)/a+" km":o>1?Math.round(o*a)/a+" m":Math.round(1e3*o*a)/a+" mm"}static getArea(e,t,r=!0,n=6371008.8){if(!r)return e.getArea();{let r={projection:t.getView().getProjection().getCode(),radius:n};return(0,l.getArea)(e,r)}}static getAreaOfCircle(e,t){if(a()(t.getView().getProjection()))return NaN;if(!["radians","degrees"].includes(t.getView().getProjection().getUnits()))return Math.PI*Math.pow(e.getRadius(),2);{let t=e.getRadius(),r=2*Math.PI*40589753129677.44;return r*(1-Math.cos(t/6371008.8))}}static formatArea(e,t,r,n=!0){let a,o=Math.pow(10,r);return(a=e instanceof i()?u.getAreaOfCircle(e,t):u.getArea(e,t,n))>1e4?Math.round(a/1e6*o)/o+" km<sup>2</sup>":a>.01?Math.round(a*o)/o+" m<sup>2</sup>":Math.round(1e6*a*o)/o+" mm<sup>2</sup>"}static angle(e,t){let r=e[0]-t[0],n=Math.atan2(e[1]-t[1],r);return 180/Math.PI*n}static angle360(e,t){let r=u.angle(e,t);return r<0&&(r=360+r),r}static makeClockwise(e){return 360-e}static makeZeroDegreesAtNorth(e){let t=e+90;return t>360&&(t-=360),t}static formatAngle(e,t=2){let r=e.getCoordinates(),n=r.length;if(n<2)return"";let a=r[n-1],o=r[n-2],i=u.angle360(o,a);return i=u.makeZeroDegreesAtNorth(i),i=u.makeClockwise(i),`${i.toFixed(t)}\xb0`}}t.A=u},51365:function(e,t,r){r.r(t),r.d(t,{default:function(){return Z},MeasureButton:function(){return B}});var n=r(76395),a=r.n(n),o=r(21834),i=r.n(o),l=r(55482),u=r.n(l),c=r(94934),s=r.n(c),f=r(1592),g=r.n(f),d=r(81802),m=r.n(d),p=r(27436),h=r.n(p),A=r(30100),w=r.n(A),C=r(15516),k=r.n(C),v=r(25194),y=r.n(v),$=r(70038),M=r.n($),b=r(40542),E=r.n(b),L=r(47312),P=r.n(L),S=r(66922),N=r.n(S),O=r(97562),_=r.n(O),I=r(20191);let R="react-util-";var D=r(30126),j=r(92712),x=r(38254),V=r(42502),G=r(70198),H=r(53529);let T=`${G.$}measurebutton`,B=({measureType:e="line",measureLayerName:t="react-geo_measure",fillColor:r="rgba(255, 0, 0, 0.5)",strokeColor:o="rgba(255, 0, 0, 0.8)",showMeasureInfoOnClickedPoints:l=!1,showHelpTooltip:c=!0,decimalPlacesInTooltips:f=2,multipleDrawing:d=!1,continuePolygonMsg:p="Click to draw area",continueLineMsg:A="Click to draw line",continueAngleMsg:C="Click to draw angle",clickToDrawText:v="Click to measure",measureTooltipCssClasses:$={tooltip:`${G.$}measure-tooltip`,tooltipDynamic:`${G.$}measure-tooltip-dynamic`,tooltipStatic:`${G.$}measure-tooltip-static`},pressed:b=!1,geodesic:L=!0,measureRadius:S=!1,className:O,...B})=>{(({measureType:e,measureLayerName:t="react-util-measure",fillColor:r="rgba(255, 0, 0, 0.5)",strokeColor:a="rgba(255, 0, 0, 0.8)",showMeasureInfoOnClickedPoints:o=!1,showHelpTooltip:l=!0,decimalPlacesInTooltips:c=2,multipleDrawing:f=!1,continuePolygonMsg:d="Click to draw area",continueLineMsg:p="Click to draw line",continueAngleMsg:A="Click to draw angle",clickToDrawText:C="Click to measure",measureTooltipCssClasses:v={tooltip:`${R}measure-tooltip`,tooltipDynamic:`${R}measure-tooltip-dynamic`,tooltipStatic:`${R}measure-tooltip-static`},active:$=!1,geodesic:b=!0,measureRadius:L=!1})=>{let[S,O]=(0,n.useState)(),G=(0,n.useRef)(),H=(0,n.useRef)(),T=(0,n.useRef)([]),B=(0,D.A)(),Z=(0,x.A)(()=>new(k())({properties:{name:t},source:new(M())({features:new(i())}),style:new(_())({fill:new(P())({color:r}),stroke:new(N())({color:a,width:2}),image:new(E())({radius:7,fill:new(P())({color:r})})})}),[t,r,a,r],$),F=(0,j.h)(()=>new(w())({source:Z?.getSource()||void 0,type:(e=>{switch(e){case"line":case"angle":default:return"MultiLineString";case"polygon":return"MultiPolygon";case"circle":return"Circle"}})(e),maxPoints:"angle"===e?2:void 0,style:new(_())({fill:new(P())({color:r}),stroke:new(N())({color:a,lineDash:[10,10],width:2}),image:new(E())({radius:5,stroke:new(N())({color:a}),fill:new(P())({color:r})})}),freehandCondition:()=>!1}),[e,Z,r,a,r],$),K=(0,n.useCallback)(()=>{B&&G.current&&(B.removeOverlay(G.current),G.current=void 0)},[B]),U=(0,n.useCallback)(()=>{if(B&&T.current.length>0){for(let e of T.current)B.removeOverlay(e);T.current=[]}},[B]),q=(0,n.useCallback)(()=>{B&&H.current&&(B.removeOverlay(H.current),H.current=void 0)},[B]),z=(0,n.useCallback)(()=>{K(),U(),q(),Z?.getSource()?.clear()},[Z,K,U,q]);(0,n.useEffect)(()=>{if($)return()=>{z()}},[$,z]);let J=(0,n.useCallback)(()=>{B&&!H.current&&(H.current=new(y())({element:document.createElement("div"),offset:[15,0],positioning:"center-left",className:v?.tooltip??""}),B.addOverlay(H.current))},[B,v?.tooltip]),Q=(0,n.useCallback)(()=>{B&&!G.current&&(G.current=new(y())({element:document.createElement("div"),offset:[0,-15],positioning:"bottom-center",className:v?`${v.tooltip} ${v.tooltipDynamic}`:""}),B.addOverlay(G.current))},[B,G,v]),W=(0,n.useCallback)(()=>{let t,r;if(!G.current||!S||!B)return;let n=S.getGeometry();if(n instanceof m()?n=n.getPolygons()[0]:n instanceof g()&&(n=n.getLineStrings()[0]),n instanceof u()){if(L){let e=I.A.getAreaOfCircle(n,B),r=Math.pow(10,c),a=Math.round(n.getRadius()*r)/r;t=`${a.toString()} m`,e>1e6*Math.PI&&(t=Math.round(n.getRadius()/1e3*r)/r+" km")}else t=I.A.formatArea(n,B,c,b);r=n.getCenter()}else if(n instanceof h())t=I.A.formatArea(n,B,c,b),r=n.getInteriorPoint().getCoordinates();else{if(!(n instanceof s()))return;r=n.getLastCoordinate(),"line"===e?t=I.A.formatLength(n,B,c,b):"angle"===e&&(t=I.A.formatAngle(n,0))}let a=G.current.getElement();t&&a&&(a.innerHTML=t),G.current.setPosition(r)},[c,S,b,B,e,L]),X=(0,n.useCallback)(e=>{B&&(f||z(),O(e.feature))},[z,B,f]),Y=(0,n.useCallback)(t=>{if(!S||!B)return;let r=S.getGeometry();r instanceof m()&&(r=r.getPolygons()[0]),r instanceof g()&&(r=r.getLineStrings()[0]);let n="line"===e?I.A.formatLength(r,B,c,b):I.A.formatArea(r,B,c,b);if(parseInt(n,10)>0){let e=document.createElement("div");v&&(e.className=`${v.tooltip} ${v.tooltipStatic}`),e.innerHTML=n;let r=new(y())({element:e,offset:[0,-15],positioning:"bottom-center"});B.addOverlay(r),r.setPosition(t),T.current.push(r)}},[c,S,b,B,v,e]),ee=(0,n.useCallback)(t=>{if(f&&Y(t.feature.getGeometry().getLastCoordinate()),(f||o)&&("line"===e||"polygon"===e))K();else{let e=G.current?.getElement();e&&v&&(e.className=`${v.tooltip} ${v.tooltipStatic}`),G.current?.setOffset([0,-7])}W(),O(void 0),(f||o)&&("line"===e||"polygon"===e)&&(G.current=void 0,Q())},[Y,Q,v,e,f,K,o,W]),et=(0,n.useCallback)(t=>{if(!H.current)return;let r=H.current?.getElement();if(!r)return;let n=C;"polygon"===e?n=d:"line"===e?n=p:"angle"===e&&(n=A),r.innerHTML=n??"",H.current.setPosition(t)},[C,A,p,d,H,e]),er=(0,n.useCallback)(e=>{!e.dragging&&$&&et(e.coordinate)},[et,$]),en=(0,n.useCallback)(t=>{o&&"line"===e&&Y(t.coordinate)},[Y,e,o]);return(0,V.A)(F,e=>e.on("drawstart",e=>{X?.(e)}),[F,X]),(0,V.A)(F,e=>e.on("drawend",e=>{ee?.(e)}),[F,ee]),(0,V.A)(B,e=>e.on("pointermove",e=>{er?.(e)}),[B,er]),(0,V.A)(B,e=>e.on("click",e=>{en?.(e)}),[B,en]),(0,n.useEffect)(()=>{Q(),l&&J()},[J,Q,l]),(0,V.A)(S,e=>e.getGeometry()?.on("change",()=>{W?.()}),[S,W])})({active:b,measureType:e,measureLayerName:t,fillColor:r,strokeColor:o,showMeasureInfoOnClickedPoints:l,showHelpTooltip:c,decimalPlacesInTooltips:f,multipleDrawing:d,continuePolygonMsg:p,continueLineMsg:A,continueAngleMsg:C,clickToDrawText:v,measureTooltipCssClasses:$,geodesic:L,measureRadius:S});let Z=O?`${O} ${T}`:T;return a().createElement(H.A,{pressed:b,className:Z,...B})};var Z=B},53529:function(e,t,r){var n=r(76395),a=r.n(n),o=r(54440),i=r(74097),l=r(70198);t.A=({type:e="primary",pressed:t=!1,tooltipProps:r={mouseEnterDelay:1.5},className:n,tooltip:u,tooltipPlacement:c,pressedIcon:s,icon:f,children:g,value:d,onClick:m,onChange:p=()=>void 0,...h})=>{let A=`${l.$}togglebutton`,w=n?`${n} ${A}`:A,C="";return t&&(C=" btn-pressed"),a().createElement(o.A,{title:u,placement:c,...r},a().createElement(i.Ay,{type:e,onClick:e=>{m&&(m(e),e.defaultPrevented)||p(e,d)},onChange:p,className:`${w}${C}`,"aria-pressed":t,icon:t?s:f,...h},g))}},70198:function(e,t,r){r.d(t,{$:function(){return n}});let n="react-geo-"},73645:function(e,t,r){var n=r(76395);t.A=r.n(n)().createContext(null)},30126:function(e,t,r){r.d(t,{k:function(){return o}});var n=r(76395),a=r(73645);let o=()=>(0,n.useContext)(a.A);t.A=o},92712:function(e,t,r){r.d(t,{h:function(){return i}});var n=r(76395),a=r(2543),o=r(30126);let i=(e,t,r)=>{let i=(0,o.A)(),[l,u]=(0,n.useState)();return(0,n.useEffect)(()=>{if(!i)return;let t=e();if(t)return u(t),i.addInteraction(t),()=>{i.removeInteraction(t),u(void 0)}},[...t,i]),(0,n.useEffect)(()=>{!l||(0,a.isNil)(r)||l.setActive(r)},[l,r]),l}},38254:function(e,t,r){r.d(t,{c:function(){return i}});var n=r(76395),a=r(2543),o=r(30126);let i=(e,t,r)=>{let i=(0,o.A)(),[l,u]=(0,n.useState)();return(0,n.useEffect)(()=>{if(!i)return;let t=e();if(t)return i.addLayer(t),u(t),()=>{i.removeLayer(t),u(void 0)}},[i,...t]),(0,n.useEffect)(()=>{!l||(0,a.isNil)(r)||l.setVisible(r)},[l,r]),l};t.A=i},42502:function(e,t,r){r.d(t,{R:function(){return o}});var n=r(76395),a=r(17936);let o=(e,t,r,o)=>{(0,n.useEffect)(()=>{if(!e||!1===o)return;let r=(Array.isArray(e)?e:[e]).flatMap(e=>{let r=t(e);return Array.isArray(r)?r:[r]}).filter(e=>void 0!==e);return()=>{for(let e of r)(0,a.unByKey)(e)}},[e,o,t,...r])};t.A=o}}]);
//# sourceMappingURL=2662.0212629e67702fb8.js.map