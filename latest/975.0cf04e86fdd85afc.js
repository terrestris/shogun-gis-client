"use strict";(self.webpackChunk_terrestris_shogun_gis_client=self.webpackChunk_terrestris_shogun_gis_client||[]).push([["975"],{80567:function(t,e,i){var s=i(68186),n=i(34178),l=i(64889),o=i(45120),r=i(21915),h=i(68509),a=i(79682),u=i(86204);class d extends l.Z{constructor(t,e,i,s){super(),this.tolerance=t,this.maxExtent=e,this.pixelRatio=s,this.maxLineWidth=0,this.resolution=i,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(t){let e=this.pixelRatio;return 1==e?t:t.map(function(t){return t*e})}appendFlatPointCoordinates(t,e){let i=this.getBufferedMaxExtent(),s=this.tmpCoordinate_,n=this.coordinates,l=n.length;for(let o=0,h=t.length;o<h;o+=e)s[0]=t[o],s[1]=t[o+1],(0,r.containsCoordinate)(i,s)&&(n[l++]=s[0],n[l++]=s[1]);return l}appendFlatLineCoordinates(t,e,i,s,l,o){let h,a,u;let d=this.coordinates,c=d.length,g=this.getBufferedMaxExtent();o&&(e+=s);let f=t[e],_=t[e+1],x=this.tmpCoordinate_,p=!0;for(h=e+s;h<i;h+=s)x[0]=t[h],x[1]=t[h+1],(u=(0,r.coordinateRelationship)(g,x))!==a?(p&&(d[c++]=f,d[c++]=_,p=!1),d[c++]=x[0],d[c++]=x[1]):u===n.Z.INTERSECTING?(d[c++]=x[0],d[c++]=x[1],p=!1):p=!0,f=x[0],_=x[1],a=u;return(l&&p||h===e+s)&&(d[c++]=f,d[c++]=_),c}drawCustomCoordinates_(t,e,i,s,n){for(let l=0,o=i.length;l<o;++l){let o=i[l],r=this.appendFlatLineCoordinates(t,e,o,s,!1,!1);n.push(r),e=o}return e}drawCustom(t,e,i,n,l){let o,r,h,a,d;this.beginGeometry(t,e,l);let c=t.getType(),g=t.getStride(),f=this.coordinates.length;switch(c){case"MultiPolygon":o=t.getOrientedFlatCoordinates(),a=[];let _=t.getEndss();d=0;for(let t=0,e=_.length;t<e;++t){let e=[];d=this.drawCustomCoordinates_(o,d,_[t],g,e),a.push(e)}this.instructions.push([s.ZP.CUSTOM,f,a,t,i,u.ug,l]),this.hitDetectionInstructions.push([s.ZP.CUSTOM,f,a,t,n||i,u.ug,l]);break;case"Polygon":case"MultiLineString":h=[],o="Polygon"==c?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),d=this.drawCustomCoordinates_(o,0,t.getEnds(),g,h),this.instructions.push([s.ZP.CUSTOM,f,h,t,i,u.o1,l]),this.hitDetectionInstructions.push([s.ZP.CUSTOM,f,h,t,n||i,u.o1,l]);break;case"LineString":case"Circle":o=t.getFlatCoordinates(),r=this.appendFlatLineCoordinates(o,0,o.length,g,!1,!1),this.instructions.push([s.ZP.CUSTOM,f,r,t,i,u.Ml,l]),this.hitDetectionInstructions.push([s.ZP.CUSTOM,f,r,t,n||i,u.Ml,l]);break;case"MultiPoint":o=t.getFlatCoordinates(),(r=this.appendFlatPointCoordinates(o,g))>f&&(this.instructions.push([s.ZP.CUSTOM,f,r,t,i,u.Ml,l]),this.hitDetectionInstructions.push([s.ZP.CUSTOM,f,r,t,n||i,u.Ml,l]));break;case"Point":o=t.getFlatCoordinates(),this.coordinates.push(o[0],o[1]),r=this.coordinates.length,this.instructions.push([s.ZP.CUSTOM,f,r,t,i,void 0,l]),this.hitDetectionInstructions.push([s.ZP.CUSTOM,f,r,t,n||i,void 0,l])}this.endGeometry(e)}beginGeometry(t,e,i){this.beginGeometryInstruction1_=[s.ZP.BEGIN_GEOMETRY,e,0,t,i],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[s.ZP.BEGIN_GEOMETRY,e,0,t,i],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){let t,e,i;let n=this.hitDetectionInstructions;n.reverse();let l=n.length,o=-1;for(t=0;t<l;++t)(i=(e=n[t])[0])==s.ZP.END_GEOMETRY?o=t:i==s.ZP.BEGIN_GEOMETRY&&(e[2]=t,(0,a.FZ)(this.hitDetectionInstructions,o,t),o=-1)}setFillStrokeStyle(t,e){let i=this.state;if(t){let e=t.getColor();i.fillPatternScale=e&&"object"==typeof e&&"src"in e?this.pixelRatio:1,i.fillStyle=(0,o.y)(e||h.defaultFillStyle)}else i.fillStyle=void 0;if(e){let t=e.getColor();i.strokeStyle=(0,o.y)(t||h.defaultStrokeStyle);let s=e.getLineCap();i.lineCap=void 0!==s?s:h.defaultLineCap;let n=e.getLineDash();i.lineDash=n?n.slice():h.defaultLineDash;let l=e.getLineDashOffset();i.lineDashOffset=l||h.defaultLineDashOffset;let r=e.getLineJoin();i.lineJoin=void 0!==r?r:h.defaultLineJoin;let a=e.getWidth();i.lineWidth=void 0!==a?a:h.defaultLineWidth;let u=e.getMiterLimit();i.miterLimit=void 0!==u?u:h.defaultMiterLimit,i.lineWidth>this.maxLineWidth&&(this.maxLineWidth=i.lineWidth,this.bufferedMaxExtent_=null)}else i.strokeStyle=void 0,i.lineCap=void 0,i.lineDash=null,i.lineDashOffset=void 0,i.lineJoin=void 0,i.lineWidth=void 0,i.miterLimit=void 0}createFill(t){let e=t.fillStyle,i=[s.ZP.SET_FILL_STYLE,e];return"string"!=typeof e&&i.push(t.fillPatternScale),i}applyStroke(t){this.instructions.push(this.createStroke(t))}createStroke(t){return[s.ZP.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]}updateFillStyle(t,e){let i=t.fillStyle;("string"!=typeof i||t.currentFillStyle!=i)&&(void 0!==i&&this.instructions.push(e.call(this,t)),t.currentFillStyle=i)}updateStrokeStyle(t,e){let i=t.strokeStyle,s=t.lineCap,n=t.lineDash,l=t.lineDashOffset,o=t.lineJoin,r=t.lineWidth,h=t.miterLimit;(t.currentStrokeStyle!=i||t.currentLineCap!=s||n!=t.currentLineDash&&!(0,a.fS)(t.currentLineDash,n)||t.currentLineDashOffset!=l||t.currentLineJoin!=o||t.currentLineWidth!=r||t.currentMiterLimit!=h)&&(void 0!==i&&e.call(this,t),t.currentStrokeStyle=i,t.currentLineCap=s,t.currentLineDash=n,t.currentLineDashOffset=l,t.currentLineJoin=o,t.currentLineWidth=r,t.currentMiterLimit=h)}endGeometry(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;let e=[s.ZP.END_GEOMETRY,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=(0,r.clone)(this.maxExtent),this.maxLineWidth>0)){let t=this.resolution*(this.maxLineWidth+1)/2;(0,r.buffer)(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}e.Z=d},82928:function(t,e,i){i.d(e,{Z:function(){return g}});var s=i("80567"),n=i("68186"),l=i("21915");class o extends s.Z{constructor(t,e,i,s){super(t,e,i,s),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(t,e,i){if(!this.image_||this.maxExtent&&!(0,l.containsCoordinate)(this.maxExtent,t.getFlatCoordinates()))return;this.beginGeometry(t,e,i);let s=t.getFlatCoordinates(),o=t.getStride(),r=this.coordinates.length,h=this.appendFlatPointCoordinates(s,o);this.instructions.push([n.ZP.DRAW_IMAGE,r,h,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([n.ZP.DRAW_IMAGE,r,h,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}drawMultiPoint(t,e,i){if(!this.image_)return;this.beginGeometry(t,e,i);let s=t.getFlatCoordinates(),o=[];for(let e=0,i=s.length;e<i;e+=t.getStride())(!this.maxExtent||(0,l.containsCoordinate)(this.maxExtent,s.slice(e,e+2)))&&o.push(s[e],s[e+1]);let r=this.coordinates.length,h=this.appendFlatPointCoordinates(o,2);this.instructions.push([n.ZP.DRAW_IMAGE,r,h,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([n.ZP.DRAW_IMAGE,r,h,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(t,e){let i=t.getAnchor(),s=t.getSize(),n=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=t.getHitDetectionImage(),this.image_=t.getImage(this.pixelRatio),this.height_=s[1],this.opacity_=t.getOpacity(),this.originX_=n[0],this.originY_=n[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=s[0],this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}}var r=i("68509");class h extends s.Z{constructor(t,e,i,s){super(t,e,i,s)}drawFlatCoordinates_(t,e,i,s){let l=this.coordinates.length,o=this.appendFlatLineCoordinates(t,e,i,s,!1,!1),r=[n.ZP.MOVE_TO_LINE_TO,l,o];return this.instructions.push(r),this.hitDetectionInstructions.push(r),i}drawLineString(t,e,i){let s=this.state,l=s.strokeStyle,o=s.lineWidth;if(void 0===l||void 0===o)return;this.updateStrokeStyle(s,this.applyStroke),this.beginGeometry(t,e,i),this.hitDetectionInstructions.push([n.ZP.SET_STROKE_STYLE,s.strokeStyle,s.lineWidth,s.lineCap,s.lineJoin,s.miterLimit,r.defaultLineDash,r.defaultLineDashOffset],n.$O);let h=t.getFlatCoordinates(),a=t.getStride();this.drawFlatCoordinates_(h,0,h.length,a),this.hitDetectionInstructions.push(n.Yc),this.endGeometry(e)}drawMultiLineString(t,e,i){let s=this.state,l=s.strokeStyle,o=s.lineWidth;if(void 0===l||void 0===o)return;this.updateStrokeStyle(s,this.applyStroke),this.beginGeometry(t,e,i),this.hitDetectionInstructions.push([n.ZP.SET_STROKE_STYLE,s.strokeStyle,s.lineWidth,s.lineCap,s.lineJoin,s.miterLimit,r.defaultLineDash,r.defaultLineDashOffset],n.$O);let h=t.getEnds(),a=t.getFlatCoordinates(),u=t.getStride(),d=0;for(let t=0,e=h.length;t<e;++t)d=this.drawFlatCoordinates_(a,d,h[t],u);this.hitDetectionInstructions.push(n.Yc),this.endGeometry(e)}finish(){let t=this.state;return void 0!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&this.instructions.push(n.Yc),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(t){void 0!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(n.Yc),t.lastStroke=this.coordinates.length),t.lastStroke=0,super.applyStroke(t),this.instructions.push(n.$O)}}var a=i("62418");class u extends s.Z{constructor(t,e,i,s){super(t,e,i,s)}drawFlatCoordinatess_(t,e,i,s){let l=this.state,o=void 0!==l.fillStyle,r=void 0!==l.strokeStyle,h=i.length;this.instructions.push(n.$O),this.hitDetectionInstructions.push(n.$O);for(let l=0;l<h;++l){let o=i[l],h=this.coordinates.length,a=this.appendFlatLineCoordinates(t,e,o,s,!0,!r),u=[n.ZP.MOVE_TO_LINE_TO,h,a];this.instructions.push(u),this.hitDetectionInstructions.push(u),r&&(this.instructions.push(n.s3),this.hitDetectionInstructions.push(n.s3)),e=o}return o&&(this.instructions.push(n.gO),this.hitDetectionInstructions.push(n.gO)),r&&(this.instructions.push(n.Yc),this.hitDetectionInstructions.push(n.Yc)),e}drawCircle(t,e,i){let s=this.state,l=s.fillStyle,o=s.strokeStyle;if(void 0===l&&void 0===o)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,i),void 0!==s.fillStyle&&this.hitDetectionInstructions.push([n.ZP.SET_FILL_STYLE,r.defaultFillStyle]),void 0!==s.strokeStyle&&this.hitDetectionInstructions.push([n.ZP.SET_STROKE_STYLE,s.strokeStyle,s.lineWidth,s.lineCap,s.lineJoin,s.miterLimit,r.defaultLineDash,r.defaultLineDashOffset]);let h=t.getFlatCoordinates(),a=t.getStride(),u=this.coordinates.length;this.appendFlatLineCoordinates(h,0,h.length,a,!1,!1);let d=[n.ZP.CIRCLE,u];this.instructions.push(n.$O,d),this.hitDetectionInstructions.push(n.$O,d),void 0!==s.fillStyle&&(this.instructions.push(n.gO),this.hitDetectionInstructions.push(n.gO)),void 0!==s.strokeStyle&&(this.instructions.push(n.Yc),this.hitDetectionInstructions.push(n.Yc)),this.endGeometry(e)}drawPolygon(t,e,i){let s=this.state,l=s.fillStyle,o=s.strokeStyle;if(void 0===l&&void 0===o)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,i),void 0!==s.fillStyle&&this.hitDetectionInstructions.push([n.ZP.SET_FILL_STYLE,r.defaultFillStyle]),void 0!==s.strokeStyle&&this.hitDetectionInstructions.push([n.ZP.SET_STROKE_STYLE,s.strokeStyle,s.lineWidth,s.lineCap,s.lineJoin,s.miterLimit,r.defaultLineDash,r.defaultLineDashOffset]);let h=t.getEnds(),a=t.getOrientedFlatCoordinates(),u=t.getStride();this.drawFlatCoordinatess_(a,0,h,u),this.endGeometry(e)}drawMultiPolygon(t,e,i){let s=this.state,l=s.fillStyle,o=s.strokeStyle;if(void 0===l&&void 0===o)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,i),void 0!==s.fillStyle&&this.hitDetectionInstructions.push([n.ZP.SET_FILL_STYLE,r.defaultFillStyle]),void 0!==s.strokeStyle&&this.hitDetectionInstructions.push([n.ZP.SET_STROKE_STYLE,s.strokeStyle,s.lineWidth,s.lineCap,s.lineJoin,s.miterLimit,r.defaultLineDash,r.defaultLineDashOffset]);let h=t.getEndss(),a=t.getOrientedFlatCoordinates(),u=t.getStride(),d=0;for(let t=0,e=h.length;t<e;++t)d=this.drawFlatCoordinatess_(a,d,h[t],u);this.endGeometry(e)}finish(){this.reverseHitDetectionInstructions(),this.state=null;let t=this.tolerance;if(0!==t){let e=this.coordinates;for(let i=0,s=e.length;i<s;++i)e[i]=(0,a.uZ)(e[i],t)}return super.finish()}setFillStrokeStyles_(){let t=this.state;void 0!==t.fillStyle&&this.updateFillStyle(t,this.createFill),void 0!==t.strokeStyle&&this.updateStrokeStyle(t,this.applyStroke)}}var d=i("10244");let c={Circle:u,Default:s.Z,Image:o,LineString:h,Polygon:u,Text:d.Z};var g=class t{constructor(t,e,i,s){this.tolerance_=t,this.maxExtent_=e,this.pixelRatio_=s,this.resolution_=i,this.buildersByZIndex_={}}finish(){let t={};for(let e in this.buildersByZIndex_){t[e]=t[e]||{};let i=this.buildersByZIndex_[e];for(let s in i){let n=i[s].finish();t[e][s]=n}}return t}getBuilder(t,e){let i=void 0!==t?t.toString():"0",s=this.buildersByZIndex_[i];void 0===s&&(s={},this.buildersByZIndex_[i]=s);let n=s[e];return void 0===n&&(n=new c[e](this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),s[e]=n),n}}},82777:function(t,e,i){i.d(e,{QN:function(){return L},ZP:function(){return P},eV:function(){return E},o5:function(){return T}});var s=i("68186"),n=i("33162"),l=i("10244"),o=i("82359"),r=i("21915"),h=i("68509"),a=i("21882"),u=i("17882"),d=i("79682"),c=i("4027");let g=(0,r.createEmpty)(),f=[],_=[],x=[],p=[];function S(t){return t[3].declutterBox}let y=RegExp("["+String.fromCharCode(1425)+"-"+String.fromCharCode(2303)+String.fromCharCode(64285)+"-"+String.fromCharCode(65023)+String.fromCharCode(65136)+"-"+String.fromCharCode(65276)+String.fromCharCode(67584)+"-"+String.fromCharCode(69631)+String.fromCharCode(124928)+"-"+String.fromCharCode(126975)+"]");function m(t,e){return"start"===e?e=y.test(t)?"right":"left":"end"===e&&(e=y.test(t)?"left":"right"),l.I[e]}function I(t,e,i){return i>0&&t.push("\n",""),t.push(e,""),t}var C=class t{constructor(t,e,i,s,l){this.overlaps=i,this.pixelRatio=e,this.resolution=t,this.alignAndScaleFill_,this.instructions=s.instructions,this.coordinates=s.coordinates,this.coordinateCache_={},this.renderedTransform_=(0,o.Ue)(),this.hitDetectionInstructions=s.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=s.fillStates||{},this.strokeStates=s.strokeStates||{},this.textStates=s.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=l?new n.Z:null}getZIndexContext(){return this.zIndexContext_}createLabel(t,e,i,s){let n;let o=t+e+i+s;if(this.labels_[o])return this.labels_[o];let r=s?this.strokeStates[s]:null,a=i?this.fillStates[i]:null,u=this.textStates[e],d=this.pixelRatio,c=[u.scale[0]*d,u.scale[1]*d],g=u.justify?l.I[u.justify]:m(Array.isArray(t)?t[0]:t,u.textAlign||h.defaultTextAlign),f=s&&r.lineWidth?r.lineWidth:0,_=Array.isArray(t)?t:String(t).split("\n").reduce(I,[]),{width:x,height:p,widths:S,heights:y,lineWidths:C}=(0,h.getTextDimensions)(u,_),k=x+f,v=[],L=(k+2)*c[0],T=(p+f)*c[1],E={width:L<0?Math.floor(L):Math.ceil(L),height:T<0?Math.floor(T):Math.ceil(T),contextInstructions:v};(1!=c[0]||1!=c[1])&&v.push("scale",c),s&&(v.push("strokeStyle",r.strokeStyle),v.push("lineWidth",f),v.push("lineCap",r.lineCap),v.push("lineJoin",r.lineJoin),v.push("miterLimit",r.miterLimit),v.push("setLineDash",[r.lineDash]),v.push("lineDashOffset",r.lineDashOffset)),i&&v.push("fillStyle",a.fillStyle),v.push("textBaseline","middle"),v.push("textAlign","center");let D=.5-g,P=g*k+D*f,M=[],b=[],O=0,R=0,F=0,w=0;for(let t=0,e=_.length;t<e;t+=2){let e=_[t];if("\n"===e){R+=O,O=0,P=g*k+D*f,++w;continue}let l=_[t+1]||u.font;l!==n&&(s&&M.push("font",l),i&&b.push("font",l),n=l),O=Math.max(O,y[F]);let o=[e,P+D*S[F]+g*(S[F]-C[w]),.5*(f+O)+R];P+=S[F],s&&M.push("strokeText",o),i&&b.push("fillText",o),++F}return Array.prototype.push.apply(v,M),Array.prototype.push.apply(v,b),this.labels_[o]=E,E}replayTextBackground_(t,e,i,s,n,l,o){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,i),t.lineTo.apply(t,s),t.lineTo.apply(t,n),t.lineTo.apply(t,e),l&&(this.alignAndScaleFill_=l[2],this.fill_(t)),o&&(this.setStrokeStyle_(t,o),t.stroke())}calculateImageOrLabelDimensions_(t,e,i,s,n,l,h,a,u,d,c,S,y,m,I,C){let k;h*=S[0],a*=S[1];let v=i-h,L=s-a,T=n+u>t?t-u:n,E=l+d>e?e-d:l,D=m[3]+T*S[0]+m[1],P=m[0]+E*S[1]+m[2],M=v-m[3],b=L-m[0];return(I||0!==c)&&(f[0]=M,p[0]=M,f[1]=b,_[1]=b,_[0]=M+D,x[0]=_[0],x[1]=b+P,p[1]=x[1]),0!==c?(k=(0,o.qC)((0,o.Ue)(),i,s,1,1,c,-i,-s),(0,o.nn)(k,f),(0,o.nn)(k,_),(0,o.nn)(k,x),(0,o.nn)(k,p),(0,r.createOrUpdate)(Math.min(f[0],_[0],x[0],p[0]),Math.min(f[1],_[1],x[1],p[1]),Math.max(f[0],_[0],x[0],p[0]),Math.max(f[1],_[1],x[1],p[1]),g)):(0,r.createOrUpdate)(Math.min(M,M+D),Math.min(b,b+P),Math.max(M,M+D),Math.max(b,b+P),g),y&&(v=Math.round(v),L=Math.round(L)),{drawImageX:v,drawImageY:L,drawImageW:T,drawImageH:E,originX:u,originY:d,declutterBox:{minX:g[0],minY:g[1],maxX:g[2],maxY:g[3],value:C},canvasTransform:k,scale:S}}replayImageOrLabel_(t,e,i,s,n,l,o){let r=!!(l||o),a=s.declutterBox,u=o?o[2]*s.scale[0]/2:0;return a.minX-u<=e[0]&&a.maxX+u>=0&&a.minY-u<=e[1]&&a.maxY+u>=0&&(r&&this.replayTextBackground_(t,f,_,x,p,l,o),(0,h.drawImageOrLabel)(t,s.canvasTransform,n,i,s.originX,s.originY,s.drawImageW,s.drawImageH,s.drawImageX,s.drawImageY,s.scale)),!0}fill_(t){let e=this.alignAndScaleFill_;if(e){let i=(0,o.nn)(this.renderedTransform_,[0,0]),s=512*this.pixelRatio;t.save(),t.translate(i[0]%s,i[1]%s),1!==e&&t.scale(e,e),t.rotate(this.viewRotation_)}t.fill(),e&&t.restore()}setStrokeStyle_(t,e){t.strokeStyle=e[1],t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],t.lineDashOffset=e[7],t.setLineDash(e[6])}drawLabelWithPointPlacement_(t,e,i,s){let n=this.textStates[e],o=this.createLabel(t,e,s,i),r=this.strokeStates[i],a=this.pixelRatio,u=m(Array.isArray(t)?t[0]:t,n.textAlign||h.defaultTextAlign),d=l.I[n.textBaseline||h.defaultTextBaseline],c=r&&r.lineWidth?r.lineWidth:0,g=o.width/a-2*n.scale[0],f=d*o.height/a+2*(.5-d)*c;return{label:o,anchorX:u*g+2*(.5-u)*c,anchorY:f}}execute_(t,e,i,n,l,g,f,_){let x,p,y,I,C,k,v,L,T,E,D,P,M,b,O,R,F,w;let Z=this.zIndexContext_;this.pixelCoordinates_&&(0,d.fS)(i,this.renderedTransform_)?x=this.pixelCoordinates_:(!this.pixelCoordinates_&&(this.pixelCoordinates_=[]),x=(0,u.vT)(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),(0,o.lk)(this.renderedTransform_,i));let W=0,A=n.length,G=0,Y=0,B=0,N=null,K=null,U=this.coordinateCache_,X=this.viewRotation_,J=Math.round(1e12*Math.atan2(-i[1],i[0]))/1e12,V={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:X},H=this.instructions!=n||this.overlaps?0:200;for(;W<A;){let i=n[W];switch(i[0]){case s.ZP.BEGIN_GEOMETRY:O=i[1],w=i[3],O.getGeometry()?void 0===f||(0,r.intersects)(f,w.getExtent())?++W:W=i[2]+1:W=i[2],Z&&(Z.zIndex=i[4]);break;case s.ZP.BEGIN_PATH:Y>H&&(this.fill_(t),Y=0),B>H&&(t.stroke(),B=0),!Y&&!B&&(t.beginPath(),k=NaN,v=NaN),++W;break;case s.ZP.CIRCLE:let o=x[G=i[1]],d=x[G+1],A=x[G+2],j=x[G+3],z=A-o,$=j-d,q=Math.sqrt(z*z+$*$);t.moveTo(o+q,d),t.arc(o,d,q,0,2*Math.PI,!0),++W;break;case s.ZP.CLOSE_PATH:t.closePath(),++W;break;case s.ZP.CUSTOM:G=i[1],p=i[2];let Q=i[3],tt=i[4],te=i[5];V.geometry=Q,V.feature=O,!(W in U)&&(U[W]=[]);let ti=U[W];te?te(x,G,p,2,ti):(ti[0]=x[G],ti[1]=x[G+1],ti.length=2),Z&&(Z.zIndex=i[6]),tt(ti,V),++W;break;case s.ZP.DRAW_IMAGE:let ts,tn,tl,to;G=i[1],p=i[2],E=i[3],y=i[4],I=i[5];let tr=i[6],th=i[7],ta=i[8],tu=i[9],td=i[10],tc=i[11],tg=i[12],tf=i[13];C=i[14]||"declutter";let t_=i[15];if(!E&&i.length>=20){D=i[19],P=i[20],M=i[21],b=i[22];let t=this.drawLabelWithPointPlacement_(D,P,M,b);E=t.label,i[3]=E;let e=i[23];y=(t.anchorX-e)*this.pixelRatio,i[4]=y;let s=i[24];I=(t.anchorY-s)*this.pixelRatio,i[5]=I,tr=E.height,i[6]=tr,tf=E.width,i[13]=tf}i.length>25&&(ts=i[25]),i.length>17?(tn=i[16],tl=i[17],to=i[18]):(tn=h.defaultPadding,tl=!1,to=!1),td&&J?tc+=X:!td&&!J&&(tc-=X);let tx=0;for(;G<p;G+=2){if(ts&&ts[tx++]<tf/this.pixelRatio)continue;let i=this.calculateImageOrLabelDimensions_(E.width,E.height,x[G],x[G+1],tf,tr,y,I,ta,tu,tc,tg,l,tn,tl||to,O),s=[t,e,E,i,th,tl?N:null,to?K:null];if(_){let t,e,n,l,o;if(t_){let i=p-G;if(!t_[i]){t_[i]={args:s,declutterMode:C};continue}let l=t_[i];t=l.args,e=l.declutterMode,delete t_[i],n=S(t)}if(t&&("declutter"!==e||!_.collides(n))&&(l=!0),("declutter"!==C||!_.collides(i.declutterBox))&&(o=!0),"declutter"===e&&"declutter"===C){let t=l&&o;l=t,o=t}l&&("none"!==e&&_.insert(n),this.replayImageOrLabel_.apply(this,t)),o&&("none"!==C&&_.insert(i.declutterBox),this.replayImageOrLabel_.apply(this,s))}else this.replayImageOrLabel_.apply(this,s)}++W;break;case s.ZP.DRAW_CHARS:let tp;let tS=i[1],ty=i[2],tm=i[3],tI=i[4];b=i[5];let tC=i[6],tk=i[7],tv=i[8];M=i[9];let tL=i[10];D=i[11],P=i[12];let tT=[i[13],i[13]];C=i[14]||"declutter";let tE=i[15],tD=this.textStates[P],tP=tD.font,tM=[tD.scale[0]*tk,tD.scale[1]*tk];tP in this.widths_?tp=this.widths_[tP]:(tp={},this.widths_[tP]=tp);let tb=(0,c.W)(x,tS,ty,2),tO=Math.abs(tM[0])*(0,h.measureAndCacheTextWidth)(tP,D,tp);if(tI||tO<=tb){let i=(tb-tO)*m(D,this.textStates[P].textAlign),s=function(t,e,i,s,n,l,o,r,h,d,c,g,f=!0){let _,x=t[e],p=t[e+1],S=0,y=0,m=0,I=0;function C(){S=x,y=p,e+=2,x=t[e],p=t[e+1],I+=m,m=Math.sqrt((x-S)*(x-S)+(p-y)*(p-y))}do C();while(e<i-s&&I+m<l);let k=0===m?0:(l-I)/m,v=(0,a.t7)(S,x,k),L=(0,a.t7)(y,p,k),T=e-s,E=I,D=l+r*h(d,n,c);for(;e<i-s&&I+m<D;)C();k=0===m?0:(D-I)/m;let P=(0,a.t7)(S,x,k),M=(0,a.t7)(y,p,k),b=!1;if(f){if(g){let t=[v,L,P,M];(0,u.U1)(t,0,4,2,g,t,t),b=t[0]>t[2]}else b=v>P}let O=Math.PI,R=[],F=T+s===e;if(e=T,m=0,I=E,x=t[e],p=t[e+1],F){C(),_=Math.atan2(p-y,x-S),b&&(_+=_>0?-O:O);let t=(P+v)/2,e=(M+L)/2;return R[0]=[t,e,(D-l)/2,_,n],R}n=n.replace(/\n/g," ");for(let t=0,u=n.length;t<u;){C();let g=Math.atan2(p-y,x-S);if(b&&(g+=g>0?-O:O),void 0!==_){let t=g-_;if(t+=t>O?-2*O:t<-O?2*O:0,Math.abs(t)>o)return null}_=g;let f=t,v=0;for(;t<u;++t){let o=r*h(d,n[b?u-t-1:t],c);if(e+s<i&&I+m<l+v+o/2)break;v+=o}if(t===f)continue;let L=b?n.substring(u-f,u-t):n.substring(f,t);k=0===m?0:(l+v/2-I)/m;let T=(0,a.t7)(S,x,k),E=(0,a.t7)(y,p,k);R.push([T,E,v/2,g,L]),l+=v}return R}(x,tS,ty,2,D,i,tC,Math.abs(tM[0]),h.measureAndCacheTextWidth,tP,tp,J?0:this.viewRotation_,tE);t:if(s){let i,n,l,o,r;let a=[];if(M)for(i=0,n=s.length;i<n;++i){l=(r=s[i])[4],o=this.createLabel(l,P,"",M),y=r[2]+(tM[0]<0?-tL:tL),I=tm*o.height+(.5-tm)*2*tL*tM[1]/tM[0]-tv;let n=this.calculateImageOrLabelDimensions_(o.width,o.height,r[0],r[1],o.width,o.height,y,I,0,0,r[3],tT,!1,h.defaultPadding,!1,O);if(_&&"declutter"===C&&_.collides(n.declutterBox))break t;a.push([t,e,o,n,1,null,null])}if(b)for(i=0,n=s.length;i<n;++i){l=(r=s[i])[4],o=this.createLabel(l,P,b,""),y=r[2],I=tm*o.height-tv;let n=this.calculateImageOrLabelDimensions_(o.width,o.height,r[0],r[1],o.width,o.height,y,I,0,0,r[3],tT,!1,h.defaultPadding,!1,O);if(_&&"declutter"===C&&_.collides(n.declutterBox))break t;a.push([t,e,o,n,1,null,null])}_&&"none"!==C&&_.load(a.map(S));for(let t=0,e=a.length;t<e;++t)this.replayImageOrLabel_.apply(this,a[t])}}++W;break;case s.ZP.END_GEOMETRY:if(void 0!==g){let t=g(O=i[1],w,C);if(t)return t}++W;break;case s.ZP.FILL:H?Y++:this.fill_(t),++W;break;case s.ZP.MOVE_TO_LINE_TO:for(G=i[1],p=i[2],R=x[G],F=x[G+1],t.moveTo(R,F),k=R+.5|0,v=F+.5|0,G+=2;G<p;G+=2)R=x[G],F=x[G+1],L=R+.5|0,T=F+.5|0,(G==p-2||L!==k||T!==v)&&(t.lineTo(R,F),k=L,v=T);++W;break;case s.ZP.SET_FILL_STYLE:N=i,this.alignAndScaleFill_=i[2],Y&&(this.fill_(t),Y=0,B&&(t.stroke(),B=0)),t.fillStyle=i[1],++W;break;case s.ZP.SET_STROKE_STYLE:K=i,B&&(t.stroke(),B=0),this.setStrokeStyle_(t,i),++W;break;case s.ZP.STROKE:H?B++:t.stroke(),++W;break;default:++W}}Y&&this.fill_(t),B&&t.stroke()}execute(t,e,i,s,n,l){this.viewRotation_=s,this.execute_(t,e,i,this.instructions,n,void 0,void 0,l)}executeHitDetection(t,e,i,s,n){return this.viewRotation_=i,this.execute_(t,[t.canvas.width,t.canvas.height],e,this.hitDetectionInstructions,!0,s,n)}},k=i("85386"),v=i("13580");let L=["Polygon","Circle","LineString","Image","Text","Default"],T=["Image","Text"],E=L.filter(t=>!T.includes(t)),D={};var P=class t{constructor(t,e,i,s,n,l,r){this.maxExtent_=t,this.overlaps_=s,this.pixelRatio_=i,this.resolution_=e,this.renderBuffer_=l,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=(0,o.Ue)(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(n,r)}clip(t,e){let i=this.getClipCoords(e);t.beginPath(),t.moveTo(i[0],i[1]),t.lineTo(i[2],i[3]),t.lineTo(i[4],i[5]),t.lineTo(i[6],i[7]),t.clip()}createExecutors_(t,e){for(let i in t){let s=this.executorsByZIndex_[i];void 0===s&&(s={},this.executorsByZIndex_[i]=s);let n=t[i];for(let t in n){let i=n[t];s[t]=new C(this.resolution_,this.pixelRatio_,this.overlaps_,i,e)}}}hasExecutors(t){for(let e in this.executorsByZIndex_){let i=this.executorsByZIndex_[e];for(let e=0,s=t.length;e<s;++e)if(t[e]in i)return!0}return!1}forEachFeatureAtCoordinate(t,e,i,s,n,l){let h,a,u,c,g,f,_;let x=2*(s=Math.round(s))+1,p=(0,o.qC)(this.hitDetectionTransform_,s+.5,s+.5,1/e,-1/e,-i,-t[0],-t[1]),S=!this.hitDetectionContext_;S&&(this.hitDetectionContext_=(0,k.E4)(x,x,void 0,{willReadFrequently:!0}));let y=this.hitDetectionContext_;y.canvas.width!==x||y.canvas.height!==x?(y.canvas.width=x,y.canvas.height=x):!S&&y.clearRect(0,0,x,x),void 0!==this.renderBuffer_&&(h=(0,r.createEmpty)(),(0,r.extendCoordinate)(h,t),(0,r.buffer)(h,e*(this.renderBuffer_+s),h));let m=function(t){if(void 0!==D[t])return D[t];let e=2*t+1,i=t*t,s=Array(i+1);for(let n=0;n<=t;++n)for(let l=0;l<=t;++l){let o=n*n+l*l;if(o>i)break;let r=s[o];!r&&(r=[],s[o]=r),r.push(((t+n)*e+(t+l))*4+3),n>0&&r.push(((t-n)*e+(t+l))*4+3),l>0&&(r.push(((t+n)*e+(t-l))*4+3),n>0&&r.push(((t-n)*e+(t-l))*4+3))}let n=[];for(let t=0,e=s.length;t<e;++t)s[t]&&n.push(...s[t]);return D[t]=n,n}(s);function I(t,e,i){let o=y.getImageData(0,0,x,x).data;for(let r=0,h=m.length;r<h;r++)if(o[m[r]]>0){if(!l||"none"===i||"Image"!==a&&"Text"!==a||l.includes(t)){let i=(m[r]-3)/4,l=s-i%x,o=s-(i/x|0),h=n(t,e,l*l+o*o);if(h)return h}y.clearRect(0,0,x,x);break}}let C=Object.keys(this.executorsByZIndex_).map(Number);for(C.sort(d.j2),u=C.length-1;u>=0;--u){let t=C[u].toString();for(g=this.executorsByZIndex_[t],c=L.length-1;c>=0;--c)if(void 0!==(f=g[a=L[c]])&&(_=f.executeHitDetection(y,p,i,I,h)))return _}}getClipCoords(t){let e=this.maxExtent_;if(!e)return null;let i=e[0],s=e[1],n=e[2],l=e[3],o=[i,s,i,l,n,l,n,s];return(0,u.vT)(o,0,8,2,t,o),o}isEmpty(){return(0,v.x)(this.executorsByZIndex_)}execute(t,e,i,s,n,l,o){let r=Object.keys(this.executorsByZIndex_).map(Number);r.sort(o?d.$1:d.j2),l=l||L;let h=L.length;for(let a=0,u=r.length;a<u;++a){let u=r[a].toString(),d=this.executorsByZIndex_[u];for(let u=0,c=l.length;u<c;++u){let c=l[u],g=d[c];if(void 0!==g){let l=null===o?void 0:g.getZIndexContext(),d=l?l.getContext():t,f=this.maxExtent_&&"Image"!==c&&"Text"!==c;if(f&&(d.save(),this.clip(d,i)),l&&"Text"!==c&&"Image"!==c?l.pushFunction(t=>g.execute(t,e,i,s,n,o)):g.execute(d,e,i,s,n,o),f&&d.restore(),l){l.offset();let t=r[a]*h+u;!this.deferredZIndexContexts_[t]&&(this.deferredZIndexContexts_[t]=[]),this.deferredZIndexContexts_[t].push(l)}}}}this.renderedContext_=t}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){let t=this.deferredZIndexContexts_,e=Object.keys(t).map(Number).sort(d.j2);for(let i=0,s=e.length;i<s;++i)t[e[i]].forEach(t=>{t.draw(this.renderedContext_),t.clear()}),t[e[i]].length=0}}},68186:function(t,e,i){i.d(e,{$O:function(){return o},Yc:function(){return l},gO:function(){return n},s3:function(){return r}});let s={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},n=[s.FILL],l=[s.STROKE],o=[s.BEGIN_PATH],r=[s.CLOSE_PATH];e.ZP=s},10244:function(t,e,i){i.d(e,{Z:function(){return c},I:function(){return u}});var s=i("80567"),n=i("68186"),l=i("45120"),o=i("68509"),r=i("49179"),h=i("21915"),a=i("21882");let u={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class d extends s.Z{constructor(t,e,i,s){super(t,e,i,s),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[o.defaultFillStyle]={fillStyle:o.defaultFillStyle},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){let t=super.finish();return t.textStates=this.textStates,t.fillStates=this.fillStates,t.strokeStates=this.strokeStates,t}drawText(t,e,i){let s=this.textFillState_,l=this.textStrokeState_,r=this.textState_;if(""===this.text_||!r||!s&&!l)return;let u=this.coordinates,d=u.length,c=t.getType(),g=null,f=t.getStride();if("line"===r.placement&&("LineString"==c||"MultiLineString"==c||"Polygon"==c||"MultiPolygon"==c)){let s;if(!(0,h.intersects)(this.maxExtent,t.getExtent()))return;if(g=t.getFlatCoordinates(),"LineString"==c)s=[g.length];else if("MultiLineString"==c)s=t.getEnds();else if("Polygon"==c)s=t.getEnds().slice(0,1);else if("MultiPolygon"==c){let e=t.getEndss();s=[];for(let t=0,i=e.length;t<i;++t)s.push(e[t][0])}this.beginGeometry(t,e,i);let n=r.repeat,l=n?void 0:r.textAlign,o=0;for(let t=0,e=s.length;t<e;++t){let e;e=n?function(t,e,i,s,n){let l=[],o=i,r=0,h=e.slice(i,2);for(;r<t&&o+n<s;){let[i,s]=h.slice(-2),u=e[o+n],d=e[o+n+1],c=Math.sqrt((u-i)*(u-i)+(d-s)*(d-s));if((r+=c)>=t){let e=(t-r+c)/c,g=(0,a.t7)(i,u,e),f=(0,a.t7)(s,d,e);h.push(g,f),l.push(h),h=[g,f],r==t&&(o+=n),r=0}else if(r<t)h.push(e[o+n],e[o+n+1]),o+=n;else{let t=c-r,e=(0,a.t7)(i,u,t/c),g=(0,a.t7)(s,d,t/c);h.push(e,g),l.push(h),h=[e,g],r=0,o+=n}}return r>0&&l.push(h),l}(n*this.resolution,g,o,s[t],f):[g.slice(o,s[t])];for(let i=0,n=e.length;i<n;++i){let n=e[i],h=0,a=n.length;if(void 0==l){let t=function(t,e,i,s,n){let l,o,r,h,a,u,d,c,g,f=0,_=i,x=0,p=0,S=i;for(l=i;l<s;l+=2){let i=e[l],s=e[l+1];void 0!==h&&(r=Math.sqrt((c=i-h)*c+(g=s-a)*g),void 0!==u&&(p+=o,Math.acos((u*c+d*g)/(o*r))>t&&(p>x&&(x=p,f=S,_=l),p=0,S=l-n)),o=r,u=c,d=g),h=i,a=s}return(p+=r)>x?[S,l]:[f,_]}(r.maxAngle,n,0,n.length,2);h=t[0],a=t[1]}for(let t=h;t<a;t+=f)u.push(n[t],n[t+1]);let c=u.length;o=s[t],this.drawChars_(d,c),d=c}}this.endGeometry(e)}else{let s=r.overflow?null:[];switch(c){case"Point":case"MultiPoint":g=t.getFlatCoordinates();break;case"LineString":g=t.getFlatMidpoint();break;case"Circle":g=t.getCenter();break;case"MultiLineString":g=t.getFlatMidpoints(),f=2;break;case"Polygon":g=t.getFlatInteriorPoint(),!r.overflow&&s.push(g[2]/this.resolution),f=3;break;case"MultiPolygon":let l=t.getFlatInteriorPoints();g=[];for(let t=0,e=l.length;t<e;t+=3)!r.overflow&&s.push(l[t+2]/this.resolution),g.push(l[t],l[t+1]);if(0===g.length)return;f=2}let h=this.appendFlatPointCoordinates(g,f);if(h===d)return;if(s&&(h-d)/2!=g.length/f){let t=d/2;s=s.filter((e,i)=>{let s=u[(t+i)*2]===g[i*f]&&u[(t+i)*2+1]===g[i*f+1];return!s&&--t,s})}this.saveTextStates_(),(r.backgroundFill||r.backgroundStroke)&&(this.setFillStrokeStyle(r.backgroundFill,r.backgroundStroke),r.backgroundFill&&this.updateFillStyle(this.state,this.createFill),r.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,e,i);let a=r.padding;if(a!=o.defaultPadding&&(r.scale[0]<0||r.scale[1]<0)){let t=r.padding[0],e=r.padding[1],i=r.padding[2],s=r.padding[3];r.scale[0]<0&&(e=-e,s=-s),r.scale[1]<0&&(t=-t,i=-i),a=[t,e,i,s]}let _=this.pixelRatio;this.instructions.push([n.ZP.DRAW_IMAGE,d,h,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,a==o.defaultPadding?o.defaultPadding:a.map(function(t){return t*_}),!!r.backgroundFill,!!r.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,s]);let x=1/_,p=this.state.fillStyle;r.backgroundFill&&(this.state.fillStyle=o.defaultFillStyle,this.hitDetectionInstructions.push(this.createFill(this.state))),this.hitDetectionInstructions.push([n.ZP.DRAW_IMAGE,d,h,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[x,x],NaN,this.declutterMode_,this.declutterImageWithText_,a,!!r.backgroundFill,!!r.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?o.defaultFillStyle:this.fillKey_,this.textOffsetX_,this.textOffsetY_,s]),r.backgroundFill&&(this.state.fillStyle=p,this.hitDetectionInstructions.push(this.createFill(this.state))),this.endGeometry(e)}}saveTextStates_(){let t=this.textStrokeState_,e=this.textState_,i=this.textFillState_,s=this.strokeKey_;t&&!(s in this.strokeStates)&&(this.strokeStates[s]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash});let n=this.textKey_;!(n in this.textStates)&&(this.textStates[n]={font:e.font,textAlign:e.textAlign||o.defaultTextAlign,justify:e.justify,textBaseline:e.textBaseline||o.defaultTextBaseline,scale:e.scale});let l=this.fillKey_;i&&!(l in this.fillStates)&&(this.fillStates[l]={fillStyle:i.fillStyle})}drawChars_(t,e){let i=this.textStrokeState_,s=this.textState_,l=this.strokeKey_,r=this.textKey_,h=this.fillKey_;this.saveTextStates_();let a=this.pixelRatio,d=u[s.textBaseline],c=this.textOffsetY_*a,g=this.text_,f=i?i.lineWidth*Math.abs(s.scale[0])/2:0;this.instructions.push([n.ZP.DRAW_CHARS,t,e,d,s.overflow,h,s.maxAngle,a,c,l,f*a,g,r,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([n.ZP.DRAW_CHARS,t,e,d,s.overflow,h?o.defaultFillStyle:h,s.maxAngle,a,c,l,f*a,g,r,1/a,this.declutterMode_,this.textKeepUpright_])}setTextStyle(t,e){let i,s,n;if(t){let e=t.getFill();e?(!(s=this.textFillState_)&&(s={},this.textFillState_=s),s.fillStyle=(0,l.y)(e.getColor()||o.defaultFillStyle)):(s=null,this.textFillState_=s);let h=t.getStroke();if(h){!(n=this.textStrokeState_)&&(n={},this.textStrokeState_=n);let t=h.getLineDash(),e=h.getLineDashOffset(),i=h.getWidth(),s=h.getMiterLimit();n.lineCap=h.getLineCap()||o.defaultLineCap,n.lineDash=t?t.slice():o.defaultLineDash,n.lineDashOffset=void 0===e?o.defaultLineDashOffset:e,n.lineJoin=h.getLineJoin()||o.defaultLineJoin,n.lineWidth=void 0===i?o.defaultLineWidth:i,n.miterLimit=void 0===s?o.defaultMiterLimit:s,n.strokeStyle=(0,l.y)(h.getColor()||o.defaultStrokeStyle)}else n=null,this.textStrokeState_=n;i=this.textState_;let a=t.getFont()||o.defaultFont;(0,o.registerFont)(a);let u=t.getScaleArray();i.overflow=t.getOverflow(),i.font=a,i.maxAngle=t.getMaxAngle(),i.placement=t.getPlacement(),i.textAlign=t.getTextAlign(),i.repeat=t.getRepeat(),i.justify=t.getJustify(),i.textBaseline=t.getTextBaseline()||o.defaultTextBaseline,i.backgroundFill=t.getBackgroundFill(),i.backgroundStroke=t.getBackgroundStroke(),i.padding=t.getPadding()||o.defaultPadding,i.scale=void 0===u?[1,1]:u;let d=t.getOffsetX(),c=t.getOffsetY(),g=t.getRotateWithView(),f=t.getKeepUpright(),_=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=void 0===d?0:d,this.textOffsetY_=void 0===c?0:c,this.textRotateWithView_=void 0!==g&&g,this.textKeepUpright_=void 0===f||f,this.textRotation_=void 0===_?0:_,this.strokeKey_=n?("string"==typeof n.strokeStyle?n.strokeStyle:(0,r.getUid)(n.strokeStyle))+n.lineCap+n.lineDashOffset+"|"+n.lineWidth+n.lineJoin+n.miterLimit+"["+n.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.repeat||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=s&&s.fillStyle?"string"==typeof s.fillStyle?s.fillStyle:"|"+(0,r.getUid)(s.fillStyle):""}else this.text_="";this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}}var c=d},17356:function(t,e,i){i.d(e,{TU:function(){return d},UN:function(){return u},ix:function(){return c}});var s=i(76798),n=i(46267),l=i(79682),o=i(21882),r=i(85386),h=i(5374),a=i(21915);let u=.5;function d(t,e,i,o,d,c,g,f,_){let x=_?(0,h.toUserExtent)(d,_):d,p=t[0]*u,S=t[1]*u,y=(0,r.E4)(p,S);y.imageSmoothingEnabled=!1;let m=y.canvas,I=new s.Z(y,u,d,null,g,f,_?(0,h.getTransformFromProjections)((0,h.getUserProjection)(),_):null),C=i.length,k=Math.floor(0xffffff/C),v={};for(let t=1;t<=C;++t){let e=i[t-1],s=e.getStyleFunction()||o;if(!s)continue;let l=s(e,c);if(!l)continue;!Array.isArray(l)&&(l=[l]);let h=(t*k).toString(16).padStart(7,"#00000");for(let t=0,i=l.length;t<i;++t){let i=l[t],s=i.getGeometryFunction()(e);if(!s||!(0,a.intersects)(x,s.getExtent()))continue;let o=i.clone(),u=o.getFill();u&&u.setColor(h);let d=o.getStroke();d&&(d.setColor(h),d.setLineDash(null)),o.setText(void 0);let c=i.getImage();if(c){let t=c.getImageSize();if(!t)continue;let e=(0,r.E4)(t[0],t[1],void 0,{alpha:!1}),i=e.canvas;e.fillStyle=h,e.fillRect(0,0,i.width,i.height),o.setImage(new n.default({img:i,anchor:c.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:c.getOrigin(),opacity:1,size:c.getSize(),scale:c.getScale(),rotation:c.getRotation(),rotateWithView:c.getRotateWithView()}))}let g=o.getZIndex()||0,f=v[g];!f&&(f={},v[g]=f,f.Polygon=[],f.Circle=[],f.LineString=[],f.Point=[]);let _=s.getType();if("GeometryCollection"===_){let t=s.getGeometriesArrayRecursive();for(let e=0,i=t.length;e<i;++e){let i=t[e];f[i.getType().replace("Multi","")].push(i,o)}}else f[_.replace("Multi","")].push(s,o)}}let L=Object.keys(v).map(Number).sort(l.j2);for(let t=0,i=L.length;t<i;++t){let i=v[L[t]];for(let t in i){let s=i[t];for(let t=0,i=s.length;t<i;t+=2){I.setStyle(s[t+1]);for(let i=0,n=e.length;i<n;++i)I.setTransform(e[i]),I.drawGeometry(s[t])}}}return y.getImageData(0,0,m.width,m.height)}function c(t,e,i){let s=[];if(i){let n=Math.floor(Math.round(t[0])*u),l=Math.floor(Math.round(t[1])*u),r=((0,o.uZ)(n,0,i.width-1)+(0,o.uZ)(l,0,i.height-1)*i.width)*4,h=i.data[r],a=i.data[r+1],d=i.data[r+2]+256*(a+256*h),c=Math.floor(0xffffff/e.length);d&&d%c==0&&s.push(e[d/c-1])}return s}}}]);
//# sourceMappingURL=975.0cf04e86fdd85afc.js.map