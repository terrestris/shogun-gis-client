"use strict";(self.webpackChunk_terrestris_shogun_gis_client=self.webpackChunk_terrestris_shogun_gis_client||[]).push([["2855"],{40175:function(e,t,n){n.r(t),n.d(t,{BackgroundLayerChooser:function(){return T},default:function(){return D}});var r=n(76395),a=n.n(r),l=n(36693),i=n(46103),s=n(56418),o=n.n(s),c=n(99138),u=n.n(c),g=n(24910),m=n.n(g),d=n(49994),f=n.n(d),p=n(20554),w=n.n(p),v=n(76512),y=n.n(v),E=n(5988),b=n.n(E),k=n(698),V=n.n(k),h=n(50858),C=n(8544),N=n.n(C),L=n(15455),S=n(30126),$=n(96604),M=n(13102),_=n.n(M),F=n(23712),U=n(38225),A=({layer:e,activeLayer:t,width:n=128,height:l=128,onClick:i,zoom:s,center:o,backgroundLayerFilter:c,titleRenderer:g})=>{let[d,p]=(0,r.useState)(!1),w=(0,S.A)(),v=(0,r.useMemo)(()=>e instanceof f()?new(f())({source:e.getSource()}):e instanceof m()?new(m())({source:e.getSource()}):void 0,[e]),y=(0,r.useMemo)(()=>new(_())({view:new(N())({projection:w?.getView().getProjection(),resolutions:w?.getView().getResolutions(),center:o,zoom:s}),controls:[],interactions:[],layers:v&&[v]}),[o,w,v,s]);(0,r.useEffect)(()=>{let e=()=>p(!0),t=()=>p(!1);return y.on("loadstart",e),y.on("loadend",t),()=>{y.un("loadstart",e),y.un("loadend",t)}},[y]),(0,r.useEffect)(()=>{s&&y.getView().setZoom(s),o&&y.getView().setCenter(o)},[s,o,y]);let E=()=>{let e=t=>{if(!t)return[];let n=[];for(let r of t.getLayers().getArray())c(r)&&n.push(r),r instanceof u()&&n.push(...e(r));return n},t=w?.getLayerGroup();return t?e(t):[]},b=e=>{let t=e?.currentTarget,n=t?.dataset?.uid;if(!n||!w)return;let r=F.BY.getLayerByOlUid(w,n);r&&(E().forEach(e=>e.setVisible(!1)),r.setVisible(!0),"click"===e.type&&i(r))},k=!1,V=(0,h.getUid)(e);return t&&(k=V===(0,h.getUid)(t)),a().createElement("div",{className:`layer-preview${k?" selected":""}`,key:V,"data-uid":V,onMouseOver:b,onMouseLeave:()=>{E().forEach(e=>e.setVisible(!1)),t?.setVisible(!0)},onClick:b},a().createElement($.A,{spinning:d},a().createElement(U.default,{mapDivId:`previewmap-${V}`,style:{height:l,width:n},map:y}),a().createElement("span",{className:"layer-title"},g?g(e):e.get("name"))))},B=n(71953);let T=({layers:e,allowEmptyBackground:t=!1,buttonTooltip:n="Change background layer",initiallySelectedLayer:s,noBackgroundTitle:c="No Background",backgroundLayerFilter:g=e=>!!e.get("isBackgroundLayer"),titleRenderer:d})=>{let p=(0,S.A)(),[v,E]=(0,r.useState)(p?.getView()?.getZoom()),[k,C]=(0,r.useState)(p?.getView()?.getCenter()),[$,M]=(0,r.useState)(!1),[_,F]=(0,r.useState)(),[U,T]=(0,r.useState)(!1),D=(0,r.useRef)(null);return(0,r.useEffect)(()=>{if(p&&$){C(p.getView().getCenter()),E(p.getView().getZoom());let e=e=>{C(e.target.getCenter())},t=e=>{E(e.target.getZoom())};return p.getView().on("change:center",e),p.getView().on("change:resolution",t),()=>{p.getView().un("change:center",e),p.getView().un("change:resolution",t)}}},[p,$]),(0,r.useEffect)(()=>{s?F(s):F(e.find(e=>e.getVisible()))},[s,e]),(0,r.useEffect)(()=>{if(!_||!p)return;let e=_.getSource(),t=null;if(_ instanceof f()){let n=null;if(e instanceof b())n=new(b())({url:e.getUrls()?.[0],params:e.getParams(),tileLoadFunction:e.getTileLoadFunction()});else if(e instanceof y())n=new(y());else if(e instanceof V()){let t=e.getTileGrid();if(!t)return;n=new(V())({url:e.getUrls()?.[0],layer:e.getLayer(),matrixSet:e.getMatrixSet(),format:e.getFormat(),tileGrid:t,style:e.getStyle(),requestEncoding:e.getRequestEncoding(),version:e.getVersion(),dimensions:e.getDimensions(),wrapX:e.getWrapX()})}n&&(t=new(f())({source:n}))}else if(_ instanceof m()){let n=null;e instanceof w()&&(n=new(w())({url:e.getUrl(),params:e.getParams(),imageLoadFunction:e.getImageLoadFunction()})),n&&(t=new(m())({source:_.getSource()}))}else _ instanceof u()&&(_.get("isVectorTile")?(t=new(u()),(0,L.Bb)(t,_.get("url"))):t=new(u())({layers:_.getLayers()}));if(t&&D.current){let e=new(o())({collapsible:!1,target:D.current,className:"ol-overviewmap react-geo-bg-layer-chooser-overviewmap",layers:[t],view:new(N())({projection:p.getView().getProjection()})});return p.addControl(e),()=>{p.removeControl(e)}}},[_,p]),a().createElement("div",{className:"bg-layer-chooser"},$&&a().createElement("div",{className:"layer-cards"},e.filter(g).map(e=>a().createElement(A,{key:(0,h.getUid)(e),activeLayer:_,onClick:e=>{M(!1),F(e),T(!1)},layer:e,backgroundLayerFilter:g,zoom:v,center:k,titleRenderer:d})),t&&a().createElement("div",{className:`no-background${_?"":" selected"}`,onMouseOver:()=>{_?.setVisible(!1)},onMouseLeave:()=>{_?.setVisible(!0)},onClick:()=>{_?.setVisible(!1),F(void 0),M(!1),T(!0)}},a().createElement("div",{className:"no-background-preview"},a().createElement(i.g,{icon:l.Dfk})),a().createElement("span",{className:"layer-title"},c))),a().createElement(B.default,{className:`change-bg-btn${$?" toggled":""}`,size:"small",tooltip:n,icon:$?a().createElement(i.g,{icon:l.XkK}):a().createElement(i.g,{icon:l.Wzs}),onClick:()=>M(!$)}),a().createElement("div",{className:"bg-preview"},U?a().createElement("div",{className:"no-background-preview"},a().createElement(i.g,{icon:l.Dfk})):a().createElement("div",{id:"overview-map",ref:D}),_?a().createElement("span",{className:"layer-title"},d?d(_):_.get("name")):a().createElement("span",{className:"layer-title"},c)))};var D=T},71953:function(e,t,n){n.r(t);var r=n(76395),a=n(54440),l=n(74097),i=n(70198);let s=`${i.$}simplebutton`;t.default=({className:e,type:t="primary",tooltip:n,tooltipPlacement:i,tooltipProps:o={mouseEnterDelay:1.5},children:c,...u})=>{let g=e?`${e} ${s}`:`${s}`;return r.createElement(a.A,{title:n,placement:i,...o},r.createElement(l.Ay,{className:g,type:t,...u},c))}},38225:function(e,t,n){n.r(t),n.d(t,{MapComponent:function(){return l}});var r=n(76395),a=n.n(r);let l=({map:e,mapDivId:t="map",...n})=>{let l=(0,r.useCallback)(t=>{e&&(null===t?e.setTarget(void 0):e.setTarget(t))},[e]);return e?a().createElement("div",{id:t,ref:l,className:"map",role:"presentation",...n}):a().createElement(a().Fragment,null)};t.default=l},70198:function(e,t,n){n.d(t,{$:function(){return r}});let r="react-geo-"}}]);
//# sourceMappingURL=2855.db2420cc4359ef75.js.map