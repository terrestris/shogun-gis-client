"use strict";(self.webpackChunk_terrestris_shogun_gis_client=self.webpackChunk_terrestris_shogun_gis_client||[]).push([["2855"],{40175:function(e,t,n){n.r(t),n.d(t,{BackgroundLayerChooser:function(){return A},default:function(){return R}});var r=n(76395),a=n.n(r),l=n(36693),o=n(46103),i=n(56418),s=n.n(i),c=n(99138),u=n.n(c),g=n(24910),m=n.n(g),d=n(49994),f=n.n(d),p=n(20554),y=n.n(p),w=n(76512),v=n.n(w),E=n(5988),b=n.n(E),k=n(698),V=n.n(k),h=n(50858),S=n(8544),C=n.n(S),N=n(15455),L=n(30126),$=n(96604),D=n(13102),F=n.n(D),B=n(23712),M=n(38225),_=({layer:e,activeLayer:t,width:n=128,height:l=128,onClick:o,zoom:i,center:s,backgroundLayerFilter:c,titleRenderer:g})=>{let[d,p]=(0,r.useState)(!1),y=(0,L.A)(),w=(0,r.useMemo)(()=>e instanceof f()?new(f())({source:e.getSource()}):e instanceof m()?new(m())({source:e.getSource()}):void 0,[e]),v=(0,r.useMemo)(()=>new(F())({view:new(C())({projection:y?.getView().getProjection(),resolutions:y?.getView().getResolutions(),center:s,zoom:i}),controls:[],interactions:[],layers:w&&[w]}),[s,y,w,i]);(0,r.useEffect)(()=>{let e=()=>p(!0),t=()=>p(!1);return v.on("loadstart",e),v.on("loadend",t),()=>{v.un("loadstart",e),v.un("loadend",t)}},[v]),(0,r.useEffect)(()=>{i&&v.getView().setZoom(i),s&&v.getView().setCenter(s)},[i,s,v]);let E=()=>{let e=t=>{if(!t)return[];let n=[];for(let r of t.getLayers().getArray())c(r)&&n.push(r),r instanceof u()&&n.push(...e(r));return n},t=y?.getLayerGroup();return t?e(t):[]},b=e=>{let t=e?.currentTarget,n=t?.dataset?.uid;if(!n||!y)return;let r=B.BY.getLayerByOlUid(y,n);r&&(E().forEach(e=>e.setVisible(!1)),r.setVisible(!0),("click"===e.type||"keydown"===e.type)&&o(r))},k=!1,V=(0,h.getUid)(e);t&&(k=V===(0,h.getUid)(t));let S=(0,r.useRef)(void 0);return a().createElement("div",{className:`layer-preview${k?" selected":""}`,key:V,"data-uid":V,role:"button",tabIndex:0,onMouseOver:b,onMouseLeave:()=>{E().forEach(e=>e.setVisible(!1)),t?.setVisible(!0)},onFocus:()=>{S.current=e},onBlur:()=>{S.current=void 0},onKeyDown:e=>{let t="Enter"===e.key||"Enter"===e.code,n=" "===e.key||"Spacebar"===e.key||"Space"===e.code;(t||n)&&(n&&e.preventDefault(),S.current&&b(e))},onClick:b},a().createElement($.A,{spinning:d},a().createElement(M.default,{mapDivId:`previewmap-${V}`,style:{height:l,width:n},map:v}),a().createElement("span",{className:"layer-title"},g?g(e):e.get("name"))))},U=n(71953);let A=({layers:e,allowEmptyBackground:t=!1,buttonTooltip:n="Change background layer",initiallySelectedLayer:i,noBackgroundTitle:c="No Background",backgroundLayerFilter:g=e=>!!e.get("isBackgroundLayer"),titleRenderer:d})=>{let p=(0,L.A)(),[w,E]=(0,r.useState)(p?.getView()?.getZoom()),[k,S]=(0,r.useState)(p?.getView()?.getCenter()),[$,D]=(0,r.useState)(!1),[F,B]=(0,r.useState)(),[M,A]=(0,r.useState)(!1),R=(0,r.useRef)(null);(0,r.useEffect)(()=>{if(p&&$){S(p.getView().getCenter()),E(p.getView().getZoom());let e=e=>{S(e.target.getCenter())},t=e=>{E(e.target.getZoom())};return p.getView().on("change:center",e),p.getView().on("change:resolution",t),()=>{p.getView().un("change:center",e),p.getView().un("change:resolution",t)}}},[p,$]),(0,r.useEffect)(()=>{i?B(i):B(e.find(e=>e.getVisible()))},[i,e]),(0,r.useEffect)(()=>{if(!F||!p)return;let e=F.getSource(),t=null;if(F instanceof f()){let n=null;if(e instanceof b())n=new(b())({url:e.getUrls()?.[0],params:e.getParams(),tileLoadFunction:e.getTileLoadFunction()});else if(e instanceof v())n=new(v());else if(e instanceof V()){let t=e.getTileGrid();if(!t)return;n=new(V())({url:e.getUrls()?.[0],layer:e.getLayer(),matrixSet:e.getMatrixSet(),format:e.getFormat(),tileGrid:t,style:e.getStyle(),requestEncoding:e.getRequestEncoding(),version:e.getVersion(),dimensions:e.getDimensions(),wrapX:e.getWrapX()})}n&&(t=new(f())({source:n}))}else if(F instanceof m()){let n=null;e instanceof y()&&(n=new(y())({url:e.getUrl(),params:e.getParams(),imageLoadFunction:e.getImageLoadFunction()})),n&&(t=new(m())({source:F.getSource()}))}else F instanceof u()&&(F.get("isVectorTile")?(t=new(u()),(0,N.Bb)(t,F.get("url"))):t=new(u())({layers:F.getLayers()}));if(t&&R.current){let e=new(s())({collapsible:!1,target:R.current,className:"ol-overviewmap react-geo-bg-layer-chooser-overviewmap",layers:[t],view:new(C())({projection:p.getView().getProjection()})});return p.addControl(e),()=>{p.removeControl(e)}}},[F,p]);let T=(0,r.useRef)(!1),x=()=>{F?.setVisible(!1),B(void 0),D(!1),A(!0)};return a().createElement("div",{className:"bg-layer-chooser"},$&&a().createElement("div",{className:"layer-cards"},e.filter(g).map(e=>a().createElement(_,{key:(0,h.getUid)(e),activeLayer:F,onClick:e=>{D(!1),B(e),A(!1)},layer:e,backgroundLayerFilter:g,zoom:w,center:k,titleRenderer:d})),t&&a().createElement("div",{role:"button",tabIndex:0,className:`no-background${F?"":" selected"}`,onMouseOver:()=>{F?.setVisible(!1)},onMouseLeave:()=>{F?.setVisible(!0)},onFocus:()=>{T.current=!0},onBlur:()=>{T.current=!1},onKeyDown:e=>{let t="Enter"===e.key||"Enter"===e.code,n=" "===e.key||"Spacebar"===e.key||"Space"===e.code;(t||n)&&(n&&e.preventDefault(),T.current&&x())},onClick:x},a().createElement("div",{className:"no-background-preview"},a().createElement(o.g,{icon:l.Dfk})),a().createElement("span",{className:"layer-title"},c))),a().createElement(U.default,{className:`change-bg-btn${$?" toggled":""}`,size:"small",tooltip:n,"aria-expanded":$,icon:$?a().createElement(o.g,{icon:l.XkK}):a().createElement(o.g,{icon:l.Wzs}),onClick:()=>D(!$)}),a().createElement("div",{className:"bg-preview"},M?a().createElement("div",{className:"no-background-preview"},a().createElement(o.g,{icon:l.Dfk})):a().createElement("div",{id:"overview-map",ref:R}),F?a().createElement("span",{className:"layer-title"},d?d(F):F.get("name")):a().createElement("span",{className:"layer-title"},c)))};var R=A},71953:function(e,t,n){n.r(t);var r=n(76395),a=n(54440),l=n(74097),o=n(70198);let i=`${o.$}simplebutton`;t.default=({className:e,type:t="primary",tooltip:n,tooltipPlacement:o,tooltipProps:s={mouseEnterDelay:1.5},children:c,...u})=>{let g=e?`${e} ${i}`:`${i}`;return r.createElement(a.A,{title:n,placement:o,...s},r.createElement(l.Ay,{className:g,type:t,...u},c))}},38225:function(e,t,n){n.r(t),n.d(t,{MapComponent:function(){return l}});var r=n(76395),a=n.n(r);let l=({map:e,mapDivId:t="map",...n})=>{let l=(0,r.useCallback)(t=>{e&&(null===t?e.setTarget(void 0):e.setTarget(t))},[e]);return e?a().createElement("div",{id:t,ref:l,className:"map",role:"presentation",...n}):a().createElement(a().Fragment,null)};t.default=l},70198:function(e,t,n){n.d(t,{$:function(){return r}});let r="react-geo-"}}]);
//# sourceMappingURL=2855.8cf11208fbd0b46c.js.map