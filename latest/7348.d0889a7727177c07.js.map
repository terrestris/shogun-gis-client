{"version":3,"file":"7348.d0889a7727177c07.js","sources":["webpack://@terrestris/shogun-gis-client/./node_modules/ol/render/VectorContext.js","webpack://@terrestris/shogun-gis-client/./node_modules/ol/render/canvas/Immediate.js","webpack://@terrestris/shogun-gis-client/./node_modules/ol/renderer/vector.js"],"sourcesContent":["/**\n * @module ol/render/VectorContext\n */\n\n/**\n * @classdesc\n * Context for drawing geometries.  A vector context is available on render\n * events and does not need to be constructed directly.\n * @api\n */\nclass VectorContext {\n  /**\n   * Render a geometry with a custom renderer.\n   *\n   * @param {import(\"../geom/SimpleGeometry.js\").default} geometry Geometry.\n   * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n   * @param {Function} renderer Renderer.\n   * @param {Function} hitDetectionRenderer Renderer.\n   * @param {number} [index] Render order index.\n   */\n  drawCustom(geometry, feature, renderer, hitDetectionRenderer, index) {}\n\n  /**\n   * Render a geometry.\n   *\n   * @param {import(\"../geom/Geometry.js\").default} geometry The geometry to render.\n   */\n  drawGeometry(geometry) {}\n\n  /**\n   * Set the rendering style.\n   *\n   * @param {import(\"../style/Style.js\").default} style The rendering style.\n   */\n  setStyle(style) {}\n\n  /**\n   * @param {import(\"../geom/Circle.js\").default} circleGeometry Circle geometry.\n   * @param {import(\"../Feature.js\").default} feature Feature.\n   * @param {number} [index] Render order index.\n   */\n  drawCircle(circleGeometry, feature, index) {}\n\n  /**\n   * @param {import(\"../Feature.js\").default} feature Feature.\n   * @param {import(\"../style/Style.js\").default} style Style.\n   * @param {number} [index] Render order index.\n   */\n  drawFeature(feature, style, index) {}\n\n  /**\n   * @param {import(\"../geom/GeometryCollection.js\").default} geometryCollectionGeometry Geometry collection.\n   * @param {import(\"../Feature.js\").default} feature Feature.\n   * @param {number} [index] Render order index.\n   */\n  drawGeometryCollection(geometryCollectionGeometry, feature, index) {}\n\n  /**\n   * @param {import(\"../geom/LineString.js\").default|import(\"./Feature.js\").default} lineStringGeometry Line string geometry.\n   * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n   * @param {number} [index] Render order index.\n   */\n  drawLineString(lineStringGeometry, feature, index) {}\n\n  /**\n   * @param {import(\"../geom/MultiLineString.js\").default|import(\"./Feature.js\").default} multiLineStringGeometry MultiLineString geometry.\n   * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n   * @param {number} [index] Render order index.\n   */\n  drawMultiLineString(multiLineStringGeometry, feature, index) {}\n\n  /**\n   * @param {import(\"../geom/MultiPoint.js\").default|import(\"./Feature.js\").default} multiPointGeometry MultiPoint geometry.\n   * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n   * @param {number} [index] Render order index.\n   */\n  drawMultiPoint(multiPointGeometry, feature, index) {}\n\n  /**\n   * @param {import(\"../geom/MultiPolygon.js\").default} multiPolygonGeometry MultiPolygon geometry.\n   * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n   * @param {number} [index] Render order index.\n   */\n  drawMultiPolygon(multiPolygonGeometry, feature, index) {}\n\n  /**\n   * @param {import(\"../geom/Point.js\").default|import(\"./Feature.js\").default} pointGeometry Point geometry.\n   * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n   * @param {number} [index] Render order index.\n   */\n  drawPoint(pointGeometry, feature, index) {}\n\n  /**\n   * @param {import(\"../geom/Polygon.js\").default|import(\"./Feature.js\").default} polygonGeometry Polygon geometry.\n   * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n   * @param {number} [index] Render order index.\n   */\n  drawPolygon(polygonGeometry, feature, index) {}\n\n  /**\n   * @param {import(\"../geom/SimpleGeometry.js\").default|import(\"./Feature.js\").default} geometry Geometry.\n   * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n   * @param {number} [index] Render order index.\n   */\n  drawText(geometry, feature, index) {}\n\n  /**\n   * @param {import(\"../style/Fill.js\").default} fillStyle Fill style.\n   * @param {import(\"../style/Stroke.js\").default} strokeStyle Stroke style.\n   */\n  setFillStrokeStyle(fillStyle, strokeStyle) {}\n\n  /**\n   * @param {import(\"../style/Image.js\").default} imageStyle Image style.\n   * @param {import(\"../render/canvas.js\").DeclutterImageWithText} [declutterImageWithText] Shared data for combined decluttering with a text style.\n   */\n  setImageStyle(imageStyle, declutterImageWithText) {}\n\n  /**\n   * @param {import(\"../style/Text.js\").default} textStyle Text style.\n   * @param {import(\"../render/canvas.js\").DeclutterImageWithText} [declutterImageWithText] Shared data for combined decluttering with an image style.\n   */\n  setTextStyle(textStyle, declutterImageWithText) {}\n}\n\nexport default VectorContext;\n","/**\n * @module ol/render/canvas/Immediate\n */\n// FIXME test, especially polygons with holes and multipolygons\n// FIXME need to handle large thick features (where pixel size matters)\n// FIXME add offset and end to ol/geom/flat/transform~transform2D?\n\nimport VectorContext from '../VectorContext.js';\nimport {asColorLike} from '../../colorlike.js';\nimport {\n  compose as composeTransform,\n  create as createTransform,\n} from '../../transform.js';\nimport {\n  defaultFillStyle,\n  defaultFont,\n  defaultLineCap,\n  defaultLineDash,\n  defaultLineDashOffset,\n  defaultLineJoin,\n  defaultLineWidth,\n  defaultMiterLimit,\n  defaultStrokeStyle,\n  defaultTextAlign,\n  defaultTextBaseline,\n} from '../canvas.js';\nimport {equals} from '../../array.js';\nimport {intersects} from '../../extent.js';\nimport {toFixed} from '../../math.js';\nimport {transform2D} from '../../geom/flat/transform.js';\nimport {transformGeom2D} from '../../geom/SimpleGeometry.js';\n\n/**\n * @classdesc\n * A concrete subclass of {@link module:ol/render/VectorContext~VectorContext} that implements\n * direct rendering of features and geometries to an HTML5 Canvas context.\n * Instances of this class are created internally by the library and\n * provided to application code as vectorContext member of the\n * {@link module:ol/render/Event~RenderEvent} object associated with postcompose, precompose and\n * render events emitted by layers and maps.\n */\nclass CanvasImmediateRenderer extends VectorContext {\n  /**\n   * @param {CanvasRenderingContext2D} context Context.\n   * @param {number} pixelRatio Pixel ratio.\n   * @param {import(\"../../extent.js\").Extent} extent Extent.\n   * @param {import(\"../../transform.js\").Transform} transform Transform.\n   * @param {number} viewRotation View rotation.\n   * @param {number} [squaredTolerance] Optional squared tolerance for simplification.\n   * @param {import(\"../../proj.js\").TransformFunction} [userTransform] Transform from user to view projection.\n   */\n  constructor(\n    context,\n    pixelRatio,\n    extent,\n    transform,\n    viewRotation,\n    squaredTolerance,\n    userTransform,\n  ) {\n    super();\n\n    /**\n     * @private\n     * @type {CanvasRenderingContext2D}\n     */\n    this.context_ = context;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.pixelRatio_ = pixelRatio;\n\n    /**\n     * @private\n     * @type {import(\"../../extent.js\").Extent}\n     */\n    this.extent_ = extent;\n\n    /**\n     * @private\n     * @type {import(\"../../transform.js\").Transform}\n     */\n    this.transform_ = transform;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.transformRotation_ = transform\n      ? toFixed(Math.atan2(transform[1], transform[0]), 10)\n      : 0;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.viewRotation_ = viewRotation;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.squaredTolerance_ = squaredTolerance;\n\n    /**\n     * @private\n     * @type {import(\"../../proj.js\").TransformFunction}\n     */\n    this.userTransform_ = userTransform;\n\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").FillState}\n     */\n    this.contextFillState_ = null;\n\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").StrokeState}\n     */\n    this.contextStrokeState_ = null;\n\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").TextState}\n     */\n    this.contextTextState_ = null;\n\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").FillState}\n     */\n    this.fillState_ = null;\n\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").StrokeState}\n     */\n    this.strokeState_ = null;\n\n    /**\n     * @private\n     * @type {import('../../DataTile.js').ImageLike}\n     */\n    this.image_ = null;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.imageAnchorX_ = 0;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.imageAnchorY_ = 0;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.imageHeight_ = 0;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.imageOpacity_ = 0;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.imageOriginX_ = 0;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.imageOriginY_ = 0;\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.imageRotateWithView_ = false;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.imageRotation_ = 0;\n\n    /**\n     * @private\n     * @type {import(\"../../size.js\").Size}\n     */\n    this.imageScale_ = [0, 0];\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.imageWidth_ = 0;\n\n    /**\n     * @private\n     * @type {string}\n     */\n    this.text_ = '';\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.textOffsetX_ = 0;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.textOffsetY_ = 0;\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.textRotateWithView_ = false;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.textRotation_ = 0;\n\n    /**\n     * @private\n     * @type {import(\"../../size.js\").Size}\n     */\n    this.textScale_ = [0, 0];\n\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").FillState}\n     */\n    this.textFillState_ = null;\n\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").StrokeState}\n     */\n    this.textStrokeState_ = null;\n\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").TextState}\n     */\n    this.textState_ = null;\n\n    /**\n     * @private\n     * @type {Array<number>}\n     */\n    this.pixelCoordinates_ = [];\n\n    /**\n     * @private\n     * @type {import(\"../../transform.js\").Transform}\n     */\n    this.tmpLocalTransform_ = createTransform();\n  }\n\n  /**\n   * @param {Array<number>} flatCoordinates Flat coordinates.\n   * @param {number} offset Offset.\n   * @param {number} end End.\n   * @param {number} stride Stride.\n   * @private\n   */\n  drawImages_(flatCoordinates, offset, end, stride) {\n    if (!this.image_) {\n      return;\n    }\n    const pixelCoordinates = transform2D(\n      flatCoordinates,\n      offset,\n      end,\n      stride,\n      this.transform_,\n      this.pixelCoordinates_,\n    );\n    const context = this.context_;\n    const localTransform = this.tmpLocalTransform_;\n    const alpha = context.globalAlpha;\n    if (this.imageOpacity_ != 1) {\n      context.globalAlpha = alpha * this.imageOpacity_;\n    }\n    let rotation = this.imageRotation_;\n    if (this.transformRotation_ === 0) {\n      rotation -= this.viewRotation_;\n    }\n    if (this.imageRotateWithView_) {\n      rotation += this.viewRotation_;\n    }\n    for (let i = 0, ii = pixelCoordinates.length; i < ii; i += 2) {\n      const x = pixelCoordinates[i] - this.imageAnchorX_;\n      const y = pixelCoordinates[i + 1] - this.imageAnchorY_;\n      if (\n        rotation !== 0 ||\n        this.imageScale_[0] != 1 ||\n        this.imageScale_[1] != 1\n      ) {\n        const centerX = x + this.imageAnchorX_;\n        const centerY = y + this.imageAnchorY_;\n        composeTransform(\n          localTransform,\n          centerX,\n          centerY,\n          1,\n          1,\n          rotation,\n          -centerX,\n          -centerY,\n        );\n        context.save();\n        context.transform.apply(context, localTransform);\n        context.translate(centerX, centerY);\n        context.scale(this.imageScale_[0], this.imageScale_[1]);\n        context.drawImage(\n          this.image_,\n          this.imageOriginX_,\n          this.imageOriginY_,\n          this.imageWidth_,\n          this.imageHeight_,\n          -this.imageAnchorX_,\n          -this.imageAnchorY_,\n          this.imageWidth_,\n          this.imageHeight_,\n        );\n        context.restore();\n      } else {\n        context.drawImage(\n          this.image_,\n          this.imageOriginX_,\n          this.imageOriginY_,\n          this.imageWidth_,\n          this.imageHeight_,\n          x,\n          y,\n          this.imageWidth_,\n          this.imageHeight_,\n        );\n      }\n    }\n    if (this.imageOpacity_ != 1) {\n      context.globalAlpha = alpha;\n    }\n  }\n\n  /**\n   * @param {Array<number>} flatCoordinates Flat coordinates.\n   * @param {number} offset Offset.\n   * @param {number} end End.\n   * @param {number} stride Stride.\n   * @private\n   */\n  drawText_(flatCoordinates, offset, end, stride) {\n    if (!this.textState_ || this.text_ === '') {\n      return;\n    }\n    if (this.textFillState_) {\n      this.setContextFillState_(this.textFillState_);\n    }\n    if (this.textStrokeState_) {\n      this.setContextStrokeState_(this.textStrokeState_);\n    }\n    this.setContextTextState_(this.textState_);\n    const pixelCoordinates = transform2D(\n      flatCoordinates,\n      offset,\n      end,\n      stride,\n      this.transform_,\n      this.pixelCoordinates_,\n    );\n    const context = this.context_;\n    let rotation = this.textRotation_;\n    if (this.transformRotation_ === 0) {\n      rotation -= this.viewRotation_;\n    }\n    if (this.textRotateWithView_) {\n      rotation += this.viewRotation_;\n    }\n    for (; offset < end; offset += stride) {\n      const x = pixelCoordinates[offset] + this.textOffsetX_;\n      const y = pixelCoordinates[offset + 1] + this.textOffsetY_;\n      if (\n        rotation !== 0 ||\n        this.textScale_[0] != 1 ||\n        this.textScale_[1] != 1\n      ) {\n        context.save();\n        context.translate(x - this.textOffsetX_, y - this.textOffsetY_);\n        context.rotate(rotation);\n        context.translate(this.textOffsetX_, this.textOffsetY_);\n        context.scale(this.textScale_[0], this.textScale_[1]);\n        if (this.textStrokeState_) {\n          context.strokeText(this.text_, 0, 0);\n        }\n        if (this.textFillState_) {\n          context.fillText(this.text_, 0, 0);\n        }\n        context.restore();\n      } else {\n        if (this.textStrokeState_) {\n          context.strokeText(this.text_, x, y);\n        }\n        if (this.textFillState_) {\n          context.fillText(this.text_, x, y);\n        }\n      }\n    }\n  }\n\n  /**\n   * @param {Array<number>} flatCoordinates Flat coordinates.\n   * @param {number} offset Offset.\n   * @param {number} end End.\n   * @param {number} stride Stride.\n   * @param {boolean} close Close.\n   * @private\n   * @return {number} end End.\n   */\n  moveToLineTo_(flatCoordinates, offset, end, stride, close) {\n    const context = this.context_;\n    const pixelCoordinates = transform2D(\n      flatCoordinates,\n      offset,\n      end,\n      stride,\n      this.transform_,\n      this.pixelCoordinates_,\n    );\n    context.moveTo(pixelCoordinates[0], pixelCoordinates[1]);\n    let length = pixelCoordinates.length;\n    if (close) {\n      length -= 2;\n    }\n    for (let i = 2; i < length; i += 2) {\n      context.lineTo(pixelCoordinates[i], pixelCoordinates[i + 1]);\n    }\n    if (close) {\n      context.closePath();\n    }\n    return end;\n  }\n\n  /**\n   * @param {Array<number>} flatCoordinates Flat coordinates.\n   * @param {number} offset Offset.\n   * @param {Array<number>} ends Ends.\n   * @param {number} stride Stride.\n   * @private\n   * @return {number} End.\n   */\n  drawRings_(flatCoordinates, offset, ends, stride) {\n    for (let i = 0, ii = ends.length; i < ii; ++i) {\n      offset = this.moveToLineTo_(\n        flatCoordinates,\n        offset,\n        ends[i],\n        stride,\n        true,\n      );\n    }\n    return offset;\n  }\n\n  /**\n   * Render a circle geometry into the canvas.  Rendering is immediate and uses\n   * the current fill and stroke styles.\n   *\n   * @param {import(\"../../geom/Circle.js\").default} geometry Circle geometry.\n   * @api\n   * @override\n   */\n  drawCircle(geometry) {\n    if (this.squaredTolerance_) {\n      geometry = /** @type {import(\"../../geom/Circle.js\").default} */ (\n        geometry.simplifyTransformed(\n          this.squaredTolerance_,\n          this.userTransform_,\n        )\n      );\n    }\n    if (!intersects(this.extent_, geometry.getExtent())) {\n      return;\n    }\n    if (this.fillState_ || this.strokeState_) {\n      if (this.fillState_) {\n        this.setContextFillState_(this.fillState_);\n      }\n      if (this.strokeState_) {\n        this.setContextStrokeState_(this.strokeState_);\n      }\n      const pixelCoordinates = transformGeom2D(\n        geometry,\n        this.transform_,\n        this.pixelCoordinates_,\n      );\n      const dx = pixelCoordinates[2] - pixelCoordinates[0];\n      const dy = pixelCoordinates[3] - pixelCoordinates[1];\n      const radius = Math.sqrt(dx * dx + dy * dy);\n      const context = this.context_;\n      context.beginPath();\n      context.arc(\n        pixelCoordinates[0],\n        pixelCoordinates[1],\n        radius,\n        0,\n        2 * Math.PI,\n      );\n      if (this.fillState_) {\n        context.fill();\n      }\n      if (this.strokeState_) {\n        context.stroke();\n      }\n    }\n    if (this.text_ !== '') {\n      this.drawText_(geometry.getCenter(), 0, 2, 2);\n    }\n  }\n\n  /**\n   * Set the rendering style.  Note that since this is an immediate rendering API,\n   * any `zIndex` on the provided style will be ignored.\n   *\n   * @param {import(\"../../style/Style.js\").default} style The rendering style.\n   * @api\n   * @override\n   */\n  setStyle(style) {\n    this.setFillStrokeStyle(style.getFill(), style.getStroke());\n    this.setImageStyle(style.getImage());\n    this.setTextStyle(style.getText());\n  }\n\n  /**\n   * @param {import(\"../../transform.js\").Transform} transform Transform.\n   */\n  setTransform(transform) {\n    this.transform_ = transform;\n  }\n\n  /**\n   * Render a geometry into the canvas.  Call\n   * {@link module:ol/render/canvas/Immediate~CanvasImmediateRenderer#setStyle renderer.setStyle()} first to set the rendering style.\n   *\n   * @param {import(\"../../geom/Geometry.js\").default|import(\"../Feature.js\").default} geometry The geometry to render.\n   * @api\n   * @override\n   */\n  drawGeometry(geometry) {\n    const type = geometry.getType();\n    switch (type) {\n      case 'Point':\n        this.drawPoint(\n          /** @type {import(\"../../geom/Point.js\").default} */ (geometry),\n        );\n        break;\n      case 'LineString':\n        this.drawLineString(\n          /** @type {import(\"../../geom/LineString.js\").default} */ (geometry),\n        );\n        break;\n      case 'Polygon':\n        this.drawPolygon(\n          /** @type {import(\"../../geom/Polygon.js\").default} */ (geometry),\n        );\n        break;\n      case 'MultiPoint':\n        this.drawMultiPoint(\n          /** @type {import(\"../../geom/MultiPoint.js\").default} */ (geometry),\n        );\n        break;\n      case 'MultiLineString':\n        this.drawMultiLineString(\n          /** @type {import(\"../../geom/MultiLineString.js\").default} */ (\n            geometry\n          ),\n        );\n        break;\n      case 'MultiPolygon':\n        this.drawMultiPolygon(\n          /** @type {import(\"../../geom/MultiPolygon.js\").default} */ (\n            geometry\n          ),\n        );\n        break;\n      case 'GeometryCollection':\n        this.drawGeometryCollection(\n          /** @type {import(\"../../geom/GeometryCollection.js\").default} */ (\n            geometry\n          ),\n        );\n        break;\n      case 'Circle':\n        this.drawCircle(\n          /** @type {import(\"../../geom/Circle.js\").default} */ (geometry),\n        );\n        break;\n      default:\n    }\n  }\n\n  /**\n   * Render a feature into the canvas.  Note that any `zIndex` on the provided\n   * style will be ignored - features are rendered immediately in the order that\n   * this method is called.  If you need `zIndex` support, you should be using an\n   * {@link module:ol/layer/Vector~VectorLayer} instead.\n   *\n   * @param {import(\"../../Feature.js\").default} feature Feature.\n   * @param {import(\"../../style/Style.js\").default} style Style.\n   * @api\n   * @override\n   */\n  drawFeature(feature, style) {\n    const geometry = style.getGeometryFunction()(feature);\n    if (!geometry) {\n      return;\n    }\n    this.setStyle(style);\n    this.drawGeometry(geometry);\n  }\n\n  /**\n   * Render a GeometryCollection to the canvas.  Rendering is immediate and\n   * uses the current styles appropriate for each geometry in the collection.\n   *\n   * @param {import(\"../../geom/GeometryCollection.js\").default} geometry Geometry collection.\n   * @override\n   */\n  drawGeometryCollection(geometry) {\n    const geometries = geometry.getGeometriesArray();\n    for (let i = 0, ii = geometries.length; i < ii; ++i) {\n      this.drawGeometry(geometries[i]);\n    }\n  }\n\n  /**\n   * Render a Point geometry into the canvas.  Rendering is immediate and uses\n   * the current style.\n   *\n   * @param {import(\"../../geom/Point.js\").default|import(\"../Feature.js\").default} geometry Point geometry.\n   * @override\n   */\n  drawPoint(geometry) {\n    if (this.squaredTolerance_) {\n      geometry = /** @type {import(\"../../geom/Point.js\").default} */ (\n        geometry.simplifyTransformed(\n          this.squaredTolerance_,\n          this.userTransform_,\n        )\n      );\n    }\n    const flatCoordinates = geometry.getFlatCoordinates();\n    const stride = geometry.getStride();\n    if (this.image_) {\n      this.drawImages_(flatCoordinates, 0, flatCoordinates.length, stride);\n    }\n    if (this.text_ !== '') {\n      this.drawText_(flatCoordinates, 0, flatCoordinates.length, stride);\n    }\n  }\n\n  /**\n   * Render a MultiPoint geometry  into the canvas.  Rendering is immediate and\n   * uses the current style.\n   *\n   * @param {import(\"../../geom/MultiPoint.js\").default|import(\"../Feature.js\").default} geometry MultiPoint geometry.\n   * @override\n   */\n  drawMultiPoint(geometry) {\n    if (this.squaredTolerance_) {\n      geometry = /** @type {import(\"../../geom/MultiPoint.js\").default} */ (\n        geometry.simplifyTransformed(\n          this.squaredTolerance_,\n          this.userTransform_,\n        )\n      );\n    }\n    const flatCoordinates = geometry.getFlatCoordinates();\n    const stride = geometry.getStride();\n    if (this.image_) {\n      this.drawImages_(flatCoordinates, 0, flatCoordinates.length, stride);\n    }\n    if (this.text_ !== '') {\n      this.drawText_(flatCoordinates, 0, flatCoordinates.length, stride);\n    }\n  }\n\n  /**\n   * Render a LineString into the canvas.  Rendering is immediate and uses\n   * the current style.\n   *\n   * @param {import(\"../../geom/LineString.js\").default|import(\"../Feature.js\").default} geometry LineString geometry.\n   * @override\n   */\n  drawLineString(geometry) {\n    if (this.squaredTolerance_) {\n      geometry = /** @type {import(\"../../geom/LineString.js\").default} */ (\n        geometry.simplifyTransformed(\n          this.squaredTolerance_,\n          this.userTransform_,\n        )\n      );\n    }\n    if (!intersects(this.extent_, geometry.getExtent())) {\n      return;\n    }\n    if (this.strokeState_) {\n      this.setContextStrokeState_(this.strokeState_);\n      const context = this.context_;\n      const flatCoordinates = geometry.getFlatCoordinates();\n      context.beginPath();\n      this.moveToLineTo_(\n        flatCoordinates,\n        0,\n        flatCoordinates.length,\n        geometry.getStride(),\n        false,\n      );\n      context.stroke();\n    }\n    if (this.text_ !== '') {\n      const flatMidpoint = geometry.getFlatMidpoint();\n      this.drawText_(flatMidpoint, 0, 2, 2);\n    }\n  }\n\n  /**\n   * Render a MultiLineString geometry into the canvas.  Rendering is immediate\n   * and uses the current style.\n   *\n   * @param {import(\"../../geom/MultiLineString.js\").default|import(\"../Feature.js\").default} geometry MultiLineString geometry.\n   * @override\n   */\n  drawMultiLineString(geometry) {\n    if (this.squaredTolerance_) {\n      geometry =\n        /** @type {import(\"../../geom/MultiLineString.js\").default} */ (\n          geometry.simplifyTransformed(\n            this.squaredTolerance_,\n            this.userTransform_,\n          )\n        );\n    }\n    const geometryExtent = geometry.getExtent();\n    if (!intersects(this.extent_, geometryExtent)) {\n      return;\n    }\n    if (this.strokeState_) {\n      this.setContextStrokeState_(this.strokeState_);\n      const context = this.context_;\n      const flatCoordinates = geometry.getFlatCoordinates();\n      let offset = 0;\n      const ends = /** @type {Array<number>} */ (geometry.getEnds());\n      const stride = geometry.getStride();\n      context.beginPath();\n      for (let i = 0, ii = ends.length; i < ii; ++i) {\n        offset = this.moveToLineTo_(\n          flatCoordinates,\n          offset,\n          ends[i],\n          stride,\n          false,\n        );\n      }\n      context.stroke();\n    }\n    if (this.text_ !== '') {\n      const flatMidpoints = geometry.getFlatMidpoints();\n      this.drawText_(flatMidpoints, 0, flatMidpoints.length, 2);\n    }\n  }\n\n  /**\n   * Render a Polygon geometry into the canvas.  Rendering is immediate and uses\n   * the current style.\n   *\n   * @param {import(\"../../geom/Polygon.js\").default|import(\"../Feature.js\").default} geometry Polygon geometry.\n   * @override\n   */\n  drawPolygon(geometry) {\n    if (this.squaredTolerance_) {\n      geometry = /** @type {import(\"../../geom/Polygon.js\").default} */ (\n        geometry.simplifyTransformed(\n          this.squaredTolerance_,\n          this.userTransform_,\n        )\n      );\n    }\n    if (!intersects(this.extent_, geometry.getExtent())) {\n      return;\n    }\n    if (this.strokeState_ || this.fillState_) {\n      if (this.fillState_) {\n        this.setContextFillState_(this.fillState_);\n      }\n      if (this.strokeState_) {\n        this.setContextStrokeState_(this.strokeState_);\n      }\n      const context = this.context_;\n      context.beginPath();\n      this.drawRings_(\n        geometry.getOrientedFlatCoordinates(),\n        0,\n        /** @type {Array<number>} */ (geometry.getEnds()),\n        geometry.getStride(),\n      );\n      if (this.fillState_) {\n        context.fill();\n      }\n      if (this.strokeState_) {\n        context.stroke();\n      }\n    }\n    if (this.text_ !== '') {\n      const flatInteriorPoint = geometry.getFlatInteriorPoint();\n      this.drawText_(flatInteriorPoint, 0, 2, 2);\n    }\n  }\n\n  /**\n   * Render MultiPolygon geometry into the canvas.  Rendering is immediate and\n   * uses the current style.\n   * @param {import(\"../../geom/MultiPolygon.js\").default} geometry MultiPolygon geometry.\n   * @override\n   */\n  drawMultiPolygon(geometry) {\n    if (this.squaredTolerance_) {\n      geometry = /** @type {import(\"../../geom/MultiPolygon.js\").default} */ (\n        geometry.simplifyTransformed(\n          this.squaredTolerance_,\n          this.userTransform_,\n        )\n      );\n    }\n    if (!intersects(this.extent_, geometry.getExtent())) {\n      return;\n    }\n    if (this.strokeState_ || this.fillState_) {\n      if (this.fillState_) {\n        this.setContextFillState_(this.fillState_);\n      }\n      if (this.strokeState_) {\n        this.setContextStrokeState_(this.strokeState_);\n      }\n      const context = this.context_;\n      const flatCoordinates = geometry.getOrientedFlatCoordinates();\n      let offset = 0;\n      const endss = geometry.getEndss();\n      const stride = geometry.getStride();\n      context.beginPath();\n      for (let i = 0, ii = endss.length; i < ii; ++i) {\n        const ends = endss[i];\n        offset = this.drawRings_(flatCoordinates, offset, ends, stride);\n      }\n      if (this.fillState_) {\n        context.fill();\n      }\n      if (this.strokeState_) {\n        context.stroke();\n      }\n    }\n    if (this.text_ !== '') {\n      const flatInteriorPoints = geometry.getFlatInteriorPoints();\n      this.drawText_(flatInteriorPoints, 0, flatInteriorPoints.length, 2);\n    }\n  }\n\n  /**\n   * @param {import(\"../canvas.js\").FillState} fillState Fill state.\n   * @private\n   */\n  setContextFillState_(fillState) {\n    const context = this.context_;\n    const contextFillState = this.contextFillState_;\n    if (!contextFillState) {\n      context.fillStyle = fillState.fillStyle;\n      this.contextFillState_ = {\n        fillStyle: fillState.fillStyle,\n      };\n    } else {\n      if (contextFillState.fillStyle != fillState.fillStyle) {\n        contextFillState.fillStyle = fillState.fillStyle;\n        context.fillStyle = fillState.fillStyle;\n      }\n    }\n  }\n\n  /**\n   * @param {import(\"../canvas.js\").StrokeState} strokeState Stroke state.\n   * @private\n   */\n  setContextStrokeState_(strokeState) {\n    const context = this.context_;\n    const contextStrokeState = this.contextStrokeState_;\n    if (!contextStrokeState) {\n      context.lineCap = strokeState.lineCap;\n      context.setLineDash(strokeState.lineDash);\n      context.lineDashOffset = strokeState.lineDashOffset;\n      context.lineJoin = strokeState.lineJoin;\n      context.lineWidth = strokeState.lineWidth;\n      context.miterLimit = strokeState.miterLimit;\n      context.strokeStyle = strokeState.strokeStyle;\n      this.contextStrokeState_ = {\n        lineCap: strokeState.lineCap,\n        lineDash: strokeState.lineDash,\n        lineDashOffset: strokeState.lineDashOffset,\n        lineJoin: strokeState.lineJoin,\n        lineWidth: strokeState.lineWidth,\n        miterLimit: strokeState.miterLimit,\n        strokeStyle: strokeState.strokeStyle,\n      };\n    } else {\n      if (contextStrokeState.lineCap != strokeState.lineCap) {\n        contextStrokeState.lineCap = strokeState.lineCap;\n        context.lineCap = strokeState.lineCap;\n      }\n      if (!equals(contextStrokeState.lineDash, strokeState.lineDash)) {\n        context.setLineDash(\n          (contextStrokeState.lineDash = strokeState.lineDash),\n        );\n      }\n      if (contextStrokeState.lineDashOffset != strokeState.lineDashOffset) {\n        contextStrokeState.lineDashOffset = strokeState.lineDashOffset;\n        context.lineDashOffset = strokeState.lineDashOffset;\n      }\n      if (contextStrokeState.lineJoin != strokeState.lineJoin) {\n        contextStrokeState.lineJoin = strokeState.lineJoin;\n        context.lineJoin = strokeState.lineJoin;\n      }\n      if (contextStrokeState.lineWidth != strokeState.lineWidth) {\n        contextStrokeState.lineWidth = strokeState.lineWidth;\n        context.lineWidth = strokeState.lineWidth;\n      }\n      if (contextStrokeState.miterLimit != strokeState.miterLimit) {\n        contextStrokeState.miterLimit = strokeState.miterLimit;\n        context.miterLimit = strokeState.miterLimit;\n      }\n      if (contextStrokeState.strokeStyle != strokeState.strokeStyle) {\n        contextStrokeState.strokeStyle = strokeState.strokeStyle;\n        context.strokeStyle = strokeState.strokeStyle;\n      }\n    }\n  }\n\n  /**\n   * @param {import(\"../canvas.js\").TextState} textState Text state.\n   * @private\n   */\n  setContextTextState_(textState) {\n    const context = this.context_;\n    const contextTextState = this.contextTextState_;\n    const textAlign = textState.textAlign\n      ? textState.textAlign\n      : defaultTextAlign;\n    if (!contextTextState) {\n      context.font = textState.font;\n      context.textAlign = textAlign;\n      context.textBaseline = textState.textBaseline;\n      this.contextTextState_ = {\n        font: textState.font,\n        textAlign: textAlign,\n        textBaseline: textState.textBaseline,\n      };\n    } else {\n      if (contextTextState.font != textState.font) {\n        contextTextState.font = textState.font;\n        context.font = textState.font;\n      }\n      if (contextTextState.textAlign != textAlign) {\n        contextTextState.textAlign = textAlign;\n        context.textAlign = textAlign;\n      }\n      if (contextTextState.textBaseline != textState.textBaseline) {\n        contextTextState.textBaseline = textState.textBaseline;\n        context.textBaseline = textState.textBaseline;\n      }\n    }\n  }\n\n  /**\n   * Set the fill and stroke style for subsequent draw operations.  To clear\n   * either fill or stroke styles, pass null for the appropriate parameter.\n   *\n   * @param {import(\"../../style/Fill.js\").default} fillStyle Fill style.\n   * @param {import(\"../../style/Stroke.js\").default} strokeStyle Stroke style.\n   * @override\n   */\n  setFillStrokeStyle(fillStyle, strokeStyle) {\n    if (!fillStyle) {\n      this.fillState_ = null;\n    } else {\n      const fillStyleColor = fillStyle.getColor();\n      this.fillState_ = {\n        fillStyle: asColorLike(\n          fillStyleColor ? fillStyleColor : defaultFillStyle,\n        ),\n      };\n    }\n    if (!strokeStyle) {\n      this.strokeState_ = null;\n    } else {\n      const strokeStyleColor = strokeStyle.getColor();\n      const strokeStyleLineCap = strokeStyle.getLineCap();\n      const strokeStyleLineDash = strokeStyle.getLineDash();\n      const strokeStyleLineDashOffset = strokeStyle.getLineDashOffset();\n      const strokeStyleLineJoin = strokeStyle.getLineJoin();\n      const strokeStyleWidth = strokeStyle.getWidth();\n      const strokeStyleMiterLimit = strokeStyle.getMiterLimit();\n      const lineDash = strokeStyleLineDash\n        ? strokeStyleLineDash\n        : defaultLineDash;\n      this.strokeState_ = {\n        lineCap:\n          strokeStyleLineCap !== undefined\n            ? strokeStyleLineCap\n            : defaultLineCap,\n        lineDash:\n          this.pixelRatio_ === 1\n            ? lineDash\n            : lineDash.map((n) => n * this.pixelRatio_),\n        lineDashOffset:\n          (strokeStyleLineDashOffset\n            ? strokeStyleLineDashOffset\n            : defaultLineDashOffset) * this.pixelRatio_,\n        lineJoin:\n          strokeStyleLineJoin !== undefined\n            ? strokeStyleLineJoin\n            : defaultLineJoin,\n        lineWidth:\n          (strokeStyleWidth !== undefined\n            ? strokeStyleWidth\n            : defaultLineWidth) * this.pixelRatio_,\n        miterLimit:\n          strokeStyleMiterLimit !== undefined\n            ? strokeStyleMiterLimit\n            : defaultMiterLimit,\n        strokeStyle: asColorLike(\n          strokeStyleColor ? strokeStyleColor : defaultStrokeStyle,\n        ),\n      };\n    }\n  }\n\n  /**\n   * Set the image style for subsequent draw operations.  Pass null to remove\n   * the image style.\n   *\n   * @param {import(\"../../style/Image.js\").default} imageStyle Image style.\n   * @override\n   */\n  setImageStyle(imageStyle) {\n    let imageSize;\n    if (!imageStyle || !(imageSize = imageStyle.getSize())) {\n      this.image_ = null;\n      return;\n    }\n    const imagePixelRatio = imageStyle.getPixelRatio(this.pixelRatio_);\n    const imageAnchor = imageStyle.getAnchor();\n    const imageOrigin = imageStyle.getOrigin();\n    this.image_ = imageStyle.getImage(this.pixelRatio_);\n    this.imageAnchorX_ = imageAnchor[0] * imagePixelRatio;\n    this.imageAnchorY_ = imageAnchor[1] * imagePixelRatio;\n    this.imageHeight_ = imageSize[1] * imagePixelRatio;\n    this.imageOpacity_ = imageStyle.getOpacity();\n    this.imageOriginX_ = imageOrigin[0];\n    this.imageOriginY_ = imageOrigin[1];\n    this.imageRotateWithView_ = imageStyle.getRotateWithView();\n    this.imageRotation_ = imageStyle.getRotation();\n    const imageScale = imageStyle.getScaleArray();\n    this.imageScale_ = [\n      (imageScale[0] * this.pixelRatio_) / imagePixelRatio,\n      (imageScale[1] * this.pixelRatio_) / imagePixelRatio,\n    ];\n    this.imageWidth_ = imageSize[0] * imagePixelRatio;\n  }\n\n  /**\n   * Set the text style for subsequent draw operations.  Pass null to\n   * remove the text style.\n   *\n   * @param {import(\"../../style/Text.js\").default} textStyle Text style.\n   * @override\n   */\n  setTextStyle(textStyle) {\n    if (!textStyle) {\n      this.text_ = '';\n    } else {\n      const textFillStyle = textStyle.getFill();\n      if (!textFillStyle) {\n        this.textFillState_ = null;\n      } else {\n        const textFillStyleColor = textFillStyle.getColor();\n        this.textFillState_ = {\n          fillStyle: asColorLike(\n            textFillStyleColor ? textFillStyleColor : defaultFillStyle,\n          ),\n        };\n      }\n      const textStrokeStyle = textStyle.getStroke();\n      if (!textStrokeStyle) {\n        this.textStrokeState_ = null;\n      } else {\n        const textStrokeStyleColor = textStrokeStyle.getColor();\n        const textStrokeStyleLineCap = textStrokeStyle.getLineCap();\n        const textStrokeStyleLineDash = textStrokeStyle.getLineDash();\n        const textStrokeStyleLineDashOffset =\n          textStrokeStyle.getLineDashOffset();\n        const textStrokeStyleLineJoin = textStrokeStyle.getLineJoin();\n        const textStrokeStyleWidth = textStrokeStyle.getWidth();\n        const textStrokeStyleMiterLimit = textStrokeStyle.getMiterLimit();\n        this.textStrokeState_ = {\n          lineCap:\n            textStrokeStyleLineCap !== undefined\n              ? textStrokeStyleLineCap\n              : defaultLineCap,\n          lineDash: textStrokeStyleLineDash\n            ? textStrokeStyleLineDash\n            : defaultLineDash,\n          lineDashOffset: textStrokeStyleLineDashOffset\n            ? textStrokeStyleLineDashOffset\n            : defaultLineDashOffset,\n          lineJoin:\n            textStrokeStyleLineJoin !== undefined\n              ? textStrokeStyleLineJoin\n              : defaultLineJoin,\n          lineWidth:\n            textStrokeStyleWidth !== undefined\n              ? textStrokeStyleWidth\n              : defaultLineWidth,\n          miterLimit:\n            textStrokeStyleMiterLimit !== undefined\n              ? textStrokeStyleMiterLimit\n              : defaultMiterLimit,\n          strokeStyle: asColorLike(\n            textStrokeStyleColor ? textStrokeStyleColor : defaultStrokeStyle,\n          ),\n        };\n      }\n      const textFont = textStyle.getFont();\n      const textOffsetX = textStyle.getOffsetX();\n      const textOffsetY = textStyle.getOffsetY();\n      const textRotateWithView = textStyle.getRotateWithView();\n      const textRotation = textStyle.getRotation();\n      const textScale = textStyle.getScaleArray();\n      const textText = textStyle.getText();\n      const textTextAlign = textStyle.getTextAlign();\n      const textTextBaseline = textStyle.getTextBaseline();\n      this.textState_ = {\n        font: textFont !== undefined ? textFont : defaultFont,\n        textAlign:\n          textTextAlign !== undefined ? textTextAlign : defaultTextAlign,\n        textBaseline:\n          textTextBaseline !== undefined\n            ? textTextBaseline\n            : defaultTextBaseline,\n      };\n      this.text_ =\n        textText !== undefined\n          ? Array.isArray(textText)\n            ? textText.reduce((acc, t, i) => (acc += i % 2 ? ' ' : t), '')\n            : textText\n          : '';\n      this.textOffsetX_ =\n        textOffsetX !== undefined ? this.pixelRatio_ * textOffsetX : 0;\n      this.textOffsetY_ =\n        textOffsetY !== undefined ? this.pixelRatio_ * textOffsetY : 0;\n      this.textRotateWithView_ =\n        textRotateWithView !== undefined ? textRotateWithView : false;\n      this.textRotation_ = textRotation !== undefined ? textRotation : 0;\n      this.textScale_ = [\n        this.pixelRatio_ * textScale[0],\n        this.pixelRatio_ * textScale[1],\n      ];\n    }\n  }\n}\n\nexport default CanvasImmediateRenderer;\n","/**\n * @module ol/renderer/vector\n */\nimport ImageState from '../ImageState.js';\nimport {getUid} from '../util.js';\n\n/**\n * Feature callback. The callback will be called with three arguments. The first\n * argument is one {@link module:ol/Feature~Feature feature} or {@link module:ol/render/Feature~RenderFeature render feature}\n * at the pixel, the second is the {@link module:ol/layer/Layer~Layer layer} of the feature and will be null for\n * unmanaged layers. The third is the {@link module:ol/geom/SimpleGeometry~SimpleGeometry} of the feature. For features\n * with a GeometryCollection geometry, it will be the first detected geometry from the collection.\n * @template T\n * @typedef {function(import(\"../Feature.js\").FeatureLike, import(\"../layer/Layer.js\").default<import(\"../source/Source\").default>, import(\"../geom/SimpleGeometry.js\").default): T} FeatureCallback\n */\n\n/**\n * Tolerance for geometry simplification in device pixels.\n * @type {number}\n */\nconst SIMPLIFY_TOLERANCE = 0.5;\n\n/**\n * @const\n * @type {Object<import(\"../geom/Geometry.js\").Type,\n *                function(import(\"../render/canvas/BuilderGroup.js\").default, import(\"../geom/Geometry.js\").default,\n *                         import(\"../style/Style.js\").default, Object): void>}\n */\nconst GEOMETRY_RENDERERS = {\n  'Point': renderPointGeometry,\n  'LineString': renderLineStringGeometry,\n  'Polygon': renderPolygonGeometry,\n  'MultiPoint': renderMultiPointGeometry,\n  'MultiLineString': renderMultiLineStringGeometry,\n  'MultiPolygon': renderMultiPolygonGeometry,\n  'GeometryCollection': renderGeometryCollectionGeometry,\n  'Circle': renderCircleGeometry,\n};\n\n/**\n * @param {import(\"../Feature.js\").FeatureLike} feature1 Feature 1.\n * @param {import(\"../Feature.js\").FeatureLike} feature2 Feature 2.\n * @return {number} Order.\n */\nexport function defaultOrder(feature1, feature2) {\n  return parseInt(getUid(feature1), 10) - parseInt(getUid(feature2), 10);\n}\n\n/**\n * @param {number} resolution Resolution.\n * @param {number} pixelRatio Pixel ratio.\n * @return {number} Squared pixel tolerance.\n */\nexport function getSquaredTolerance(resolution, pixelRatio) {\n  const tolerance = getTolerance(resolution, pixelRatio);\n  return tolerance * tolerance;\n}\n\n/**\n * @param {number} resolution Resolution.\n * @param {number} pixelRatio Pixel ratio.\n * @return {number} Pixel tolerance.\n */\nexport function getTolerance(resolution, pixelRatio) {\n  return (SIMPLIFY_TOLERANCE * resolution) / pixelRatio;\n}\n\n/**\n * @param {import(\"../render/canvas/BuilderGroup.js\").default} builderGroup Builder group.\n * @param {import(\"../geom/Circle.js\").default} geometry Geometry.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {import(\"../Feature.js\").default} feature Feature.\n * @param {number} [index] Render order index.\n */\nfunction renderCircleGeometry(builderGroup, geometry, style, feature, index) {\n  const fillStyle = style.getFill();\n  const strokeStyle = style.getStroke();\n  if (fillStyle || strokeStyle) {\n    const circleReplay = builderGroup.getBuilder(style.getZIndex(), 'Circle');\n    circleReplay.setFillStrokeStyle(fillStyle, strokeStyle);\n    circleReplay.drawCircle(geometry, feature, index);\n  }\n  const textStyle = style.getText();\n  if (textStyle && textStyle.getText()) {\n    const textReplay = builderGroup.getBuilder(style.getZIndex(), 'Text');\n    textReplay.setTextStyle(textStyle);\n    textReplay.drawText(geometry, feature);\n  }\n}\n\n/**\n * @param {import(\"../render/canvas/BuilderGroup.js\").default} replayGroup Replay group.\n * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {number} squaredTolerance Squared tolerance.\n * @param {function(import(\"../events/Event.js\").default): void} listener Listener function.\n * @param {import(\"../proj.js\").TransformFunction} [transform] Transform from user to view projection.\n * @param {boolean} [declutter] Enable decluttering.\n * @param {number} [index] Render order index..\n * @return {boolean} `true` if style is loading.\n */\nexport function renderFeature(\n  replayGroup,\n  feature,\n  style,\n  squaredTolerance,\n  listener,\n  transform,\n  declutter,\n  index,\n) {\n  const loadingPromises = [];\n  const imageStyle = style.getImage();\n  if (imageStyle) {\n    let loading = true;\n    const imageState = imageStyle.getImageState();\n    if (imageState == ImageState.LOADED || imageState == ImageState.ERROR) {\n      loading = false;\n    } else {\n      if (imageState == ImageState.IDLE) {\n        imageStyle.load();\n      }\n    }\n    if (loading) {\n      loadingPromises.push(imageStyle.ready());\n    }\n  }\n  const fillStyle = style.getFill();\n  if (fillStyle && fillStyle.loading()) {\n    loadingPromises.push(fillStyle.ready());\n  }\n  const loading = loadingPromises.length > 0;\n  if (loading) {\n    Promise.all(loadingPromises).then(() => listener(null));\n  }\n  renderFeatureInternal(\n    replayGroup,\n    feature,\n    style,\n    squaredTolerance,\n    transform,\n    declutter,\n    index,\n  );\n\n  return loading;\n}\n\n/**\n * @param {import(\"../render/canvas/BuilderGroup.js\").default} replayGroup Replay group.\n * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {number} squaredTolerance Squared tolerance.\n * @param {import(\"../proj.js\").TransformFunction} [transform] Optional transform function.\n * @param {boolean} [declutter] Enable decluttering.\n * @param {number} [index] Render order index..\n */\nfunction renderFeatureInternal(\n  replayGroup,\n  feature,\n  style,\n  squaredTolerance,\n  transform,\n  declutter,\n  index,\n) {\n  const geometry = style.getGeometryFunction()(feature);\n  if (!geometry) {\n    return;\n  }\n  const simplifiedGeometry = geometry.simplifyTransformed(\n    squaredTolerance,\n    transform,\n  );\n  const renderer = style.getRenderer();\n  if (renderer) {\n    renderGeometry(replayGroup, simplifiedGeometry, style, feature, index);\n  } else {\n    const geometryRenderer = GEOMETRY_RENDERERS[simplifiedGeometry.getType()];\n    geometryRenderer(\n      replayGroup,\n      simplifiedGeometry,\n      style,\n      feature,\n      index,\n      declutter,\n    );\n  }\n}\n\n/**\n * @param {import(\"../render/canvas/BuilderGroup.js\").default} replayGroup Replay group.\n * @param {import(\"../geom/Geometry.js\").default|import(\"../render/Feature.js\").default} geometry Geometry.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n * @param {number} [index] Render order index.\n */\nfunction renderGeometry(replayGroup, geometry, style, feature, index) {\n  if (geometry.getType() == 'GeometryCollection') {\n    const geometries =\n      /** @type {import(\"../geom/GeometryCollection.js\").default} */ (\n        geometry\n      ).getGeometries();\n    for (let i = 0, ii = geometries.length; i < ii; ++i) {\n      renderGeometry(replayGroup, geometries[i], style, feature, index);\n    }\n    return;\n  }\n  const replay = replayGroup.getBuilder(style.getZIndex(), 'Default');\n  replay.drawCustom(\n    /** @type {import(\"../geom/SimpleGeometry.js\").default} */ (geometry),\n    feature,\n    style.getRenderer(),\n    style.getHitDetectionRenderer(),\n    index,\n  );\n}\n\n/**\n * @param {import(\"../render/canvas/BuilderGroup.js\").default} replayGroup Replay group.\n * @param {import(\"../geom/GeometryCollection.js\").default} geometry Geometry.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {import(\"../Feature.js\").default} feature Feature.\n * @param {import(\"../render/canvas/BuilderGroup.js\").default} [declutterBuilderGroup] Builder for decluttering.\n * @param {number} [index] Render order index.\n */\nfunction renderGeometryCollectionGeometry(\n  replayGroup,\n  geometry,\n  style,\n  feature,\n  declutterBuilderGroup,\n  index,\n) {\n  const geometries = geometry.getGeometriesArray();\n  let i, ii;\n  for (i = 0, ii = geometries.length; i < ii; ++i) {\n    const geometryRenderer = GEOMETRY_RENDERERS[geometries[i].getType()];\n    geometryRenderer(\n      replayGroup,\n      geometries[i],\n      style,\n      feature,\n      declutterBuilderGroup,\n      index,\n    );\n  }\n}\n\n/**\n * @param {import(\"../render/canvas/BuilderGroup.js\").default} builderGroup Replay group.\n * @param {import(\"../geom/LineString.js\").default|import(\"../render/Feature.js\").default} geometry Geometry.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n * @param {number} [index] Render order index.\n */\nfunction renderLineStringGeometry(\n  builderGroup,\n  geometry,\n  style,\n  feature,\n  index,\n) {\n  const strokeStyle = style.getStroke();\n  if (strokeStyle) {\n    const lineStringReplay = builderGroup.getBuilder(\n      style.getZIndex(),\n      'LineString',\n    );\n    lineStringReplay.setFillStrokeStyle(null, strokeStyle);\n    lineStringReplay.drawLineString(geometry, feature, index);\n  }\n  const textStyle = style.getText();\n  if (textStyle && textStyle.getText()) {\n    const textReplay = builderGroup.getBuilder(style.getZIndex(), 'Text');\n    textReplay.setTextStyle(textStyle);\n    textReplay.drawText(geometry, feature, index);\n  }\n}\n\n/**\n * @param {import(\"../render/canvas/BuilderGroup.js\").default} builderGroup Replay group.\n * @param {import(\"../geom/MultiLineString.js\").default|import(\"../render/Feature.js\").default} geometry Geometry.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n * @param {number} [index] Render order index.\n */\nfunction renderMultiLineStringGeometry(\n  builderGroup,\n  geometry,\n  style,\n  feature,\n  index,\n) {\n  const strokeStyle = style.getStroke();\n  if (strokeStyle) {\n    const lineStringReplay = builderGroup.getBuilder(\n      style.getZIndex(),\n      'LineString',\n    );\n    lineStringReplay.setFillStrokeStyle(null, strokeStyle);\n    lineStringReplay.drawMultiLineString(geometry, feature, index);\n  }\n  const textStyle = style.getText();\n  if (textStyle && textStyle.getText()) {\n    const textReplay = builderGroup.getBuilder(style.getZIndex(), 'Text');\n    textReplay.setTextStyle(textStyle);\n    textReplay.drawText(geometry, feature, index);\n  }\n}\n\n/**\n * @param {import(\"../render/canvas/BuilderGroup.js\").default} builderGroup Replay group.\n * @param {import(\"../geom/MultiPolygon.js\").default} geometry Geometry.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {import(\"../Feature.js\").default} feature Feature.\n * @param {number} [index] Render order index.\n */\nfunction renderMultiPolygonGeometry(\n  builderGroup,\n  geometry,\n  style,\n  feature,\n  index,\n) {\n  const fillStyle = style.getFill();\n  const strokeStyle = style.getStroke();\n  if (strokeStyle || fillStyle) {\n    const polygonReplay = builderGroup.getBuilder(style.getZIndex(), 'Polygon');\n    polygonReplay.setFillStrokeStyle(fillStyle, strokeStyle);\n    polygonReplay.drawMultiPolygon(geometry, feature, index);\n  }\n  const textStyle = style.getText();\n  if (textStyle && textStyle.getText()) {\n    const textReplay = builderGroup.getBuilder(style.getZIndex(), 'Text');\n    textReplay.setTextStyle(textStyle);\n    textReplay.drawText(geometry, feature, index);\n  }\n}\n\n/**\n * @param {import(\"../render/canvas/BuilderGroup.js\").default} builderGroup Replay group.\n * @param {import(\"../geom/Point.js\").default|import(\"../render/Feature.js\").default} geometry Geometry.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n * @param {number} [index] Render order index.\n * @param {boolean} [declutter] Enable decluttering.\n */\nfunction renderPointGeometry(\n  builderGroup,\n  geometry,\n  style,\n  feature,\n  index,\n  declutter,\n) {\n  const imageStyle = style.getImage();\n  const textStyle = style.getText();\n  const hasText = textStyle && textStyle.getText();\n  /** @type {import(\"../render/canvas.js\").DeclutterImageWithText} */\n  const declutterImageWithText =\n    declutter && imageStyle && hasText ? {} : undefined;\n  if (imageStyle) {\n    if (imageStyle.getImageState() != ImageState.LOADED) {\n      return;\n    }\n    const imageReplay = builderGroup.getBuilder(style.getZIndex(), 'Image');\n    imageReplay.setImageStyle(imageStyle, declutterImageWithText);\n    imageReplay.drawPoint(geometry, feature, index);\n  }\n  if (hasText) {\n    const textReplay = builderGroup.getBuilder(style.getZIndex(), 'Text');\n    textReplay.setTextStyle(textStyle, declutterImageWithText);\n    textReplay.drawText(geometry, feature, index);\n  }\n}\n\n/**\n * @param {import(\"../render/canvas/BuilderGroup.js\").default} builderGroup Replay group.\n * @param {import(\"../geom/MultiPoint.js\").default|import(\"../render/Feature.js\").default} geometry Geometry.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n * @param {number} [index] Render order index.\n * @param {boolean} [declutter] Enable decluttering.\n */\nfunction renderMultiPointGeometry(\n  builderGroup,\n  geometry,\n  style,\n  feature,\n  index,\n  declutter,\n) {\n  const imageStyle = style.getImage();\n  const hasImage = imageStyle && imageStyle.getOpacity() !== 0;\n  const textStyle = style.getText();\n  const hasText = textStyle && textStyle.getText();\n  /** @type {import(\"../render/canvas.js\").DeclutterImageWithText} */\n  const declutterImageWithText =\n    declutter && hasImage && hasText ? {} : undefined;\n  if (hasImage) {\n    if (imageStyle.getImageState() != ImageState.LOADED) {\n      return;\n    }\n    const imageReplay = builderGroup.getBuilder(style.getZIndex(), 'Image');\n    imageReplay.setImageStyle(imageStyle, declutterImageWithText);\n    imageReplay.drawMultiPoint(geometry, feature, index);\n  }\n  if (hasText) {\n    const textReplay = builderGroup.getBuilder(style.getZIndex(), 'Text');\n    textReplay.setTextStyle(textStyle, declutterImageWithText);\n    textReplay.drawText(geometry, feature, index);\n  }\n}\n\n/**\n * @param {import(\"../render/canvas/BuilderGroup.js\").default} builderGroup Replay group.\n * @param {import(\"../geom/Polygon.js\").default|import(\"../render/Feature.js\").default} geometry Geometry.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n * @param {number} [index] Render order index.\n */\nfunction renderPolygonGeometry(builderGroup, geometry, style, feature, index) {\n  const fillStyle = style.getFill();\n  const strokeStyle = style.getStroke();\n  if (fillStyle || strokeStyle) {\n    const polygonReplay = builderGroup.getBuilder(style.getZIndex(), 'Polygon');\n    polygonReplay.setFillStrokeStyle(fillStyle, strokeStyle);\n    polygonReplay.drawPolygon(geometry, feature, index);\n  }\n  const textStyle = style.getText();\n  if (textStyle && textStyle.getText()) {\n    const textReplay = builderGroup.getBuilder(style.getZIndex(), 'Text');\n    textReplay.setTextStyle(textStyle);\n    textReplay.drawText(geometry, feature, index);\n  }\n}\n"],"names":["VectorContext","geometry","feature","renderer","hitDetectionRenderer","index","style","circleGeometry","geometryCollectionGeometry","lineStringGeometry","multiLineStringGeometry","multiPointGeometry","multiPolygonGeometry","pointGeometry","polygonGeometry","fillStyle","strokeStyle","imageStyle","declutterImageWithText","textStyle","CanvasImmediateRenderer","context","pixelRatio","extent","transform","viewRotation","squaredTolerance","userTransform","Math","flatCoordinates","offset","end","stride","pixelCoordinates","localTransform","alpha","rotation","i","ii","x","y","centerX","centerY","close","length","ends","dx","dy","radius","geometries","flatMidpoint","geometryExtent","flatMidpoints","flatInteriorPoint","endss","flatInteriorPoints","fillState","contextFillState","strokeState","contextStrokeState","textState","contextTextState","textAlign","fillStyleColor","strokeStyleColor","strokeStyleLineCap","strokeStyleLineDash","strokeStyleLineDashOffset","strokeStyleLineJoin","strokeStyleWidth","strokeStyleMiterLimit","lineDash","undefined","n","imageSize","imagePixelRatio","imageAnchor","imageOrigin","imageScale","textFillStyle","textFillStyleColor","textStrokeStyle","textStrokeStyleColor","textStrokeStyleLineCap","textStrokeStyleLineDash","textStrokeStyleLineDashOffset","textStrokeStyleLineJoin","textStrokeStyleWidth","textStrokeStyleMiterLimit","textFont","textOffsetX","textOffsetY","textRotateWithView","textRotation","textScale","textText","textTextAlign","textTextBaseline","Array","acc","t","GEOMETRY_RENDERERS","builderGroup","declutter","hasText","imageReplay","textReplay","lineStringReplay","polygonReplay","hasImage","replayGroup","declutterBuilderGroup","geometryRenderer","circleReplay","defaultOrder","feature1","feature2","parseInt","getSquaredTolerance","resolution","tolerance","getTolerance","renderFeature","listener","loadingPromises","loading","imageState","Promise","renderFeatureInternal","simplifiedGeometry","renderGeometry","replay"],"mappings":"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"}