"use strict";(self.webpackChunk_terrestris_shogun_gis_client=self.webpackChunk_terrestris_shogun_gis_client||[]).push([["7849"],{32062:function(t,e,i){var n=i(10255);class r extends n.Z{constructor(t,e,i,n,r,s){super(t,e,r),this.originalEvent=i,this.pixel_=null,this.coordinate_=null,this.dragging=void 0!==n&&n,this.activePointers=s}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(t){this.pixel_=t}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(t){this.coordinate_=t}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}e.Z=r},30006:function(t,e,i){var n=i(73381);e.Z={SINGLECLICK:"singleclick",CLICK:n.default.CLICK,DBLCLICK:n.default.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"}},10255:function(t,e,i){var n=i(9520);class r extends n.default{constructor(t,e,i){super(t),this.map=e,this.frameState=void 0!==i?i:null}}e.Z=r},86320:function(t,e,i){function n(t){return Math.pow(t,3)}function r(t){return 1-n(1-t)}function s(t){return 3*t*t-2*t*t*t}function o(t){return t}function a(t){return t<.5?s(2*t):1-s(2*(t-.5))}i.r(e),i.d(e,{easeIn:function(){return n},easeOut:function(){return r},inAndOut:function(){return s},linear:function(){return o},upAndDown:function(){return a}})},36403:function(t,e,i){i.r(e),i.d(e,{all:function(){return a},altKeyOnly:function(){return h},altShiftKeysOnly:function(){return l},always:function(){return c},click:function(){return g},doubleClick:function(){return C},focus:function(){return d},focusWithTabindex:function(){return u},mouseActionButton:function(){return f},mouseOnly:function(){return x},never:function(){return _},noModifierKeys:function(){return y},penOnly:function(){return w},platformModifierKey:function(){return E},platformModifierKeyOnly:function(){return v},pointerMove:function(){return p},primaryAction:function(){return D},shiftKeyOnly:function(){return P},singleClick:function(){return m},targetNotEditable:function(){return T},touchOnly:function(){return k}});var n=i(30006),r=i(38906),s=i(64011),o=i(91358);function a(t){let e=arguments;return function(t){let i=!0;for(let n=0,r=e.length;n<r&&(i=i&&e[n](t));++n);return i}}let h=function(t){let e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},l=function(t){let e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},d=function(t){let e=t.map.getTargetElement(),i=e.getRootNode(),n=t.map.getOwnerDocument().activeElement;return i instanceof ShadowRoot?i.host.contains(n):e.contains(n)},u=function(t){let e=t.map.getTargetElement(),i=e.getRootNode();return!(i instanceof ShadowRoot?i.host:e).hasAttribute("tabindex")||d(t)},c=s.TRUE,g=function(t){return t.type==n.Z.CLICK},f=function(t){let e=t.originalEvent;return 0==e.button&&!(o.WEBKIT&&o.MAC&&e.ctrlKey)},_=s.FALSE,p=function(t){return"pointermove"==t.type},m=function(t){return t.type==n.Z.SINGLECLICK},C=function(t){return t.type==n.Z.DBLCLICK},y=function(t){let e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},v=function(t){let e=t.originalEvent;return!e.altKey&&(o.MAC?e.metaKey:e.ctrlKey)&&!e.shiftKey},E=function(t){let e=t.originalEvent;return o.MAC?e.metaKey:e.ctrlKey},P=function(t){let e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},T=function(t){let e=t.originalEvent,i=e.target.tagName;return"INPUT"!==i&&"SELECT"!==i&&"TEXTAREA"!==i&&!e.target.isContentEditable},x=function(t){let e=t.originalEvent;return(0,r.h)(void 0!==e,"mapBrowserEvent must originate from a pointer event"),"mouse"==e.pointerType},k=function(t){let e=t.originalEvent;return(0,r.h)(void 0!==e,"mapBrowserEvent must originate from a pointer event"),"touch"===e.pointerType},w=function(t){let e=t.originalEvent;return(0,r.h)(void 0!==e,"mapBrowserEvent must originate from a pointer event"),"pen"===e.pointerType},D=function(t){let e=t.originalEvent;return(0,r.h)(void 0!==e,"mapBrowserEvent must originate from a pointer event"),e.isPrimary&&0===e.button}},69669:function(t,e,i){i.r(e);var n=i(21915),r=i(32538),s=i(38667),o=i(17882);class a extends r.ZP{constructor(t,e,i){super(),void 0!==i&&void 0===e?this.setFlatCoordinates(i,t):(e=e||0,this.setCenterAndRadius(t,e,i))}clone(){let t=new a(this.flatCoordinates.slice(),void 0,this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,n){let r=this.flatCoordinates,s=t-r[0],o=e-r[1],a=s*s+o*o;if(a<n){if(0===a)for(let t=0;t<this.stride;++t)i[t]=r[t];else{let t=this.getRadius()/Math.sqrt(a);i[0]=r[0]+t*s,i[1]=r[1]+t*o;for(let t=2;t<this.stride;++t)i[t]=r[t]}return i.length=this.stride,a}return n}containsXY(t,e){let i=this.flatCoordinates,n=t-i[0],r=e-i[1];return n*n+r*r<=this.getRadiusSquared_()}getCenter(){return this.flatCoordinates.slice(0,this.stride)}computeExtent(t){let e=this.flatCoordinates,i=e[this.stride]-e[0];return(0,n.createOrUpdate)(e[0]-i,e[1]-i,e[0]+i,e[1]+i,t)}getRadius(){return Math.sqrt(this.getRadiusSquared_())}getRadiusSquared_(){let t=this.flatCoordinates[this.stride]-this.flatCoordinates[0],e=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return t*t+e*e}getType(){return"Circle"}intersectsExtent(t){let e=this.getExtent();if((0,n.intersects)(t,e)){let e=this.getCenter();return t[0]<=e[0]&&t[2]>=e[0]||t[1]<=e[1]&&t[3]>=e[1]||(0,n.forEachCorner)(t,this.intersectsCoordinate.bind(this))}return!1}setCenter(t){let e=this.stride,i=this.flatCoordinates[e]-this.flatCoordinates[0],n=t.slice();n[e]=n[0]+i;for(let i=1;i<e;++i)n[e+i]=t[i];this.setFlatCoordinates(this.layout,n),this.changed()}setCenterAndRadius(t,e,i){this.setLayout(i,t,0),this.flatCoordinates||(this.flatCoordinates=[]);let n=this.flatCoordinates,r=(0,s.IG)(n,0,t,this.stride);n[r++]=n[0]+e;for(let t=1,e=this.stride;t<e;++t)n[r++]=n[t];n.length=r,this.changed()}getCoordinates(){return null}setCoordinates(t,e){}setRadius(t){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+t,this.changed()}rotate(t,e){let i=this.getCenter(),n=this.getStride();this.setCenter((0,o.U1)(i,0,i.length,n,t,e,i)),this.changed()}}a.prototype.transform,e.default=a},98090:function(t,e,i){i.r(e);var n=i(73381),r=i(13002),s=i(21915),o=i(8204);class a extends o.default{constructor(t){super(),this.geometries_=t,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(r.bN),this.changeEventsKeys_.length=0}listenGeometriesChange_(){let t=this.geometries_;for(let e=0,i=t.length;e<i;++e)this.changeEventsKeys_.push((0,r.oL)(t[e],n.default.CHANGE,this.changed,this))}clone(){let t=new a(h(this.geometries_));return t.applyProperties(this),t}closestPointXY(t,e,i,n){if(n<(0,s.closestSquaredDistanceXY)(this.getExtent(),t,e))return n;let r=this.geometries_;for(let s=0,o=r.length;s<o;++s)n=r[s].closestPointXY(t,e,i,n);return n}containsXY(t,e){let i=this.geometries_;for(let n=0,r=i.length;n<r;++n)if(i[n].containsXY(t,e))return!0;return!1}computeExtent(t){(0,s.createOrUpdateEmpty)(t);let e=this.geometries_;for(let i=0,n=e.length;i<n;++i)(0,s.extend)(t,e[i].getExtent());return t}getGeometries(){return h(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let t=[],e=this.geometries_;for(let i=0,n=e.length;i<n;++i)e[i].getType()===this.getType()?t=t.concat(e[i].getGeometriesArrayRecursive()):t.push(e[i]);return t}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<this.simplifiedGeometryMaxMinSquaredTolerance)return this;let e=[],i=this.geometries_,n=!1;for(let r=0,s=i.length;r<s;++r){let s=i[r],o=s.getSimplifiedGeometry(t);e.push(o),o!==s&&(n=!0)}return n?new a(e):(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getType(){return"GeometryCollection"}intersectsExtent(t){let e=this.geometries_;for(let i=0,n=e.length;i<n;++i)if(e[i].intersectsExtent(t))return!0;return!1}isEmpty(){return 0===this.geometries_.length}rotate(t,e){let i=this.geometries_;for(let n=0,r=i.length;n<r;++n)i[n].rotate(t,e);this.changed()}scale(t,e,i){i||(i=(0,s.getCenter)(this.getExtent()));let n=this.geometries_;for(let r=0,s=n.length;r<s;++r)n[r].scale(t,e,i);this.changed()}setGeometries(t){this.setGeometriesArray(h(t))}setGeometriesArray(t){this.unlistenGeometriesChange_(),this.geometries_=t,this.listenGeometriesChange_(),this.changed()}applyTransform(t){let e=this.geometries_;for(let i=0,n=e.length;i<n;++i)e[i].applyTransform(t);this.changed()}translate(t,e){let i=this.geometries_;for(let n=0,r=i.length;n<r;++n)i[n].translate(t,e);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function h(t){return t.map(t=>t.clone())}e.default=a},72445:function(t,e,i){i.r(e),i.d(e,{DrawEvent:function(){return L},createBox:function(){return Z},createRegularPolygon:function(){return U}});var n=i(23068),r=i(32062),s=i(30006),o=i(90728),a=i(9520),h=i(73381),l=i(36403),d=i(21915),u=i(64011),c=i(69669),g=i(98090),f=i(44538),_=i(25642),p=i(52329),m=i(13987),C=i(52043),y=i(15265),v=i(32538),E=i(28799),P=i(21882),T=i(5374),x=i(73410),k=i(31219),w=i(38024),D=i(73604);let I={DRAWSTART:"drawstart",DRAWEND:"drawend",DRAWABORT:"drawabort"};class L extends a.default{constructor(t,e){super(t),this.feature=e}}function S(t,e){return(0,P.bI)(t[0],t[1],e[0],e[1])}function M(t,e){let i=t.length;return e<0?t[e+i]:e>=i?t[e-i]:t[e]}function R(t,e,i){let n,r;e<i?(n=e,r=i):(n=i,r=e);let s=Math.ceil(n),o=Math.floor(r);if(s>o)return S(G(t,n),G(t,r));let a=0;n<s&&(a+=S(G(t,n),M(t,s))),o<r&&(a+=S(M(t,o),G(t,r)));for(let e=s;e<o-1;++e)a+=S(M(t,e),M(t,e+1));return a}let F={index:-1,endIndex:NaN};function O(t,e,i,n){let r=t[0],s=t[1];for(let t=0,o=e.length-1;t<o;++t){let o=A(r,s,e[t],e[t+1]);if(0===o.squaredDistance){let r=t+o.along;n.push({coordinates:e,ring:i,startIndex:r,endIndex:r});return}}}let N={along:0,squaredDistance:0};function A(t,e,i,n){let r=i[0],s=i[1],o=n[0],a=n[1],h=o-r,l=a-s,d=0,u=r,c=s;return(0!==h||0!==l)&&(d=(0,P.uZ)(((t-r)*h+(e-s)*l)/(h*h+l*l),0,1),u+=h*d,c+=l*d),N.along=d,N.squaredDistance=(0,P.FH)((0,P.bI)(t,e,u,c),10),N}function G(t,e){let i=t.length,n=Math.floor(e),r=e-n;n>=i?n-=i:n<0&&(n+=i);let s=n+1;s>=i&&(s-=i);let o=t[n],a=o[0],h=o[1],l=t[s],d=l[0]-a,u=l[1]-h;return[a+d*r,h+u*r]}class K extends w.default{constructor(t){t.stopDown||(t.stopDown=u.FALSE),super(t),this.on,this.once,this.un,this.shouldHandle_=!1,this.downPx_=null,this.downTimeout_,this.lastDragTime_,this.pointerType_,this.freehand_=!1,this.source_=t.source?t.source:null,this.features_=t.features?t.features:null,this.snapTolerance_=t.snapTolerance?t.snapTolerance:12,this.type_=t.type,this.mode_=function(t){switch(t){case"Point":case"MultiPoint":return"Point";case"LineString":case"MultiLineString":return"LineString";case"Polygon":case"MultiPolygon":return"Polygon";case"Circle":return"Circle";default:throw Error("Invalid type: "+t)}}(this.type_),this.stopClick_=!!t.stopClick,this.minPoints_=t.minPoints?t.minPoints:"Polygon"===this.mode_?3:2,this.maxPoints_="Circle"===this.mode_?2:t.maxPoints?t.maxPoints:1/0,this.finishCondition_=t.finishCondition?t.finishCondition:u.TRUE,this.geometryLayout_=t.geometryLayout?t.geometryLayout:"XY";let e=t.geometryFunction;if(!e){let t=this.mode_;if("Circle"===t)e=(t,e,i)=>{let n=e||new c.default([NaN,NaN]),r=(0,T.fromUserCoordinate)(t[0],i),s=(0,o.squaredDistance)(r,(0,T.fromUserCoordinate)(t[t.length-1],i));n.setCenterAndRadius(r,Math.sqrt(s),this.geometryLayout_);let a=(0,T.getUserProjection)();return a&&n.transform(i,a),n};else{let i;"Point"===t?i=C.default:"LineString"===t?i=f.default:"Polygon"===t&&(i=y.default),e=(e,n,r)=>(n?"Polygon"===t?e[0].length?n.setCoordinates([e[0].concat([e[0][0]])],this.geometryLayout_):n.setCoordinates([],this.geometryLayout_):n.setCoordinates(e,this.geometryLayout_):n=new i(e,this.geometryLayout_),n)}}this.geometryFunction_=e,this.dragVertexDelay_=void 0!==t.dragVertexDelay?t.dragVertexDelay:500,this.finishCoordinate_=null,this.sketchFeature_=null,this.sketchPoint_=null,this.sketchCoords_=null,this.sketchLine_=null,this.sketchLineCoords_=null,this.squaredClickTolerance_=t.clickTolerance?t.clickTolerance*t.clickTolerance:36,this.overlay_=new E.default({source:new x.default({useSpatialIndex:!1,wrapX:!!t.wrapX&&t.wrapX}),style:t.style?t.style:function(){let t=(0,k.createEditingStyle)();return function(e,i){return t[e.getGeometry().getType()]}}(),updateWhileInteracting:!0}),this.geometryName_=t.geometryName,this.condition_=t.condition?t.condition:l.noModifierKeys,this.freehandCondition_,t.freehand?this.freehandCondition_=l.always:this.freehandCondition_=t.freehandCondition?t.freehandCondition:l.shiftKeyOnly,this.traceCondition_,this.setTrace(t.trace||!1),this.traceState_={active:!1},this.traceSource_=t.traceSource||t.source||null,this.addChangeListener(D.Z.ACTIVE,this.updateState_)}setTrace(t){let e;e=t?!0===t?l.always:t:l.never,this.traceCondition_=e}setMap(t){super.setMap(t),this.updateState_()}getOverlay(){return this.overlay_}handleEvent(t){t.originalEvent.type===h.default.CONTEXTMENU&&t.originalEvent.preventDefault(),this.freehand_="Point"!==this.mode_&&this.freehandCondition_(t);let e=t.type===s.Z.POINTERMOVE,i=!0;return!this.freehand_&&this.lastDragTime_&&t.type===s.Z.POINTERDRAG&&(Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=t.pixel,this.shouldHandle_=!this.freehand_,e=!0):this.lastDragTime_=void 0,this.shouldHandle_&&void 0!==this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0)),this.freehand_&&t.type===s.Z.POINTERDRAG&&null!==this.sketchFeature_?(this.addToDrawing_(t.coordinate),i=!1):this.freehand_&&t.type===s.Z.POINTERDOWN?i=!1:e&&2>this.getPointerCount()?(i=t.type===s.Z.POINTERMOVE)&&this.freehand_?(this.handlePointerMove_(t),this.shouldHandle_&&t.originalEvent.preventDefault()):("mouse"===t.originalEvent.pointerType||t.type===s.Z.POINTERDRAG&&void 0===this.downTimeout_)&&this.handlePointerMove_(t):t.type===s.Z.DBLCLICK&&(i=!1),super.handleEvent(t)&&i}handleDownEvent(t){return(this.shouldHandle_=!this.freehand_,this.freehand_)?(this.downPx_=t.pixel,this.finishCoordinate_||this.startDrawing_(t.coordinate),!0):this.condition_(t)?(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout(()=>{this.handlePointerMove_(new r.Z(s.Z.POINTERMOVE,t.map,t.originalEvent,!1,t.frameState))},this.dragVertexDelay_),this.downPx_=t.pixel,!0):(this.lastDragTime_=void 0,!1)}deactivateTrace_(){this.traceState_={active:!1}}toggleTraceState_(t){if(!this.traceSource_||!this.traceCondition_(t))return;if(this.traceState_.active){this.deactivateTrace_();return}let e=this.getMap(),i=e.getCoordinateFromPixel([t.pixel[0]-this.snapTolerance_,t.pixel[1]+this.snapTolerance_]),n=e.getCoordinateFromPixel([t.pixel[0]+this.snapTolerance_,t.pixel[1]-this.snapTolerance_]),r=(0,d.boundingExtent)([i,n]),s=this.traceSource_.getFeaturesInExtent(r);if(0===s.length)return;let o=function(t,e){let i=[];for(let n=0;n<e.length;++n)!function t(e,i,n){if(i instanceof f.default){O(e,i.getCoordinates(),!1,n);return}if(i instanceof _.default){let t=i.getCoordinates();for(let i=0,r=t.length;i<r;++i)O(e,t[i],!1,n);return}if(i instanceof y.default){let t=i.getCoordinates();for(let i=0,r=t.length;i<r;++i)O(e,t[i],!0,n);return}if(i instanceof m.default){let t=i.getCoordinates();for(let i=0,r=t.length;i<r;++i){let r=t[i];for(let t=0,i=r.length;t<i;++t)O(e,r[t],!0,n)}return}if(i instanceof g.default){let r=i.getGeometries();for(let i=0;i<r.length;++i)t(e,r[i],n);return}}(t,e[n].getGeometry(),i);return i}(t.coordinate,s);o.length&&(this.traceState_={active:!0,startPx:t.pixel.slice(),targets:o,targetIndex:-1})}addOrRemoveTracedCoordinates_(t,e){let i=t.startIndex<=t.endIndex;i===t.startIndex<=e?i&&e>t.endIndex||!i&&e<t.endIndex?this.addTracedCoordinates_(t,t.endIndex,e):(i&&e<t.endIndex||!i&&e>t.endIndex)&&this.removeTracedCoordinates_(e,t.endIndex):(this.removeTracedCoordinates_(t.startIndex,t.endIndex),this.addTracedCoordinates_(t,t.startIndex,e))}removeTracedCoordinates_(t,e){if(t===e)return;let i=0;if(t<e){let n=Math.floor(e);n===e&&(n-=1),i=n-Math.ceil(t)+1}else{let n=Math.ceil(e);n===e&&(n+=1),i=Math.floor(t)-n+1}i>0&&this.removeLastPoints_(i)}addTracedCoordinates_(t,e,i){if(e===i)return;let n=[];if(e<i){let r=Math.ceil(e),s=Math.floor(i);s===i&&(s-=1);for(let e=r;e<=s;++e)n.push(M(t.coordinates,e))}else{let r=Math.floor(e),s=Math.ceil(i);s===i&&(s+=1);for(let e=r;e>=s;--e)n.push(M(t.coordinates,e))}n.length&&this.appendCoordinates(n)}updateTrace_(t){let e=this.traceState_;if(!e.active||-1===e.targetIndex&&(0,o.distance)(e.startPx,t.pixel)<this.snapTolerance_)return;let i=function(t,e,i,n){let r=t[0],s=t[1],a=1/0,h=-1,l=NaN;for(let t=0;t<e.targets.length;++t){let i;let n=e.targets[t],o=n.coordinates,d=1/0;for(let t=0;t<o.length-1;++t){let e=A(r,s,o[t],o[t+1]);e.squaredDistance<d&&(d=e.squaredDistance,i=t+e.along)}d<a&&(a=d,n.ring&&e.targetIndex===t&&(n.endIndex>n.startIndex?i<n.startIndex&&(i+=o.length):n.endIndex<n.startIndex&&i>n.startIndex&&(i-=o.length)),l=i,h=t)}let d=e.targets[h],u=d.ring;if(e.targetIndex===h&&u){let t=G(d.coordinates,l),r=i.getPixelFromCoordinate(t);(0,o.distance)(r,e.startPx)>n&&(u=!1)}if(u){let t=d.coordinates,e=t.length,i=d.startIndex,n=l;if(i<n){let r=R(t,i,n);R(t,i,n-e)<r&&(l-=e)}else{let r=R(t,i,n);R(t,i,n+e)<r&&(l+=e)}}return F.index=h,F.endIndex=l,F}(t.coordinate,e,this.getMap(),this.snapTolerance_);if(e.targetIndex!==i.index){if(-1!==e.targetIndex){let t=e.targets[e.targetIndex];this.removeTracedCoordinates_(t.startIndex,t.endIndex)}let t=e.targets[i.index];this.addTracedCoordinates_(t,t.startIndex,i.endIndex)}else{let t=e.targets[e.targetIndex];this.addOrRemoveTracedCoordinates_(t,i.endIndex)}e.targetIndex=i.index;let n=e.targets[e.targetIndex];n.endIndex=i.endIndex;let r=G(n.coordinates,n.endIndex),s=this.getMap().getPixelFromCoordinate(r);t.coordinate=r,t.pixel=[Math.round(s[0]),Math.round(s[1])]}handleUpEvent(t){let e=!0;if(0===this.getPointerCount()){this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(t);let i=this.traceState_.active;if(this.toggleTraceState_(t),this.shouldHandle_){let n=!this.finishCoordinate_;n&&this.startDrawing_(t.coordinate),!n&&this.freehand_?this.finishDrawing():this.freehand_||n&&"Point"!==this.mode_||(this.atFinish_(t.pixel,i)?this.finishCondition_(t)&&this.finishDrawing():this.addToDrawing_(t.coordinate)),e=!1}else this.freehand_&&this.abortDrawing()}return!e&&this.stopClick_&&t.preventDefault(),e}handlePointerMove_(t){if(this.pointerType_=t.originalEvent.pointerType,this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){let e=this.downPx_,i=t.pixel,n=e[0]-i[0],r=e[1]-i[1],s=n*n+r*r;if(this.shouldHandle_=this.freehand_?s>this.squaredClickTolerance_:s<=this.squaredClickTolerance_,!this.shouldHandle_)return}if(!this.finishCoordinate_){this.createOrUpdateSketchPoint_(t.coordinate.slice());return}this.updateTrace_(t),this.modifyDrawing_(t.coordinate)}atFinish_(t,e){let i=!1;if(this.sketchFeature_){let n=!1,r=[this.finishCoordinate_],s=this.mode_;if("Point"===s)i=!0;else if("Circle"===s)i=2===this.sketchCoords_.length;else if("LineString"===s)n=!e&&this.sketchCoords_.length>this.minPoints_;else if("Polygon"===s){let t=this.sketchCoords_;n=t[0].length>this.minPoints_,r=[t[0][0],t[0][t[0].length-2]],r=e?[t[0][0]]:[t[0][0],t[0][t[0].length-2]]}if(n){let e=this.getMap();for(let n=0,s=r.length;n<s;n++){let s=r[n],o=e.getPixelFromCoordinate(s),a=t[0]-o[0],h=t[1]-o[1];if(i=Math.sqrt(a*a+h*h)<=(this.freehand_?1:this.snapTolerance_)){this.finishCoordinate_=s;break}}}}return i}createOrUpdateSketchPoint_(t){this.sketchPoint_?this.sketchPoint_.getGeometry().setCoordinates(t):(this.sketchPoint_=new n.default(new C.default(t)),this.updateSketchFeatures_())}createOrUpdateCustomSketchLine_(t){this.sketchLine_||(this.sketchLine_=new n.default);let e=t.getLinearRing(0),i=this.sketchLine_.getGeometry();i?(i.setFlatCoordinates(e.getLayout(),e.getFlatCoordinates()),i.changed()):(i=new f.default(e.getFlatCoordinates(),e.getLayout()),this.sketchLine_.setGeometry(i))}startDrawing_(t){let e=this.getMap().getView().getProjection(),i=(0,v.tP)(this.geometryLayout_);for(;t.length<i;)t.push(0);this.finishCoordinate_=t,"Point"===this.mode_?this.sketchCoords_=t.slice():"Polygon"===this.mode_?(this.sketchCoords_=[[t.slice(),t.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[t.slice(),t.slice()],this.sketchLineCoords_&&(this.sketchLine_=new n.default(new f.default(this.sketchLineCoords_)));let r=this.geometryFunction_(this.sketchCoords_,void 0,e);this.sketchFeature_=new n.default,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(r),this.updateSketchFeatures_(),this.dispatchEvent(new L(I.DRAWSTART,this.sketchFeature_))}modifyDrawing_(t){let e,i;let n=this.getMap(),r=this.sketchFeature_.getGeometry(),s=n.getView().getProjection(),o=(0,v.tP)(this.geometryLayout_);for(;t.length<o;)t.push(0);"Point"===this.mode_?i=this.sketchCoords_:"Polygon"===this.mode_?(i=(e=this.sketchCoords_[0])[e.length-1],this.atFinish_(n.getPixelFromCoordinate(t))&&(t=this.finishCoordinate_.slice())):i=(e=this.sketchCoords_)[e.length-1],i[0]=t[0],i[1]=t[1],this.geometryFunction_(this.sketchCoords_,r,s),this.sketchPoint_&&this.sketchPoint_.getGeometry().setCoordinates(t),"Polygon"===r.getType()&&"Polygon"!==this.mode_?this.createOrUpdateCustomSketchLine_(r):this.sketchLineCoords_&&this.sketchLine_.getGeometry().setCoordinates(this.sketchLineCoords_),this.updateSketchFeatures_()}addToDrawing_(t){let e,i;let n=this.sketchFeature_.getGeometry(),r=this.getMap().getView().getProjection(),s=this.mode_;return("LineString"===s||"Circle"===s?(this.finishCoordinate_=t.slice(),(i=this.sketchCoords_).length>=this.maxPoints_&&(this.freehand_?i.pop():e=!0),i.push(t.slice()),this.geometryFunction_(i,n,r)):"Polygon"===s&&((i=this.sketchCoords_[0]).length>=this.maxPoints_&&(this.freehand_?i.pop():e=!0),i.push(t.slice()),e&&(this.finishCoordinate_=i[0]),this.geometryFunction_(this.sketchCoords_,n,r)),this.createOrUpdateSketchPoint_(t.slice()),this.updateSketchFeatures_(),e)?this.finishDrawing():this.sketchFeature_}removeLastPoints_(t){if(!this.sketchFeature_)return;let e=this.sketchFeature_.getGeometry(),i=this.getMap().getView().getProjection(),n=this.mode_;for(let r=0;r<t;++r){let t;if("LineString"===n||"Circle"===n){if((t=this.sketchCoords_).splice(-2,1),t.length>=2){this.finishCoordinate_=t[t.length-2].slice();let e=this.finishCoordinate_.slice();t[t.length-1]=e,this.createOrUpdateSketchPoint_(e)}this.geometryFunction_(t,e,i),"Polygon"===e.getType()&&this.sketchLine_&&this.createOrUpdateCustomSketchLine_(e)}else if("Polygon"===n){(t=this.sketchCoords_[0]).splice(-2,1);let n=this.sketchLine_.getGeometry();if(t.length>=2){let e=t[t.length-2].slice();t[t.length-1]=e,this.createOrUpdateSketchPoint_(e)}n.setCoordinates(t),this.geometryFunction_(this.sketchCoords_,e,i)}if(1===t.length){this.abortDrawing();break}}this.updateSketchFeatures_()}removeLastPoint(){this.removeLastPoints_(1)}finishDrawing(){let t=this.abortDrawing_();if(!t)return null;let e=this.sketchCoords_,i=t.getGeometry(),n=this.getMap().getView().getProjection();return"LineString"===this.mode_?(e.pop(),this.geometryFunction_(e,i,n)):"Polygon"===this.mode_&&(e[0].pop(),this.geometryFunction_(e,i,n),e=i.getCoordinates()),"MultiPoint"===this.type_?t.setGeometry(new p.default([e])):"MultiLineString"===this.type_?t.setGeometry(new _.default([e])):"MultiPolygon"===this.type_&&t.setGeometry(new m.default([e])),this.dispatchEvent(new L(I.DRAWEND,t)),this.features_&&this.features_.push(t),this.source_&&this.source_.addFeature(t),t}abortDrawing_(){this.finishCoordinate_=null;let t=this.sketchFeature_;return this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0),this.deactivateTrace_(),t}abortDrawing(){let t=this.abortDrawing_();t&&this.dispatchEvent(new L(I.DRAWABORT,t))}appendCoordinates(t){let e;let i=this.mode_,n=!this.sketchFeature_;if(n&&this.startDrawing_(t[0]),"LineString"===i||"Circle"===i)e=this.sketchCoords_;else{if("Polygon"!==i)return;e=this.sketchCoords_&&this.sketchCoords_.length?this.sketchCoords_[0]:[]}n&&e.shift(),e.pop();for(let e=0;e<t.length;e++)this.addToDrawing_(t[e]);let r=t[t.length-1];this.sketchFeature_=this.addToDrawing_(r),this.modifyDrawing_(r)}extend(t){let e=t.getGeometry();this.sketchFeature_=t,this.sketchCoords_=e.getCoordinates();let i=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=i.slice(),this.sketchCoords_.push(i.slice()),this.sketchPoint_=new n.default(new C.default(i)),this.updateSketchFeatures_(),this.dispatchEvent(new L(I.DRAWSTART,this.sketchFeature_))}updateSketchFeatures_(){let t=[];this.sketchFeature_&&t.push(this.sketchFeature_),this.sketchLine_&&t.push(this.sketchLine_),this.sketchPoint_&&t.push(this.sketchPoint_);let e=this.overlay_.getSource();e.clear(!0),e.addFeatures(t)}updateState_(){let t=this.getMap(),e=this.getActive();t&&e||this.abortDrawing(),this.overlay_.setMap(e?t:null)}}function U(t,e){return function(i,n,r){let s=(0,T.fromUserCoordinate)(i[0],r),a=(0,T.fromUserCoordinate)(i[i.length-1],r),h=Math.sqrt((0,o.squaredDistance)(s,a));n=n||(0,y.fromCircle)(new c.default(s),t);let l=e;if(!e&&0!==e){let t=a[0]-s[0];l=Math.atan2(a[1]-s[1],t)}(0,y.makeRegular)(n,s,h,l);let d=(0,T.getUserProjection)();return d&&n.transform(r,d),n}}function Z(){return function(t,e,i){let n=(0,d.boundingExtent)([t[0],t[t.length-1]].map(function(t){return(0,T.fromUserCoordinate)(t,i)})),r=[[(0,d.getBottomLeft)(n),(0,d.getBottomRight)(n),(0,d.getTopRight)(n),(0,d.getTopLeft)(n),(0,d.getBottomLeft)(n)]];e?e.setCoordinates(r):e=new y.default(r);let s=(0,T.getUserProjection)();return s&&e.transform(i,s),e}}e.default=K},47588:function(t,e,i){i.d(e,{Cv:function(){return a},FW:function(){return h}});var n=i(58493),r=i(86320),s=i(73604);class o extends n.default{constructor(t){super(),this.on,this.once,this.un,t&&t.handleEvent&&(this.handleEvent=t.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(s.Z.ACTIVE)}getMap(){return this.map_}handleEvent(t){return!0}setActive(t){this.set(s.Z.ACTIVE,t)}setMap(t){this.map_=t}}function a(t,e,i){let n=t.getCenterInternal();if(n){let s=[n[0]+e[0],n[1]+e[1]];t.animateInternal({duration:void 0!==i?i:250,easing:r.linear,center:t.getConstrainedCenter(s)})}}function h(t,e,i,n){let s=t.getZoom();if(void 0===s)return;let o=t.getConstrainedZoom(s+e),a=t.getResolutionForZoom(o);t.getAnimating()&&t.cancelAnimations(),t.animate({resolution:a,anchor:i,duration:void 0!==n?n:250,easing:r.easeOut})}e.ZP=o},38024:function(t,e,i){i.r(e),i.d(e,{centroid:function(){return o}});var n=i(30006),r=i(47588);class s extends r.ZP{constructor(t){super(t=t||{}),t.handleDownEvent&&(this.handleDownEvent=t.handleDownEvent),t.handleDragEvent&&(this.handleDragEvent=t.handleDragEvent),t.handleMoveEvent&&(this.handleMoveEvent=t.handleMoveEvent),t.handleUpEvent&&(this.handleUpEvent=t.handleUpEvent),t.stopDown&&(this.stopDown=t.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(t){return!1}handleDragEvent(t){}handleEvent(t){if(!t.originalEvent)return!0;let e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==n.Z.POINTERDRAG)this.handleDragEvent(t),t.originalEvent.preventDefault();else if(t.type==n.Z.POINTERUP){let e=this.handleUpEvent(t);this.handlingDownUpSequence=e&&this.targetPointers.length>0}}else if(t.type==n.Z.POINTERDOWN){let i=this.handleDownEvent(t);this.handlingDownUpSequence=i,e=this.stopDown(i)}else t.type==n.Z.POINTERMOVE&&this.handleMoveEvent(t);return!e}handleMoveEvent(t){}handleUpEvent(t){return!1}stopDown(t){return t}updateTrackedPointers_(t){t.activePointers&&(this.targetPointers=t.activePointers)}}function o(t){let e=t.length,i=0,n=0;for(let r=0;r<e;r++)i+=t[r].clientX,n+=t[r].clientY;return{clientX:i/e,clientY:n/e}}e.default=s},73604:function(t,e){e.Z={ACTIVE:"active"}},49179:function(t,e,i){function n(){throw Error("Unimplemented abstract method.")}i.r(e),i.d(e,{VERSION:function(){return o},abstract:function(){return n},getUid:function(){return s}});let r=0;function s(t){return t.ol_uid||(t.ol_uid=String(++r))}let o="10.4.0"}}]);
//# sourceMappingURL=7849.4286a9fe93412fbc.js.map