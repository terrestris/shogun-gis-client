{"version":3,"file":"1510.364099dfe4a65f58.js","sources":["webpack://@terrestris/shogun-gis-client/./node_modules/@terrestris/react-util/dist/Hooks/useModify/useModify.js","webpack://@terrestris/shogun-gis-client/./node_modules/@terrestris/react-geo/dist/Button/ModifyButton/ModifyButton.js","webpack://@terrestris/shogun-gis-client/./node_modules/@terrestris/react-util/dist/Hooks/useSelectFeatures/useSelectFeatures.js"],"sourcesContent":["import { useEffect, useMemo, useRef } from 'react';\nimport OlCollection from 'ol/Collection';\nimport { singleClick } from 'ol/events/condition';\nimport Modify from 'ol/interaction/Modify';\nimport Translate from 'ol/interaction/Translate';\nimport { DigitizeUtil } from '../../Util/DigitizeUtil';\nimport useMap from '../useMap/useMap';\nimport { useOlInteraction } from '../useOlInteraction/useOlInteraction';\nimport { useOlListener } from '../useOlListener/useOlListener';\nimport { usePropOrDefault } from '../usePropOrDefault/usePropOrDefault';\nimport { useSelectFeatures } from '../useSelectFeatures/useSelectFeatures';\nexport const useModify = ({ active, onFeatureSelect, onModifyStart, onModifyEnd, onTranslateStart, onTranslateEnd, onTranslating, digitizeLayer, selectStyle, selectInteractionConfig, hitTolerance, modifyInteractionConfig, translateInteractionConfig }) => {\n    const map = useMap();\n    const layer = usePropOrDefault(digitizeLayer, () => map ? DigitizeUtil.getDigitizeLayer(map) : null, [map]);\n    const featuresRef = useRef(new OlCollection());\n    const layers = useMemo(() => layer ? [layer] : [], [layer]);\n    useEffect(() => {\n        if (!active) {\n            featuresRef.current.clear();\n        }\n    }, [active]);\n    useSelectFeatures({\n        clearAfterSelect: false,\n        onFeatureSelect,\n        active,\n        layers,\n        selectStyle,\n        selectInteractionConfig,\n        hitTolerance,\n        featuresCollection: featuresRef.current\n    });\n    const translateInteraction = useOlInteraction(() => {\n        const newTranslateInteraction = new Translate({\n            features: featuresRef.current,\n            ...translateInteractionConfig\n        });\n        newTranslateInteraction.set('name', 'react-util-translate-interaction');\n        return newTranslateInteraction;\n    }, [translateInteractionConfig], active);\n    const modifyInteraction = useOlInteraction(() => {\n        const newModifyInteraction = new Modify({\n            features: featuresRef.current,\n            deleteCondition: singleClick,\n            style: selectStyle ?? DigitizeUtil.DEFAULT_SELECT_STYLE,\n            ...modifyInteractionConfig\n        });\n        newModifyInteraction.set('name', 'react-util-modify-interaction');\n        return newModifyInteraction;\n    }, [modifyInteractionConfig], active);\n    useOlListener(modifyInteraction, i => i.on('modifystart', e => onModifyStart?.(e)), [onModifyStart]);\n    useOlListener(modifyInteraction, i => i.on('modifyend', e => onModifyEnd?.(e)), [onModifyEnd]);\n    useOlListener(translateInteraction, i => i.on('translatestart', e => onTranslateStart?.(e)), [onTranslateStart]);\n    useOlListener(translateInteraction, i => i.on('translateend', e => onTranslateEnd?.(e)), [onTranslateEnd]);\n    useOlListener(translateInteraction, i => i.on('translating', e => onTranslating?.(e)), [onTranslating]);\n};\nexport default useModify;\n//# sourceMappingURL=useModify.js.map","import { useModify } from '@terrestris/react-util/dist/Hooks/useModify/useModify';\nimport * as React from 'react';\nimport { useCallback, useState } from 'react';\nimport { CSS_PREFIX } from '../../constants';\nimport { FeatureLabelModal } from '../../FeatureLabelModal/FeatureLabelModal';\nimport ToggleButton from '../ToggleButton/ToggleButton';\n/**\n * The className added to this component.\n */\nconst defaultClassName = `${CSS_PREFIX}modifybutton`;\nexport const ModifyButton = ({ className, hitTolerance = 5, onFeatureSelect, onModifyStart, onModifyEnd, onTranslateStart, onTranslateEnd, onTranslating, digitizeLayer, selectStyle, selectInteractionConfig, modifyInteractionConfig, translateInteractionConfig, onModalLabelOk, onModalLabelCancel, maxLabelLineLength, modalPromptTitle, modalPromptOkButtonText, modalPromptCancelButtonText, editLabel = true, pressed, ...passThroughProps }) => {\n    const [editLabelFeature, setEditLabelFeature] = useState(null);\n    const onFeatureSelectInternal = useCallback((event) => {\n        if (editLabel) {\n            const labeled = event.selected.find(f => f.get('isLabel'));\n            setEditLabelFeature(labeled || null);\n        }\n        onFeatureSelect?.(event);\n    }, [editLabel, onFeatureSelect]);\n    useModify({\n        selectStyle,\n        selectInteractionConfig,\n        digitizeLayer,\n        onModifyStart,\n        onModifyEnd,\n        onTranslateStart,\n        onTranslateEnd,\n        onTranslating,\n        active: !!pressed,\n        modifyInteractionConfig,\n        translateInteractionConfig,\n        onFeatureSelect: onFeatureSelectInternal,\n        hitTolerance\n    });\n    const finalClassName = className\n        ? `${defaultClassName} ${className}`\n        : defaultClassName;\n    const btnWrapperClass = `${CSS_PREFIX}digitize-button-wrapper`;\n    let modal = null;\n    if (editLabelFeature) {\n        const onModalLabelOkInternal = () => {\n            onModalLabelOk?.(editLabelFeature);\n            setEditLabelFeature(null);\n        };\n        const onModalLabelCancelInternal = () => {\n            onModalLabelCancel?.();\n            setEditLabelFeature(null);\n        };\n        modal = (React.createElement(FeatureLabelModal, { feature: editLabelFeature, onOk: onModalLabelOkInternal, onCancel: onModalLabelCancelInternal, title: modalPromptTitle, okText: modalPromptOkButtonText, cancelText: modalPromptCancelButtonText, maxLabelLineLength: maxLabelLineLength }));\n    }\n    return (React.createElement(\"span\", { className: btnWrapperClass },\n        React.createElement(ToggleButton, { pressed: pressed, className: finalClassName, ...passThroughProps }),\n        modal));\n};\nexport default ModifyButton;\n//# sourceMappingURL=ModifyButton.js.map","import { useEffect } from 'react';\nimport OlCollection from 'ol/Collection';\nimport * as OlEventConditions from 'ol/events/condition';\nimport OlInteractionSelect from 'ol/interaction/Select';\nimport { DigitizeUtil } from '../../Util/DigitizeUtil';\nimport { useOlInteraction } from '../useOlInteraction/useOlInteraction';\nimport { useOlListener } from '../useOlListener/useOlListener';\nimport { usePropOrDefault } from '../usePropOrDefault/usePropOrDefault';\nexport const useSelectFeatures = ({ active, selectStyle, selectInteractionConfig, onFeatureSelect, hitTolerance = 5, layers, clearAfterSelect = false, featuresCollection }) => {\n    const features = usePropOrDefault(featuresCollection, () => new OlCollection(), []);\n    const selectInteraction = useOlInteraction(() => {\n        if (!features) {\n            return undefined;\n        }\n        const newInteraction = new OlInteractionSelect({\n            condition: OlEventConditions.singleClick,\n            features,\n            hitTolerance: hitTolerance,\n            style: selectStyle ?? DigitizeUtil.DEFAULT_SELECT_STYLE,\n            layers: layers,\n            ...(selectInteractionConfig ?? {})\n        });\n        newInteraction.set('name', 'react-util-select-interaction');\n        return newInteraction;\n    }, [features, hitTolerance, selectStyle, layers, selectInteractionConfig], active);\n    useOlListener(selectInteraction, i => i.on('select', e => {\n        if (features && clearAfterSelect) {\n            features.clear();\n        }\n        onFeatureSelect?.(e);\n    }), [features, clearAfterSelect, onFeatureSelect]);\n    useEffect(() => {\n        if (!active && features) {\n            features.clear();\n        }\n    }, [active, features]);\n};\nexport default useSelectFeatures;\n//# sourceMappingURL=useSelectFeatures.js.map"],"names":["useModify","active","onFeatureSelect","onModifyStart","onModifyEnd","onTranslateStart","onTranslateEnd","onTranslating","digitizeLayer","selectStyle","selectInteractionConfig","hitTolerance","modifyInteractionConfig","translateInteractionConfig","map","useMap","layer","usePropOrDefault","DigitizeUtil","featuresRef","layers","useSelectFeatures","translateInteraction","useOlInteraction","newTranslateInteraction","modifyInteraction","newModifyInteraction","useOlListener","i","e","defaultClassName","ModifyButton","className","onModalLabelOk","onModalLabelCancel","maxLabelLineLength","modalPromptTitle","modalPromptOkButtonText","modalPromptCancelButtonText","editLabel","pressed","passThroughProps","editLabelFeature","setEditLabelFeature","event","labeled","f","finalClassName","btnWrapperClass","modal","FeatureLabelModal","ToggleButton","clearAfterSelect","featuresCollection","features","selectInteraction","newInteraction"],"mappings":"4XAWO,IAAMA,EAAY,CAAC,CAAEC,OAAAA,CAAM,CAAEC,gBAAAA,CAAe,CAAEC,cAAAA,CAAa,CAAEC,YAAAA,CAAW,CAAEC,iBAAAA,CAAgB,CAAEC,eAAAA,CAAc,CAAEC,cAAAA,CAAa,CAAEC,cAAAA,CAAa,CAAEC,YAAAA,CAAW,CAAEC,wBAAAA,CAAuB,CAAEC,aAAAA,CAAY,CAAEC,wBAAAA,CAAuB,CAAEC,2BAAAA,CAA0B,CAAE,IACtP,IAAMC,EAAM,GAAAC,EAAA,KACNC,EAAQ,GAAAC,EAAA,GAAiBT,EAAe,IAAMM,EAAMI,EAAA,kBAA6B,CAACJ,GAAO,KAAM,CAACA,EAAI,EACpGK,EAAc,aAAO,GAAI,OACzBC,EAAS,cAAQ,IAAMJ,EAAQ,CAACA,EAAM,CAAG,EAAE,CAAE,CAACA,EAAM,EAC1D,gBAAU,KACDf,GACDkB,EAAY,OAAO,CAAC,KAAK,EAEjC,EAAG,CAAClB,EAAO,EACX,GAAAoB,EAAA,GAAkB,CACd,iBAAkB,GAClBnB,gBAAAA,EACAD,OAAAA,EACAmB,OAAAA,EACAX,YAAAA,EACAC,wBAAAA,EACAC,aAAAA,EACA,mBAAoBQ,EAAY,OAAO,AAC3C,GACA,IAAMG,EAAuB,GAAAC,EAAA,GAAiB,KAC1C,IAAMC,EAA0B,GAAI,MAAU,CAC1C,SAAUL,EAAY,OAAO,CAC7B,GAAGN,CAA0B,AACjC,GAEA,OADAW,EAAwB,GAAG,CAAC,OAAQ,oCAC7BA,CACX,EAAG,CAACX,EAA2B,CAAEZ,GAC3BwB,EAAoB,GAAAF,EAAA,GAAiB,KACvC,IAAMG,EAAuB,GAAI,MAAO,CACpC,SAAUP,EAAY,OAAO,CAC7B,gBAAiB,aAAW,CAC5B,MAAOV,GAAeS,EAAA,sBAAiC,CACvD,GAAGN,CAAuB,AAC9B,GAEA,OADAc,EAAqB,GAAG,CAAC,OAAQ,iCAC1BA,CACX,EAAG,CAACd,EAAwB,CAAEX,GAC9B,GAAA0B,EAAA,GAAcF,EAAmBG,GAAKA,EAAE,EAAE,CAAC,cAAeC,GAAK1B,IAAgB0B,IAAK,CAAC1B,EAAc,EACnG,GAAAwB,EAAA,GAAcF,EAAmBG,GAAKA,EAAE,EAAE,CAAC,YAAaC,GAAKzB,IAAcyB,IAAK,CAACzB,EAAY,EAC7F,GAAAuB,EAAA,GAAcL,EAAsBM,GAAKA,EAAE,EAAE,CAAC,iBAAkBC,GAAKxB,IAAmBwB,IAAK,CAACxB,EAAiB,EAC/G,GAAAsB,EAAA,GAAcL,EAAsBM,GAAKA,EAAE,EAAE,CAAC,eAAgBC,GAAKvB,IAAiBuB,IAAK,CAACvB,EAAe,EACzG,GAAAqB,EAAA,GAAcL,EAAsBM,GAAKA,EAAE,EAAE,CAAC,cAAeC,GAAKtB,IAAgBsB,IAAK,CAACtB,EAAc,CAC1G,E,qCC7CA,IAAMuB,EAAmB,CAAC,EAAE,GAAU,CAAC,YAAY,CAAC,CACvCC,EAAe,CAAC,CAAEC,UAAAA,CAAS,CAAErB,aAAAA,EAAe,CAAC,CAAET,gBAAAA,CAAe,CAAEC,cAAAA,CAAa,CAAEC,YAAAA,CAAW,CAAEC,iBAAAA,CAAgB,CAAEC,eAAAA,CAAc,CAAEC,cAAAA,CAAa,CAAEC,cAAAA,CAAa,CAAEC,YAAAA,CAAW,CAAEC,wBAAAA,CAAuB,CAAEE,wBAAAA,CAAuB,CAAEC,2BAAAA,CAA0B,CAAEoB,eAAAA,CAAc,CAAEC,mBAAAA,CAAkB,CAAEC,mBAAAA,CAAkB,CAAEC,iBAAAA,CAAgB,CAAEC,wBAAAA,CAAuB,CAAEC,4BAAAA,CAA2B,CAAEC,UAAAA,EAAY,EAAI,CAAEC,QAAAA,CAAO,CAAE,GAAGC,EAAkB,IAChb,GAAM,CAACC,EAAkBC,EAAoB,CAAG,eAAS,MAQzD3C,EAAU,CACNS,YAAAA,EACAC,wBAAAA,EACAF,cAAAA,EACAL,cAAAA,EACAC,YAAAA,EACAC,iBAAAA,EACAC,eAAAA,EACAC,cAAAA,EACA,OAAQ,CAAC,CAACiC,EACV5B,wBAAAA,EACAC,2BAAAA,EACA,gBAnB4B,kBAAY,AAAC+B,IACrCL,GAEAI,EAAoBE,AADJD,EAAM,QAAQ,CAAC,IAAI,CAACE,GAAKA,EAAE,GAAG,CAAC,aAChB,MAEnC5C,IAAkB0C,EACtB,EAAG,CAACL,EAAWrC,EAAgB,EAc3BS,aAAAA,CACJ,GACA,IAAMoC,EAAiBf,EACjB,CAAC,EAAEF,EAAiB,CAAC,EAAEE,EAAU,CAAC,CAClCF,EACAkB,EAAkB,CAAC,EAAE,GAAU,CAAC,uBAAuB,CAAC,CAC1DC,EAAQ,KAYZ,OAXIP,GASAO,CAAAA,EAAS,eAAmB,CAACC,EAAA,CAAiB,CAAE,CAAE,QAASR,EAAkB,KAR9C,KAC3BT,IAAiBS,GACjBC,EAAoB,KACxB,EAK2G,SAJxE,KAC/BT,MACAS,EAAoB,KACxB,EACiJ,MAAOP,EAAkB,OAAQC,EAAyB,WAAYC,EAA6B,mBAAoBH,CAAmB,EAAE,EAEzR,eAAmB,CAAC,OAAQ,CAAE,UAAWa,CAAgB,EAC7D,eAAmB,CAACG,EAAA,CAAY,CAAE,CAAE,QAASX,EAAS,UAAWO,EAAgB,GAAGN,CAAgB,AAAC,GACrGQ,EACR,EACA,MAAelB,C,oKC9CR,IAAMV,EAAoB,CAAC,CAAEpB,OAAAA,CAAM,CAAEQ,YAAAA,CAAW,CAAEC,wBAAAA,CAAuB,CAAER,gBAAAA,CAAe,CAAES,aAAAA,EAAe,CAAC,CAAES,OAAAA,CAAM,CAAEgC,iBAAAA,EAAmB,EAAK,CAAEC,mBAAAA,CAAkB,CAAE,IACvK,IAAMC,EAAW,QAAiBD,EAAoB,IAAM,GAAI,MAAgB,EAAE,EAC5EE,EAAoB,QAAiB,KACvC,GAAI,CAACD,EACD,OAEJ,IAAME,EAAiB,GAAI,MAAoB,CAC3C,UAAW,aAA6B,CACxCF,SAAAA,EACA,aAAc3C,EACd,MAAOF,GAAe,wBAAiC,CACvD,OAAQW,EACR,GAAIV,GAA2B,CAAC,CAAC,AACrC,GAEA,OADA8C,EAAe,GAAG,CAAC,OAAQ,iCACpBA,CACX,EAAG,CAACF,EAAU3C,EAAcF,EAAaW,EAAQV,EAAwB,CAAET,GAC3E,QAAcsD,EAAmB3B,GAAKA,EAAE,EAAE,CAAC,SAAUC,IAC7CyB,GAAYF,GACZE,EAAS,KAAK,GAElBpD,IAAkB2B,EACtB,GAAI,CAACyB,EAAUF,EAAkBlD,EAAgB,EACjD,gBAAU,KACF,CAACD,GAAUqD,GACXA,EAAS,KAAK,EAEtB,EAAG,CAACrD,EAAQqD,EAAS,CACzB,C"}