"use strict";(self.webpackChunk_terrestris_shogun_gis_client=self.webpackChunk_terrestris_shogun_gis_client||[]).push([["6872"],{38904:function(e,t,n){var i=n(22490);class r extends i.A{constructor(e,t,n,i,r,s){super(e,t,r),this.originalEvent=n,this.pixel_=null,this.coordinate_=null,this.dragging=void 0!==i&&i,this.activePointers=s}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(e){this.pixel_=e}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(e){this.coordinate_=e}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}t.A=r},5888:function(e,t,n){var i=n(55506);t.A={SINGLECLICK:"singleclick",CLICK:i.default.CLICK,DBLCLICK:i.default.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"}},22490:function(e,t,n){var i=n(43354);class r extends i.default{constructor(e,t,n){super(e),this.map=t,this.frameState=void 0!==n?n:null}}t.A=r},7773:function(e,t,n){function i(e){return Math.pow(e,3)}function r(e){return 1-i(1-e)}function s(e){return 3*e*e-2*e*e*e}function o(e){return e}function a(e){return e<.5?s(2*e):1-s(2*(e-.5))}n.r(t),n.d(t,{easeIn:function(){return i},easeOut:function(){return r},inAndOut:function(){return s},linear:function(){return o},upAndDown:function(){return a}})},89267:function(e,t,n){n.r(t),n.d(t,{all:function(){return o},altKeyOnly:function(){return a},altShiftKeysOnly:function(){return h},always:function(){return u},click:function(){return c},doubleClick:function(){return m},focus:function(){return l},focusWithTabindex:function(){return d},mouseActionButton:function(){return g},mouseOnly:function(){return T},never:function(){return _},noModifierKeys:function(){return y},penOnly:function(){return k},platformModifierKey:function(){return v},platformModifierKeyOnly:function(){return C},pointerMove:function(){return f},primaryAction:function(){return w},shiftKeyOnly:function(){return E},singleClick:function(){return p},targetNotEditable:function(){return P},touchOnly:function(){return x}});var i=n(5888),r=n(29991),s=n(44954);function o(e){let t=arguments;return function(e){let n=!0;for(let i=0,r=t.length;i<r&&(n=n&&t[i](e));++i);return n}}let a=function(e){let t=e.originalEvent;return t.altKey&&!(t.metaKey||t.ctrlKey)&&!t.shiftKey},h=function(e){let t=e.originalEvent;return t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},l=function(e){let t=e.map.getTargetElement(),n=t.getRootNode(),i=e.map.getOwnerDocument().activeElement;return n instanceof ShadowRoot?n.host.contains(i):t.contains(i)},d=function(e){let t=e.map.getTargetElement(),n=t.getRootNode();return!(n instanceof ShadowRoot?n.host:t).hasAttribute("tabindex")||l(e)},u=r.TRUE,c=function(e){return e.type==i.A.CLICK},g=function(e){let t=e.originalEvent;return"pointerId"in t&&0==t.button&&!(s.WEBKIT&&s.MAC&&t.ctrlKey)},_=r.FALSE,f=function(e){return"pointermove"==e.type},p=function(e){return e.type==i.A.SINGLECLICK},m=function(e){return e.type==i.A.DBLCLICK},y=function(e){let t=e.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&!t.shiftKey},C=function(e){let t=e.originalEvent;return!t.altKey&&(s.MAC?t.metaKey:t.ctrlKey)&&!t.shiftKey},v=function(e){let t=e.originalEvent;return s.MAC?t.metaKey:t.ctrlKey},E=function(e){let t=e.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},P=function(e){let t=e.originalEvent,n=t.target.tagName;return"INPUT"!==n&&"SELECT"!==n&&"TEXTAREA"!==n&&!t.target.isContentEditable},T=function(e){let t=e.originalEvent;return"pointerId"in t&&"mouse"==t.pointerType},x=function(e){let t=e.originalEvent;return"pointerId"in t&&"touch"===t.pointerType},k=function(e){let t=e.originalEvent;return"pointerId"in t&&"pen"===t.pointerType},w=function(e){let t=e.originalEvent;return"pointerId"in t&&t.isPrimary&&0===t.button}},28383:function(e,t,n){n.r(t);var i=n(55506),r=n(17353),s=n(85752),o=n(71147);class a extends o.default{constructor(e){super(),this.geometries_=e,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(r.JH),this.changeEventsKeys_.length=0}listenGeometriesChange_(){let e=this.geometries_;for(let t=0,n=e.length;t<n;++t)this.changeEventsKeys_.push((0,r.KT)(e[t],i.default.CHANGE,this.changed,this))}clone(){let e=new a(h(this.geometries_));return e.applyProperties(this),e}closestPointXY(e,t,n,i){if(i<(0,s.closestSquaredDistanceXY)(this.getExtent(),e,t))return i;let r=this.geometries_;for(let s=0,o=r.length;s<o;++s)i=r[s].closestPointXY(e,t,n,i);return i}containsXY(e,t){let n=this.geometries_;for(let i=0,r=n.length;i<r;++i)if(n[i].containsXY(e,t))return!0;return!1}computeExtent(e){(0,s.createOrUpdateEmpty)(e);let t=this.geometries_;for(let n=0,i=t.length;n<i;++n)(0,s.extend)(e,t[n].getExtent());return e}getGeometries(){return h(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let e=[],t=this.geometries_;for(let n=0,i=t.length;n<i;++n)t[n].getType()===this.getType()?e=e.concat(t[n].getGeometriesArrayRecursive()):e.push(t[n]);return e}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&e<this.simplifiedGeometryMaxMinSquaredTolerance)return this;let t=[],n=this.geometries_,i=!1;for(let r=0,s=n.length;r<s;++r){let s=n[r],o=s.getSimplifiedGeometry(e);t.push(o),o!==s&&(i=!0)}return i?new a(t):(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getType(){return"GeometryCollection"}intersectsExtent(e){let t=this.geometries_;for(let n=0,i=t.length;n<i;++n)if(t[n].intersectsExtent(e))return!0;return!1}isEmpty(){return 0===this.geometries_.length}rotate(e,t){let n=this.geometries_;for(let i=0,r=n.length;i<r;++i)n[i].rotate(e,t);this.changed()}scale(e,t,n){n||(n=(0,s.getCenter)(this.getExtent()));let i=this.geometries_;for(let r=0,s=i.length;r<s;++r)i[r].scale(e,t,n);this.changed()}setGeometries(e){this.setGeometriesArray(h(e))}setGeometriesArray(e){this.unlistenGeometriesChange_(),this.geometries_=e,this.listenGeometriesChange_(),this.changed()}applyTransform(e){let t=this.geometries_;for(let n=0,i=t.length;n<i;++n)t[n].applyTransform(e);this.changed()}translate(e,t){let n=this.geometries_;for(let i=0,r=n.length;i<r;++i)n[i].translate(e,t);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function h(e){return e.map(e=>e.clone())}t.default=a},68971:function(e,t,n){n.r(t),n.d(t,{DrawEvent:function(){return L},createBox:function(){return q},createRegularPolygon:function(){return U}});var i=n(22772),r=n(38904),s=n(5888),o=n(53094),a=n(43354),h=n(55506),l=n(89267),d=n(85752),u=n(29991),c=n(96279),g=n(28383),_=n(52820),f=n(32817),p=n(29094),m=n(70910),y=n(51117),C=n(29229),v=n(57029),E=n(24113),P=n(94966),T=n(21128),x=n(84143),k=n(48069),w=n(29592),I=n(48340);let D="drawstart";class L extends a.default{constructor(e,t){super(e),this.feature=t}}function M(e,t){return(0,P.hG)(e[0],e[1],t[0],t[1])}function S(e,t){let n=e.length;return t<0?e[t+n]:t>=n?e[t-n]:e[t]}function A(e,t,n){let i,r;t<n?(i=t,r=n):(i=n,r=t);let s=Math.ceil(i),o=Math.floor(r);if(s>o)return M(N(e,i),N(e,r));let a=0;i<s&&(a+=M(N(e,i),S(e,s))),o<r&&(a+=M(S(e,o),N(e,r)));for(let t=s;t<o-1;++t)a+=M(S(e,t),S(e,t+1));return a}let F={index:-1,endIndex:NaN};function O(e,t,n,i){let r=e[0],s=e[1];for(let e=0,o=t.length-1;e<o;++e){let o=R(r,s,t[e],t[e+1]);if(0===o.squaredDistance){let r=e+o.along;i.push({coordinates:t,ring:n,startIndex:r,endIndex:r});return}}}let G={along:0,squaredDistance:0};function R(e,t,n,i){let r=n[0],s=n[1],o=i[0],a=i[1],h=o-r,l=a-s,d=0,u=r,c=s;return(0!==h||0!==l)&&(d=(0,P.qE)(((e-r)*h+(t-s)*l)/(h*h+l*l),0,1),u+=h*d,c+=l*d),G.along=d,G.squaredDistance=(0,P.Mg)((0,P.hG)(e,t,u,c),10),G}function N(e,t){let n=e.length,i=Math.floor(t),r=t-i;i>=n?i-=n:i<0&&(i+=n);let s=i+1;s>=n&&(s-=n);let o=e[i],a=o[0],h=o[1],l=e[s],d=l[0]-a,u=l[1]-h;return[a+d*r,h+u*r]}class K extends w.default{constructor(e){e.stopDown||(e.stopDown=u.FALSE),super(e),this.on,this.once,this.un,this.shouldHandle_=!1,this.downPx_=null,this.downTimeout_,this.lastDragTime_,this.pointerType_,this.freehand_=!1,this.source_=e.source?e.source:null,this.features_=e.features?e.features:null,this.snapTolerance_=e.snapTolerance?e.snapTolerance:12,this.type_=e.type,this.mode_=function(e){switch(e){case"Point":case"MultiPoint":return"Point";case"LineString":case"MultiLineString":return"LineString";case"Polygon":case"MultiPolygon":return"Polygon";case"Circle":return"Circle";default:throw Error("Invalid type: "+e)}}(this.type_),this.stopClick_=!!e.stopClick,this.minPoints_=e.minPoints?e.minPoints:"Polygon"===this.mode_?3:2,this.maxPoints_="Circle"===this.mode_?2:e.maxPoints?e.maxPoints:1/0,this.finishCondition_=e.finishCondition?e.finishCondition:u.TRUE,this.geometryLayout_=e.geometryLayout?e.geometryLayout:"XY";let t=e.geometryFunction;if(!t){let e=this.mode_;if("Circle"===e)t=(e,t,n)=>{let i=t||new c.default([NaN,NaN]),r=(0,T.fromUserCoordinate)(e[0],n),s=(0,o.squaredDistance)(r,(0,T.fromUserCoordinate)(e[e.length-1],n));i.setCenterAndRadius(r,Math.sqrt(s),this.geometryLayout_);let a=(0,T.getUserProjection)();return a&&i.transform(n,a),i};else{let n;"Point"===e?n=y.default:"LineString"===e?n=_.default:"Polygon"===e&&(n=C.default),t=(t,i,r)=>(i?"Polygon"===e?t[0].length?i.setCoordinates([t[0].concat([t[0][0]])],this.geometryLayout_):i.setCoordinates([],this.geometryLayout_):i.setCoordinates(t,this.geometryLayout_):i=new n(t,this.geometryLayout_),i)}}this.geometryFunction_=t,this.dragVertexDelay_=void 0!==e.dragVertexDelay?e.dragVertexDelay:500,this.finishCoordinate_=null,this.sketchFeature_=null,this.sketchPoint_=null,this.sketchCoords_=null,this.sketchLine_=null,this.sketchLineCoords_=null,this.squaredClickTolerance_=e.clickTolerance?e.clickTolerance*e.clickTolerance:36,this.overlay_=new E.default({source:new x.default({useSpatialIndex:!1,wrapX:!!e.wrapX&&e.wrapX}),style:e.style?e.style:function(){let e=(0,k.createEditingStyle)();return function(t,n){return e[t.getGeometry().getType()]}}(),updateWhileInteracting:!0}),this.geometryName_=e.geometryName,this.condition_=e.condition?e.condition:l.noModifierKeys,this.freehandCondition_,e.freehand?this.freehandCondition_=l.always:this.freehandCondition_=e.freehandCondition?e.freehandCondition:l.shiftKeyOnly,this.traceCondition_,this.setTrace(e.trace||!1),this.traceState_={active:!1},this.traceSource_=e.traceSource||e.source||null,this.addChangeListener(I.A.ACTIVE,this.updateState_)}setTrace(e){let t;t=e?!0===e?l.always:e:l.never,this.traceCondition_=t}setMap(e){super.setMap(e),this.updateState_()}getOverlay(){return this.overlay_}handleEvent(e){e.originalEvent.type===h.default.CONTEXTMENU&&e.originalEvent.preventDefault(),this.freehand_="Point"!==this.mode_&&this.freehandCondition_(e);let t=e.type===s.A.POINTERMOVE,n=!0;return!this.freehand_&&this.lastDragTime_&&e.type===s.A.POINTERDRAG&&(Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=e.pixel,this.shouldHandle_=!this.freehand_,t=!0):this.lastDragTime_=void 0,this.shouldHandle_&&void 0!==this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0)),this.freehand_&&e.type===s.A.POINTERDRAG&&null!==this.sketchFeature_?(this.addToDrawing_(e.coordinate),n=!1):this.freehand_&&e.type===s.A.POINTERDOWN?n=!1:t&&2>this.getPointerCount()?(n=e.type===s.A.POINTERMOVE)&&this.freehand_?(this.handlePointerMove_(e),this.shouldHandle_&&e.originalEvent.preventDefault()):("mouse"===e.originalEvent.pointerType||e.type===s.A.POINTERDRAG&&void 0===this.downTimeout_)&&this.handlePointerMove_(e):e.type===s.A.DBLCLICK&&(n=!1),super.handleEvent(e)&&n}handleDownEvent(e){return(this.shouldHandle_=!this.freehand_,this.freehand_)?(this.downPx_=e.pixel,this.finishCoordinate_||this.startDrawing_(e.coordinate),!0):this.condition_(e)?(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout(()=>{this.handlePointerMove_(new r.A(s.A.POINTERMOVE,e.map,e.originalEvent,!1,e.frameState))},this.dragVertexDelay_),this.downPx_=e.pixel,!0):(this.lastDragTime_=void 0,!1)}deactivateTrace_(){this.traceState_={active:!1}}toggleTraceState_(e){if(!this.traceSource_||!this.traceCondition_(e))return;if(this.traceState_.active)return void this.deactivateTrace_();let t=this.getMap(),n=t.getCoordinateFromPixel([e.pixel[0]-this.snapTolerance_,e.pixel[1]+this.snapTolerance_]),i=t.getCoordinateFromPixel([e.pixel[0]+this.snapTolerance_,e.pixel[1]-this.snapTolerance_]),r=(0,d.boundingExtent)([n,i]),s=this.traceSource_.getFeaturesInExtent(r);if(0===s.length)return;let o=function(e,t){let n=[];for(let i=0;i<t.length;++i)!function e(t,n,i){if(n instanceof _.default)return void O(t,n.getCoordinates(),!1,i);if(n instanceof f.default){let e=n.getCoordinates();for(let n=0,r=e.length;n<r;++n)O(t,e[n],!1,i);return}if(n instanceof C.default){let e=n.getCoordinates();for(let n=0,r=e.length;n<r;++n)O(t,e[n],!0,i);return}if(n instanceof m.default){let e=n.getCoordinates();for(let n=0,r=e.length;n<r;++n){let r=e[n];for(let e=0,n=r.length;e<n;++e)O(t,r[e],!0,i)}return}if(n instanceof g.default){let r=n.getGeometries();for(let n=0;n<r.length;++n)e(t,r[n],i);return}}(e,t[i].getGeometry(),n);return n}(e.coordinate,s);o.length&&(this.traceState_={active:!0,startPx:e.pixel.slice(),targets:o,targetIndex:-1})}addOrRemoveTracedCoordinates_(e,t){let n=e.startIndex<=e.endIndex;n===e.startIndex<=t?n&&t>e.endIndex||!n&&t<e.endIndex?this.addTracedCoordinates_(e,e.endIndex,t):(n&&t<e.endIndex||!n&&t>e.endIndex)&&this.removeTracedCoordinates_(t,e.endIndex):(this.removeTracedCoordinates_(e.startIndex,e.endIndex),this.addTracedCoordinates_(e,e.startIndex,t))}removeTracedCoordinates_(e,t){if(e===t)return;let n=0;if(e<t){let i=Math.floor(t);i===t&&(i-=1),n=i-Math.ceil(e)+1}else{let i=Math.ceil(t);i===t&&(i+=1),n=Math.floor(e)-i+1}n>0&&this.removeLastPoints_(n)}addTracedCoordinates_(e,t,n){if(t===n)return;let i=[];if(t<n){let r=Math.ceil(t),s=Math.floor(n);s===n&&(s-=1);for(let t=r;t<=s;++t)i.push(S(e.coordinates,t))}else{let r=Math.floor(t),s=Math.ceil(n);s===n&&(s+=1);for(let t=r;t>=s;--t)i.push(S(e.coordinates,t))}i.length&&this.appendCoordinates(i)}updateTrace_(e){let t=this.traceState_;if(!t.active||-1===t.targetIndex&&(0,o.distance)(t.startPx,e.pixel)<this.snapTolerance_)return;let n=function(e,t,n,i){let r=e[0],s=e[1],a=1/0,h=-1,l=NaN;for(let e=0;e<t.targets.length;++e){let n,i=t.targets[e],o=i.coordinates,d=1/0;for(let e=0;e<o.length-1;++e){let t=R(r,s,o[e],o[e+1]);t.squaredDistance<d&&(d=t.squaredDistance,n=e+t.along)}d<a&&(a=d,i.ring&&t.targetIndex===e&&(i.endIndex>i.startIndex?n<i.startIndex&&(n+=o.length):i.endIndex<i.startIndex&&n>i.startIndex&&(n-=o.length)),l=n,h=e)}let d=t.targets[h],u=d.ring;if(t.targetIndex===h&&u){let e=N(d.coordinates,l),r=n.getPixelFromCoordinate(e);(0,o.distance)(r,t.startPx)>i&&(u=!1)}if(u){let e=d.coordinates,t=e.length,n=d.startIndex,i=l;if(n<i){let r=A(e,n,i);A(e,n,i-t)<r&&(l-=t)}else{let r=A(e,n,i);A(e,n,i+t)<r&&(l+=t)}}return F.index=h,F.endIndex=l,F}(e.coordinate,t,this.getMap(),this.snapTolerance_);if(t.targetIndex!==n.index){if(-1!==t.targetIndex){let e=t.targets[t.targetIndex];this.removeTracedCoordinates_(e.startIndex,e.endIndex)}let e=t.targets[n.index];this.addTracedCoordinates_(e,e.startIndex,n.endIndex)}else{let e=t.targets[t.targetIndex];this.addOrRemoveTracedCoordinates_(e,n.endIndex)}t.targetIndex=n.index;let i=t.targets[t.targetIndex];i.endIndex=n.endIndex;let r=N(i.coordinates,i.endIndex),s=this.getMap().getPixelFromCoordinate(r);e.coordinate=r,e.pixel=[Math.round(s[0]),Math.round(s[1])]}handleUpEvent(e){let t=!0;if(0===this.getPointerCount()){this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(e);let n=this.traceState_.active;if(this.toggleTraceState_(e),this.shouldHandle_){let i=!this.finishCoordinate_;i&&this.startDrawing_(e.coordinate),!i&&this.freehand_?this.finishDrawing():this.freehand_||i&&"Point"!==this.mode_||(this.atFinish_(e.pixel,n)?this.finishCondition_(e)&&this.finishDrawing():this.addToDrawing_(e.coordinate)),t=!1}else this.freehand_&&this.abortDrawing()}return!t&&this.stopClick_&&e.preventDefault(),t}handlePointerMove_(e){if(this.pointerType_=e.originalEvent.pointerType,this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){let t=this.downPx_,n=e.pixel,i=t[0]-n[0],r=t[1]-n[1],s=i*i+r*r;if(this.shouldHandle_=this.freehand_?s>this.squaredClickTolerance_:s<=this.squaredClickTolerance_,!this.shouldHandle_)return}if(!this.finishCoordinate_)return void this.createOrUpdateSketchPoint_(e.coordinate.slice());this.updateTrace_(e),this.modifyDrawing_(e.coordinate)}atFinish_(e,t){let n=!1;if(this.sketchFeature_){let i=!1,r=[this.finishCoordinate_],s=this.mode_;if("Point"===s)n=!0;else if("Circle"===s)n=2===this.sketchCoords_.length;else if("LineString"===s)i=!t&&this.sketchCoords_.length>this.minPoints_;else if("Polygon"===s){let e=this.sketchCoords_;i=e[0].length>this.minPoints_,r=[e[0][0],e[0][e[0].length-2]],r=t?[e[0][0]]:[e[0][0],e[0][e[0].length-2]]}if(i){let t=this.getMap();for(let i=0,s=r.length;i<s;i++){let s=r[i],o=t.getPixelFromCoordinate(s),a=e[0]-o[0],h=e[1]-o[1];if(n=Math.sqrt(a*a+h*h)<=(this.freehand_?1:this.snapTolerance_)){this.finishCoordinate_=s;break}}}}return n}createOrUpdateSketchPoint_(e){this.sketchPoint_?this.sketchPoint_.getGeometry().setCoordinates(e):(this.sketchPoint_=new i.default(new y.default(e)),this.updateSketchFeatures_())}createOrUpdateCustomSketchLine_(e){this.sketchLine_||(this.sketchLine_=new i.default);let t=e.getLinearRing(0),n=this.sketchLine_.getGeometry();n?(n.setFlatCoordinates(t.getLayout(),t.getFlatCoordinates()),n.changed()):(n=new _.default(t.getFlatCoordinates(),t.getLayout()),this.sketchLine_.setGeometry(n))}startDrawing_(e){let t=this.getMap().getView().getProjection(),n=(0,v.dn)(this.geometryLayout_);for(;e.length<n;)e.push(0);this.finishCoordinate_=e,"Point"===this.mode_?this.sketchCoords_=e.slice():"Polygon"===this.mode_?(this.sketchCoords_=[[e.slice(),e.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[e.slice(),e.slice()],this.sketchLineCoords_&&(this.sketchLine_=new i.default(new _.default(this.sketchLineCoords_)));let r=this.geometryFunction_(this.sketchCoords_,void 0,t);this.sketchFeature_=new i.default,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(r),this.updateSketchFeatures_(),this.dispatchEvent(new L(D,this.sketchFeature_))}modifyDrawing_(e){let t,n,i=this.getMap(),r=this.sketchFeature_.getGeometry(),s=i.getView().getProjection(),o=(0,v.dn)(this.geometryLayout_);for(;e.length<o;)e.push(0);"Point"===this.mode_?n=this.sketchCoords_:"Polygon"===this.mode_?(n=(t=this.sketchCoords_[0])[t.length-1],this.atFinish_(i.getPixelFromCoordinate(e))&&(e=this.finishCoordinate_.slice())):n=(t=this.sketchCoords_)[t.length-1],n[0]=e[0],n[1]=e[1],this.geometryFunction_(this.sketchCoords_,r,s),this.sketchPoint_&&this.sketchPoint_.getGeometry().setCoordinates(e),"Polygon"===r.getType()&&"Polygon"!==this.mode_?this.createOrUpdateCustomSketchLine_(r):this.sketchLineCoords_&&this.sketchLine_.getGeometry().setCoordinates(this.sketchLineCoords_),this.updateSketchFeatures_()}addToDrawing_(e){let t,n,i=this.sketchFeature_.getGeometry(),r=this.getMap().getView().getProjection(),s=this.mode_;return("LineString"===s||"Circle"===s?(this.finishCoordinate_=e.slice(),(n=this.sketchCoords_).length>=this.maxPoints_&&(this.freehand_?n.pop():t=!0),n.push(e.slice()),this.geometryFunction_(n,i,r)):"Polygon"===s&&((n=this.sketchCoords_[0]).length>=this.maxPoints_&&(this.freehand_?n.pop():t=!0),n.push(e.slice()),t&&(this.finishCoordinate_=n[0]),this.geometryFunction_(this.sketchCoords_,i,r)),this.createOrUpdateSketchPoint_(e.slice()),this.updateSketchFeatures_(),t)?this.finishDrawing():this.sketchFeature_}removeLastPoints_(e){if(!this.sketchFeature_)return;let t=this.sketchFeature_.getGeometry(),n=this.getMap().getView().getProjection(),i=this.mode_;for(let r=0;r<e;++r){let e;if("LineString"===i||"Circle"===i){if((e=this.sketchCoords_).splice(-2,1),e.length>=2){this.finishCoordinate_=e[e.length-2].slice();let t=this.finishCoordinate_.slice();e[e.length-1]=t,this.createOrUpdateSketchPoint_(t)}this.geometryFunction_(e,t,n),"Polygon"===t.getType()&&this.sketchLine_&&this.createOrUpdateCustomSketchLine_(t)}else if("Polygon"===i){(e=this.sketchCoords_[0]).splice(-2,1);let i=this.sketchLine_.getGeometry();if(e.length>=2){let t=e[e.length-2].slice();e[e.length-1]=t,this.createOrUpdateSketchPoint_(t)}i.setCoordinates(e),this.geometryFunction_(this.sketchCoords_,t,n)}if(1===e.length){this.abortDrawing();break}}this.updateSketchFeatures_()}removeLastPoint(){this.removeLastPoints_(1)}finishDrawing(){let e=this.abortDrawing_();if(!e)return null;let t=this.sketchCoords_,n=e.getGeometry(),i=this.getMap().getView().getProjection();return"LineString"===this.mode_?(t.pop(),this.geometryFunction_(t,n,i)):"Polygon"===this.mode_&&(t[0].pop(),this.geometryFunction_(t,n,i),t=n.getCoordinates()),"MultiPoint"===this.type_?e.setGeometry(new p.default([t])):"MultiLineString"===this.type_?e.setGeometry(new f.default([t])):"MultiPolygon"===this.type_&&e.setGeometry(new m.default([t])),this.dispatchEvent(new L("drawend",e)),this.features_&&this.features_.push(e),this.source_&&this.source_.addFeature(e),e}abortDrawing_(){this.finishCoordinate_=null;let e=this.sketchFeature_;return this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0),this.deactivateTrace_(),e}abortDrawing(){let e=this.abortDrawing_();e&&this.dispatchEvent(new L("drawabort",e))}appendCoordinates(e){let t,n=this.mode_,i=!this.sketchFeature_;if(i&&this.startDrawing_(e[0]),"LineString"===n||"Circle"===n)t=this.sketchCoords_;else{if("Polygon"!==n)return;t=this.sketchCoords_&&this.sketchCoords_.length?this.sketchCoords_[0]:[]}i&&t.shift(),t.pop();for(let t=0;t<e.length;t++)this.addToDrawing_(e[t]);let r=e[e.length-1];this.sketchFeature_=this.addToDrawing_(r),this.modifyDrawing_(r)}extend(e){let t=e.getGeometry();this.sketchFeature_=e,this.sketchCoords_=t.getCoordinates();let n=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=n.slice(),this.sketchCoords_.push(n.slice()),this.sketchPoint_=new i.default(new y.default(n)),this.updateSketchFeatures_(),this.dispatchEvent(new L(D,this.sketchFeature_))}updateSketchFeatures_(){let e=[];this.sketchFeature_&&e.push(this.sketchFeature_),this.sketchLine_&&e.push(this.sketchLine_),this.sketchPoint_&&e.push(this.sketchPoint_);let t=this.overlay_.getSource();t.clear(!0),t.addFeatures(e)}updateState_(){let e=this.getMap(),t=this.getActive();e&&t||this.abortDrawing(),this.overlay_.setMap(t?e:null)}}function U(e,t){return function(n,i,r){let s=(0,T.fromUserCoordinate)(n[0],r),a=(0,T.fromUserCoordinate)(n[n.length-1],r),h=Math.sqrt((0,o.squaredDistance)(s,a));i=i||(0,C.fromCircle)(new c.default(s),e);let l=t;if(!t&&0!==t){let e=a[0]-s[0];l=Math.atan2(a[1]-s[1],e)}(0,C.makeRegular)(i,s,h,l);let d=(0,T.getUserProjection)();return d&&i.transform(r,d),i}}function q(){return function(e,t,n){let i=(0,d.boundingExtent)([e[0],e[e.length-1]].map(function(e){return(0,T.fromUserCoordinate)(e,n)})),r=[[(0,d.getBottomLeft)(i),(0,d.getBottomRight)(i),(0,d.getTopRight)(i),(0,d.getTopLeft)(i),(0,d.getBottomLeft)(i)]];t?t.setCoordinates(r):t=new C.default(r);let s=(0,T.getUserProjection)();return s&&t.transform(n,s),t}}t.default=K},52101:function(e,t,n){n.d(t,{D2:function(){return h},e4:function(){return a}});var i=n(85215),r=n(7773),s=n(48340);class o extends i.default{constructor(e){super(),this.on,this.once,this.un,e&&e.handleEvent&&(this.handleEvent=e.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(s.A.ACTIVE)}getMap(){return this.map_}handleEvent(e){return!0}setActive(e){this.set(s.A.ACTIVE,e)}setMap(e){this.map_=e}}function a(e,t,n){let i=e.getCenterInternal();if(i){let s=[i[0]+t[0],i[1]+t[1]];e.animateInternal({duration:void 0!==n?n:250,easing:r.linear,center:e.getConstrainedCenter(s)})}}function h(e,t,n,i){let s=e.getZoom();if(void 0===s)return;let o=e.getConstrainedZoom(s+t),a=e.getResolutionForZoom(o);e.getAnimating()&&e.cancelAnimations(),e.animate({resolution:a,anchor:n,duration:void 0!==i?i:250,easing:r.easeOut})}t.Ay=o},29592:function(e,t,n){n.r(t),n.d(t,{centroid:function(){return o}});var i=n(5888),r=n(52101);class s extends r.Ay{constructor(e){super(e=e||{}),e.handleDownEvent&&(this.handleDownEvent=e.handleDownEvent),e.handleDragEvent&&(this.handleDragEvent=e.handleDragEvent),e.handleMoveEvent&&(this.handleMoveEvent=e.handleMoveEvent),e.handleUpEvent&&(this.handleUpEvent=e.handleUpEvent),e.stopDown&&(this.stopDown=e.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(e){return!1}handleDragEvent(e){}handleEvent(e){if(!e.originalEvent)return!0;let t=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==i.A.POINTERDRAG)this.handleDragEvent(e),e.originalEvent.preventDefault();else if(e.type==i.A.POINTERUP){let t=this.handleUpEvent(e);this.handlingDownUpSequence=t&&this.targetPointers.length>0}}else if(e.type==i.A.POINTERDOWN){let n=this.handleDownEvent(e);this.handlingDownUpSequence=n,t=this.stopDown(n)}else e.type==i.A.POINTERMOVE&&this.handleMoveEvent(e);return!t}handleMoveEvent(e){}handleUpEvent(e){return!1}stopDown(e){return e}updateTrackedPointers_(e){e.activePointers&&(this.targetPointers=e.activePointers)}}function o(e){let t=e.length,n=0,i=0;for(let r=0;r<t;r++)n+=e[r].clientX,i+=e[r].clientY;return{clientX:n/t,clientY:i/t}}t.default=s},48340:function(e,t){t.A={ACTIVE:"active"}}}]);
//# sourceMappingURL=6872.723b1679a44b201f.js.map