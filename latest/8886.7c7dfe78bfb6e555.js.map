{"version":3,"file":"8886.7c7dfe78bfb6e555.js","sources":["webpack://@terrestris/shogun-gis-client/./node_modules/@terrestris/react-geo/dist/Button/DeleteButton/DeleteButton.js","webpack://@terrestris/shogun-gis-client/./node_modules/@terrestris/react-geo/dist/Button/ToggleButton/ToggleButton.js","webpack://@terrestris/shogun-gis-client/./node_modules/@terrestris/react-geo/dist/constants.js","webpack://@terrestris/shogun-gis-client/./node_modules/@terrestris/react-util/dist/Hooks/useOlInteraction/useOlInteraction.js","webpack://@terrestris/shogun-gis-client/./node_modules/@terrestris/react-util/dist/Hooks/useOlListener/useOlListener.js","webpack://@terrestris/shogun-gis-client/./node_modules/@terrestris/react-util/dist/Hooks/usePropOrDefault/usePropOrDefault.js","webpack://@terrestris/shogun-gis-client/./node_modules/@terrestris/react-util/dist/Hooks/useSelectFeatures/useSelectFeatures.js"],"sourcesContent":["import useMap from '@terrestris/react-util/dist/Hooks/useMap/useMap';\nimport { usePropOrDefault } from '@terrestris/react-util/dist/Hooks/usePropOrDefault/usePropOrDefault';\nimport { useSelectFeatures } from '@terrestris/react-util/dist/Hooks/useSelectFeatures/useSelectFeatures';\nimport { DigitizeUtil } from '@terrestris/react-util/dist/Util/DigitizeUtil';\nimport * as React from 'react';\nimport { useCallback, useMemo } from 'react';\nimport { CSS_PREFIX } from '../../constants';\nimport ToggleButton from '../ToggleButton/ToggleButton';\n/**\n * The className added to this component.\n */\nconst defaultClassName = `${CSS_PREFIX}deletebutton`;\nexport const DeleteButton = ({ className, digitizeLayer, onFeatureRemove, selectStyle, selectInteractionConfig, hitTolerance, pressed, ...passThroughProps }) => {\n    const map = useMap();\n    const layer = usePropOrDefault(digitizeLayer, () => map ? DigitizeUtil.getDigitizeLayer(map) : undefined, [map]);\n    const layers = useMemo(() => layer ? [layer] : [], [layer]);\n    const onFeatureSelect = useCallback((event) => {\n        if (!layer) {\n            return;\n        }\n        onFeatureRemove?.(event);\n        const feat = event.selected[0];\n        layer.getSource()?.removeFeature(feat);\n    }, [layer, onFeatureRemove]);\n    useSelectFeatures({\n        selectStyle,\n        selectInteractionConfig,\n        layers,\n        active: !!pressed,\n        hitTolerance,\n        onFeatureSelect,\n        clearAfterSelect: true\n    });\n    const finalClassName = className\n        ? `${defaultClassName} ${className}`\n        : defaultClassName;\n    return (React.createElement(ToggleButton, { pressed: pressed, className: finalClassName, ...passThroughProps }));\n};\nexport default DeleteButton;\n//# sourceMappingURL=DeleteButton.js.map","import './ToggleButton.less';\nimport { Button, Tooltip } from 'antd';\nimport React from 'react';\nimport { CSS_PREFIX } from '../../constants';\nexport const ToggleButton = ({ type = 'primary', pressed = false, tooltipProps = {\n    mouseEnterDelay: 1.5\n}, className, tooltip, tooltipPlacement, pressedIcon, icon, children, value, onClick, onChange = () => { }, ...passThroughProps }) => {\n    const handleChange = (evt) => {\n        if (onClick) {\n            onClick(evt);\n            if (evt.defaultPrevented) {\n                return;\n            }\n        }\n        onChange(evt, value);\n    };\n    const internalClassName = `${CSS_PREFIX}togglebutton`;\n    const finalClassName = className\n        ? `${className} ${internalClassName}`\n        : internalClassName;\n    let pressedClass = '';\n    if (pressed) {\n        pressedClass = ' btn-pressed';\n    }\n    return (React.createElement(Tooltip, { title: tooltip, placement: tooltipPlacement, ...tooltipProps },\n        React.createElement(Button, { type: type, onClick: handleChange, onChange: onChange, className: `${finalClassName}${pressedClass}`, \"aria-pressed\": pressed, icon: pressed ?\n                pressedIcon :\n                icon, ...passThroughProps }, children)));\n};\nexport default ToggleButton;\n//# sourceMappingURL=ToggleButton.js.map","const CSS_PREFIX = 'react-geo-';\nexport { CSS_PREFIX };\n//# sourceMappingURL=constants.js.map","import { useEffect, useState } from 'react';\nimport { isNil } from 'lodash';\nimport useMap from '../useMap/useMap';\n/**\n * This hook adds an interaction to the map and removes/updates it if the dependency array changes.\n * It accepts an optional active parameter that toggles the active state of the interaction. If it is undefined the\n * active state will not get changed.\n * @param constructor returns an interaction to be added to the map, will be called again, if the interaction needs\n * to be updated\n * @param dependencies\n * @param active\n */\nexport const useOlInteraction = (constructor, dependencies, active) => {\n    const map = useMap();\n    const [interaction, setInteraction] = useState();\n    useEffect(() => {\n        if (!map) {\n            return undefined;\n        }\n        const newInteraction = constructor();\n        if (!newInteraction) {\n            return undefined;\n        }\n        setInteraction(newInteraction);\n        map.addInteraction(newInteraction);\n        return () => {\n            map.removeInteraction(newInteraction);\n            setInteraction(undefined);\n        };\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [...dependencies, map]);\n    useEffect(() => {\n        if (!interaction || isNil(active)) {\n            return;\n        }\n        interaction.setActive(active);\n    }, [interaction, active]);\n    return interaction;\n};\nexport default useOlInteraction;\n//# sourceMappingURL=useOlInteraction.js.map","import { useEffect } from 'react';\nimport { unByKey } from 'ol/Observable';\n/**\n * This hook unregisters listeners if the dependency array changes\n */\nexport const useOlListener = (observable, observe, dependencies, active) => {\n    useEffect(() => {\n        if (!observable || active === false) {\n            return undefined;\n        }\n        const observables = Array.isArray(observable) ? observable : [observable];\n        const keys = observables\n            .flatMap(o => {\n            const k = observe(o);\n            return Array.isArray(k) ? k : [k];\n        })\n            .filter(k => k !== undefined);\n        return () => {\n            for (const key of keys) {\n                unByKey(key);\n            }\n        };\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [observable, active, observe, ...dependencies]);\n};\nexport default useOlListener;\n//# sourceMappingURL=useOlListener.js.map","import { useEffect, useState } from 'react';\nexport const usePropOrDefault = (prop, defaultFunc, dependencies) => {\n    const [value, setValue] = useState();\n    useEffect(() => {\n        if (prop) {\n            setValue(prop);\n        }\n        else {\n            setValue(defaultFunc());\n        }\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [prop, ...dependencies]);\n    return value;\n};\nexport default usePropOrDefault;\n//# sourceMappingURL=usePropOrDefault.js.map","import { useEffect } from 'react';\nimport OlCollection from 'ol/Collection';\nimport * as OlEventConditions from 'ol/events/condition';\nimport OlInteractionSelect from 'ol/interaction/Select';\nimport { DigitizeUtil } from '../../Util/DigitizeUtil';\nimport { useOlInteraction } from '../useOlInteraction/useOlInteraction';\nimport { useOlListener } from '../useOlListener/useOlListener';\nimport { usePropOrDefault } from '../usePropOrDefault/usePropOrDefault';\nexport const useSelectFeatures = ({ active, selectStyle, selectInteractionConfig, onFeatureSelect, hitTolerance = 5, layers, clearAfterSelect = false, featuresCollection }) => {\n    const features = usePropOrDefault(featuresCollection, () => new OlCollection(), []);\n    const selectInteraction = useOlInteraction(() => {\n        if (!features) {\n            return undefined;\n        }\n        const newInteraction = new OlInteractionSelect({\n            condition: OlEventConditions.singleClick,\n            features,\n            hitTolerance: hitTolerance,\n            style: selectStyle ?? DigitizeUtil.DEFAULT_SELECT_STYLE,\n            layers: layers,\n            ...(selectInteractionConfig ?? {})\n        });\n        newInteraction.set('name', 'react-util-select-interaction');\n        return newInteraction;\n    }, [features, hitTolerance, selectStyle, layers, selectInteractionConfig], active);\n    useOlListener(selectInteraction, i => i.on('select', e => {\n        if (features && clearAfterSelect) {\n            features.clear();\n        }\n        onFeatureSelect?.(e);\n    }), [features, clearAfterSelect, onFeatureSelect]);\n    useEffect(() => {\n        if (!active && features) {\n            features.clear();\n        }\n    }, [active, features]);\n};\nexport default useSelectFeatures;\n//# sourceMappingURL=useSelectFeatures.js.map"],"names":["defaultClassName","DeleteButton","className","digitizeLayer","onFeatureRemove","selectStyle","selectInteractionConfig","hitTolerance","pressed","passThroughProps","map","layer","undefined","layers","onFeatureSelect","event","feat","finalClassName","type","tooltipProps","tooltip","tooltipPlacement","pressedIcon","icon","children","value","onClick","onChange","internalClassName","pressedClass","evt","CSS_PREFIX","useOlInteraction","constructor","dependencies","active","interaction","setInteraction","newInteraction","useOlListener","observable","observe","keys","observables","Array","o","k","key","usePropOrDefault","prop","defaultFunc","setValue","useSelectFeatures","clearAfterSelect","featuresCollection","features","selectInteraction","i","e"],"mappings":"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"}