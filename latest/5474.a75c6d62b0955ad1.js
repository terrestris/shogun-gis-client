"use strict";(self.webpackChunk_terrestris_shogun_gis_client=self.webpackChunk_terrestris_shogun_gis_client||[]).push([["5474"],{81075:function(t,e,i){var s=i(19487),n=i(42882),l=i(43461),r=i(85752),o=i(1072),h=i(30521),a=i(96299),u=i(28112);class d extends h.A{constructor(t,e,i,s){super(),this.tolerance=t,this.maxExtent=e,this.pixelRatio=s,this.maxLineWidth=0,this.resolution=i,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(t){let e=this.pixelRatio;return 1==e?t:t.map(function(t){return t*e})}appendFlatPointCoordinates(t,e){let i=this.getBufferedMaxExtent(),s=this.tmpCoordinate_,n=this.coordinates,l=n.length;for(let o=0,h=t.length;o<h;o+=e)s[0]=t[o],s[1]=t[o+1],(0,r.containsCoordinate)(i,s)&&(n[l++]=s[0],n[l++]=s[1]);return l}appendFlatLineCoordinates(t,e,i,s,n,o){let h,a,u,d=this.coordinates,c=d.length,f=this.getBufferedMaxExtent();o&&(e+=s);let g=t[e],_=t[e+1],x=this.tmpCoordinate_,p=!0;for(h=e+s;h<i;h+=s)x[0]=t[h],x[1]=t[h+1],(u=(0,r.coordinateRelationship)(f,x))!==a?(p&&(d[c++]=g,d[c++]=_,p=!1),d[c++]=x[0],d[c++]=x[1]):u===l.A.INTERSECTING?(d[c++]=x[0],d[c++]=x[1],p=!1):p=!0,g=x[0],_=x[1],a=u;return(n&&p||h===e+s)&&(d[c++]=g,d[c++]=_),c}drawCustomCoordinates_(t,e,i,s,n){for(let l=0,r=i.length;l<r;++l){let r=i[l],o=this.appendFlatLineCoordinates(t,e,r,s,!1,!1);n.push(o),e=r}return e}drawCustom(t,e,i,s,n){let l,r,h,a,d;this.beginGeometry(t,e,n);let c=t.getType(),f=t.getStride(),g=this.coordinates.length;switch(c){case"MultiPolygon":l=t.getOrientedFlatCoordinates(),a=[];let _=t.getEndss();d=0;for(let t=0,e=_.length;t<e;++t){let e=[];d=this.drawCustomCoordinates_(l,d,_[t],f,e),a.push(e)}this.instructions.push([u.Ay.CUSTOM,g,a,t,i,o.Dz,n]),this.hitDetectionInstructions.push([u.Ay.CUSTOM,g,a,t,s||i,o.Dz,n]);break;case"Polygon":case"MultiLineString":h=[],l="Polygon"==c?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),d=this.drawCustomCoordinates_(l,0,t.getEnds(),f,h),this.instructions.push([u.Ay.CUSTOM,g,h,t,i,o.cD,n]),this.hitDetectionInstructions.push([u.Ay.CUSTOM,g,h,t,s||i,o.cD,n]);break;case"LineString":case"Circle":l=t.getFlatCoordinates(),r=this.appendFlatLineCoordinates(l,0,l.length,f,!1,!1),this.instructions.push([u.Ay.CUSTOM,g,r,t,i,o.n2,n]),this.hitDetectionInstructions.push([u.Ay.CUSTOM,g,r,t,s||i,o.n2,n]);break;case"MultiPoint":l=t.getFlatCoordinates(),(r=this.appendFlatPointCoordinates(l,f))>g&&(this.instructions.push([u.Ay.CUSTOM,g,r,t,i,o.n2,n]),this.hitDetectionInstructions.push([u.Ay.CUSTOM,g,r,t,s||i,o.n2,n]));break;case"Point":l=t.getFlatCoordinates(),this.coordinates.push(l[0],l[1]),r=this.coordinates.length,this.instructions.push([u.Ay.CUSTOM,g,r,t,i,void 0,n]),this.hitDetectionInstructions.push([u.Ay.CUSTOM,g,r,t,s||i,void 0,n])}this.endGeometry(e)}beginGeometry(t,e,i){this.beginGeometryInstruction1_=[u.Ay.BEGIN_GEOMETRY,e,0,t,i],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[u.Ay.BEGIN_GEOMETRY,e,0,t,i],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){let t,e,i,n=this.hitDetectionInstructions;n.reverse();let l=n.length,r=-1;for(t=0;t<l;++t)(i=(e=n[t])[0])==u.Ay.END_GEOMETRY?r=t:i==u.Ay.BEGIN_GEOMETRY&&(e[2]=t,(0,s.gI)(this.hitDetectionInstructions,r,t),r=-1)}fillStyleToState(t,e={}){if(t){let i=t.getColor();e.fillPatternScale=i&&"object"==typeof i&&"src"in i?this.pixelRatio:1,e.fillStyle=(0,n.F)(i||a.defaultFillStyle)}else e.fillStyle=void 0;return e}strokeStyleToState(t,e={}){if(t){let i=t.getColor();e.strokeStyle=(0,n.F)(i||a.defaultStrokeStyle);let s=t.getLineCap();e.lineCap=void 0!==s?s:a.defaultLineCap;let l=t.getLineDash();e.lineDash=l?l.slice():a.defaultLineDash,e.lineDashOffset=t.getLineDashOffset()||a.defaultLineDashOffset;let r=t.getLineJoin();e.lineJoin=void 0!==r?r:a.defaultLineJoin;let o=t.getWidth();e.lineWidth=void 0!==o?o:a.defaultLineWidth;let h=t.getMiterLimit();e.miterLimit=void 0!==h?h:a.defaultMiterLimit,e.lineWidth>this.maxLineWidth&&(this.maxLineWidth=e.lineWidth,this.bufferedMaxExtent_=null)}else e.strokeStyle=void 0,e.lineCap=void 0,e.lineDash=null,e.lineDashOffset=void 0,e.lineJoin=void 0,e.lineWidth=void 0,e.miterLimit=void 0;return e}setFillStrokeStyle(t,e){let i=this.state;this.fillStyleToState(t,i),this.strokeStyleToState(e,i)}createFill(t){let e=t.fillStyle,i=[u.Ay.SET_FILL_STYLE,e];return"string"!=typeof e&&i.push(t.fillPatternScale),i}applyStroke(t){this.instructions.push(this.createStroke(t))}createStroke(t){return[u.Ay.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,t.lineDash?this.applyPixelRatio(t.lineDash):null,t.lineDashOffset*this.pixelRatio]}updateFillStyle(t,e){let i=t.fillStyle;("string"!=typeof i||t.currentFillStyle!=i)&&(this.instructions.push(e.call(this,t)),t.currentFillStyle=i)}updateStrokeStyle(t,e){let i=t.strokeStyle,n=t.lineCap,l=t.lineDash,r=t.lineDashOffset,o=t.lineJoin,h=t.lineWidth,a=t.miterLimit;t.currentStrokeStyle==i&&t.currentLineCap==n&&(l==t.currentLineDash||(0,s.aI)(t.currentLineDash,l))&&t.currentLineDashOffset==r&&t.currentLineJoin==o&&t.currentLineWidth==h&&t.currentMiterLimit==a||(e.call(this,t),t.currentStrokeStyle=i,t.currentLineCap=n,t.currentLineDash=l,t.currentLineDashOffset=r,t.currentLineJoin=o,t.currentLineWidth=h,t.currentMiterLimit=a)}endGeometry(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;let e=[u.Ay.END_GEOMETRY,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=(0,r.clone)(this.maxExtent),this.maxLineWidth>0)){let t=this.resolution*(this.maxLineWidth+1)/2;(0,r.buffer)(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}e.A=d},9966:function(t,e,i){i.d(e,{A:function(){return f}});var s=i(81075),n=i(85752),l=i(28112);class r extends s.A{constructor(t,e,i,s){super(t,e,i,s),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(t,e,i){if(!this.image_||this.maxExtent&&!(0,n.containsCoordinate)(this.maxExtent,t.getFlatCoordinates()))return;this.beginGeometry(t,e,i);let s=t.getFlatCoordinates(),r=t.getStride(),o=this.coordinates.length,h=this.appendFlatPointCoordinates(s,r);this.instructions.push([l.Ay.DRAW_IMAGE,o,h,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([l.Ay.DRAW_IMAGE,o,h,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}drawMultiPoint(t,e,i){if(!this.image_)return;this.beginGeometry(t,e,i);let s=t.getFlatCoordinates(),r=[];for(let e=0,i=s.length;e<i;e+=t.getStride())(!this.maxExtent||(0,n.containsCoordinate)(this.maxExtent,s.slice(e,e+2)))&&r.push(s[e],s[e+1]);let o=this.coordinates.length,h=this.appendFlatPointCoordinates(r,2);this.instructions.push([l.Ay.DRAW_IMAGE,o,h,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([l.Ay.DRAW_IMAGE,o,h,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(t,e){let i=t.getAnchor(),s=t.getSize(),n=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=t.getHitDetectionImage(),this.image_=t.getImage(this.pixelRatio),this.height_=s[1],this.opacity_=t.getOpacity(),this.originX_=n[0],this.originY_=n[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=s[0],this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}}var o=i(96299);class h extends s.A{constructor(t,e,i,s){super(t,e,i,s)}drawFlatCoordinates_(t,e,i,s){let n=this.coordinates.length,r=this.appendFlatLineCoordinates(t,e,i,s,!1,!1),o=[l.Ay.MOVE_TO_LINE_TO,n,r];return this.instructions.push(o),this.hitDetectionInstructions.push(o),i}drawLineString(t,e,i){let s=this.state,n=s.strokeStyle,r=s.lineWidth;if(void 0===n||void 0===r)return;this.updateStrokeStyle(s,this.applyStroke),this.beginGeometry(t,e,i),this.hitDetectionInstructions.push([l.Ay.SET_STROKE_STYLE,s.strokeStyle,s.lineWidth,s.lineCap,s.lineJoin,s.miterLimit,o.defaultLineDash,o.defaultLineDashOffset],l.th);let h=t.getFlatCoordinates(),a=t.getStride();this.drawFlatCoordinates_(h,0,h.length,a),this.hitDetectionInstructions.push(l.VD),this.endGeometry(e)}drawMultiLineString(t,e,i){let s=this.state,n=s.strokeStyle,r=s.lineWidth;if(void 0===n||void 0===r)return;this.updateStrokeStyle(s,this.applyStroke),this.beginGeometry(t,e,i),this.hitDetectionInstructions.push([l.Ay.SET_STROKE_STYLE,s.strokeStyle,s.lineWidth,s.lineCap,s.lineJoin,s.miterLimit,o.defaultLineDash,o.defaultLineDashOffset],l.th);let h=t.getEnds(),a=t.getFlatCoordinates(),u=t.getStride(),d=0;for(let t=0,e=h.length;t<e;++t)d=this.drawFlatCoordinates_(a,d,h[t],u);this.hitDetectionInstructions.push(l.VD),this.endGeometry(e)}finish(){let t=this.state;return void 0!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&this.instructions.push(l.VD),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(t){void 0!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(l.VD),t.lastStroke=this.coordinates.length),t.lastStroke=0,super.applyStroke(t),this.instructions.push(l.th)}}var a=i(73468);class u extends s.A{constructor(t,e,i,s){super(t,e,i,s)}drawFlatCoordinatess_(t,e,i,s){let n=this.state,r=void 0!==n.fillStyle,o=void 0!==n.strokeStyle,h=i.length;this.instructions.push(l.th),this.hitDetectionInstructions.push(l.th);for(let n=0;n<h;++n){let r=i[n],h=this.coordinates.length,a=this.appendFlatLineCoordinates(t,e,r,s,!0,!o),u=[l.Ay.MOVE_TO_LINE_TO,h,a];this.instructions.push(u),this.hitDetectionInstructions.push(u),o&&(this.instructions.push(l.kx),this.hitDetectionInstructions.push(l.kx)),e=r}return r&&(this.instructions.push(l.I5),this.hitDetectionInstructions.push(l.I5)),o&&(this.instructions.push(l.VD),this.hitDetectionInstructions.push(l.VD)),e}drawCircle(t,e,i){let s=this.state,n=s.fillStyle,r=s.strokeStyle;if(void 0===n&&void 0===r)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,i),void 0!==s.fillStyle&&this.hitDetectionInstructions.push([l.Ay.SET_FILL_STYLE,o.defaultFillStyle]),void 0!==s.strokeStyle&&this.hitDetectionInstructions.push([l.Ay.SET_STROKE_STYLE,s.strokeStyle,s.lineWidth,s.lineCap,s.lineJoin,s.miterLimit,o.defaultLineDash,o.defaultLineDashOffset]);let h=t.getFlatCoordinates(),a=t.getStride(),u=this.coordinates.length;this.appendFlatLineCoordinates(h,0,h.length,a,!1,!1);let d=[l.Ay.CIRCLE,u];this.instructions.push(l.th,d),this.hitDetectionInstructions.push(l.th,d),void 0!==s.fillStyle&&(this.instructions.push(l.I5),this.hitDetectionInstructions.push(l.I5)),void 0!==s.strokeStyle&&(this.instructions.push(l.VD),this.hitDetectionInstructions.push(l.VD)),this.endGeometry(e)}drawPolygon(t,e,i){let s=this.state,n=s.fillStyle,r=s.strokeStyle;if(void 0===n&&void 0===r)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,i),void 0!==s.fillStyle&&this.hitDetectionInstructions.push([l.Ay.SET_FILL_STYLE,o.defaultFillStyle]),void 0!==s.strokeStyle&&this.hitDetectionInstructions.push([l.Ay.SET_STROKE_STYLE,s.strokeStyle,s.lineWidth,s.lineCap,s.lineJoin,s.miterLimit,o.defaultLineDash,o.defaultLineDashOffset]);let h=t.getEnds(),a=t.getOrientedFlatCoordinates(),u=t.getStride();this.drawFlatCoordinatess_(a,0,h,u),this.endGeometry(e)}drawMultiPolygon(t,e,i){let s=this.state,n=s.fillStyle,r=s.strokeStyle;if(void 0===n&&void 0===r)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,i),void 0!==s.fillStyle&&this.hitDetectionInstructions.push([l.Ay.SET_FILL_STYLE,o.defaultFillStyle]),void 0!==s.strokeStyle&&this.hitDetectionInstructions.push([l.Ay.SET_STROKE_STYLE,s.strokeStyle,s.lineWidth,s.lineCap,s.lineJoin,s.miterLimit,o.defaultLineDash,o.defaultLineDashOffset]);let h=t.getEndss(),a=t.getOrientedFlatCoordinates(),u=t.getStride(),d=0;for(let t=0,e=h.length;t<e;++t)d=this.drawFlatCoordinatess_(a,d,h[t],u);this.endGeometry(e)}finish(){this.reverseHitDetectionInstructions(),this.state=null;let t=this.tolerance;if(0!==t){let e=this.coordinates;for(let i=0,s=e.length;i<s;++i)e[i]=(0,a.n$)(e[i],t)}return super.finish()}setFillStrokeStyles_(){let t=this.state;this.updateFillStyle(t,this.createFill),this.updateStrokeStyle(t,this.applyStroke)}}var d=i(85682);let c={Circle:u,Default:s.A,Image:r,LineString:h,Polygon:u,Text:d.A};var f=class{constructor(t,e,i,s){this.tolerance_=t,this.maxExtent_=e,this.pixelRatio_=s,this.resolution_=i,this.buildersByZIndex_={}}finish(){let t={};for(let e in this.buildersByZIndex_){t[e]=t[e]||{};let i=this.buildersByZIndex_[e];for(let s in i){let n=i[s].finish();t[e][s]=n}}return t}getBuilder(t,e){let i=void 0!==t?t.toString():"0",s=this.buildersByZIndex_[i];void 0===s&&(s={},this.buildersByZIndex_[i]=s);let n=s[e];return void 0===n&&(n=new c[e](this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),s[e]=n),n}}},20337:function(t,e,i){i.d(e,{Ay:function(){return M},$i:function(){return T},y2:function(){return L},x$:function(){return E}});var s=i(19487),n=i(84674),l=i(85752),r=i(31103),o=i(53495),h=i(21878),a=i(77903),u=i(94966),d=i(61553),c=i(96299),f=i(28112),g=i(85682);let _=(0,l.createEmpty)(),x=[],p=[],y=[],S=[];function m(t){return t[3].declutterBox}let C=RegExp("["+String.fromCharCode(1425)+"-"+String.fromCharCode(2303)+String.fromCharCode(64285)+"-"+String.fromCharCode(65023)+String.fromCharCode(65136)+"-"+String.fromCharCode(65276)+String.fromCharCode(67584)+"-"+String.fromCharCode(69631)+String.fromCharCode(124928)+"-"+String.fromCharCode(126975)+"]");function I(t,e){return"start"===e?e=C.test(t)?"right":"left":"end"===e&&(e=C.test(t)?"left":"right"),g.E[e]}function v(t,e,i){return i>0&&t.push("\n",""),t.push(e,""),t}function k(t,e,i){return i%2==0&&(t+=e),t}var D=class{constructor(t,e,i,s,n){this.overlaps=i,this.pixelRatio=e,this.resolution=t,this.alignAndScaleFill_,this.instructions=s.instructions,this.coordinates=s.coordinates,this.coordinateCache_={},this.renderedTransform_=(0,h.vt)(),this.hitDetectionInstructions=s.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=s.fillStates||{},this.strokeStates=s.strokeStates||{},this.textStates=s.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=n?new d.A:null}getZIndexContext(){return this.zIndexContext_}createLabel(t,e,i,s){let n,l=t+e+i+s;if(this.labels_[l])return this.labels_[l];let r=s?this.strokeStates[s]:null,o=i?this.fillStates[i]:null,h=this.textStates[e],a=this.pixelRatio,u=[h.scale[0]*a,h.scale[1]*a],d=h.justify?g.E[h.justify]:I(Array.isArray(t)?t[0]:t,h.textAlign||c.defaultTextAlign),f=s&&r.lineWidth?r.lineWidth:0,_=Array.isArray(t)?t:String(t).split("\n").reduce(v,[]),{width:x,height:p,widths:y,heights:S,lineWidths:m}=(0,c.getTextDimensions)(h,_),C=x+f,k=[],D=(C+2)*u[0],L=(p+f)*u[1],T={width:D<0?Math.floor(D):Math.ceil(D),height:L<0?Math.floor(L):Math.ceil(L),contextInstructions:k};(1!=u[0]||1!=u[1])&&k.push("scale",u),s&&(k.push("strokeStyle",r.strokeStyle),k.push("lineWidth",f),k.push("lineCap",r.lineCap),k.push("lineJoin",r.lineJoin),k.push("miterLimit",r.miterLimit),k.push("setLineDash",[r.lineDash]),k.push("lineDashOffset",r.lineDashOffset)),i&&k.push("fillStyle",o.fillStyle),k.push("textBaseline","middle"),k.push("textAlign","center");let E=.5-d,A=d*C+E*f,M=[],b=[],R=0,O=0,w=0,F=0;for(let t=0,e=_.length;t<e;t+=2){let e=_[t];if("\n"===e){O+=R,R=0,A=d*C+E*f,++F;continue}let l=_[t+1]||h.font;l!==n&&(s&&M.push("font",l),i&&b.push("font",l),n=l),R=Math.max(R,S[w]);let r=[e,A+E*y[w]+d*(y[w]-m[F]),.5*(f+R)+O];A+=y[w],s&&M.push("strokeText",r),i&&b.push("fillText",r),++w}return Array.prototype.push.apply(k,M),Array.prototype.push.apply(k,b),this.labels_[l]=T,T}replayTextBackground_(t,e,i,s,n,l,r){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,i),t.lineTo.apply(t,s),t.lineTo.apply(t,n),t.lineTo.apply(t,e),l&&(this.alignAndScaleFill_=l[2],t.fillStyle=l[1],this.fill_(t)),r&&(this.setStrokeStyle_(t,r),t.stroke())}calculateImageOrLabelDimensions_(t,e,i,s,n,r,o,a,u,d,c,f,g,m,C,I){let v;o*=f[0],a*=f[1];let k=i-o,D=s-a,L=n+u>t?t-u:n,T=r+d>e?e-d:r,E=m[3]+L*f[0]+m[1],A=m[0]+T*f[1]+m[2],M=k-m[3],b=D-m[0];return(C||0!==c)&&(x[0]=M,S[0]=M,x[1]=b,p[1]=b,p[0]=M+E,y[0]=p[0],y[1]=b+A,S[1]=y[1]),0!==c?(v=(0,h.Zz)((0,h.vt)(),i,s,1,1,c,-i,-s),(0,h.Bb)(v,x),(0,h.Bb)(v,p),(0,h.Bb)(v,y),(0,h.Bb)(v,S),(0,l.createOrUpdate)(Math.min(x[0],p[0],y[0],S[0]),Math.min(x[1],p[1],y[1],S[1]),Math.max(x[0],p[0],y[0],S[0]),Math.max(x[1],p[1],y[1],S[1]),_)):(0,l.createOrUpdate)(Math.min(M,M+E),Math.min(b,b+A),Math.max(M,M+E),Math.max(b,b+A),_),g&&(k=Math.round(k),D=Math.round(D)),{drawImageX:k,drawImageY:D,drawImageW:L,drawImageH:T,originX:u,originY:d,declutterBox:{minX:_[0],minY:_[1],maxX:_[2],maxY:_[3],value:I},canvasTransform:v,scale:f}}replayImageOrLabel_(t,e,i,s,n,l,r){let o=!!(l||r),h=s.declutterBox,a=r?r[2]*s.scale[0]/2:0;return h.minX-a<=e[0]&&h.maxX+a>=0&&h.minY-a<=e[1]&&h.maxY+a>=0&&(o&&this.replayTextBackground_(t,x,p,y,S,l,r),(0,c.drawImageOrLabel)(t,s.canvasTransform,n,i,s.originX,s.originY,s.drawImageW,s.drawImageH,s.drawImageX,s.drawImageY,s.scale)),!0}fill_(t){let e=this.alignAndScaleFill_;if(e){let i=(0,h.Bb)(this.renderedTransform_,[0,0]),s=512*this.pixelRatio;t.save(),t.translate(i[0]%s,i[1]%s),1!==e&&t.scale(e,e),t.rotate(this.viewRotation_)}t.fill(),e&&t.restore()}setStrokeStyle_(t,e){t.strokeStyle=e[1],e[1]&&(t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],t.lineDashOffset=e[7],t.setLineDash(e[6]))}drawLabelWithPointPlacement_(t,e,i,s){let n=this.textStates[e],l=this.createLabel(t,e,s,i),r=this.strokeStates[i],o=this.pixelRatio,h=I(Array.isArray(t)?t[0]:t,n.textAlign||c.defaultTextAlign),a=g.E[n.textBaseline||c.defaultTextBaseline],u=r&&r.lineWidth?r.lineWidth:0,d=l.width/o-2*n.scale[0],f=a*l.height/o+2*(.5-a)*u;return{label:l,anchorX:h*d+2*(.5-h)*u,anchorY:f}}execute_(t,e,i,n,o,d,g,_){let x,p,y,S,C,v,D,L,T,E,A,M,b,R,O,w,F,P,W=this.zIndexContext_;this.pixelCoordinates_&&(0,s.aI)(i,this.renderedTransform_)?x=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),x=(0,r.Rc)(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),(0,h.k3)(this.renderedTransform_,i));let G=0,B=n.length,Y=0,N=0,K=0,V=this.coordinateCache_,X=this.viewRotation_,Z=Math.round(1e12*Math.atan2(-i[1],i[0]))/1e12,U={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:X},J=this.instructions!=n||this.overlaps?0:200;for(;G<B;){let i=n[G];switch(i[0]){case f.Ay.BEGIN_GEOMETRY:O=i[1],P=i[3],O.getGeometry()?void 0===g||(0,l.intersects)(g,P.getExtent())?++G:G=i[2]+1:G=i[2],W&&(W.zIndex=i[4]);break;case f.Ay.BEGIN_PATH:N>J&&(this.fill_(t),N=0),K>J&&(t.stroke(),K=0),N||K||(t.beginPath(),v=NaN,D=NaN),++G;break;case f.Ay.CIRCLE:let s=x[Y=i[1]],h=x[Y+1],B=x[Y+2],H=x[Y+3],j=B-s,z=H-h,q=Math.sqrt(j*j+z*z);t.moveTo(s+q,h),t.arc(s,h,q,0,2*Math.PI,!0),++G;break;case f.Ay.CLOSE_PATH:t.closePath(),++G;break;case f.Ay.CUSTOM:Y=i[1],p=i[2];let $=i[3],Q=i[4],tt=i[5];U.geometry=$,U.feature=O,G in V||(V[G]=[]);let te=V[G];tt?tt(x,Y,p,2,te):(te[0]=x[Y],te[1]=x[Y+1],te.length=2),W&&(W.zIndex=i[6]),Q(te,U),++G;break;case f.Ay.DRAW_IMAGE:let ti,ts,tn,tl;Y=i[1],p=i[2],E=i[3],y=i[4],S=i[5];let tr=i[6],to=i[7],th=i[8],ta=i[9],tu=i[10],td=i[11],tc=i[12],tf=i[13];C=i[14]||"declutter";let tg=i[15];if(!E&&i.length>=20){A=i[19],M=i[20],b=i[21],R=i[22];let t=this.drawLabelWithPointPlacement_(A,M,b,R);E=t.label,i[3]=E;let e=i[23];y=(t.anchorX-e)*this.pixelRatio,i[4]=y;let s=i[24];S=(t.anchorY-s)*this.pixelRatio,i[5]=S,tr=E.height,i[6]=tr,tf=E.width,i[13]=tf}i.length>25&&(ti=i[25]),i.length>17?(ts=i[16],tn=i[17],tl=i[18]):(ts=c.defaultPadding,tn=null,tl=null),tu&&Z?td+=X:tu||Z||(td-=X);let t_=0;for(;Y<p;Y+=2){if(ti&&ti[t_++]<tf/this.pixelRatio)continue;let i=this.calculateImageOrLabelDimensions_(E.width,E.height,x[Y],x[Y+1],tf,tr,y,S,th,ta,td,tc,o,ts,!!tn||!!tl,O),s=[t,e,E,i,to,tn,tl];if(_){let t,e,n,l,r;if(tg){let i=p-Y;if(!tg[i]){tg[i]={args:s,declutterMode:C};continue}let l=tg[i];t=l.args,e=l.declutterMode,delete tg[i],n=m(t)}if(t&&("declutter"!==e||!_.collides(n))&&(l=!0),"declutter"===C&&_.collides(i.declutterBox)||(r=!0),"declutter"===e&&"declutter"===C){let t=l&&r;l=t,r=t}l&&("none"!==e&&_.insert(n),this.replayImageOrLabel_.apply(this,t)),r&&("none"!==C&&_.insert(i.declutterBox),this.replayImageOrLabel_.apply(this,s))}else this.replayImageOrLabel_.apply(this,s)}++G;break;case f.Ay.DRAW_CHARS:let tx,tp=i[1],ty=i[2],tS=i[3],tm=i[4];R=i[5];let tC=i[6],tI=i[7],tv=i[8];b=i[9];let tk=i[10];Array.isArray(A=i[11])&&(A=A.reduce(k,"")),M=i[12];let tD=[i[13],i[13]];C=i[14]||"declutter";let tL=i[15],tT=this.textStates[M],tE=tT.font,tA=[tT.scale[0]*tI,tT.scale[1]*tI];tE in this.widths_?tx=this.widths_[tE]:(tx={},this.widths_[tE]=tx);let tM=(0,a.k)(x,tp,ty,2),tb=Math.abs(tA[0])*(0,c.measureAndCacheTextWidth)(tE,A,tx);if(tm||tb<=tM){let i=(tM-tb)*I(A,this.textStates[M].textAlign),s=function(t,e,i,s,n,l,o,h,a,d,c,f,g=!0){let _,x=t[e],p=t[e+1],y=0,S=0,m=0,C=0;function I(){y=x,S=p,e+=2,x=t[e],p=t[e+1],C+=m,m=Math.sqrt((x-y)*(x-y)+(p-S)*(p-S))}do I();while(e<i-2&&C+m<l);let v=0===m?0:(l-C)/m,k=(0,u.Cc)(y,x,v),D=(0,u.Cc)(S,p,v),L=e-2,T=C,E=l+h*a(d,n,c);for(;e<i-2&&C+m<E;)I();v=0===m?0:(E-C)/m;let A=(0,u.Cc)(y,x,v),M=(0,u.Cc)(S,p,v),b=!1;if(g)if(f){let t=[k,D,A,M];(0,r.e$)(t,0,4,2,f,t,t),b=t[0]>t[2]}else b=k>A;let R=Math.PI,O=[],w=L+2===e;if(e=L,m=0,C=T,x=t[e],p=t[e+1],w){I(),_=Math.atan2(p-S,x-y),b&&(_+=_>0?-R:R);let t=(A+k)/2,e=(M+D)/2;return O[0]=[t,e,(E-l)/2,_,n],O}n=n.replace(/\n/g," ");for(let t=0,s=n.length;t<s;){I();let r=Math.atan2(p-S,x-y);if(b&&(r+=r>0?-R:R),void 0!==_){let t=r-_;if(Math.abs(t+=t>R?-2*R:t<-R?2*R:0)>o)return null}_=r;let f=t,g=0;for(;t<s;++t){let r=h*a(d,n[b?s-t-1:t],c);if(e+2<i&&C+m<l+g+r/2)break;g+=r}if(t===f)continue;let k=b?n.substring(s-f,s-t):n.substring(f,t);v=0===m?0:(l+g/2-C)/m;let D=(0,u.Cc)(y,x,v),L=(0,u.Cc)(S,p,v);O.push([D,L,g/2,r,k]),l+=g}return O}(x,tp,ty,0,A,i,tC,Math.abs(tA[0]),c.measureAndCacheTextWidth,tE,tx,Z?0:this.viewRotation_,tL);t:if(s){let i,n,l,r,o,h=[];if(b)for(i=0,n=s.length;i<n;++i){l=(o=s[i])[4],r=this.createLabel(l,M,"",b),y=o[2]+(tA[0]<0?-tk:tk),S=tS*r.height+(.5-tS)*2*tk*tA[1]/tA[0]-tv;let n=this.calculateImageOrLabelDimensions_(r.width,r.height,o[0],o[1],r.width,r.height,y,S,0,0,o[3],tD,!1,c.defaultPadding,!1,O);if(_&&"declutter"===C&&_.collides(n.declutterBox))break t;h.push([t,e,r,n,1,null,null])}if(R)for(i=0,n=s.length;i<n;++i){l=(o=s[i])[4],r=this.createLabel(l,M,R,""),y=o[2],S=tS*r.height-tv;let n=this.calculateImageOrLabelDimensions_(r.width,r.height,o[0],o[1],r.width,r.height,y,S,0,0,o[3],tD,!1,c.defaultPadding,!1,O);if(_&&"declutter"===C&&_.collides(n.declutterBox))break t;h.push([t,e,r,n,1,null,null])}_&&"none"!==C&&_.load(h.map(m));for(let t=0,e=h.length;t<e;++t)this.replayImageOrLabel_.apply(this,h[t])}}++G;break;case f.Ay.END_GEOMETRY:if(void 0!==d){let t=d(O=i[1],P,C);if(t)return t}++G;break;case f.Ay.FILL:J?N++:this.fill_(t),++G;break;case f.Ay.MOVE_TO_LINE_TO:for(Y=i[1],p=i[2],w=x[Y],F=x[Y+1],t.moveTo(w,F),v=w+.5|0,D=F+.5|0,Y+=2;Y<p;Y+=2)w=x[Y],F=x[Y+1],L=w+.5|0,T=F+.5|0,(Y==p-2||L!==v||T!==D)&&(t.lineTo(w,F),v=L,D=T);++G;break;case f.Ay.SET_FILL_STYLE:this.alignAndScaleFill_=i[2],N&&(this.fill_(t),N=0,K&&(t.stroke(),K=0)),t.fillStyle=i[1],++G;break;case f.Ay.SET_STROKE_STYLE:K&&(t.stroke(),K=0),this.setStrokeStyle_(t,i),++G;break;case f.Ay.STROKE:J?K++:t.stroke(),++G;break;default:++G}}N&&this.fill_(t),K&&t.stroke()}execute(t,e,i,s,n,l){this.viewRotation_=s,this.execute_(t,e,i,this.instructions,n,void 0,void 0,l)}executeHitDetection(t,e,i,s,n){return this.viewRotation_=i,this.execute_(t,[t.canvas.width,t.canvas.height],e,this.hitDetectionInstructions,!0,s,n)}};let L=["Polygon","Circle","LineString","Image","Text","Default"],T=["Image","Text"],E=L.filter(t=>!T.includes(t)),A={};var M=class{constructor(t,e,i,s,n,l,r){this.maxExtent_=t,this.overlaps_=s,this.pixelRatio_=i,this.resolution_=e,this.renderBuffer_=l,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=(0,h.vt)(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(n,r)}clip(t,e){let i=this.getClipCoords(e);t.beginPath(),t.moveTo(i[0],i[1]),t.lineTo(i[2],i[3]),t.lineTo(i[4],i[5]),t.lineTo(i[6],i[7]),t.clip()}createExecutors_(t,e){for(let i in t){let s=this.executorsByZIndex_[i];void 0===s&&(s={},this.executorsByZIndex_[i]=s);let n=t[i];for(let t in n){let i=n[t];s[t]=new D(this.resolution_,this.pixelRatio_,this.overlaps_,i,e)}}}hasExecutors(t){for(let e in this.executorsByZIndex_){let i=this.executorsByZIndex_[e];for(let e=0,s=t.length;e<s;++e)if(t[e]in i)return!0}return!1}forEachFeatureAtCoordinate(t,e,i,r,o,a){let u,d,c,f,g,_,x,p=2*(r=Math.round(r))+1,y=(0,h.Zz)(this.hitDetectionTransform_,r+.5,r+.5,1/e,-1/e,-i,-t[0],-t[1]),S=!this.hitDetectionContext_;S&&(this.hitDetectionContext_=(0,n.Y)(p,p));let m=this.hitDetectionContext_;m.canvas.width!==p||m.canvas.height!==p?(m.canvas.width=p,m.canvas.height=p):S||m.clearRect(0,0,p,p),void 0!==this.renderBuffer_&&(u=(0,l.createEmpty)(),(0,l.extendCoordinate)(u,t),(0,l.buffer)(u,e*(this.renderBuffer_+r),u));let C=function(t){if(void 0!==A[t])return A[t];let e=2*t+1,i=t*t,s=Array(i+1);for(let n=0;n<=t;++n)for(let l=0;l<=t;++l){let r=n*n+l*l;if(r>i)break;let o=s[r];o||(o=[],s[r]=o),o.push(((t+n)*e+(t+l))*4+3),n>0&&o.push(((t-n)*e+(t+l))*4+3),l>0&&(o.push(((t+n)*e+(t-l))*4+3),n>0&&o.push(((t-n)*e+(t-l))*4+3))}let n=[];for(let t=0,e=s.length;t<e;++t)s[t]&&n.push(...s[t]);return A[t]=n,n}(r);function I(t,e,i){let s=m.getImageData(0,0,p,p).data;for(let n=0,l=C.length;n<l;n++)if(s[C[n]]>0){if(!a||"none"===i||"Image"!==d&&"Text"!==d||a.includes(t)){let i=(C[n]-3)/4,s=r-i%p,l=r-(i/p|0),h=o(t,e,s*s+l*l);if(h)return h}m.clearRect(0,0,p,p);break}}let v=Object.keys(this.executorsByZIndex_).map(Number);for(v.sort(s.V_),c=v.length-1;c>=0;--c){let t=v[c].toString();for(g=this.executorsByZIndex_[t],f=L.length-1;f>=0;--f)if(void 0!==(_=g[d=L[f]])&&(x=_.executeHitDetection(m,y,i,I,u)))return x}}getClipCoords(t){let e=this.maxExtent_;if(!e)return null;let i=e[0],s=e[1],n=e[2],l=e[3],o=[i,s,i,l,n,l,n,s];return(0,r.Rc)(o,0,8,2,t,o),o}isEmpty(){return(0,o.p)(this.executorsByZIndex_)}execute(t,e,i,n,l,r,o){let h=Object.keys(this.executorsByZIndex_).map(Number);h.sort(o?s.rG:s.V_),r=r||L;let a=L.length;for(let s=0,u=h.length;s<u;++s){let u=h[s].toString(),d=this.executorsByZIndex_[u];for(let u=0,c=r.length;u<c;++u){let c=r[u],f=d[c];if(void 0!==f){let r=null===o?void 0:f.getZIndexContext(),u=r?r.getContext():t,d=this.maxExtent_&&"Image"!==c&&"Text"!==c;if(d&&(u.save(),this.clip(u,i)),r&&"Text"!==c&&"Image"!==c?r.pushFunction(t=>f.execute(t,e,i,n,l,o)):f.execute(u,e,i,n,l,o),d&&u.restore(),r){r.offset();let t=h[s]*a+L.indexOf(c);this.deferredZIndexContexts_[t]||(this.deferredZIndexContexts_[t]=[]),this.deferredZIndexContexts_[t].push(r)}}}}this.renderedContext_=t}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){let t=this.deferredZIndexContexts_,e=Object.keys(t).map(Number).sort(s.V_);for(let i=0,s=e.length;i<s;++i)t[e[i]].forEach(t=>{t.draw(this.renderedContext_),t.clear()}),t[e[i]].length=0}}},28112:function(t,e,i){i.d(e,{I5:function(){return n},VD:function(){return l},kx:function(){return o},th:function(){return r}});let s={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},n=[s.FILL],l=[s.STROKE],r=[s.BEGIN_PATH],o=[s.CLOSE_PATH];e.Ay=s},85682:function(t,e,i){i.d(e,{E:function(){return u},A:function(){return c}});var s=i(42882),n=i(85752),l=i(94966),r=i(94092),o=i(96299),h=i(81075),a=i(28112);let u={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class d extends h.A{constructor(t,e,i,s){super(t,e,i,s),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[o.defaultFillStyle]={fillStyle:o.defaultFillStyle},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){let t=super.finish();return t.textStates=this.textStates,t.fillStates=this.fillStates,t.strokeStates=this.strokeStates,t}drawText(t,e,i){let s=this.textFillState_,r=this.textStrokeState_,h=this.textState_;if(""===this.text_||!h||!s&&!r)return;let u=this.coordinates,d=u.length,c=t.getType(),f=null,g=t.getStride();if("line"===h.placement&&("LineString"==c||"MultiLineString"==c||"Polygon"==c||"MultiPolygon"==c)){let s;if(!(0,n.intersects)(this.maxExtent,t.getExtent()))return;if(f=t.getFlatCoordinates(),"LineString"==c)s=[f.length];else if("MultiLineString"==c)s=t.getEnds();else if("Polygon"==c)s=t.getEnds().slice(0,1);else if("MultiPolygon"==c){let e=t.getEndss();s=[];for(let t=0,i=e.length;t<i;++t)s.push(e[t][0])}this.beginGeometry(t,e,i);let r=h.repeat,o=r?void 0:h.textAlign,a=0;for(let t=0,e=s.length;t<e;++t){let e;e=r?function(t,e,i,s,n){let r=[],o=i,h=0,a=e.slice(i,2);for(;h<t&&o+n<s;){let[i,s]=a.slice(-2),u=e[o+n],d=e[o+n+1],c=Math.sqrt((u-i)*(u-i)+(d-s)*(d-s));if((h+=c)>=t){let e=(t-h+c)/c,f=(0,l.Cc)(i,u,e),g=(0,l.Cc)(s,d,e);a.push(f,g),r.push(a),a=[f,g],h==t&&(o+=n),h=0}else if(h<t)a.push(e[o+n],e[o+n+1]),o+=n;else{let t=c-h,e=(0,l.Cc)(i,u,t/c),f=(0,l.Cc)(s,d,t/c);a.push(e,f),r.push(a),a=[e,f],h=0,o+=n}}return h>0&&r.push(a),r}(r*this.resolution,f,a,s[t],g):[f.slice(a,s[t])];for(let i=0,n=e.length;i<n;++i){let n=e[i],l=0,r=n.length;if(void 0==o){let t=function(t,e,i,s,n){let l,r,o,h,a,u,d,c,f,g=0,_=0,x=0,p=0,y=0;for(l=0;l<s;l+=2){let i=e[l],s=e[l+1];void 0!==h&&(o=Math.sqrt((c=i-h)*c+(f=s-a)*f),void 0!==u&&(p+=r,Math.acos((u*c+d*f)/(r*o))>t&&(p>x&&(x=p,g=y,_=l),p=0,y=l-2)),r=o,u=c,d=f),h=i,a=s}return(p+=o)>x?[y,l]:[g,_]}(h.maxAngle,n,0,n.length,0);l=t[0],r=t[1]}for(let t=l;t<r;t+=g)u.push(n[t],n[t+1]);let c=u.length;a=s[t],this.drawChars_(d,c),d=c}}this.endGeometry(e)}else{let s=h.overflow?null:[];switch(c){case"Point":case"MultiPoint":f=t.getFlatCoordinates();break;case"LineString":f=t.getFlatMidpoint();break;case"Circle":f=t.getCenter();break;case"MultiLineString":f=t.getFlatMidpoints(),g=2;break;case"Polygon":f=t.getFlatInteriorPoint(),h.overflow||s.push(f[2]/this.resolution),g=3;break;case"MultiPolygon":let n=t.getFlatInteriorPoints();f=[];for(let t=0,e=n.length;t<e;t+=3)h.overflow||s.push(n[t+2]/this.resolution),f.push(n[t],n[t+1]);if(0===f.length)return;g=2}let l=this.appendFlatPointCoordinates(f,g);if(l===d)return;if(s&&(l-d)/2!=f.length/g){let t=d/2;s=s.filter((e,i)=>{let s=u[(t+i)*2]===f[i*g]&&u[(t+i)*2+1]===f[i*g+1];return!s&&--t,s})}this.saveTextStates_();let r=h.backgroundFill?this.createFill(this.fillStyleToState(h.backgroundFill)):null,_=h.backgroundStroke?this.createStroke(this.strokeStyleToState(h.backgroundStroke)):null;this.beginGeometry(t,e,i);let x=h.padding;if(x!=o.defaultPadding&&(h.scale[0]<0||h.scale[1]<0)){let t=h.padding[0],e=h.padding[1],i=h.padding[2],s=h.padding[3];h.scale[0]<0&&(e=-e,s=-s),h.scale[1]<0&&(t=-t,i=-i),x=[t,e,i,s]}let p=this.pixelRatio;this.instructions.push([a.Ay.DRAW_IMAGE,d,l,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,x==o.defaultPadding?o.defaultPadding:x.map(function(t){return t*p}),r,_,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,s]);let y=1/p,S=r?r.slice(0):null;S&&(S[1]=o.defaultFillStyle),this.hitDetectionInstructions.push([a.Ay.DRAW_IMAGE,d,l,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[y,y],NaN,this.declutterMode_,this.declutterImageWithText_,x,S,_,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?o.defaultFillStyle:this.fillKey_,this.textOffsetX_,this.textOffsetY_,s]),this.endGeometry(e)}}saveTextStates_(){let t=this.textStrokeState_,e=this.textState_,i=this.textFillState_,s=this.strokeKey_;!t||s in this.strokeStates||(this.strokeStates[s]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash});let n=this.textKey_;n in this.textStates||(this.textStates[n]={font:e.font,textAlign:e.textAlign||o.defaultTextAlign,justify:e.justify,textBaseline:e.textBaseline||o.defaultTextBaseline,scale:e.scale});let l=this.fillKey_;!i||l in this.fillStates||(this.fillStates[l]={fillStyle:i.fillStyle})}drawChars_(t,e){let i=this.textStrokeState_,s=this.textState_,n=this.strokeKey_,l=this.textKey_,r=this.fillKey_;this.saveTextStates_();let h=this.pixelRatio,d=u[s.textBaseline],c=this.textOffsetY_*h,f=this.text_,g=i?i.lineWidth*Math.abs(s.scale[0])/2:0;this.instructions.push([a.Ay.DRAW_CHARS,t,e,d,s.overflow,r,s.maxAngle,h,c,n,g*h,f,l,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([a.Ay.DRAW_CHARS,t,e,d,s.overflow,r?o.defaultFillStyle:r,s.maxAngle,h,c,n,g*h,f,l,1/h,this.declutterMode_,this.textKeepUpright_])}setTextStyle(t,e){let i,n,l;if(t){let e=t.getFill();e?((n=this.textFillState_)||(n={},this.textFillState_=n),n.fillStyle=(0,s.F)(e.getColor()||o.defaultFillStyle)):(n=null,this.textFillState_=n);let h=t.getStroke();if(h){(l=this.textStrokeState_)||(l={},this.textStrokeState_=l);let t=h.getLineDash(),e=h.getLineDashOffset(),i=h.getWidth(),n=h.getMiterLimit();l.lineCap=h.getLineCap()||o.defaultLineCap,l.lineDash=t?t.slice():o.defaultLineDash,l.lineDashOffset=void 0===e?o.defaultLineDashOffset:e,l.lineJoin=h.getLineJoin()||o.defaultLineJoin,l.lineWidth=void 0===i?o.defaultLineWidth:i,l.miterLimit=void 0===n?o.defaultMiterLimit:n,l.strokeStyle=(0,s.F)(h.getColor()||o.defaultStrokeStyle)}else l=null,this.textStrokeState_=l;i=this.textState_;let a=t.getFont()||o.defaultFont;(0,o.registerFont)(a);let u=t.getScaleArray();i.overflow=t.getOverflow(),i.font=a,i.maxAngle=t.getMaxAngle(),i.placement=t.getPlacement(),i.textAlign=t.getTextAlign(),i.repeat=t.getRepeat(),i.justify=t.getJustify(),i.textBaseline=t.getTextBaseline()||o.defaultTextBaseline,i.backgroundFill=t.getBackgroundFill(),i.backgroundStroke=t.getBackgroundStroke(),i.padding=t.getPadding()||o.defaultPadding,i.scale=void 0===u?[1,1]:u;let d=t.getOffsetX(),c=t.getOffsetY(),f=t.getRotateWithView(),g=t.getKeepUpright(),_=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=void 0===d?0:d,this.textOffsetY_=void 0===c?0:c,this.textRotateWithView_=void 0!==f&&f,this.textKeepUpright_=void 0===g||g,this.textRotation_=void 0===_?0:_,this.strokeKey_=l?("string"==typeof l.strokeStyle?l.strokeStyle:(0,r.getUid)(l.strokeStyle))+l.lineCap+l.lineDashOffset+"|"+l.lineWidth+l.lineJoin+l.miterLimit+"["+l.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.repeat||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=n&&n.fillStyle?"string"==typeof n.fillStyle?n.fillStyle:"|"+(0,r.getUid)(n.fillStyle):""}else this.text_="";this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}}var c=d},67474:function(t,e,i){i.d(e,{F8:function(){return c},_7:function(){return d},tF:function(){return u}});var s=i(19487),n=i(84674),l=i(85752),r=i(94966),o=i(21128),h=i(35299),a=i(39265);let u=.5;function d(t,e,i,r,d,c,f,g,_){let x=_?(0,o.toUserExtent)(d,_):d,p=t[0]*u,y=t[1]*u,S=(0,n.Y)(p,y);S.imageSmoothingEnabled=!1;let m=S.canvas,C=new a.A(S,u,d,null,f,g,_?(0,o.getTransformFromProjections)((0,o.getUserProjection)(),_):null),I=i.length,v=Math.floor(0xffffff/I),k={};for(let t=1;t<=I;++t){let e=i[t-1],s=e.getStyleFunction()||r;if(!s)continue;let o=s(e,c);if(!o)continue;Array.isArray(o)||(o=[o]);let a=(t*v).toString(16).padStart(7,"#00000");for(let t=0,i=o.length;t<i;++t){let i=o[t],s=i.getGeometryFunction()(e);if(!s||!(0,l.intersects)(x,s.getExtent()))continue;let r=i.clone(),u=r.getFill();u&&u.setColor(a);let d=r.getStroke();d&&(d.setColor(a),d.setLineDash(null)),r.setText(void 0);let c=i.getImage();if(c){let t=c.getImageSize();if(!t)continue;let e=(0,n.Y)(t[0],t[1],void 0,{alpha:!1}),i=e.canvas;e.fillStyle=a,e.fillRect(0,0,i.width,i.height),r.setImage(new h.default({img:i,anchor:c.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:c.getOrigin(),opacity:1,size:c.getSize(),scale:c.getScale(),rotation:c.getRotation(),rotateWithView:c.getRotateWithView()}))}let f=r.getZIndex()||0,g=k[f];g||(g={},k[f]=g,g.Polygon=[],g.Circle=[],g.LineString=[],g.Point=[]);let _=s.getType();if("GeometryCollection"===_){let t=s.getGeometriesArrayRecursive();for(let e=0,i=t.length;e<i;++e){let i=t[e];g[i.getType().replace("Multi","")].push(i,r)}}else g[_.replace("Multi","")].push(s,r)}}let D=Object.keys(k).map(Number).sort(s.V_);for(let t=0,i=D.length;t<i;++t){let i=k[D[t]];for(let t in i){let s=i[t];for(let t=0,i=s.length;t<i;t+=2){C.setStyle(s[t+1]);for(let i=0,n=e.length;i<n;++i)C.setTransform(e[i]),C.drawGeometry(s[t])}}}return S.getImageData(0,0,m.width,m.height)}function c(t,e,i){let s=[];if(i){let n=Math.floor(Math.round(t[0])*u),l=Math.floor(Math.round(t[1])*u),o=((0,r.qE)(n,0,i.width-1)+(0,r.qE)(l,0,i.height-1)*i.width)*4,h=i.data[o],a=i.data[o+1],d=i.data[o+2]+256*(a+256*h),c=Math.floor(0xffffff/e.length);d&&d%c==0&&s.push(e[d/c-1])}return s}}}]);
//# sourceMappingURL=5474.a75c6d62b0955ad1.js.map