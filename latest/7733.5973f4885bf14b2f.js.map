{"version":3,"file":"7733.5973f4885bf14b2f.js","sources":["webpack://@terrestris/shogun-gis-client/./node_modules/ol/format/WMSGetFeatureInfo.js","webpack://@terrestris/shogun-gis-client/./node_modules/ol/util.js"],"sourcesContent":["/**\n * @module ol/format/WMSGetFeatureInfo\n */\nimport {extend} from '../array.js';\nimport {makeArrayPusher, makeStructureNS, pushParseAndPop} from '../xml.js';\nimport GML2 from './GML2.js';\nimport XMLFeature from './XMLFeature.js';\n\n/**\n * @typedef {Object} Options\n * @property {Array<string>} [layers] If set, only features of the given layers will be returned by the format when read.\n */\n\n/**\n * @const\n * @type {string}\n */\nconst featureIdentifier = '_feature';\n\n/**\n * @const\n * @type {string}\n */\nconst layerIdentifier = '_layer';\n\n/**\n * @classdesc\n * Format for reading WMSGetFeatureInfo format. It uses\n * {@link module:ol/format/GML2~GML2} to read features.\n *\n * @api\n */\nclass WMSGetFeatureInfo extends XMLFeature {\n  /**\n   * @param {Options} [options] Options.\n   */\n  constructor(options) {\n    super();\n\n    options = options ? options : {};\n\n    /**\n     * @private\n     * @type {string}\n     */\n    this.featureNS_ = 'http://mapserver.gis.umn.edu/mapserver';\n\n    /**\n     * @private\n     * @type {GML2}\n     */\n    this.gmlFormat_ = new GML2();\n\n    /**\n     * @private\n     * @type {Array<string>|null}\n     */\n    this.layers_ = options.layers ? options.layers : null;\n  }\n\n  /**\n   * @return {Array<string>|null} layers\n   */\n  getLayers() {\n    return this.layers_;\n  }\n\n  /**\n   * @param {Array<string>|null} layers Layers to parse.\n   */\n  setLayers(layers) {\n    this.layers_ = layers;\n  }\n\n  /**\n   * @param {Element} node Node.\n   * @param {Array<*>} objectStack Object stack.\n   * @return {Array<import(\"../Feature.js\").default>} Features.\n   * @private\n   */\n  readFeatures_(node, objectStack) {\n    node.setAttribute('namespaceURI', this.featureNS_);\n    const localName = node.localName;\n    /** @type {Array<import(\"../Feature.js\").default>} */\n    let features = [];\n    if (node.childNodes.length === 0) {\n      return features;\n    }\n    if (localName == 'msGMLOutput') {\n      for (let i = 0, ii = node.childNodes.length; i < ii; i++) {\n        const layer = node.childNodes[i];\n        if (layer.nodeType !== Node.ELEMENT_NODE) {\n          continue;\n        }\n\n        const layerElement = /** @type {Element} */ (layer);\n        const context = objectStack[0];\n\n        const toRemove = layerIdentifier;\n        const layerName = layerElement.localName.replace(toRemove, '');\n\n        if (this.layers_ && !this.layers_.includes(layerName)) {\n          continue;\n        }\n\n        const featureType = layerName + featureIdentifier;\n\n        context['featureType'] = featureType;\n        context['featureNS'] = this.featureNS_;\n\n        /** @type {Object<string, import(\"../xml.js\").Parser>} */\n        const parsers = {};\n        parsers[featureType] = makeArrayPusher(\n          this.gmlFormat_.readFeatureElement,\n          this.gmlFormat_,\n        );\n        const parsersNS = makeStructureNS(\n          [context['featureNS'], null],\n          parsers,\n        );\n        layerElement.setAttribute('namespaceURI', this.featureNS_);\n        const layerFeatures = pushParseAndPop(\n          [],\n          // @ts-ignore\n          parsersNS,\n          layerElement,\n          objectStack,\n          this.gmlFormat_,\n        );\n        if (layerFeatures) {\n          extend(features, layerFeatures);\n        }\n      }\n    }\n    if (localName == 'FeatureCollection') {\n      const gmlFeatures = pushParseAndPop(\n        [],\n        this.gmlFormat_.FEATURE_COLLECTION_PARSERS,\n        node,\n        [{}],\n        this.gmlFormat_,\n      );\n      if (gmlFeatures) {\n        features = gmlFeatures;\n      }\n    }\n    return features;\n  }\n\n  /**\n   * @protected\n   * @param {Element} node Node.\n   * @param {import(\"./Feature.js\").ReadOptions} [options] Options.\n   * @return {Array<import(\"../Feature.js\").default>} Features.\n   * @override\n   */\n  readFeaturesFromNode(node, options) {\n    const internalOptions = {};\n    if (options) {\n      Object.assign(internalOptions, this.getReadOptions(node, options));\n    }\n    return this.readFeatures_(node, [internalOptions]);\n  }\n}\n\nexport default WMSGetFeatureInfo;\n","/**\n * @module ol/util\n */\n\n/**\n * @return {never} Any return.\n */\nexport function abstract() {\n  throw new Error('Unimplemented abstract method.');\n}\n\n/**\n * Counter for getUid.\n * @type {number}\n * @private\n */\nlet uidCounter_ = 0;\n\n/**\n * Gets a unique ID for an object. This mutates the object so that further calls\n * with the same object as a parameter returns the same value. Unique IDs are generated\n * as a strictly increasing sequence. Adapted from goog.getUid.\n *\n * @param {Object} obj The object to get the unique ID for.\n * @return {string} The unique ID for the object.\n * @api\n */\nexport function getUid(obj) {\n  return obj.ol_uid || (obj.ol_uid = String(++uidCounter_));\n}\n\n/**\n * OpenLayers version.\n * @type {string}\n */\nexport const VERSION = '10.6.1';\n"],"names":["i","Node","Object","Error","String"],"mappings":"2MAgCA,OAAM,UAA0B,GAAU,CAIxC,YAAY,CAAO,CAAE,CACnB,KAAK,GAEL,EAAU,GAAoB,CAAC,EAM/B,IAAI,CAAC,UAAU,CAAG,yCAMlB,IAAI,CAAC,UAAU,CAAG,IAAI,SAAI,CAM1B,IAAI,CAAC,OAAO,CAAG,EAAQ,MAAM,CAAG,EAAQ,MAAM,CAAG,IACnD,CAKA,WAAY,CACV,OAAO,IAAI,CAAC,OAAO,AACrB,CAKA,UAAU,CAAM,CAAE,CAChB,IAAI,CAAC,OAAO,CAAG,CACjB,CAQA,cAAc,CAAI,CAAE,CAAW,CAAE,CAC/B,EAAK,YAAY,CAAC,eAAgB,IAAI,CAAC,UAAU,EACjD,IAAM,EAAY,EAAK,SAAS,CAE5B,EAAW,EAAE,CACjB,GAAI,AAA2B,IAA3B,EAAK,UAAU,CAAC,MAAM,CACxB,OAAO,EAET,GAAI,AAAa,eAAb,EACF,IAAK,IAAI,EAAI,EAAGA,EAAK,EAAK,UAAU,CAAC,MAAM,CAAE,EAAIA,EAAI,IAAK,CACxD,IAAM,EAAQ,EAAK,UAAU,CAAC,EAAE,CAChC,GAAI,EAAM,QAAQ,GAAKC,KAAK,YAAY,CACtC,SAIF,IAAM,EAAU,CAAW,CAAC,EAAE,CAGxB,EAAY,AAJ2B,EAId,SAAS,CAAC,OAAO,CA5EhC,SA4E2C,IAE3D,GAAI,IAAI,CAAC,OAAO,EAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,GACzC,SAGF,IAAM,EAAc,EAxFF,UA0FlB,GAAQ,WAAc,CAAG,EACzB,EAAQ,SAAY,CAAG,IAAI,CAAC,UAAU,CAGtC,IAAM,EAAU,CAAC,CACjB,EAAO,CAAC,EAAY,CAAG,SACrB,IAAI,CAAC,UAAU,CAAC,kBAAkB,CAClC,IAAI,CAAC,UAAU,EAEjB,IAAM,EAAY,SAChB,CAAC,EAAQ,SAAY,CAAE,KAAK,CAC5B,GAEF,AAzB6C,EAyBhC,YAAY,CAAC,eAAgB,IAAI,CAAC,UAAU,EACzD,IAAM,EAAgB,QACpB,EAAE,CAEF,EA7B2C,EA+B3C,EACA,IAAI,CAAC,UAAU,CAEb,IACF,SAAO,EAAU,EAErB,CAEF,GAAI,AAAa,qBAAb,EAAkC,CACpC,IAAM,EAAc,QAClB,EAAE,CACF,IAAI,CAAC,UAAU,CAAC,0BAA0B,CAC1C,EACA,CAAC,CAAC,EAAE,CACJ,IAAI,CAAC,UAAU,CAEb,IACF,GAAW,CAAU,CAEzB,CACA,OAAO,CACT,CASA,qBAAqB,CAAI,CAAE,CAAO,CAAE,CAClC,IAAM,EAAkB,CAAC,EAIzB,OAHI,GACFC,OAAO,MAAM,CAAC,EAAiB,IAAI,CAAC,cAAc,CAAC,EAAM,IAEpD,IAAI,CAAC,aAAa,CAAC,EAAM,CAAC,EAAgB,CACnD,CACF,CAEA,UAAe,C,wBC9JR,SAAS,IACd,MAAM,AAAIC,MAAM,iCAClB,C,uGAOA,IAAI,EAAc,EAWX,SAAS,EAAO,CAAG,EACxB,OAAO,EAAI,MAAM,EAAK,GAAI,MAAM,CAAGC,OAAO,EAAE,EAAW,CACzD,CAMO,IAAM,EAAU,Q"}