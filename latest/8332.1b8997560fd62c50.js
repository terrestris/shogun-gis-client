"use strict";(self.webpackChunk_terrestris_shogun_gis_client=self.webpackChunk_terrestris_shogun_gis_client||[]).push([["8332"],{31559:function(e,t,n){n.r(t),n.d(t,{default:function(){return S},GeoLocationButton:function(){return N}});var r=n(76395),a=n.n(r),i=n(69843),o=n.n(i),s=n(66046),u=n.n(s),c=n(62918),l=n.n(c),g=n(94934),f=n.n(g),d=n(25188),h=n.n(d),m=n(15516),p=n.n(m),b=n(17936),M=n(70038),w=n.n(M),y=n(36528),C=n.n(y),k=n(97562),A=n.n(k),v=class{static radToDeg=e=>360*e/(2*Math.PI);static degToRad=e=>e*Math.PI*2/360;static mod=e=>(e%(2*Math.PI)+2*Math.PI)%(2*Math.PI)},$=n(30126),E=n(38254),P=n.p+"6afbd13a3ce1b95d.png",_=n.p+"3380da3c8b677218.png",I=n(70198),T=n(53529);let N=({className:e,enableTracking:t=!1,follow:n=!1,onChange:i,onError:s=()=>void 0,onGeoLocationChange:c=()=>void 0,pressed:g,showMarker:d=!0,trackingOptions:m,onPressedChange:M,...y})=>{let[k,N]=(0,r.useState)(!1),S="boolean"==typeof g,V=S?!!g:k;(({active:e,enableTracking:t=!1,follow:n=!1,onError:a,onGeoLocationChange:i,showMarker:s=!1,trackingOptions:c={enableHighAccuracy:!0,maximumAge:1e4,timeout:6e5}})=>{let g=(0,$.A)(),[d,m]=(0,r.useState)(),M=(0,r.useMemo)(()=>new(f())([],"XYZM"),[]),y=(0,r.useMemo)(()=>new(u()),[]);(0,E.c)(()=>new(p())({properties:{name:"react-geo_geolocationlayer"},source:new(w())({features:[y]}),style:e=>{let t=e.get("heading"),n=Number.isFinite(t)&&0!==t?P:_,r=Number.isFinite(t)&&0!==t?t*Math.PI/180:0;return[new(A())({image:new(C())({rotation:r,src:n})})]}}),[],s&&e);let k=(0,r.useCallback)(e=>{let t=e.target,n=t.getPosition()??[0,0],r=t.getAccuracy(),a=t.getHeading()||0,o=t.getSpeed()||0,s=n[0],u=n[1],c=M.getCoordinates(),l=c[c.length-1],g=l&&l[2];if(g){let e=a-v.mod(g);Math.abs(e)>Math.PI&&(e=-(e>=0?1:-1)*(2*Math.PI-Math.abs(e))),a=g+e}M.appendCoordinate([s,u,a,Date.now()]),M.setCoordinates(M.getCoordinates().slice(-20));let f={position:n,accuracy:r,heading:a,speed:o};m(f),i?.(f)},[M,i]),I=(0,r.useMemo)(()=>{if(!e||!g)return;let n=new(l())({projection:g.getView().getProjection(),trackingOptions:c});return t&&n.setTracking(!0),n},[e,g,c,t]),T=(0,r.useCallback)((e,t,n)=>{let r=(g?.getSize()??[0,0])[1];return[e[0]-Math.sin(t)*r*n/4,e[1]+Math.cos(t)*r*n/4]},[g]);return(0,r.useEffect)(()=>{if(!a||!I)return;let e=I.on("error",()=>{a()});return()=>{(0,b.unByKey)(e)}},[I,a]),(0,r.useEffect)(()=>{if(!I)return;let e=I.on("change",k);return()=>{(0,b.unByKey)(e)}},[I,k]),(0,r.useEffect)(()=>{if(I)return I.setTracking(t),()=>{I.setTracking(!1)}},[t,I]),(0,r.useEffect)(()=>{I&&I.setTrackingOptions(c)},[I,c]),(0,r.useEffect)(()=>{let e=Date.now()-750;e=Math.max(e,0);let t=M.getCoordinateAtM(e,!0);if(!o()(t)&&(n&&(g?.getView().setCenter(T([t[0],t[1]],-t[2],g?.getView().getResolution()??0)),g?.getView().setRotation(-t[2])),s)){let e=new(h())([t[0],t[1]]);y.setGeometry(e)}},[d,s,n,g,M,T,y])})({active:V,enableTracking:V&&t,follow:n,onError:s,onGeoLocationChange:c,showMarker:d,trackingOptions:m});let x=e?`${e} ${I.$}geolocationbutton`:`${I.$}geolocationbutton`;return a().createElement(T.A,{pressed:V,className:x,onChange:(e,t)=>{S?M?.(!V):N(e=>{let t=!e;return M?.(t),t}),i?.(e,t)},...y})};var S=N},53529:function(e,t,n){var r=n(76395),a=n.n(r),i=n(8110),o=n(71021),s=n(70198);t.A=({type:e="primary",pressed:t=!1,tooltipProps:n={mouseEnterDelay:1.5},className:r,tooltip:u,tooltipPlacement:c,pressedIcon:l,icon:g,children:f,value:d,onClick:h,onChange:m=()=>void 0,...p})=>{let b=`${s.$}togglebutton`,M=r?`${r} ${b}`:b,w="";return t&&(w=" btn-pressed"),a().createElement(i.A,{title:u,placement:c,...n},a().createElement(o.Ay,{type:e,onClick:e=>{h&&(h(e),e.defaultPrevented)||m(e,d)},onChange:m,className:`${M}${w}`,"aria-pressed":t,icon:t?l:g,...p},f))}},70198:function(e,t,n){n.d(t,{$:function(){return r}});let r="react-geo-"},73645:function(e,t,n){var r=n(76395);t.A=n.n(r)().createContext(null)},30126:function(e,t,n){n.d(t,{k:function(){return i}});var r=n(76395),a=n(73645);let i=()=>(0,r.useContext)(a.A);t.A=i},38254:function(e,t,n){n.d(t,{c:function(){return o}});var r=n(76395),a=n(2543),i=n(30126);let o=(e,t,n)=>{let o=(0,i.A)(),[s,u]=(0,r.useState)();return(0,r.useEffect)(()=>{if(!o)return;let t=e();if(t)return o.addLayer(t),u(t),()=>{o.removeLayer(t),u(void 0)}},[o,...t]),(0,r.useEffect)(()=>{!s||(0,a.isNil)(n)||s.setVisible(n)},[s,n]),s};t.A=o}}]);
//# sourceMappingURL=8332.1b8997560fd62c50.js.map