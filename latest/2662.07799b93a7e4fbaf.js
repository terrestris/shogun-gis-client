"use strict";(self.webpackChunk_terrestris_shogun_gis_client=self.webpackChunk_terrestris_shogun_gis_client||[]).push([["2662"],{51365:function(e,t,r){r.r(t),r.d(t,{default:function(){return z},MeasureButton:function(){return q}});var n=r(76395),o=r.n(n),a=r(21834),l=r.n(a),i=r(55482),c=r.n(i),u=r(94934),s=r.n(u),f=r(1592),g=r.n(f),d=r(81802),m=r.n(d),p=r(27436),v=r.n(p),C=r(30100),y=r.n(C),k=r(15516),A=r.n(k),w=r(25194),h=r.n(w),b=r(70038),$=r.n(b),E=r(40542),O=r.n(E),L=r(47312),M=r.n(L),P=r(66922),S=r.n(P),_=r(97562),I=r.n(_),R=r(20191);let N="react-util-";var D=r(30126),H=r(92712),T=r(38254),G=r(42502);function B(e){let t=e.getGeometry();return t instanceof m()&&(t=t.getPolygons()[0]),t instanceof g()&&(t=t.getLineStrings()[0]),t}var x=r(70198),K=r(53529);let j=`${x.$}measurebutton`,q=({measureType:e="line",measureLayerName:t="react-geo_measure",fillColor:r="rgba(255, 0, 0, 0.5)",strokeColor:a="rgba(255, 0, 0, 0.8)",showMeasureInfoOnClickedPoints:i=!1,showSegmentLengths:u=!1,showHelpTooltip:f=!0,decimalPlacesInTooltips:g=2,multipleDrawing:d=!1,continuePolygonMsg:m="Click to draw area",continueLineMsg:p="Click to draw line",continueAngleMsg:C="Click to draw angle",clickToDrawText:k="Click to measure",measureTooltipCssClasses:w={tooltip:`${x.$}measure-tooltip`,tooltipDynamic:`${x.$}measure-tooltip-dynamic`,tooltipStatic:`${x.$}measure-tooltip-static`},pressed:b=!1,geodesic:E=!0,measureRadius:L=!1,className:P,..._})=>{(({measureType:e,measureLayerName:t="react-util-measure",fillColor:r="rgba(255, 0, 0, 0.5)",strokeColor:o="rgba(255, 0, 0, 0.8)",showMeasureInfoOnClickedPoints:a=!1,showSegmentLengths:i=!1,showHelpTooltip:u=!0,decimalPlacesInTooltips:f=2,multipleDrawing:g=!1,continuePolygonMsg:d="Click to draw area",continueLineMsg:m="Click to draw line",continueAngleMsg:p="Click to draw angle",clickToDrawText:C="Click to measure",measureTooltipCssClasses:k={tooltip:`${N}measure-tooltip`,tooltipDynamic:`${N}measure-tooltip-dynamic`,tooltipStatic:`${N}measure-tooltip-static`},active:w=!1,geodesic:b=!0,measureRadius:E=!1})=>{let[L,P]=(0,n.useState)(),_=(0,n.useRef)(),x=(0,n.useRef)(),K=(0,n.useRef)([]),j=(0,n.useRef)([]),q=(0,n.useRef)(),z=(0,D.A)(),F=(0,T.A)(()=>new(A())({properties:{name:t},source:new($())({features:new(l())}),style:new(I())({fill:new(M())({color:r}),stroke:new(S())({color:o,width:2}),image:new(O())({radius:7,fill:new(M())({color:r})})})}),[t,r,o,r],w),J=(0,H.h)(()=>new(y())({source:F?.getSource()||void 0,type:(e=>{switch(e){case"line":case"angle":default:return"MultiLineString";case"polygon":return"MultiPolygon";case"circle":return"Circle"}})(e),maxPoints:"angle"===e?2:void 0,style:new(I())({fill:new(M())({color:r}),stroke:new(S())({color:o,lineDash:[10,10],width:2}),image:new(O())({radius:5,stroke:new(S())({color:o}),fill:new(M())({color:r})})}),freehandCondition:()=>!1}),[e,F,r,o,r],w),Q=(0,n.useCallback)(()=>{z&&_.current&&(z.removeOverlay(_.current),_.current=void 0)},[z]),U=(0,n.useCallback)(()=>{if(z&&K.current.length>0){for(let e of K.current)z.removeOverlay(e);K.current=[]}},[z]),V=(0,n.useCallback)(()=>{if(z&&K.current.length>0){let e=K.current.pop();z.removeOverlay(e)}},[z]),W=(0,n.useCallback)(()=>{if(z&&j.current.length>0){for(let e of j.current)z.removeOverlay(e);j.current=[]}},[z]),X=(0,n.useCallback)(()=>{z&&void 0!==q.current&&(z.removeOverlay(q.current),q.current=void 0)},[z]),Y=(0,n.useCallback)(()=>{z&&x.current&&(z.removeOverlay(x.current),x.current=void 0)},[z]),Z=(0,n.useCallback)(()=>{Q(),U(),W(),X(),Y(),F?.getSource()?.clear()},[F,Q,U,W,Y,X]);(0,n.useEffect)(()=>{if(w)return()=>{Z()}},[w,Z]);let ee=(0,n.useCallback)(()=>{z&&!x.current&&(x.current=new(h())({element:document.createElement("div"),offset:[15,0],positioning:"center-left",className:k?.tooltip??""}),z.addOverlay(x.current))},[z,k?.tooltip]),et=(0,n.useCallback)(()=>new(h())({element:document.createElement("div"),offset:[0,-15],positioning:"bottom-center",className:k?`${k.tooltip} ${k.tooltipDynamic}`:""}),[k]),er=(0,n.useCallback)(()=>{let t,r;if(!L||!z)return;let n=B(L);if(n instanceof c()){if(E){let e=R.A.getAreaOfCircle(n,z),r=Math.pow(10,f),o=Math.round(n.getRadius()*r)/r;t=`${o.toString()} m`,e>1e6*Math.PI&&(t=Math.round(n.getRadius()/1e3*r)/r+" km")}else t=R.A.formatArea(n,z,f,b);r=n.getCenter()}else n instanceof v()?n.getCoordinates()[0].length>3&&(t=R.A.formatArea(n,z,f,b),r=n.getInteriorPoint().getCoordinates()):n instanceof s()&&(r=n.getLastCoordinate(),"line"===e?t=R.A.formatLength(n,z,f,b):"angle"===e&&(t=R.A.formatAngle(n,0)));if(void 0===t||0===parseInt(t,10))return void Q();void 0===_.current&&(_.current=et(),z.addOverlay(_.current));let o=_.current,a=o.getElement();t&&a&&(a.innerHTML=t),o.setPosition(r)},[f,L,b,z,e,E,et,Q]),en=(0,n.useCallback)(e=>{z&&(g||Z(),P(e.feature))},[Z,z,g]),eo=(0,n.useCallback)(t=>{if(!L||!z)return;let r=B(L),n="line"===e?R.A.formatLength(r,z,f,b):R.A.formatArea(r,z,f,b);if(parseInt(n,10)>0){let e=et();e.getElement().innerHTML=n,z.addOverlay(e),e.setPosition(t),K.current.push(e)}},[f,L,b,z,et,e]),ea=(0,n.useCallback)((e=!1)=>{if(!L||!z)return;let t=B(L),r=[];if(e){if(!(t instanceof v()))return;r=t.getCoordinates()[0].slice(-2)}else{if(t instanceof v()&&(r=t.getCoordinates()[0].slice(0,-1)),t instanceof s()&&(r=t.getCoordinates()),r.length<3)return;r=r.slice(-3,-1)}let n=new(s())(r),o=R.A.formatLength(n,z,f,b);if(parseInt(o,10)>0){let e=et();e.getElement().innerHTML=o,z.addOverlay(e);let t=n.getCoordinateAt(.5);e.setPosition(t),j.current.push(e)}},[f,L,b,z,et]),el=(0,n.useCallback)(()=>{if(!L||!z)return;let e=B(L),t=[];if(e instanceof v()&&(t=e.getCoordinates()[0].slice(0,-1)),e instanceof s()&&(t=e.getCoordinates()),t.length<2)return;t=t.slice(-2);let r=new(s())(t),n=R.A.formatLength(r,z,f,b);if(parseInt(n,10)>0){void 0===q.current&&(q.current=et(),z.addOverlay(q.current));let e=q.current;e.getElement().innerHTML=n;let t=r.getCoordinateAt(.5);e.setPosition(t)}},[f,L,b,z,et]),ei=(0,n.useCallback)(t=>{if(z){if(a&&"line"===e&&V(),g&&("line"===e||"polygon"===e)&&(eo(t.feature.getGeometry().getLastCoordinate()),Q()),!g){er();let e=_.current?.getElement();e&&k&&(e.className=`${k.tooltip} ${k.tooltipStatic}`),_.current?.setOffset([0,-7])}if(P(void 0),i){if(X(),j.current.length>1){let[e]=j.current.splice(-2,1);z.removeOverlay(e)}"polygon"===e&&ea(!0)}}},[eo,k,z,e,g,Q,a,er,i,ea,V,X]),ec=(0,n.useCallback)(t=>{if(!x.current)return;let r=x.current?.getElement();if(!r)return;let n=C;"polygon"===e?n=d:"line"===e?n=m:"angle"===e&&(n=p),r.innerHTML=n??"",x.current.setPosition(t)},[C,p,m,d,x,e]),eu=(0,n.useCallback)(e=>{!e.dragging&&w&&(ec(e.coordinate),i&&el())},[ec,w,i,el]),es=(0,n.useCallback)(t=>{w&&a&&"line"===e&&eo(t.coordinate),w&&i&&("line"===e||"polygon"===e)&&ea()},[eo,ea,e,a,i,w]);return(0,G.A)(J,e=>e.on("drawstart",e=>{en?.(e)}),[J,en]),(0,G.A)(J,e=>e.on("drawend",e=>{ei?.(e)}),[J,ei]),(0,G.A)(z,e=>e.on("pointermove",e=>{eu?.(e)}),[z,eu]),(0,G.A)(z,e=>e.on("click",e=>{es?.(e)}),[z,es]),(0,n.useEffect)(()=>{u&&ee()},[ee,u]),(0,G.A)(L,e=>e.getGeometry()?.on("change",()=>{er?.()}),[L,er])})({active:b,measureType:e,measureLayerName:t,fillColor:r,strokeColor:a,showMeasureInfoOnClickedPoints:i,showSegmentLengths:u,showHelpTooltip:f,decimalPlacesInTooltips:g,multipleDrawing:d,continuePolygonMsg:m,continueLineMsg:p,continueAngleMsg:C,clickToDrawText:k,measureTooltipCssClasses:w,geodesic:E,measureRadius:L});let q=P?`${P} ${j}`:j;return o().createElement(K.A,{pressed:b,className:q,..._})};var z=q},53529:function(e,t,r){var n=r(76395),o=r.n(n),a=r(54440),l=r(74097),i=r(70198);t.A=({type:e="primary",pressed:t=!1,tooltipProps:r={mouseEnterDelay:1.5},className:n,tooltip:c,tooltipPlacement:u,pressedIcon:s,icon:f,children:g,value:d,onClick:m,onChange:p=()=>void 0,...v})=>{let C=`${i.$}togglebutton`,y=n?`${n} ${C}`:C,k="";return t&&(k=" btn-pressed"),o().createElement(a.A,{title:c,placement:u,...r},o().createElement(l.Ay,{type:e,onClick:e=>{m&&(m(e),e.defaultPrevented)||p(e,d)},onChange:p,className:`${y}${k}`,"aria-pressed":t,icon:t?s:f,...v},g))}},70198:function(e,t,r){r.d(t,{$:function(){return n}});let n="react-geo-"},92712:function(e,t,r){r.d(t,{h:function(){return l}});var n=r(76395),o=r(2543),a=r(30126);let l=(e,t,r)=>{let l=(0,a.A)(),[i,c]=(0,n.useState)();return(0,n.useEffect)(()=>{if(!l)return;let t=e();if(t)return c(t),l.addInteraction(t),()=>{l.removeInteraction(t),c(void 0)}},[...t,l]),(0,n.useEffect)(()=>{!i||(0,o.isNil)(r)||i.setActive(r)},[i,r]),i}},42502:function(e,t,r){r.d(t,{R:function(){return a}});var n=r(76395),o=r(17936);let a=(e,t,r,a)=>{(0,n.useEffect)(()=>{if(!e||!1===a)return;let r=(Array.isArray(e)?e:[e]).flatMap(e=>{let r=t(e);return Array.isArray(r)?r:[r]}).filter(e=>void 0!==e);return()=>{for(let e of r)(0,o.unByKey)(e)}},[e,a,t,...r])};t.A=a}}]);
//# sourceMappingURL=2662.07799b93a7e4fbaf.js.map