{"version":3,"file":"2809.cd403381867150fc.js","sources":["webpack://@terrestris/shogun-gis-client/./node_modules/@terrestris/react-geo/dist/Field/ScaleCombo/ScaleCombo.js","webpack://@terrestris/shogun-gis-client/./node_modules/@terrestris/react-geo/dist/constants.js","webpack://@terrestris/shogun-gis-client/./node_modules/@terrestris/react-util/dist/Context/MapContext/MapContext.js","webpack://@terrestris/shogun-gis-client/./node_modules/@terrestris/react-util/dist/Hooks/useMap/useMap.js","webpack://@terrestris/shogun-gis-client/./node_modules/lodash/isEmpty.js","webpack://@terrestris/shogun-gis-client/./node_modules/lodash/isInteger.js","webpack://@terrestris/shogun-gis-client/./node_modules/lodash/isNumber.js","webpack://@terrestris/shogun-gis-client/./node_modules/lodash/reverse.js"],"sourcesContent":["import './ScaleCombo.less';\nimport MapUtil from '@terrestris/ol-util/dist/MapUtil/MapUtil';\nimport useMap from '@terrestris/react-util/dist/Hooks/useMap/useMap';\nimport { Select } from 'antd';\nimport _clone from 'lodash/clone';\nimport _isEmpty from 'lodash/isEmpty';\nimport _isInteger from 'lodash/isInteger';\nimport _isNil from 'lodash/isNil';\nimport _isNumber from 'lodash/isNumber';\nimport _reverse from 'lodash/reverse';\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { CSS_PREFIX } from '../../constants';\nconst defaultClassName = `${CSS_PREFIX}scalecombo`;\nconst ScaleCombo = ({ resolutionsFilter = () => true, syncWithMap = true, scales = [], className, onZoomLevelSelect, resolutions, ...passThroughProps }) => {\n    const [internalZoomLevel, setInternalZoomLevel] = useState();\n    const map = useMap();\n    const getOptionsFromMap = useCallback(() => {\n        if (!map) {\n            return [];\n        }\n        const optionScales = [];\n        const view = map.getView();\n        // use existing resolutions array if exists\n        const viewResolutions = view.getResolutions();\n        const pushScale = (s, r, v) => {\n            const scale = MapUtil.getScaleForResolution(r, v.getProjection().getUnits());\n            if (!scale) {\n                return;\n            }\n            const roundScale = MapUtil.roundScale(scale);\n            if (optionScales.includes(roundScale)) {\n                return;\n            }\n            optionScales.push(roundScale);\n        };\n        if (_isEmpty(viewResolutions) || _isNil(viewResolutions)) {\n            for (let currentZoomLevel = view.getMaxZoom(); currentZoomLevel >= view.getMinZoom(); currentZoomLevel--) {\n                const resolution = view.getResolutionForZoom(currentZoomLevel);\n                if (resolutionsFilter(resolution)) {\n                    pushScale(optionScales, resolution, view);\n                }\n            }\n        }\n        else {\n            const reversedResolutions = _reverse(_clone(viewResolutions));\n            reversedResolutions\n                .filter(resolutionsFilter)\n                .forEach(resolution => pushScale(scales, resolution, view));\n        }\n        return optionScales;\n    }, [map, resolutionsFilter, scales]);\n    const zoomListener = useCallback((evt) => {\n        const zoom = evt.target.getZoom();\n        let roundZoom = 0;\n        if (_isNumber(zoom)) {\n            roundZoom = Math.round(zoom);\n        }\n        setInternalZoomLevel(roundZoom);\n    }, []);\n    const internalScales = useMemo(() => {\n        return scales.length > 0 ? scales : getOptionsFromMap();\n    }, [scales, getOptionsFromMap]);\n    useEffect(() => {\n        if (!map) {\n            return;\n        }\n        if (syncWithMap) {\n            map.getView().on('change:resolution', zoomListener);\n        }\n        else {\n            map.getView().un('change:resolution', zoomListener);\n        }\n    }, [map, syncWithMap, zoomListener]);\n    useEffect(() => {\n        setInternalZoomLevel(map?.getView().getZoom());\n    }, [map]);\n    const onZoomLevelSelectInternal = (selectedScale) => {\n        if (!map) {\n            return;\n        }\n        if (onZoomLevelSelect) {\n            onZoomLevelSelect(selectedScale);\n        }\n        else {\n            // The default.\n            const mapView = map.getView();\n            const calculatedResolution = MapUtil.getResolutionForScale(parseInt(selectedScale, 10), mapView.getProjection().getUnits());\n            mapView.setResolution(calculatedResolution);\n        }\n    };\n    const determineOptionKeyForZoomLevel = (zoom) => {\n        if (!_isInteger(zoom) || (internalScales.length - 1 - zoom) < 0) {\n            return undefined;\n        }\n        return internalScales[internalScales.length - 1 - zoom].toString();\n    };\n    const finalClassName = className\n        ? `${className} ${defaultClassName}`\n        : defaultClassName;\n    return (React.createElement(Select, { showSearch: true, onChange: onZoomLevelSelectInternal, filterOption: (input, option) => option?.key?.toString().startsWith(input) ?? false, value: determineOptionKeyForZoomLevel(internalZoomLevel ?? 0), size: \"small\", className: finalClassName, options: internalScales.map(roundScale => ({\n            value: roundScale.toString(),\n            label: `1:${roundScale.toLocaleString()}`\n        })), ...passThroughProps }));\n};\nexport default ScaleCombo;\n//# sourceMappingURL=ScaleCombo.js.map","const CSS_PREFIX = 'react-geo-';\nexport { CSS_PREFIX };\n//# sourceMappingURL=constants.js.map","import React from 'react';\nconst MapContext = React.createContext(null);\nexport default MapContext;\n//# sourceMappingURL=MapContext.js.map","import { useContext } from 'react';\nimport MapContext from '../../Context/MapContext/MapContext';\nexport const useMap = () => {\n    return useContext(MapContext);\n};\nexport default useMap;\n//# sourceMappingURL=useMap.js.map","var baseKeys = require('./_baseKeys'),\n    getTag = require('./_getTag'),\n    isArguments = require('./isArguments'),\n    isArray = require('./isArray'),\n    isArrayLike = require('./isArrayLike'),\n    isBuffer = require('./isBuffer'),\n    isPrototype = require('./_isPrototype'),\n    isTypedArray = require('./isTypedArray');\n\n/** `Object#toString` result references. */\nvar mapTag = '[object Map]',\n    setTag = '[object Set]';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Checks if `value` is an empty object, collection, map, or set.\n *\n * Objects are considered empty if they have no own enumerable string keyed\n * properties.\n *\n * Array-like values such as `arguments` objects, arrays, buffers, strings, or\n * jQuery-like collections are considered empty if they have a `length` of `0`.\n * Similarly, maps and sets are considered empty if they have a `size` of `0`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is empty, else `false`.\n * @example\n *\n * _.isEmpty(null);\n * // => true\n *\n * _.isEmpty(true);\n * // => true\n *\n * _.isEmpty(1);\n * // => true\n *\n * _.isEmpty([1, 2, 3]);\n * // => false\n *\n * _.isEmpty({ 'a': 1 });\n * // => false\n */\nfunction isEmpty(value) {\n  if (value == null) {\n    return true;\n  }\n  if (isArrayLike(value) &&\n      (isArray(value) || typeof value == 'string' || typeof value.splice == 'function' ||\n        isBuffer(value) || isTypedArray(value) || isArguments(value))) {\n    return !value.length;\n  }\n  var tag = getTag(value);\n  if (tag == mapTag || tag == setTag) {\n    return !value.size;\n  }\n  if (isPrototype(value)) {\n    return !baseKeys(value).length;\n  }\n  for (var key in value) {\n    if (hasOwnProperty.call(value, key)) {\n      return false;\n    }\n  }\n  return true;\n}\n\nmodule.exports = isEmpty;\n","var toInteger = require('./toInteger');\n\n/**\n * Checks if `value` is an integer.\n *\n * **Note:** This method is based on\n * [`Number.isInteger`](https://mdn.io/Number/isInteger).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an integer, else `false`.\n * @example\n *\n * _.isInteger(3);\n * // => true\n *\n * _.isInteger(Number.MIN_VALUE);\n * // => false\n *\n * _.isInteger(Infinity);\n * // => false\n *\n * _.isInteger('3');\n * // => false\n */\nfunction isInteger(value) {\n  return typeof value == 'number' && value == toInteger(value);\n}\n\nmodule.exports = isInteger;\n","var baseGetTag = require('./_baseGetTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar numberTag = '[object Number]';\n\n/**\n * Checks if `value` is classified as a `Number` primitive or object.\n *\n * **Note:** To exclude `Infinity`, `-Infinity`, and `NaN`, which are\n * classified as numbers, use the `_.isFinite` method.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a number, else `false`.\n * @example\n *\n * _.isNumber(3);\n * // => true\n *\n * _.isNumber(Number.MIN_VALUE);\n * // => true\n *\n * _.isNumber(Infinity);\n * // => true\n *\n * _.isNumber('3');\n * // => false\n */\nfunction isNumber(value) {\n  return typeof value == 'number' ||\n    (isObjectLike(value) && baseGetTag(value) == numberTag);\n}\n\nmodule.exports = isNumber;\n","/** Used for built-in method references. */\nvar arrayProto = Array.prototype;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeReverse = arrayProto.reverse;\n\n/**\n * Reverses `array` so that the first element becomes the last, the second\n * element becomes the second to last, and so on.\n *\n * **Note:** This method mutates `array` and is based on\n * [`Array#reverse`](https://mdn.io/Array/reverse).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Array\n * @param {Array} array The array to modify.\n * @returns {Array} Returns `array`.\n * @example\n *\n * var array = [1, 2, 3];\n *\n * _.reverse(array);\n * // => [3, 2, 1]\n *\n * console.log(array);\n * // => [3, 2, 1]\n */\nfunction reverse(array) {\n  return array == null ? array : nativeReverse.call(array);\n}\n\nmodule.exports = reverse;\n"],"names":["defaultClassName","resolutionsFilter","syncWithMap","scales","className","onZoomLevelSelect","resolutions","passThroughProps","internalZoomLevel","setInternalZoomLevel","map","getOptionsFromMap","optionScales","view","viewResolutions","pushScale","s","r","v","scale","roundScale","currentZoomLevel","resolution","reversedResolutions","zoomListener","evt","zoom","roundZoom","Math","internalScales","finalClassName","selectedScale","mapView","calculatedResolution","parseInt","input","option","determineOptionKeyForZoomLevel","CSS_PREFIX","useMap","baseKeys","getTag","isArguments","isArray","isArrayLike","isBuffer","isPrototype","isTypedArray","hasOwnProperty","objectProto","Object","module","value","tag","key","toInteger","baseGetTag","isObjectLike","nativeReverse","arrayProto","Array","array"],"mappings":"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"}