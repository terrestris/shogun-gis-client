"use strict";(self.webpackChunk_terrestris_shogun_gis_client=self.webpackChunk_terrestris_shogun_gis_client||[]).push([["2637"],{94428:function(e,t,r){r.r(t);var a=r(76395),l=r.n(a),n=r(73319),s=r(1882),i=r.n(s),o=r(94092),u=r(99138),g=r.n(u),c=r(17936),f=r(59648),y=r(18635),d=r(30126),p=r(70198);let h=`${p.$}layertree`;t.default=({className:e,layerGroup:t,nodeTitleRenderer:r,filterFunction:s,onLayerVisibilityChanged:u,checkable:p=!0,draggable:k=!0,...L})=>{let[b,A]=(0,a.useState)([]),[C,v]=(0,a.useState)([]),m=(0,d.A)(),_=(0,a.useCallback)(()=>{if(!m)return[];let e=(t?y.A.getAllLayers(t):y.A.getAllLayers(m)).filter(e=>!(e instanceof g())&&e.getVisible());return s&&(e=e.filter(s)),e.map(o.getUid)},[s,t,m]),E=(0,a.useCallback)(e=>i()(r)?r(e):e.get("name"),[r]),B=(0,a.useCallback)(e=>{let t;if(m&&(!s||0!==[e].filter(s).length)){if(e instanceof g()){let r=e.getLayers().getArray();s&&(r=r.filter(s)),t=r.map(e=>B(e)).filter(e=>void 0!==e).toReversed()}return{key:(0,o.getUid)(e),title:l().createElement("div",{draggable:!0,onClick:e=>e.stopPropagation()},E(e)),className:y.A.layerInResolutionRange(e,m)?"":"out-of-range",children:t}}},[m,E,s]),I=(0,a.useCallback)(()=>m?(t||m.getLayerGroup()).getLayers().getArray().map(e=>B(e)).filter(e=>void 0!==e).toReversed():[],[t,m,B]),P=(0,a.useCallback)(()=>{v(I())},[I]),U=(0,a.useCallback)((e,t)=>{e instanceof g()?e.getLayers().forEach(e=>{U(e,t)}):e.setVisible(t)},[]),$=(0,a.useCallback)(()=>{A(_())},[_]),w=(0,a.useCallback)(()=>{v(I()),$()},[$,I]);(0,a.useEffect)(()=>{w()},[w]);let N=(0,a.useCallback)(e=>{if(s&&0===[e].filter(s).length)return[];let t=[];if(t.push(e.on("propertychange",w)),e instanceof g()){let r=e.getLayers();for(let a of(t.push(r.on("add",w)),t.push(r.on("remove",w)),t.push(e.on("change:layers",w)),r.getArray()))t.push(...N(a))}else t.push(e.on("change:visible",$));return t},[s,w,$]),R=(0,a.useCallback)(()=>m?N(t||m.getLayerGroup()):[],[t,m,N]);(0,a.useEffect)(()=>{let e=R();return()=>{(0,c.unByKey)(e)}},[C,R]),(0,a.useEffect)(()=>{if(!m)return;let e=m.getView().on("change:resolution",P);return()=>{(0,c.unByKey)(e)}},[m,P]);let D=(0,a.useCallback)((e,t)=>{if(!m)return;let r=t.node.key,a=t.checked;if(!r)return;let l=y.A.getLayerByOlUid(m,r);if(!l)return void f.A.error("Layer is not defined");U(l,a),i()(u)&&u(l,a)},[m,U,u]),K=(0,a.useCallback)(e=>{let t=e.node.key,r=e.dragNode.key,a=e.node.pos.split("-"),l=e.dropPosition,n=l-parseInt(a[a.length-1],10);if(!m)return;let s=y.A.getLayerByOlUid(m,r);if(!s)return void f.A.error("dragLayer is not defined");let i=y.A.getLayerByOlUid(m,t);if(!i)return void f.A.error("dropLayer is not defined");let o=y.A.getLayerPositionInfo(s,m);if(!o||!o?.groupLayer)return;let u=y.A.getLayerPositionInfo(i,m);if(!u||!u?.groupLayer)return;let c=o.groupLayer.getLayers(),d=u.groupLayer.getLayers();c.remove(s);let p=d.getArray().findIndex(e=>e===i);-1===n?l===d.getLength()-1?d.push(s):d.insertAt(p+1,s):0===n?i instanceof g()&&i.getLayers().push(s):1===n&&d.insertAt(p,s)},[m]),O=(0,a.useCallback)(e=>{let t=e.dropNode;return!(0===e.dropPosition&&!t.children)},[]),V=e?`${e} ${h}`:h;return l().createElement(n.A,{className:V,checkedKeys:b,onCheck:D,onDrop:K,allowDrop:O,selectable:!1,checkable:p,draggable:k,treeData:C,...L})}},70198:function(e,t,r){r.d(t,{$:function(){return a}});let a="react-geo-"}}]);
//# sourceMappingURL=2637.ced1f8c71730f59e.js.map