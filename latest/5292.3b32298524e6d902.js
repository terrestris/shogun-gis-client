"use strict";(self.webpackChunk_terrestris_shogun_gis_client=self.webpackChunk_terrestris_shogun_gis_client||[]).push([["5292"],{7323:function(e,t,n){n.r(t),n.d(t,{default:function(){return T},GeoLocationButton:function(){return S}});var r=n(9948),a=n.n(r),o=n(14293),i=n.n(o),s=n(16120),u=n.n(s),c=n(92588),l=n.n(c),g=n(12162),f=n.n(g),d=n(99973),m=n.n(d),h=n(35586),M=n.n(h),p=n(42893),b=n(41357),w=n.n(b),v=n(53220),y=n.n(v),C=n(50268),P=n.n(C),E=class{static radToDeg=e=>360*e/(2*Math.PI);static degToRad=e=>e*Math.PI*2/360;static mod=e=>(e%(2*Math.PI)+2*Math.PI)%(2*Math.PI)},Z=n(39660),k=n(49968),_=n.p+"6afbd13a3ce1b95d.png",I=n.p+"3380da3c8b677218.png",$=n(35703),N=n(32022);let S=({className:e,enableTracking:t=!1,follow:n=!1,onError:o=()=>void 0,onGeoLocationChange:s=()=>void 0,pressed:c,showMarker:g=!0,trackingOptions:d,...h})=>{(({active:e,enableTracking:t=!1,follow:n=!1,onError:a,onGeoLocationChange:o,showMarker:s=!1,trackingOptions:c={enableHighAccuracy:!0,maximumAge:1e4,timeout:6e5}})=>{let g=(0,Z.Z)(),[d,h]=(0,r.useState)(),b=(0,r.useMemo)(()=>new(f())([],"XYZM"),[]),v=(0,r.useMemo)(()=>new(u()),[]);(0,k.n)(()=>new(M())({properties:{name:"react-geo_geolocationlayer"},source:new(w())({features:[v]}),style:e=>{let t=e.get("heading"),n=Number.isFinite(t)&&0!==t?_:I,r=Number.isFinite(t)&&0!==t?t*Math.PI/180:0;return[new(P())({image:new(y())({rotation:r,src:n})})]}}),[],s&&e);let C=(0,r.useCallback)(e=>{let t=e.target,n=t.getPosition()??[0,0],r=t.getAccuracy(),a=t.getHeading()||0,i=t.getSpeed()||0,s=n[0],u=n[1],c=b.getCoordinates(),l=c[c.length-1],g=l&&l[2];if(g){let e=a-E.mod(g);Math.abs(e)>Math.PI&&(e=-(e>=0?1:-1)*(2*Math.PI-Math.abs(e))),a=g+e}b.appendCoordinate([s,u,a,Date.now()]),b.setCoordinates(b.getCoordinates().slice(-20));let f={position:n,accuracy:r,heading:a,speed:i};h(f),o?.(f)},[b,o]),$=(0,r.useMemo)(()=>e?new(l())({projection:g?.getView().getProjection()}):void 0,[e,g]),N=(0,r.useCallback)((e,t,n)=>{let r=(g?.getSize()??[0,0])[1];return[e[0]-Math.sin(t)*r*n/4,e[1]+Math.cos(t)*r*n/4]},[g]);return(0,r.useEffect)(()=>{if(!a||!$)return;let e=$.on("error",a);return()=>{(0,p.unByKey)(e)}},[$]),(0,r.useEffect)(()=>{if(!$)return;let e=$.on("change",C);return()=>{(0,p.unByKey)(e)}},[$,C]),(0,r.useEffect)(()=>{$?.setTracking(t)},[t,$]),(0,r.useEffect)(()=>{$?.setTrackingOptions(c)},[$,c]),(0,r.useEffect)(()=>{let e=Date.now()-750;e=Math.max(e,0);let t=b.getCoordinateAtM(e,!0);if(!i()(t)&&(n&&(g?.getView().setCenter(N([t[0],t[1]],-t[2],g?.getView().getResolution()??0)),g?.getView().setRotation(-t[2])),s)){let e=new(m())([t[0],t[1]]);v.setGeometry(e)}},[d,s,n,g,b,N,v])})({active:!!c,enableTracking:c&&t,follow:n,onError:o,onGeoLocationChange:s,showMarker:g,trackingOptions:d});let b=e?`${e} ${$.M}geolocationbutton`:`${$.M}geolocationbutton`;return a().createElement(N.Z,{pressed:c,className:b,...h})};var T=S},32022:function(e,t,n){var r=n(9948),a=n.n(r),o=n(40440),i=n(76534),s=n(35703);t.Z=({type:e="primary",pressed:t=!1,tooltipProps:n={mouseEnterDelay:1.5},className:r,tooltip:u,tooltipPlacement:c,pressedIcon:l,icon:g,children:f,value:d,onClick:m,onChange:h=()=>void 0,...M})=>{let p=`${s.M}togglebutton`,b=r?`${r} ${p}`:p,w="";return t&&(w=" btn-pressed"),a().createElement(o.Z,{title:u,placement:c,...n},a().createElement(i.ZP,{type:e,onClick:e=>{m&&(m(e),e.defaultPrevented)||h(e,d)},onChange:h,className:`${b}${w}`,"aria-pressed":t,icon:t?l:g,...M},f))}},35703:function(e,t,n){n.d(t,{M:function(){return r}});let r="react-geo-"},33071:function(e,t,n){var r=n(9948);t.Z=n.n(r)().createContext(null)},39660:function(e,t,n){n.d(t,{S:function(){return o}});var r=n(9948),a=n(33071);let o=()=>(0,r.useContext)(a.Z);t.Z=o},49968:function(e,t,n){n.d(t,{n:function(){return i}});var r=n(9948),a=n(96486),o=n(39660);let i=(e,t,n)=>{let i=(0,o.Z)(),[s,u]=(0,r.useState)();return(0,r.useEffect)(()=>{if(!i)return;let t=e();if(t)return i.addLayer(t),u(t),()=>{i.removeLayer(t),u(void 0)}},[i,...t]),(0,r.useEffect)(()=>{!s||(0,a.isNil)(n)||s.setVisible(n)},[s,n]),s};t.Z=i}}]);
//# sourceMappingURL=5292.3b32298524e6d902.js.map