"use strict";(self.webpackChunk_terrestris_shogun_gis_client=self.webpackChunk_terrestris_shogun_gis_client||[]).push([["6717"],{54072:function(t,e,i){i.d(e,{Ps:function(){return O},ZP:function(){return j},r6:function(){return S}});var n=i(2022),r=i(11256),s=i(79682),a=i(9520),o=i(73381),u=i(21915),l=i(21882),h=i(5374),g=i(13002),c=i(52209);function d(t){return Array.isArray(t)?Math.min(...t):t}var _=i(56245),f=i(35211);class E extends n.ZP{constructor(t,e,i,n,s,a,o){let l=t.getExtent();l&&t.canWrapX()&&((l=l.slice())[0]=-1/0,l[2]=1/0);let h=e.getExtent();h&&e.canWrapX()&&((h=h.slice())[0]=-1/0,h[2]=1/0);let g=h?(0,u.getIntersection)(i,h):i,d=(0,u.getCenter)(g),E=(0,c.aA)(t,e,d,n),m=f.m,p=new _.Z(t,e,g,l,E*m,n),R=p.calculateSourceExtent(),I=(0,u.isEmpty)(R)?null:a(R,E,s),S=I?r.default.IDLE:r.default.EMPTY,O=I?I.getPixelRatio():1;super(i,n,O,S),this.targetProj_=e,this.maxSourceExtent_=l,this.triangulation_=p,this.targetResolution_=n,this.targetExtent_=i,this.sourceImage_=I,this.sourcePixelRatio_=O,this.interpolate_=o,this.canvas_=null,this.sourceListenerKey_=null}disposeInternal(){this.state==r.default.LOADING&&this.unlistenSource_(),super.disposeInternal()}getImage(){return this.canvas_}getProjection(){return this.targetProj_}reproject_(){let t=this.sourceImage_.getState();if(t==r.default.LOADED){let t=(0,u.getWidth)(this.targetExtent_)/this.targetResolution_,e=(0,u.getHeight)(this.targetExtent_)/this.targetResolution_;this.canvas_=(0,c.sY)(t,e,this.sourcePixelRatio_,d(this.sourceImage_.getResolution()),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0,void 0,this.interpolate_,!0)}this.state=t,this.changed()}load(){if(this.state==r.default.IDLE){this.state=r.default.LOADING,this.changed();let t=this.sourceImage_.getState();t==r.default.LOADED||t==r.default.ERROR?this.reproject_():(this.sourceListenerKey_=(0,g.oL)(this.sourceImage_,o.default.CHANGE,t=>{let e=this.sourceImage_.getState();(e==r.default.LOADED||e==r.default.ERROR)&&(this.unlistenSource_(),this.reproject_())}),this.sourceImage_.load())}}unlistenSource_(){(0,g.bN)(this.sourceListenerKey_),this.sourceListenerKey_=null}}var m=i(71405),p=i(14431);class R extends a.default{constructor(t,e){super(t),this.image=e}}class I extends m.default{constructor(t){super({attributions:t.attributions,projection:t.projection,state:t.state,interpolate:void 0===t.interpolate||t.interpolate}),this.on,this.once,this.un,this.loader=t.loader||null,this.resolutions_=void 0!==t.resolutions?t.resolutions:null,this.reprojectedImage_=null,this.reprojectedRevision_=0,this.image=null,this.wantedExtent_,this.wantedResolution_,this.static_=!!t.loader&&0===t.loader.length,this.wantedProjection_=null}getResolutions(){return this.resolutions_}setResolutions(t){this.resolutions_=t}findNearestResolution(t){let e=this.getResolutions();if(e){let i=(0,s.h7)(e,t,0);t=e[i]}return t}getImage(t,e,i,n){let r=this.getProjection();if(!r||!n||(0,h.equivalent)(r,n))return r&&(n=r),this.getImageInternal(t,e,i,n);if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&(0,h.equivalent)(this.reprojectedImage_.getProjection(),n)&&this.reprojectedImage_.getResolution()==e&&(0,u.equals)(this.reprojectedImage_.getExtent(),t))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new E(r,n,t,e,i,(t,e,i)=>this.getImageInternal(t,e,i,r),this.getInterpolate()),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}getImageInternal(t,e,i,r){if(this.loader){let s=O(t,e,i,1),a=this.findNearestResolution(e);if(this.image&&(this.static_||this.wantedProjection_===r&&(this.wantedExtent_&&(0,u.containsExtent)(this.wantedExtent_,s)||(0,u.containsExtent)(this.image.getExtent(),s))&&(this.wantedResolution_&&d(this.wantedResolution_)===a||d(this.image.getResolution())===a)))return this.image;this.wantedProjection_=r,this.wantedExtent_=s,this.wantedResolution_=a,this.image=new n.ZP(s,a,i,this.loader),this.image.addEventListener(o.default.CHANGE,this.handleImageChange.bind(this))}return this.image}handleImageChange(t){let e,i=t.target;switch(i.getState()){case r.default.LOADING:this.loading=!0,e="imageloadstart";break;case r.default.LOADED:this.loading=!1,e="imageloadend";break;case r.default.ERROR:this.loading=!1,e="imageloaderror";break;default:return}this.hasListener(e)&&this.dispatchEvent(new R(e,i))}}function S(t,e){t.getImage().src=e}function O(t,e,i,n){let r=e/i,s=(0,u.getCenter)(t),a=(0,l.mD)((0,u.getWidth)(t)/r,p.L),o=(0,l.mD)((0,u.getHeight)(t)/r,p.L),h=(0,l.mD)((n-1)*a/2,p.L),g=(0,l.mD)((n-1)*o/2,p.L);return(0,u.getForViewAndSize)(s,r,0,[a+2*h,o+2*g])}var j=I},14431:function(t,e,i){i.d(e,{L:function(){return n}});let n=4},49081:function(t,e,i){i.d(e,{Ke:function(){return E},Q4:function(){return _},QL:function(){return m},YT:function(){return p},eQ:function(){return g},jt:function(){return f}});var n=i(2022),r=i(21915),s=i(21882),a=i(5374),o=i(79313),u=i(78487),l=i(54072),h=i(14431);let g="1.3.0",c=[101,101];function d(t,e,i,n,r){r.WIDTH=i[0],r.HEIGHT=i[1];let s=n.getAxisOrientation(),a=(0,o.n)(r.VERSION,"1.3")>=0;return r[a?"CRS":"SRS"]=n.getCode(),r.BBOX=(a&&s.startsWith("ne")?[e[1],e[0],e[3],e[2]]:e).join(","),(0,u.B5)(t,r)}function _(t,e,i,n,a,o,u){o=Object.assign({REQUEST:"GetMap"},o);let l=e/i,g=[(0,s.NM)((0,r.getWidth)(t)/l,h.L),(0,s.NM)((0,r.getHeight)(t)/l,h.L)];if(1!=i)switch(u){case"geoserver":let c=90*i+.5|0;"FORMAT_OPTIONS"in o?o.FORMAT_OPTIONS+=";dpi:"+c:o.FORMAT_OPTIONS="dpi:"+c;break;case"mapserver":o.MAP_RESOLUTION=90*i;break;case"carmentaserver":case"qgis":o.DPI=90*i;break;default:throw Error("Unknown `serverType` configured")}return d(a,t,g,n,o)}function f(t,e){return Object.assign({REQUEST:e,SERVICE:"WMS",VERSION:g,FORMAT:"image/png",STYLES:"",TRANSPARENT:"TRUE"},t)}function E(t){let e=void 0===t.hidpi||t.hidpi,i=(0,a.get)(t.projection||"EPSG:3857"),r=t.ratio||1.5,s=t.load||n.Jx,o=t.crossOrigin??null;return(n,a,u)=>{n=(0,l.Ps)(n,a,u,r),1==u||e&&void 0!==t.serverType||(u=1);let h=_(n,a,u,i,t.url,f(t.params,"GetMap"),t.serverType),g=new Image;return g.crossOrigin=o,s(g,h).then(t=>({image:t,extent:n,pixelRatio:u}))}}function m(t,e,i){if(void 0===t.url)return;let n=(0,a.get)(t.projection||"EPSG:3857"),u=(0,r.getForViewAndSize)(e,i,0,c),l={QUERY_LAYERS:t.params.LAYERS,INFO_FORMAT:"application/json"};Object.assign(l,f(t.params,"GetFeatureInfo"),t.params);let g=(0,s.GW)((e[0]-u[0])/i,h.L),_=(0,s.GW)((u[3]-e[1])/i,h.L),E=(0,o.n)(l.VERSION,"1.3")>=0;return l[E?"I":"X"]=g,l[E?"J":"Y"]=_,d(t.url,u,c,n,l)}function p(t,e){if(void 0===t.url)return;let i={SERVICE:"WMS",VERSION:g,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(void 0!==e&&(i.SCALE=e*((0,a.get)(t.projection||"EPSG:3857").getMetersPerUnit()||1)/28e-5),Object.assign(i,t.params),void 0!==t.params&&void 0===i.LAYER){let t=i.LAYERS;if(!(!Array.isArray(t)||1!==t.length))return;i.LAYER=t}return(0,u.B5)(t.url,i)}},49179:function(t,e,i){function n(){throw Error("Unimplemented abstract method.")}i.r(e),i.d(e,{VERSION:function(){return a},abstract:function(){return n},getUid:function(){return s}});let r=0;function s(t){return t.ol_uid||(t.ol_uid=String(++r))}let a="10.6.1"}}]);
//# sourceMappingURL=6717.258797ba8836f0a7.js.map