(self.webpackChunk_terrestris_shogun_gis_client=self.webpackChunk_terrestris_shogun_gis_client||[]).push([["681"],{26058:function(e,r,t){var a={"./af":"42786","./af.js":"42786","./ar":"30867","./ar-dz":"14130","./ar-dz.js":"14130","./ar-kw":"96135","./ar-kw.js":"96135","./ar-ly":"56440","./ar-ly.js":"56440","./ar-ma":"47702","./ar-ma.js":"47702","./ar-ps":"20315","./ar-ps.js":"20315","./ar-sa":"16040","./ar-sa.js":"16040","./ar-tn":"37100","./ar-tn.js":"37100","./ar.js":"30867","./az":"31083","./az.js":"31083","./be":"9808","./be.js":"9808","./bg":"68338","./bg.js":"68338","./bm":"67438","./bm.js":"67438","./bn":"8905","./bn-bd":"76225","./bn-bd.js":"76225","./bn.js":"8905","./bo":"11560","./bo.js":"11560","./br":"1278","./br.js":"1278","./bs":"80622","./bs.js":"80622","./ca":"2468","./ca.js":"2468","./cs":"5822","./cs.js":"5822","./cv":"50877","./cv.js":"50877","./cy":"47373","./cy.js":"47373","./da":"24780","./da.js":"24780","./de":"59740","./de-at":"60217","./de-at.js":"60217","./de-ch":"60894","./de-ch.js":"60894","./de.js":"59740","./dv":"5300","./dv.js":"5300","./el":"50837","./el.js":"50837","./en-au":"78348","./en-au.js":"78348","./en-ca":"77925","./en-ca.js":"77925","./en-gb":"22243","./en-gb.js":"22243","./en-ie":"46436","./en-ie.js":"46436","./en-il":"47207","./en-il.js":"47207","./en-in":"44175","./en-in.js":"44175","./en-nz":"76319","./en-nz.js":"76319","./en-sg":"31662","./en-sg.js":"31662","./eo":"92915","./eo.js":"92915","./es":"55655","./es-do":"55251","./es-do.js":"55251","./es-mx":"96112","./es-mx.js":"96112","./es-us":"71146","./es-us.js":"71146","./es.js":"55655","./et":"5603","./et.js":"5603","./eu":"77763","./eu.js":"77763","./fa":"76959","./fa.js":"76959","./fi":"11897","./fi.js":"11897","./fil":"42549","./fil.js":"42549","./fo":"94694","./fo.js":"94694","./fr":"94470","./fr-ca":"63049","./fr-ca.js":"63049","./fr-ch":"52330","./fr-ch.js":"52330","./fr.js":"94470","./fy":"5044","./fy.js":"5044","./ga":"29295","./ga.js":"29295","./gd":"2101","./gd.js":"2101","./gl":"38794","./gl.js":"38794","./gom-deva":"27884","./gom-deva.js":"27884","./gom-latn":"23168","./gom-latn.js":"23168","./gu":"95349","./gu.js":"95349","./he":"24206","./he.js":"24206","./hi":"30094","./hi.js":"30094","./hr":"30316","./hr.js":"30316","./hu":"22138","./hu.js":"22138","./hy-am":"11423","./hy-am.js":"11423","./id":"29218","./id.js":"29218","./is":"90135","./is.js":"90135","./it":"90626","./it-ch":"10150","./it-ch.js":"10150","./it.js":"90626","./ja":"39183","./ja.js":"39183","./jv":"24286","./jv.js":"24286","./ka":"12105","./ka.js":"12105","./kk":"47772","./kk.js":"47772","./km":"18758","./km.js":"18758","./kn":"79282","./kn.js":"79282","./ko":"33730","./ko.js":"33730","./ku":"1408","./ku-kmr":"90563","./ku-kmr.js":"90563","./ku.js":"1408","./ky":"33291","./ky.js":"33291","./lb":"36841","./lb.js":"36841","./lo":"55466","./lo.js":"55466","./lt":"57010","./lt.js":"57010","./lv":"37595","./lv.js":"37595","./me":"39861","./me.js":"39861","./mi":"35493","./mi.js":"35493","./mk":"95966","./mk.js":"95966","./ml":"87341","./ml.js":"87341","./mn":"5115","./mn.js":"5115","./mr":"10370","./mr.js":"10370","./ms":"9847","./ms-my":"41237","./ms-my.js":"41237","./ms.js":"9847","./mt":"72126","./mt.js":"72126","./my":"56165","./my.js":"56165","./nb":"64924","./nb.js":"64924","./ne":"16744","./ne.js":"16744","./nl":"93901","./nl-be":"59814","./nl-be.js":"59814","./nl.js":"93901","./nn":"83877","./nn.js":"83877","./oc-lnc":"92135","./oc-lnc.js":"92135","./pa-in":"15858","./pa-in.js":"15858","./pl":"64495","./pl.js":"64495","./pt":"89520","./pt-br":"57971","./pt-br.js":"57971","./pt.js":"89520","./ro":"15453","./ro.js":"15453","./ru":"21793","./ru.js":"21793","./sd":"40950","./sd.js":"40950","./se":"10490","./se.js":"10490","./si":"90124","./si.js":"90124","./sk":"64249","./sk.js":"64249","./sl":"14985","./sl.js":"14985","./sq":"51104","./sq.js":"51104","./sr":"49131","./sr-cyrl":"79915","./sr-cyrl.js":"79915","./sr.js":"49131","./ss":"95606","./ss.js":"95606","./sv":"98760","./sv.js":"98760","./sw":"91172","./sw.js":"91172","./ta":"27333","./ta.js":"27333","./te":"23110","./te.js":"23110","./tet":"52095","./tet.js":"52095","./tg":"27321","./tg.js":"27321","./th":"9041","./th.js":"9041","./tk":"19005","./tk.js":"19005","./tl-ph":"75768","./tl-ph.js":"75768","./tlh":"89444","./tlh.js":"89444","./tr":"72397","./tr.js":"72397","./tzl":"28254","./tzl.js":"28254","./tzm":"51106","./tzm-latn":"30699","./tzm-latn.js":"30699","./tzm.js":"51106","./ug-cn":"9288","./ug-cn.js":"9288","./uk":"67691","./uk.js":"67691","./ur":"13795","./ur.js":"13795","./uz":"6791","./uz-latn":"60588","./uz-latn.js":"60588","./uz.js":"6791","./vi":"65666","./vi.js":"65666","./x-pseudo":"14378","./x-pseudo.js":"14378","./yo":"75805","./yo.js":"75805","./zh-cn":"83839","./zh-cn.js":"83839","./zh-hk":"55726","./zh-hk.js":"55726","./zh-mo":"99807","./zh-mo.js":"99807","./zh-tw":"74152","./zh-tw.js":"74152"};function n(e){return t(i(e))}function i(e){if(!t.o(a,e)){var r=Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}return a[e]}n.keys=function(){return Object.keys(a)},n.resolve=i,e.exports=n,n.id="26058"},89006:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return aX},App:function(){return aH}});var a,n=t("58106"),i=t("32206"),l=t("91439"),s=t("46439"),o=t("85893"),u=t("9948"),c=t.n(u),d=t("92485"),f=t("87719"),p=t("65353"),m=t("79718"),g=t("58155"),v=t("77802"),h=t("45037"),y=t("88983"),j=t("62530"),x=t("49179"),b=t("21730"),w=t.n(b),S=t("36472"),_=t.n(S),C=t("9026"),E=t.n(C),k=t("29435"),L=t("12038"),N=t("92212"),F=t("49413"),T=t("54388"),P=t("20164"),Z=t.n(P),M=t("39660"),D=t("4649"),A=()=>(0,D.useDispatch)(),O=D.useSelector,U=t("56511"),I=e=>{var r,t=(0,n._)({},(0,i._)(e)),a=(0,f._)((0,u.useState)(!1),2),c=a[0],b=a[1],S=(0,f._)((0,u.useState)([]),2),C=S[0],P=S[1],D=(0,f._)((0,u.useState)([]),2),I=D[0],G=D[1],R=(0,f._)((0,u.useState)(""),2),$=R[0],B=R[1],V=(0,f._)((0,u.useState)("https://sgx.geodatenzentrum.de/wms_topplus_open"),2),z=V[0],J=V[1],W=(0,f._)((0,u.useState)(),2),K=W[0],q=W[1],Y=(0,f._)((0,u.useState)("1.3.0"),2),H=Y[0],X=Y[1],Q=O(e=>e.addLayerModal.visible),ee=A(),er=(0,M.S)(),et=(0,k.useTranslation)().t;(0,u.useEffect)(()=>{if(!!Q)q(N.V.createValidGetCapabilitiesRequest(z,"WMS",H))},[H,Q,z]);var ea=(r=(0,d._)(function(){var e,r;return(0,p.Jh)(this,function(t){switch(t.label){case 0:if(!K)return[2];t.label=1;case 1:return t.trys.push([1,3,4,5]),b(!0),[4,F.Z.getWmsCapabilities(K)];case 2:return e=t.sent(),P(F.Z.getLayersFromWmsCapabilities(e,"Title")),[3,5];case 3:return r=t.sent(),m.ZP.error({message:et("AddLayerModal.errorMessage"),description:et("AddLayerModal.errorDescription")}),L.Z.error(r),[3,5];case 4:return b(!1),[7];case 5:return[2]}})}),function(){return r.apply(this,arguments)}),en=()=>{G([]),P([]),ee((0,U.Cp)())},ei=e=>{if(!!er){var r=et("AddLayerModal.externalWmsFolder"),t=T.C.getLayerByName(er,r),a=!!t;if(!t&&(t=new(w())({layers:[]})).set("name",r),e.forEach(e=>{if(!t.getLayers().getArray().includes(e)){if(e.set("isExternalLayer",!0),e instanceof _()&&(a=null===(n=e.getSource())||void 0===n?void 0:n.getUrl()),e instanceof E()){var r,a,n,i,l=null===(i=e.getSource())||void 0===i?void 0:i.getUrls();a=(null==l?void 0:l.length)===1?l[0]:void 0}var s={name:e.get("name"),type:e instanceof E()?"TILEWMS":"WMS",opacity:e.getOpacity(),sourceConfig:{layerNames:null===(r=e.getSource())||void 0===r?void 0:r.getParams().LAYERS,url:a,useBearerToken:!1}};e.set("layerConfig",s),t.getLayers().push(e)}}),!a){var n=er.getLayerGroup().getLayers();n.insertAt((null==n?void 0:n.getLength())||0,t)}en()}};return(0,o.jsxs)(g.Z,(0,s._)((0,l._)({className:"add-layer-modal",title:et("AddLayerModal.title"),open:Q,onCancel:en,width:600,footer:[(0,o.jsx)(Z(),{"aria-label":"add-all",disabled:(null==C?void 0:C.length)<1,onClick:()=>{ei(C)},children:et("AddLayerModal.addAllLayers")},"add-all"),(0,o.jsx)(Z(),{"aria-label":"add-selected",disabled:(null==I?void 0:I.length)<1,onClick:()=>{ei(C.filter(e=>I.includes((0,x.getUid)(e))))},children:et("AddLayerModal.addSelectedLayers")},"add-selected")]},t),{children:[(0,o.jsx)("span",{children:et("AddLayerModal.requestWmsGetCapabilitiesInstruction")}),(0,o.jsx)(v.Z.Search,{"aria-label":"input-search",className:"url-input",placeholder:et("AddLayerModal.inputPlaceholder"),value:z,onChange:e=>{var r=e.target.value;B(N.V.isValid(r.trim())?"":"error"),J(e.target.value)},onSearch:ea,status:$,enterButton:!0,addonBefore:(0,o.jsx)(h.Z,{"aria-label":"select-version",defaultValue:"1.3.0",onChange:X,options:[{value:"1.3.0",label:`${et("AddLayerModal.version")} 1.3.0`},{value:"1.1.1",label:`${et("AddLayerModal.version")} 1.1.1`}]})}),""!==$&&(0,o.jsx)(y.Z,{className:"error",children:et("AddLayerModal.invalidUrlErrorMsg")}),(0,o.jsx)(j.Z,{"aria-label":"wms-table",loading:c,columns:[{title:et("AddLayerModal.columnTitle"),render:(e,r)=>r.get("title")}],scroll:{y:250},rowKey:e=>(0,x.getUid)(e),rowSelection:{selectedRowKeys:I,onChange:G},pagination:!1,dataSource:C})]}))},G=t("7925"),R=t("70413"),$=t("17126"),B=()=>(0,u.useContext)($.ZP),V=e=>{var r=(0,n._)({},(0,i._)(e)),t=(0,M.S)(),a=B(),c=(0,k.useTranslation)(),d=c.t,f=c.i18n;(0,u.useEffect)(()=>{if(!t)return;var e=T.C.getLayersByProperty(t,"isExternalLayerGroup",!0);if((null==e?void 0:e.length)===1){var r=e[0],a=e[0].get("name");r.set("name",d("AddLayerModal.externalWmsFolder"));var n=new G.ObjectEvent("change:layers","name",a);r.dispatchEvent(n)}},[f.language,t,d]);var p=[];return(a&&a.forEach(e=>{var r;if((r=e.integration)&&"map"===r.placement){var t=e.key,a=e.wrappedComponent;p.push((0,o.jsx)(a,{},t))}}),t)?(0,o.jsx)(R.MapComponent,(0,s._)((0,l._)({map:t},r),{children:p})):(0,o.jsx)(o.Fragment,{})},z=t("30143"),J=()=>{var e=B(),r=(0,k.useTranslation)().t,t=()=>{var r=null;return e.forEach(e=>{var t;if((t=e.integration)&&"cookie-banner"===t.placement){var a=e.key,n=e.wrappedComponent;r=(0,o.jsx)(n,{},a)}}),r};return(0,o.jsx)(z.Gk,{disableStyles:!0,location:"bottom",buttonText:r("CookieBanner.button"),cookieName:"SHOGun-Session-Cookie",buttonClasses:"cookie-button",containerClasses:"cookie-container",contentClasses:"cookie-content",expires:150,children:t()?t():r("CookieBanner.info")},"default-cookie-consent")},W=t("33357"),K=t("87617"),q=t.n(K),Y=t("42151"),H=t.n(Y),X=t("68191"),Q=t("67549"),ee=t.n(Q),er=t("24194"),et=t.n(er),ea=t("78459"),en=t("71797"),ei=()=>{var e,r=(0,en.Z)(),t=e=>["wfs:FAILED","ows:ExceptionReport"].some(r=>e.getElementsByTagName(r).length>0);return(0,u.useCallback)((e=(0,d._)(function(e){var a,n,i,s,o,u,c;return(0,p.Jh)(this,function(d){switch(d.label){case 0:if((i=e.layer.getSource())instanceof ee()&&(n=i.getUrl()),i instanceof et()&&(n=(s=i.getUrls())?s[0]:void 0),!n)return[2];return n.endsWith("?")&&(n=n.slice(0,-1)),o={"Content-Type":"application/xml"},[4,fetch(n,{method:"POST",headers:(null===(a=e.layer)||void 0===a?void 0:a.get("useBearerToken"))?(0,l._)({},o,(0,ea.a)(null==r?void 0:r.getKeycloak())):o,body:new XMLSerializer().serializeToString(e.transaction)})];case 1:if(!(u=d.sent()).ok)throw Error("No successful response while executing a WFS-Transaction");return[4,u.text()];case 2:if(c=d.sent(),t(new DOMParser().parseFromString(c,"text/xml")))throw Error(`Something failed: ${c}`);return[2,c]}})}),function(r){return e.apply(this,arguments)}),[r])},el=t("50361"),es=t.n(el),eo=t("30381"),eu=t.n(eo),ec=t("33905"),ed=t("26257"),ef=t.n(ed),ep=t("91007"),em=t("70033"),eg=t("19478"),ev=t("96935"),eh=t("36192"),ey=t("96973"),ej=t("23279"),ex=t.n(ej),eb=t("14293"),ew=t.n(eb),eS=t("13218"),e_=t.n(eS),eC=t("63364"),eE=t("47037"),ek=t.n(eE),eL=t("24512"),eN=t("76534"),eF=t("58548"),eT=e=>{var r,t,a=e.readOnly,n=e.fieldConfig,i=(0,ep._)(e,["readOnly","fieldConfig"]),u=(0,en.Z)(),c=(0,k.useTranslation)().t;var f=(r=(0,d._)(function(e){var r,t,a,n,i,s;return(0,p.Jh)(this,function(o){switch(o.label){case 0:if(!u)return[2];if(t=null==(r=e.response)?void 0:r.fileName,a=`/files/${null==r?void 0:r.fileUuid}`,ew()(t)||ew()(null==r?void 0:r.fileUuid))return[2];return n=document.createElement("a"),document.body.appendChild(n),[4,fetch(a,{headers:(0,l._)({},(0,ea.a)(u.getKeycloak()))})];case 1:return[4,o.sent().blob()];case 2:return i=o.sent(),s=window.URL.createObjectURL(i),n.href=s,n.download=t,n.click(),window.URL.revokeObjectURL(s),[2]}})}),function(e){return r.apply(this,arguments)});var m=(t=(0,d._)(function(e){var r,t;return(0,p.Jh)(this,function(a){switch(a.label){case 0:if(!(t=null==e?void 0:null===(r=e.response)||void 0===r?void 0:r.fileUuid))return[3,2];return[4,fetch(`${null==u?void 0:u.getBasePath()}files/${t}`,{method:"DELETE",credentials:"same-origin",headers:(0,l._)({},(0,eF.y)(),(0,ea.a)(null==u?void 0:u.getKeycloak()))})];case 1:return[2,a.sent()];case 2:return[2]}})}),function(e){return t.apply(this,arguments)});return u?(0,o.jsx)(eL.Z,(0,s._)((0,l._)({multiple:!0,name:"file",action:"/files/uploadToFileSystem",withCredentials:!0,headers:(0,l._)({},(0,eF.y)(),(0,ea.a)(u.getKeycloak())),onRemove:m,onPreview:f},null==n?void 0:n.fieldProps,i),{children:!(void 0!==a&&a)&&(0,o.jsx)(eN.ZP,{children:c("FileUpload.upload")})})):(0,o.jsx)(o.Fragment,{})},eP=t("84131"),eZ=t("62163"),eM=t("76383"),eD=()=>{var e,r=(0,en.Z)();return(0,u.useCallback)((e=(0,d._)(function(e){var t;return(0,p.Jh)(this,function(a){switch(a.label){case 0:if(ew()(e))return[2,Promise.reject()];return[4,fetch(e,{credentials:"include",headers:(0,l._)({},(0,ea.a)(null==r?void 0:r.getKeycloak()))})];case 1:return[4,a.sent().blob()];case 2:return t=a.sent(),[2,new Promise((e,r)=>{try{var a=new FileReader;a.onload=function(){e(this.result)},a.readAsDataURL(t)}catch(e){r(e)}})]}})}),function(r){return e.apply(this,arguments)}),[r])},eA=e=>{var r,t,a=e.fieldConfig,n=e.readOnly,i=void 0!==n&&n,c=e.initialFileList,m=(0,ep._)(e,["fieldConfig","readOnly","initialFileList"]),v=(0,f._)((0,u.useState)(!1),2),h=v[0],y=v[1],j=(0,f._)((0,u.useState)(""),2),x=j[0],b=j[1],w=(0,f._)((0,u.useState)(),2),S=w[0],_=w[1],C=(0,en.Z)(),E=eD(),L=(0,k.useTranslation)().t;(0,eM.b)((0,d._)(function(){return(0,p.Jh)(this,function(e){switch(e.label){case 0:var r;if(!c||0===c.length)return[2];return r=(0,d._)(function(e){return(0,p.Jh)(this,function(r){switch(r.label){case 0:var t;return[4,Promise.all(e.map((t=(0,d._)(function(e){var r,t,a;return(0,p.Jh)(this,function(n){switch(n.label){case 0:return t=[(0,l._)({},e)],a={},[4,E(`${null==C?void 0:C.getBasePath()}imagefiles/${null==e?void 0:null===(r=e.response)||void 0===r?void 0:r.fileUuid}/thumbnail`)];case 1:return[2,s._.apply(void 0,t.concat([(a.thumbUrl=n.sent(),a.url=void 0,a)]))]}})}),function(e){return t.apply(this,arguments)})))];case 1:return[2,r.sent()]}})}),[4,function(e){return r.apply(this,arguments)}(c)];case 1:return _(e.sent()),[2]}})}),[null==c?void 0:c.length]);var N=(r=(0,d._)(function(e){var r;return(0,p.Jh)(this,function(t){switch(t.label){case 0:if(r=e.response,ew()(r)||ew()(null==r?void 0:r.fileUuid))return[2];return[4,E(`${null==C?void 0:C.getBasePath()}imagefiles/${r.fileUuid}`)];case 1:return b(t.sent()),y(!0),[2]}})}),function(e){return r.apply(this,arguments)});var F=(t=(0,d._)(function(e){var r,t;return(0,p.Jh)(this,function(a){switch(a.label){case 0:if(!(t=null==e?void 0:null===(r=e.response)||void 0===r?void 0:r.fileUuid))return[3,2];return[4,fetch(`${null==C?void 0:C.getBasePath()}imagefiles/${t}`,{method:"DELETE",credentials:"same-origin",headers:(0,l._)({},(0,eF.y)(),(0,ea.a)(null==C?void 0:C.getKeycloak()))})];case 1:return[2,a.sent()];case 2:return[2]}})}),function(e){return t.apply(this,arguments)});return C?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(eL.Z,(0,s._)((0,l._)({accept:"image/*",multiple:!0,name:"file",action:`${C.getBasePath()}imagefiles/uploadToFileSystem`,withCredentials:!0,listType:"picture-card",headers:(0,l._)({},(0,eF.y)(),(0,ea.a)(C.getKeycloak())),onRemove:F,onPreview:N,fileList:i?S:void 0},null==a?void 0:a.fieldProps,m),{children:!i&&(0,o.jsxs)("div",{children:[(0,o.jsx)(eZ.G,{icon:eP.r8p}),(0,o.jsx)("div",{style:{marginTop:8},children:L("ImageUpload.upload")})]})})),(0,o.jsx)(g.Z,{open:h,footer:null,onCancel:()=>y(!1),children:(0,o.jsx)("img",{alt:"example",style:{width:"100%"},src:x})})]}):(0,o.jsx)(o.Fragment,{})},eO=t("50963"),eU=e=>{var r=e.feature,t=e.formConfig,a=(0,ep._)(e,["feature","formConfig"]),n=(0,f._)((0,eO.useForm)(),1)[0];return(0,u.useEffect)(()=>{n.resetFields(),n.setFieldsValue(r.getProperties())},[r,n]),(0,o.jsx)(em.Z,(0,s._)((0,l._)({className:"feature-info-form",form:n,labelCol:{span:8},labelAlign:"left",labelWrap:!0},a),{children:null==t?void 0:t.map(e=>(0,o.jsx)(em.Z.Item,{name:e.propertyName,label:e.displayName||e.propertyName,children:(0,o.jsx)(eG,(0,l._)({label:e.displayName||e.propertyName},e.fieldProps))},e.propertyName))}))},eI=e=>{var r,t=e.value,a=e.referenceConfig,n=(0,ep._)(e,["value","referenceConfig"]),i=(0,f._)((0,u.useState)(!1),2),s=i[0],c=i[1],m=(0,f._)((0,u.useState)(),2),v=m[0],h=m[1],y=(0,k.useTranslation)().t,x=e=>{if(null==a?void 0:a.tablePropertyName){var r=/{{(.*?)}}/g;if(null==a?void 0:a.tablePropertyName.match(r)){for(var t,n=null==a?void 0:a.tablePropertyName;t=r.exec(null==a?void 0:a.tablePropertyName);)n=n.replace(t[0],e[t[1]]);return n}return e[null==a?void 0:a.tablePropertyName]}if(e.id)return e.id},b=[{width:"100%",render:(e,r)=>x(r)?x(r):y("ReferenceTable.defaultRowPlaceholder")},{render:(e,r)=>(0,o.jsx)(eN.ZP,{onClick:()=>w(e,r),icon:(0,o.jsx)(eZ.G,{icon:eP.IA$})})}],w=(e,r)=>{var t=new(H());t.setProperties(r),h(t),c(!0)};var S=(r=(0,d._)(function(){return(0,p.Jh)(this,function(e){return c(!1),h(void 0),[2]})}),function(){return r.apply(this,arguments)});return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(j.Z,(0,l._)({size:"small",showHeader:!1,pagination:!1,columns:b,rowKey:"id",dataSource:(()=>{if(!t)return[];try{var e=JSON.parse(t);if(Array.isArray(e))return e;if(null==e||"number"==typeof e||"boolean"==typeof e||"string"==typeof e)return L.Z.warn("Unsupported value given"),[];if("object"==typeof e)return[e]}catch(e){return L.Z.warn("Error while parsing the table data ",e),[]}})()},n)),(0,o.jsx)(g.Z,{className:"reference-table-modal",open:s,maskClosable:!1,footer:null,width:600,destroyOnClose:!0,title:(()=>{if(!v)return y("ReferenceTable.defaultModalTitle");var e=x(v.getProperties());return e?`${y("ReferenceTable.modalTitle",{referenceValue:e})}`:y("ReferenceTable.defaultModalTitle")})(),onCancel:S,children:v&&(0,o.jsx)(eU,{feature:v,formConfig:null==a?void 0:a.featureInfoFormConfig})})]})},eG=e=>{var r,t,a,n=e.dataType,i=void 0===n?"auto":n,u=e.valueMap,c=e.format,d=e.suffix,f=e.value,p=e.referenceConfig,m=e.urlDisplayValue,g=(0,ep._)(e,["dataType","valueMap","format","suffix","value","referenceConfig","urlDisplayValue"]),v=(0,k.useTranslation)().i18n,h="";if(f&&"string"==typeof f&&(null==u?void 0:u.hasOwnProperty(f))&&(f=u[f]),("string"===i||"auto"===i&&"string"==typeof f)&&f&&(h=null==f?void 0:f.toString()),"boolean"===i||"auto"===i&&"boolean"==typeof f||"false"===f||"true"===f)return(0,o.jsx)(eg.Z,{checked:"false"!==f&&!1!==f,disabled:!0});("number"===i||"auto"===i&&Number.isFinite(f))&&f&&(h=new Intl.NumberFormat(v.language,{useGrouping:!1}).format(Number(f))),("date"===i||"auto"===i&&(0,eo.isMoment)(f))&&f&&(h=eu()(f).format(void 0===c?"DD.MM.YYYY":c)),"auto"===i&&Array.isArray(f)&&(h=f.join(", "));if("url"===i||"auto"===i&&ek()(f)&&(r=f.toLowerCase(),["http://","https://","ftp://","mailto:"].some(e=>r.startsWith(e))))f&&(h=(0,o.jsx)("a",{href:null==f?void 0:f.toString(),target:"_blank",rel:"noreferrer",children:m||(null==f?void 0:f.toString())}));var j=f&&(e=>{if(!f)return null;var r="string"!=typeof e?JSON.stringify(e):e;try{r=JSON.parse(r)}catch(e){return L.Z.trace(e),null}return"object"==typeof r&&null!==r&&eV(r[0])?r:null})(f);if("auto"===i&&j)return(null===(a=j[0].response)||void 0===a?void 0:null===(t=a.fileType)||void 0===t?void 0:t.startsWith("image/"))?(0,o.jsx)(eA,{initialFileList:j,disabled:!0,readOnly:!0}):(0,o.jsx)(eT,{defaultFileList:j,disabled:!0,readOnly:!0});return"json"===i||"auto"===i&&f&&(e=>{var r="string"!=typeof e?JSON.stringify(e):e;try{r=JSON.parse(r)}catch(e){return L.Z.trace(e),!1}return"object"==typeof r&&null!==r})(f)?(0,o.jsx)(eI,{value:"string"==typeof f?f:JSON.stringify(f),referenceConfig:p}):(d&&(h=(0,o.jsxs)(o.Fragment,{children:[h," ",d]})),(0,o.jsx)(y.Z.Text,(0,s._)((0,l._)({className:"displayfield"},g),{children:h})))},eR=t("21689"),e$=t("94945"),eB=e=>{var r,t=e.parentForm,a=e.propertyName,n=e.value,i=e.tablePropertyName,c=e.formConfig,m=e.onChange,v=void 0===m?()=>{}:m,h=(0,ep._)(e,["parentForm","propertyName","value","tablePropertyName","formConfig","onChange"]),y=(0,f._)((0,u.useState)(!1),2),x=y[0],b=y[1],w=(0,f._)((0,u.useState)(),2),S=w[0],_=w[1],C=(0,f._)((0,eO.useForm)(),1)[0],E=(0,k.useTranslation)().t,N=eD(),F=(0,en.Z)(),T=e=>{if(!i)return e.id||"";var r,t=/{{(.*?)}}/g;if(!i.match(t))return e[i];for(var a=i;r=t.exec(i);)a=a.replace(r[0],e[r[1]]);return a},P=[{width:"100%",defaultSortOrder:"ascend",sorter:(e,r)=>{var t=T(e),a=T(r);return Number.isFinite(t)&&Number.isFinite(a)?t-a:"string"==typeof t&&"string"==typeof a?t.localeCompare(a):0},render:(e,r)=>T(r)},{render:(e,r)=>(0,o.jsx)(eN.ZP,{onClick:()=>M(r),icon:(0,o.jsx)(eZ.G,{icon:eP.Xcf})})},{render:(e,r)=>(0,o.jsx)(eR.Z,{title:E("EditReferenceTable.confirmDeleteTitle"),onConfirm:()=>Z(r),placement:"bottomRight",children:(0,o.jsx)(eN.ZP,{danger:!0,icon:(0,o.jsx)(eZ.G,{icon:eP.$aW})})})}],Z=e=>{var r=t.getFieldsValue();if(!r[a]){L.Z.warn(`Could not find the property ${a} in the form values`);return}var n=es()(r[a]);if(!Array.isArray(n)){L.Z.warn("The delete candidate is not of required type array");return}var i=n.findIndex(r=>!!Number.isFinite(r.id)&&r.id===e.id||!!r.internalId&&r.internalId===e.internalId||!1);if(-1===i){L.Z.warn(`Could not find the index (${e.id}) to delete`);return}n.splice(i,1),v(n)},M=e=>{var r=new(H());r.setProperties(e),C.setFieldsValue(r.getProperties()),_(r),b(!0)},D=()=>{var e=es()(C.getFieldsValue(!0)),r=[];Array.isArray(t.getFieldValue(a))&&(r=es()(t.getFieldValue(a)));var n=r.findIndex(r=>!!Number.isFinite(r.id)&&r.id===e.id||!!r.internalId&&r.internalId===e.internalId||!1);n>-1?r[n]=e:r.push(e),C.isFieldsTouched()&&v(r)};var A=(r=(0,d._)(function(){var e;return(0,p.Jh)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,C.validateFields()];case 1:return r.sent(),[3,3];case 2:return e=r.sent(),L.Z.warn("Form validation failed: ",e),[2];case 3:return D(),O(),[2]}})}),function(){return r.apply(this,arguments)}),O=()=>{C.resetFields(),b(!1),_(void 0)};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(eN.ZP,{className:"add-reference-button",onClick:()=>{var e=new(H());e.set("internalId",(0,e$.getUid)(e)),C.setFieldsValue(e.getProperties()),_(e),b(!0)},icon:(0,o.jsx)(eZ.G,{icon:eP.r8p})}),(0,o.jsx)(j.Z,(0,l._)({size:"small",showHeader:!1,pagination:!1,columns:P,rowKey:"id",dataSource:(()=>{if(!!n){if(!Array.isArray(n)){L.Z.warn("Reference value must be of of type array.");return}var e=es()(n);return e.forEach(e=>{var r;Object.entries(e).forEach((r=(0,d._)(function(r){var t,a,i,o,u;return(0,p.Jh)(this,function(m){switch(m.label){case 0:var g;if(a=(t=(0,f._)(r,2))[0],i=t[1],(null==c?void 0:c.some(e=>e.propertyName===a&&"DATE"===e.component))&&i&&(eu()(n).isValid()?e[a]=eu()(i):(L.Z.warn("Could not parse date"),e[a]=null)),!(null==c?void 0:c.some(e=>e.propertyName===a&&"UPLOAD"===e.component)))return[3,3];if(!Array.isArray(e[a]))return[3,2];return[4,Promise.all(null===(o=e[a])||void 0===o?void 0:o.map((g=(0,d._)(function(e){var r,t,a,n;return(0,p.Jh)(this,function(i){switch(i.label){case 0:if(t=[(0,l._)({},e)],a={},!e.type.startsWith("image"))return[3,2];return[4,N(`${null==F?void 0:F.getBasePath()}imagefiles/${null==e?void 0:null===(r=e.response)||void 0===r?void 0:r.fileUuid}/thumbnail`)];case 1:return n=i.sent(),[3,3];case 2:n=void 0,i.label=3;case 3:return[2,s._.apply(void 0,t.concat([(a.thumbUrl=n,a.url=e.type.startsWith("image")?void 0:e.url,a)]))]}})}),function(e){return g.apply(this,arguments)})))];case 1:return u=m.sent(),e[a]=u,[3,3];case 2:e[a]=[],m.label=3;case 3:return[2]}})}),function(e){return r.apply(this,arguments)}))}),!e.every(e=>!!Number.isFinite(e.id)||"string"==typeof e.id&&!!(e.id.length>0)||!1)&&L.Z.warn("Not all elements in the referenced array contain an id value. This might result in unexpected behaviour"),e}})()},h)),(0,o.jsx)(g.Z,{className:"edit-reference-table-modal",open:x,maskClosable:!1,width:600,destroyOnClose:!0,title:`${E("EditReferenceTable.modalTitle",{referenceValue:S?T(S.getProperties()):void 0})}`,onCancel:()=>{O()},onOk:A,children:S&&(0,o.jsx)(ez,{form:C,formConfig:c,applyFormDirty:!1})})]})};function eV(e){return!ew()(e)&&e.uid&&!ew()(e.name)&&!ew()(e.type)&&!ew()(e.uid)&&e_()(e.response)&&!ew()(e.response.id)&&!ew()(e.response.fileUuid)&&!ew()(e.response.fileName)&&!ew()(e.response.fileType)}var ez=e=>{var r,t=e.form,a=e.formConfig,n=e.applyFormDirty,i=void 0===n||n,u=(0,ep._)(e,["form","formConfig","applyFormDirty"]),c=(0,en.Z)(),f=A(),m=O(e=>e.editFeature.formDirty),g=e=>(0,o.jsx)(eG,(0,l._)({},e.fieldProps)),y=e=>{if(!!c)switch(e.component){case"CHECKBOX":return(0,o.jsx)(eg.Z,(0,l._)({},null==e?void 0:e.fieldProps));case"DATE":return(0,o.jsx)(ev.Z,(0,l._)({},null==e?void 0:e.fieldProps));case"DISPLAY":return(0,o.jsx)("span",(0,l._)({},null==e?void 0:e.fieldProps));case"INPUT":return(0,o.jsx)(v.Z,(0,l._)({},null==e?void 0:e.fieldProps));case"NUMBER":return(0,o.jsx)(eh.Z,(0,l._)({},null==e?void 0:e.fieldProps));case"SELECT":return(0,o.jsx)(h.Z,(0,l._)({allowClear:!0},null==e?void 0:e.fieldProps));case"SWITCH":return(0,o.jsx)(ey.Z,(0,l._)({},null==e?void 0:e.fieldProps));case"TEXTAREA":return(0,o.jsx)(v.Z.TextArea,(0,l._)({},null==e?void 0:e.fieldProps));case"UPLOAD":var r;if((null==e?void 0:null===(r=e.fieldProps)||void 0===r?void 0:r.type)==="IMAGE")return(0,o.jsx)(eA,(0,l._)({},null==e?void 0:e.fieldProps));return(0,o.jsx)(eT,(0,l._)({},null==e?void 0:e.fieldProps));case"REFERENCE_TABLE":return(0,o.jsx)(eB,(0,l._)({tablePropertyName:e.tablePropertyName,propertyName:e.propertyName,formConfig:e.editFormConfig,parentForm:t},e.fieldProps),e.propertyName);default:return L.Z.error(`Component type "${null==e?void 0:e.component}" is not supported`),(0,o.jsx)(o.Fragment,{})}};var j=(r=(0,d._)(function(e){return(0,p.Jh)(this,function(r){return i&&e&&!m&&f((0,eC.uQ)(!0)),[2]})}),function(e){return r.apply(this,arguments)});return(0,o.jsx)(em.Z,(0,s._)((0,l._)({className:"edit-feature-form",form:t,labelCol:{span:8},labelAlign:"left",labelWrap:!0,onValuesChange:ex()(j,250)},u),{children:null==a?void 0:a.map(e=>{e.readOnly?r=g(e):e.component?r=y(e):(L.Z.warn("FieldConfig is missing `readOnly`, `component` or `dataType` property."),r=(0,o.jsx)(v.Z,{placeholder:""},e.propertyName));var r,t={rules:[]};return t.rules=[{required:e.required}],("SWITCH"===e.component||"CHECKBOX"===e.component)&&!e.readOnly&&(t.valuePropName="checked"),"UPLOAD"===e.component&&!e.readOnly&&(t.valuePropName="fileList",t.getValueFromEvent=e=>Array.isArray(e)?e:e&&e.fileList),(0,o.jsx)(em.Z.Item,(0,s._)((0,l._)({name:e.propertyName,label:e.displayName||e.propertyName},t),{children:r}),e.propertyName)})}))},eJ=e=>["gml:MultiPoint","gml:Point","gml:MultiLineString","gml:LineString","gml:MultiPolygon","gml:Polygon"].includes(e),eW=()=>{var e,r=(0,en.Z)(),t="describeFeatureTypeCache";return(0,u.useCallback)((e=(0,d._)(function(e){var a,n,i,s,o,u,c,d,f,m,g;return(0,p.Jh)(this,function(p){switch(p.label){case 0:if((i=e.getSource())instanceof ee()&&(n=i.getUrl()),i instanceof et()&&(n=(s=i.getUrls())?s[0]:void 0),!n)return[2];if(n.endsWith("?")&&(n=n.slice(0,-1)),!(o=null===(a=e.getSource())||void 0===a?void 0:a.getParams().LAYERS))return[2];if(c=(u=JSON.parse(sessionStorage.getItem(t)||"{}"))[o])return[2,c];return d={SERVICE:"WFS",REQUEST:"DescribeFeatureType",VERSION:"2.0.0",OUTPUTFORMAT:"application/json",TYPENAMES:o},f={"Content-Type":"application/json"},[4,fetch(`${n}?${N.V.objectToRequestString(d)}`,{method:"GET",headers:e.get("useBearerToken")?(0,l._)({},f,(0,ea.a)(null==r?void 0:r.getKeycloak())):f})];case 1:if(!(m=p.sent()).ok)throw Error("No successful response while executing a WFS-DescribeFeature");return[4,m.json()];case 2:return g=p.sent(),u[o]=g,sessionStorage.setItem(t,JSON.stringify(u)),[2,g]}})}),function(r){return e.apply(this,arguments)}),[r])},eK=()=>{var e,r=(0,M.S)(),t=eW(),a=(0,en.Z)(),n=O(e=>e.editFeature.userEditMode),i=(0,u.useCallback)((e,r,t)=>{var n=!0,l=!1,s=void 0;try{for(var o,u=Object.entries(e)[Symbol.iterator]();!(n=(o=u.next()).done);n=!0)!function(){var n=(0,f._)(o.value,2),l=n[0],s=n[1];if(Array.isArray(s)){var u=s.map(e=>i(e,r));e[l]=t?JSON.stringify(u):u}if(void 0===s&&(e[l]=null),r.some(e=>{var r;return null===(r=e.children)||void 0===r?void 0:r.some(e=>e.propertyName===l&&e.readOnly)})&&delete e[l],(0,eo.isMoment)(s)&&(e[l]=s.toISOString()),Array.isArray(s)&&s.length>0&&eV(s[0])){var c,d,p=(null===(d=s[0].response)||void 0===d?void 0:null===(c=d.fileType)||void 0===c?void 0:c.startsWith("image/"))?"imagefiles/":"files/",m=s.map(e=>{var r,t,n,i,l;return{uid:e.uid,lastModified:e.lastModified,name:e.name,type:e.type,url:`${null==a?void 0:a.getBasePath()}${p}${e.response.fileUuid}`,response:{id:null===(r=e.response)||void 0===r?void 0:r.id,created:null===(t=e.response)||void 0===t?void 0:t.created,fileName:null===(n=e.response)||void 0===n?void 0:n.fileName,fileType:null===(i=e.response)||void 0===i?void 0:i.fileType,fileUuid:null===(l=e.response)||void 0===l?void 0:l.fileUuid}}});e[l]=JSON.stringify(m)}}()}catch(e){l=!0,s=e}finally{try{!n&&null!=u.return&&u.return()}finally{if(l)throw s}}return e},[a]);return(0,u.useCallback)((e=(0,d._)(function(e){var a,l,s,o,u,c,d,f,m,g,v,h,y,j,x,b,w,S,_,C,E,k,L,N,F,T;return(0,p.Jh)(this,function(p){switch(p.label){case 0:if(!r)return[2];return o=[],u=[],c=[],[4,t(e.layer)];case 1:if(!(d=p.sent()))return[2];if(f=e.layer.get("editFormConfig"),m=null===(l=d.featureTypes[0])||void 0===l?void 0:null===(a=l.properties)||void 0===a?void 0:a.find(e=>eJ(e.type)),g=!1,e.upsertFeatures){v=!0,h=!1,y=void 0;try{for(j=e.upsertFeatures[Symbol.iterator]();!(v=(x=j.next()).done);v=!0)b=x.value,S=new(H()),(_=null===(w=b.getGeometry())||void 0===w?void 0:w.clone())&&!(0,ec.isEmpty)(_.getExtent())&&(null==n?void 0:n.includes("EDIT_GEOMETRY"))&&(S.set((null==m?void 0:m.name)||"geom",_),S.setGeometryName((null==m?void 0:m.name)||"geom")),e.form&&S.setProperties(i(es()(null===(C=e.form)||void 0===C?void 0:C.getFieldsValue()),f,!0)),(E=!!b.getId())&&!g&&(g=!0),E&&S.setId(b.getId()),E?u.push(S):o.push(S)}catch(e){h=!0,y=e}finally{try{!v&&null!=j.return&&j.return()}finally{if(h)throw y}}}return e.deleteFeatures&&c.push(...e.deleteFeatures),k={featureNS:d.targetNamespace,featurePrefix:d.targetPrefix,featureType:null===(s=e.layer.getSource())||void 0===s?void 0:s.getParams().LAYERS,srsName:r.getView().getProjection().getCode(),version:"1.1.0",nativeElements:[]},L=new(ef())().writeTransaction(o,u,c,k),g&&q().wfsLockFeatureEnabled&&(N=L.getRootNode(),F=document.createElementNS("http://www.opengis.net/wfs","LockId"),T=document.createTextNode("GeoServer"),F.appendChild(T),N.appendChild(F)),[2,L]}})}),function(r){return e.apply(this,arguments)}),[r,n,t,i])},eq=t("67187"),eY=t("12477"),eH=e=>{var r=e.open,t=e.children,a=(0,ep._)(e,["open","children"]),n=(0,M.S)();return(0,u.useEffect)(()=>{var e;null===(e=document.querySelectorAll("#map")[0])||void 0===e||e.classList.toggle("bisected",!!r)},[r]),(0,o.jsx)(eY.Z,(0,s._)((0,l._)({rootClassName:"map-drawer",mask:!1,open:r,placement:"right",width:getComputedStyle(document.documentElement).getPropertyValue("--editDrawerWidth"),afterOpenChange:()=>{null==n||n.updateSize()}},a),{children:t}))},eX=t("53501"),eQ=t.n(eX),e0=()=>{var e,r=(0,en.Z)(),t=(0,M.S)(),a=eW();return(0,u.useCallback)((e=(0,d._)(function(e){var n,i,s,o,u,c,d,f,m,g,v,h,y=arguments;return(0,p.Jh)(this,function(p){switch(p.label){case 0:if(n=y.length>1&&void 0!==y[1]?y[1]:"1.1.0",!t)return[2];return[4,a(e.layer)];case 1:if(!(u=p.sent()))return[2];if((d=e.layer.getSource())instanceof ee()&&(c=d.getUrl()),d instanceof et()&&(c=(f=d.getUrls())?f[0]:void 0),!c)return[2];return c.endsWith("?")&&(c=c.slice(0,-1)),m=null===(s=u.featureTypes[0])||void 0===s?void 0:null===(i=s.properties)||void 0===i?void 0:i.find(e=>eJ(e.type)),(g=new(ef())({version:n}).writeGetFeature({srsName:t.getView().getProjection().getCode(),featureNS:u.targetNamespace,featurePrefix:u.targetPrefix,featureTypes:[null==d?void 0:d.getParams().LAYERS],outputFormat:"application/json",maxFeatures:e.maxFeatures,propertyNames:e.propertyNames&&(null==m?void 0:m.name)?[...e.propertyNames,null==m?void 0:m.name]:void 0,bbox:e.bbox,filter:e.filter instanceof eQ()?e.filter:void 0,geometryName:null==m?void 0:m.name}))instanceof Element&&e.filter instanceof Element&&g.getElementsByTagName("Query")[0].appendChild(e.filter),v={"Content-Type":"application/json"},[4,fetch(c,{method:"POST",headers:(null===(o=e.layer)||void 0===o?void 0:o.get("useBearerToken"))?(0,l._)({},v,(0,ea.a)(null==r?void 0:r.getKeycloak())):v,body:new XMLSerializer().serializeToString(g)})];case 2:if(!(h=p.sent()).ok)throw Error("No successful response while executing a WFS-GetFeature");return[4,h.json()];case 3:return[2,p.sent()]}})}),function(r){return e.apply(this,arguments)}),[r,a,t])},e1=t("78001"),e2=t("41609"),e3=t.n(e2),e4=t("48472"),e5=t.n(e4),e7=t("10771"),e6=t("72858"),e9=t.n(e6),e8=t("60297"),re=t("91967"),rr=t("14292"),rt=e=>{var r=e.alignment,t=e.className,a=void 0===t?"":t,n=e.children,i=(0,ep._)(e,["alignment","className","children"]),u="toolbar",c=a?`${a} ${u}`:u;return(0,o.jsx)("div",(0,s._)((0,l._)({className:`${c} ${void 0===r?"horizontal":r}-toolbar`,role:"toolbar"},i),{children:n}))},ra=e=>{var r,t,a=e.feature,n=e.historyLength,i=void 0===n?10:n,c=(0,u.useRef)({past:[],future:[]}),d=(0,M.S)(),p=A(),m=(0,f._)((0,u.useState)(),2),g=m[0],v=m[1],h=(0,f._)((0,u.useState)(0),2)[1],y=(0,f._)((0,u.useState)(void 0),2),j=y[0],x=y[1],b=(0,u.useMemo)(()=>new(e5()),[]),w=O(e=>e.editFeature.userEditMode),S=O(e=>e.editFeature.formDirty);(0,u.useEffect)(()=>{if(!!d)return!g&&v(rr.w.getDigitizeLayer(d)),()=>{g&&(null==d||d.removeLayer(g))}},[g,d]),(0,u.useEffect)(()=>{c.current.past.length>0&&!S&&p((0,eC.uQ)(!0))},[p,c.current.past]),(0,u.useEffect)(()=>{if(g&&(null==a?void 0:a.id)){null===(e=g.getSource())||void 0===e||e.clear();var e,r=b.readFeature(a);if(!Array.isArray(r)){var t=g.getSource();t.addFeature(r),h(e=>e+1),!(0,ec.isEmpty)(t.getExtent())&&(null==d||d.getView().fit(t.getExtent(),{padding:[50,50,50,50]}))}}},[a,g,b,d]);var _=()=>{var e,r=null==g?void 0:null===(e=g.getSource())||void 0===e?void 0:e.getFeatures();if(!!r){var t=b.writeFeaturesObject(r);c.current=(0,s._)((0,l._)({},c.current),{past:[...c.current.past,t].slice(-10)}),h(e=>e+1)}},C={tooltipPlacement:"left",tooltipProps:{mouseEnterDelay:.5}};return g?w.includes("EDIT_GEOMETRY")?(0,o.jsxs)(rt,{className:"geometry-edit-tb",alignment:"vertical",children:[(0,o.jsxs)(re.ToggleGroup,{selected:j,onChange:(e,r)=>{x(r)},children:[w.includes("CREATE")?(0,o.jsx)(e9(),(0,l._)({value:"create",icon:(0,o.jsx)(eZ.G,{icon:eP.TzT}),pressedIcon:(0,o.jsx)(eZ.G,{icon:eP.TzT}),name:"draw",digitizeLayer:g,tooltip:(0,e1.t)("EditFeatureGeometryToolbar.draw"),drawType:a.geometry.type,onDrawEnd:e=>{if(!a.geometry.type.toLocaleLowerCase().startsWith("multi")){var r=null==g?void 0:g.getSource(),t=null==r?void 0:r.getFeatures()[0];t&&(null==r||r.once("addfeature",e=>r.removeFeature(e.feature)),t.setGeometry(e.feature.getGeometry()))}_()}},C)):(0,o.jsx)(o.Fragment,{}),w.includes("UPDATE")?(0,o.jsx)(e8.ModifyButton,(0,l._)({value:"update",icon:(0,o.jsx)(eZ.G,{icon:eP.ubJ}),pressedIcon:(0,o.jsx)(eZ.G,{icon:eP.ubJ}),name:"edit",digitizeLayer:g,tooltip:(0,e1.t)("EditFeatureGeometryToolbar.edit"),onModifyStart:_,onModifyEnd:_,onTranslateEnd:_},C)):(0,o.jsx)(o.Fragment,{}),w.includes("DELETE")?(0,o.jsx)(e7.DeleteButton,(0,l._)({value:"delete",icon:(0,o.jsx)(eZ.G,{icon:eP.$aW}),pressedIcon:(0,o.jsx)(eZ.G,{icon:eP.$aW}),name:"delete",digitizeLayer:g,tooltip:(0,e1.t)("EditFeatureGeometryToolbar.delete"),onFeatureRemove:_},C)):(0,o.jsx)(o.Fragment,{})]}),(0,o.jsx)(Z(),(0,l._)({icon:(0,o.jsx)(eZ.G,{icon:eP.X7o}),tooltip:(0,e1.t)("EditFeatureGeometryToolbar.undo"),onClick:()=>{var e=null==g?void 0:g.getSource(),r=null==e?void 0:e.getFeatures();if(!!r){var t=b.writeFeaturesObject(r),a=c.current.past[c.current.past.length-1];!e3()(a)&&(null==e||e.clear(),null==e||e.addFeatures(b.readFeatures(a)),c.current={past:c.current.past.slice(0,-1),future:[...c.current.future,t].slice(-i)},h(e=>e+1))}},disabled:(null===(r=c.current.past)||void 0===r?void 0:r.length)===0},C)),(0,o.jsx)(Z(),(0,l._)({icon:(0,o.jsx)(eZ.G,{icon:eP.X7o,flip:"horizontal"}),tooltip:(0,e1.t)("EditFeatureGeometryToolbar.redo"),onClick:()=>{var e=null==g?void 0:g.getSource(),r=null==e?void 0:e.getFeatures();if(!!r){var t=b.writeFeaturesObject(r),a=c.current.future[c.current.future.length-1];!e3()(a)&&(null==e||e.clear(),null==e||e.addFeatures(b.readFeatures(a)),c.current={future:c.current.future.slice(0,-1),past:[...c.current.past,t].slice(-i)},h(e=>e+1))}},disabled:(null===(t=c.current.future)||void 0===t?void 0:t.length)===0},C))]}):(0,o.jsx)(o.Fragment,{}):(0,o.jsx)(o.Fragment,{})},rn=t("33100"),ri=e=>{var r=e.tabConfig,t=e.form,a=e.initialValues,n=(0,ep._)(e,["tabConfig","form","initialValues"]),i=null==r?void 0:r.map((e,r)=>({label:e.title,key:`${r}`,forceRender:!0,children:(0,o.jsx)(ez,{name:e.title,form:t,initialValues:a,formConfig:e.children})}));return(0,o.jsx)(rn.Z,(0,l._)({items:i},n))},rl=e=>{var r,t=e.feature,a=e.layer,n=e.onError,i=void 0===n?()=>{}:n,c=e.onSuccess,m=void 0===c?()=>{}:c,g=(0,ep._)(e,["feature","layer","onError","onSuccess"]),v=(0,f._)((0,u.useState)(!1),2),h=v[0],y=v[1],j=(0,k.useTranslation)().t,x=(0,M.S)(),b=eK(),w=ei();var S=(r=(0,d._)(function(){var e,r,n,l;return(0,p.Jh)(this,function(s){switch(s.label){case 0:if(!x||!a||!(0,X.us)(a))return[2];s.label=1;case 1:return s.trys.push([1,4,5,6]),y(!0),[4,b({deleteFeatures:Array.isArray(r=new(e5())().readFeature(t))?r:[r],layer:a})];case 2:if(!(n=s.sent()))return[2];return[4,w({layer:a,transaction:n})];case 3:return s.sent(),null===(e=a.getSource())||void 0===e||e.refresh(),m(),[3,6];case 4:return l=s.sent(),L.Z.error(l),i(l),[3,6];case 5:return y(!1),[7];case 6:return[2]}})}),function(){return r.apply(this,arguments)});return(0,o.jsx)(eR.Z,{title:j("DeleteButton.confirm"),onConfirm:S,placement:"bottomRight",children:(0,o.jsx)(eN.ZP,(0,s._)((0,l._)({type:"primary",loading:h,disabled:!t.id,danger:!0,icon:(0,o.jsx)(eZ.G,{icon:eP.$aW})},g),{children:j("DeleteButton.title")}))})},rs=e=>{var r=e.feature,t=e.form,a=(0,ep._)(e,["feature","form"]),n=(0,k.useTranslation)().t,i=(0,M.S)(),u=A();return(0,o.jsx)(eN.ZP,(0,s._)((0,l._)({type:"primary",onClick:()=>{if(t.resetFields(),u((0,eC.uQ)(!1)),i){var e=rr.w.getDigitizeLayer(i);if(e){null===(a=e.getSource())||void 0===a||a.clear();var a,n,l=new(e5())().readFeature(r);if(Array.isArray(l))return;null===(n=e.getSource())||void 0===n||n.addFeature(l)}}},icon:(0,o.jsx)(eZ.G,{icon:eP.XnX})},a),{children:n("ResetButton.title")}))},ro=e=>{var r=e.loadComplete,t=void 0!==r&&r;return(0,o.jsx)("div",{className:t?"feedback-icon":"feedback-icon hidden",children:(0,o.jsx)("div",{className:t?"checkmark":"checkmark-hidden"})})},ru=e=>{var r,t=e.form,a=e.layer,n=e.onError,i=void 0===n?()=>{}:n,c=e.onSuccess,m=void 0===c?()=>{}:c,g=(0,ep._)(e,["form","layer","onError","onSuccess"]),v=(0,f._)((0,u.useState)(!1),2),h=v[0],y=v[1],j=(0,f._)((0,u.useState)(!1),2),x=j[0],b=j[1],w=(0,M.S)(),S=eK(),_=ei(),C=A(),E=O(e=>e.editFeature.formDirty),N=(0,k.useTranslation)().t;var F=(r=(0,d._)(function(){var e,r,n,l,s,o,u,c;return(0,p.Jh)(this,function(d){switch(d.label){case 0:if(!w||!a||!(0,X.us)(a))return[2];if(!(r=rr.w.getDigitizeLayer(w)))return L.Z.error("Cannot find the digitize layer"),i(),[2];if(!(n=null===(e=r.getSource())||void 0===e?void 0:e.getFeatures())||0===n.length)return L.Z.error("Cannot save feature without geometry"),i(N("SaveButton.errorNoGeometry")),[2];d.label=1;case 1:return d.trys.push([1,3,,4]),[4,t.validateFields()];case 2:return d.sent(),[3,4];case 3:return i(l=d.sent()),L.Z.warn("Validation has failed: ",l),[2];case 4:return d.trys.push([4,7,8,9]),y(!0),[4,S({upsertFeatures:n,form:t,layer:a})];case 5:if(!(o=d.sent()))return[2];return[4,_({layer:a,transaction:o})];case 6:return u=d.sent(),null===(s=a.getSource())||void 0===s||s.refresh(),b(!0),setTimeout(()=>{b(!1)},3e3),C((0,eC.uQ)(!1)),m(u),[3,9];case 7:return c=d.sent(),L.Z.error(c),i(c),[3,9];case 8:return y(!1),[7];case 9:return[2]}})}),function(){return r.apply(this,arguments)});return(0,o.jsxs)(eN.ZP,(0,s._)((0,l._)({className:"save-button",type:"primary",onClick:F,loading:h,disabled:!E,icon:(0,o.jsx)(eZ.G,{icon:eP.EdJ})},g),{children:[N("SaveButton.title"),(0,o.jsx)(ro,{loadComplete:x})]}))},rc=e=>{var r=e.feature,t=e.layer,a=e.form,n=e.onSaveSuccess,i=e.onSaveError,l=e.onDeleteSuccess,s=e.onDeleteError,u=O(e=>e.editFeature.userEditMode);return(0,o.jsxs)("div",{className:"edit-feature-toolbar",children:[u.includes("CREATE")||u.includes("UPDATE")?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(rs,{feature:r,form:a}),(0,o.jsx)(ru,{form:a,layer:t,onSuccess:void 0===n?()=>{}:n,onError:void 0===i?()=>{}:i})]}):(0,o.jsx)(o.Fragment,{}),u.includes("DELETE")&&(0,o.jsx)(rl,{feature:r,layer:t,onSuccess:void 0===l?()=>{}:l,onError:void 0===s?()=>{}:s})]})},rd=e=>{var r,t=e.feature,a=e.layer,n=(0,k.useTranslation)().t,i=e0(),m=eD(),g=(0,f._)((0,u.useState)(),2),v=g[0],h=g[1],y=(0,f._)((0,u.useState)(),2),j=y[0],x=y[1],b=(0,f._)((0,u.useState)(),2),w=b[0],S=b[1],_=(0,f._)((0,eO.useForm)(),1)[0],C=(0,M.S)(),E=A(),N=(0,en.Z)();var F=(0,u.useCallback)((r=(0,d._)(function(e){var r,t,n,l;return(0,p.Jh)(this,function(s){switch(s.label){case 0:if(!a||!(0,X.us)(a))return[2];return t=(r=document.implementation.createDocument(null,"root")).createElement("Filter"),(n=r.createElement("ResourceId")).setAttribute("rid",e),t.appendChild(n),r.documentElement.appendChild(t),[4,i({layer:a,filter:t},"2.0.0")];case 1:return(null==(l=s.sent())?void 0:l.features[0])&&E((0,eC.hr)(null==l?void 0:l.features[0])),[2]}})}),function(e){return r.apply(this,arguments)}),[E,i,a]),T=(0,u.useCallback)((0,d._)(function(){var e,r;return(0,p.Jh)(this,function(n){switch(n.label){case 0:var i;if(!C||!N)return[2];if((null==(e=a.get("editFormConfig"))?void 0:e.length)===0)return L.Z.warn(`Layer ${a.get("name")} has no 'editFormConfig' set`),[2];return[4,Promise.all(Object.entries(r=structuredClone(null==t?void 0:t.properties)||{}).map((i=(0,d._)(function(t){var a,n,i,o,u,c,g,v,h,y,j,x;return(0,p.Jh)(this,function(b){switch(b.label){case 0:if(n=(a=(0,f._)(t,2))[0],i=a[1],(null==(o=null==e?void 0:e.filter(e=>{var r;return null===(r=e.children)||void 0===r?void 0:r.find(e=>e.propertyName===n)}))?void 0:o.length)>1&&L.Z.warn(`Property ${n} is configured in multiple tabs. Is this intended?`),!(o&&o[0]))return[3,7];if((null===(u=o[0].children)||void 0===u?void 0:u.some(e=>e.propertyName===n&&"DATE"===e.component))&&((v=eu()(i)).isValid()?r[n]=v:(L.Z.warn("Could not parse date"),r[n]=null)),!(null===(c=o[0].children)||void 0===c?void 0:c.some(e=>e.propertyName===n&&"UPLOAD"===e.component)))return[3,6];if(!i)return[3,5];b.label=1;case 1:var w;if(b.trys.push([1,3,,4]),!eV((h=JSON.parse(i))[0]))throw Error("File config is no valid SHOGun file.");return y=h,r[n]=y,[4,Promise.all(y.map((w=(0,d._)(function(e){var r,t,a,n,i,o;return(0,p.Jh)(this,function(u){switch(u.label){case 0:if(!(n=null===(t=y[0].response)||void 0===t?void 0:null===(r=t.fileType)||void 0===r?void 0:r.startsWith("image/")))return[3,2];return[4,m(`${N.getBasePath()}imagefiles/${null==e?void 0:null===(a=e.response)||void 0===a?void 0:a.fileUuid}/thumbnail`)];case 1:return o=u.sent(),[3,3];case 2:o=void 0,u.label=3;case 3:return i=o,[2,(0,s._)((0,l._)({},e),{thumbUrl:i,url:n?void 0:e.url})]}})}),function(e){return w.apply(this,arguments)})))];case 2:return j=b.sent(),r[n]=j,[3,4];case 3:return x=b.sent(),L.Z.error("Could not parse file list from JSON config: ",x),r[n]=[],[3,4];case 4:return[3,6];case 5:r[n]=[],b.label=6;case 6:if(null===(g=o[0].children)||void 0===g?void 0:g.some(e=>e.propertyName===n&&"REFERENCE_TABLE"===e.component))try{r[n]=JSON.parse(r[n])}catch(e){L.Z.warn("Could not parse the input for the REFERENCE_TABLE",e)}b.label=7;case 7:return[2]}})}),function(e){return i.apply(this,arguments)})))];case 1:return n.sent(),x(r),_.resetFields(),_.setFieldsValue(r),h(e),[2]}})}),[C,N,a,null==t?void 0:t.properties,_,m]);(0,u.useEffect)(()=>{T()},[T]);var P=e=>{var r=[];return(e.errorFields||[]).forEach(e=>{Array.isArray(e.errors)&&r.push(...e.errors)}),r.map((e,t)=>(0,o.jsxs)(c().Fragment,{children:[e,t!==r.length-1&&(0,o.jsx)("br",{})]},t))};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(ra,{feature:t}),w&&(0,o.jsx)(W.Z,{className:"error-alert",message:w,type:"error",showIcon:!0}),(0,o.jsx)(rc,{feature:t,layer:a,form:_,onSaveSuccess:e=>{if(!!e){S(void 0);var r,a=null===(r=new DOMParser().parseFromString(e,"text/xml").getElementsByTagName("ogc:FeatureId").item(0))||void 0===r?void 0:r.getAttribute("fid");if("none"===a){var n=t.id;if(!n)return;F(n)}else a&&F(a)}},onSaveError:e=>{"object"==typeof e&&null!==e&&"errorFields"in e?S(P(e)):"string"==typeof e?S(e):S(n("EditFeatureFullForm.saveErrorMsg"))},onDeleteSuccess:()=>{S(void 0),E((0,eC.hr)(null))},onDeleteError:()=>{S(n("EditFeatureFullForm.deleteErrorMsg"))}}),(0,o.jsx)(ri,{tabConfig:v,initialValues:j,form:_})]})},rf=()=>{var e,r=(0,en.Z)(),t=e=>{var r,t,a=e.feature.id,n=e.feature.properties;if(!a||!n){L.Z.warn("Either the id of the feature or its properties (or even both) aren't available");return}t="number"==typeof a?a:parseInt(a.split(".")[1],10);var i=Object.entries(n).find(e=>{var r=(0,f._)(e,2)[1];return r===t||r===t.toString()});if(!i){L.Z.warn("Count not detect the id property");return}var l=i[0],s=null===(r=e.layer.getSource())||void 0===r?void 0:r.getParams().LAYERS,o=document.createElementNS("http://www.opengis.net/wfs/2.0","LockFeature");o.setAttribute("service","WFS"),o.setAttribute("version","2.0.0"),o.setAttribute("expiry","300"),o.setAttribute("lockAction","SOME");var u=document.createElementNS("http://www.opengis.net/wfs/2.0","Query");u.setAttribute("typeNames",s);var c=document.createElementNS("http://www.opengis.net/fes/2.0","Filter"),d=document.createElementNS("http://www.opengis.net/fes/2.0","PropertyIsEqualTo"),p=document.createElementNS("http://www.opengis.net/fes/2.0","ValueReference"),m=document.createTextNode(l);p.appendChild(m);var g=document.createElementNS("http://www.opengis.net/fes/2.0","Literal"),v=document.createTextNode(t.toString());return g.appendChild(v),d.appendChild(p),d.appendChild(g),c.appendChild(d),u.appendChild(c),o.appendChild(u),o};return(0,u.useCallback)((e=(0,d._)(function(e){var a,n,i,s,o,u,c,d;return(0,p.Jh)(this,function(f){switch(f.label){case 0:if((i=e.layer.getSource())instanceof ee()&&(n=i.getUrl()),i instanceof et()&&(n=(s=i.getUrls())?s[0]:void 0),!n)return[2];if(n.endsWith("?")&&(n=n.slice(0,-1)),!(o=t({layer:e.layer,feature:e.feature})))return[2];return u={"Content-Type":"application/xml"},[4,fetch(n,{method:"POST",headers:(null===(a=e.layer)||void 0===a?void 0:a.get("useBearerToken"))?(0,l._)({},u,(0,ea.a)(null==r?void 0:r.getKeycloak())):u,body:new XMLSerializer().serializeToString(o)})];case 1:if(!(c=f.sent()).ok)throw Error("No successful response while executing a WFS-LockFeature");return[4,c.text()];case 2:if(d=f.sent(),new DOMParser().parseFromString(d,"text/xml").getElementsByTagName("wfs:FeaturesNotLocked").length>0)throw Error(`Error while locking a feature: ${d}`);return[2,d]}})}),function(r){return e.apply(this,arguments)}),[r])},rp=(e,r,t)=>{var a,n=(0,M.S)(),i=(0,en.Z)();var s=(0,u.useCallback)((a=(0,d._)(function(a){var s,o,u,c,d,f,m,g;return(0,p.Jh)(this,function(p){switch(p.label){case 0:if(!n||!e)return[2];if(s=a.coordinate,!(o=n.getView().getResolution()))return[2];if(c=null==(u=e.getSource())?void 0:u.getFeatureInfoUrl(s,o,n.getView().getProjection(),{INFO_FORMAT:"application/json",BUFFER:10}),d={"Content-Type":"application/json"},!c)return[2];p.label=1;case 1:return p.trys.push([1,4,5,6]),n.getTargetElement().style.cursor="wait",[4,fetch(c,{method:"GET",headers:e.get("useBearerToken")?(0,l._)({},d,(0,ea.a)(null==i?void 0:i.getKeycloak())):d})];case 2:if(!(f=p.sent()).ok)throw Error("No successful response");return[4,f.json()];case 3:return m=p.sent(),r&&r(m),[3,6];case 4:return g=p.sent(),L.Z.error("Error: ",g),t&&t(),[3,6];case 5:return n.getTargetElement().style.cursor="",[7];case 6:return[2]}})}),function(e){return a.apply(this,arguments)}),[i,e,n,r,t]),o=(0,u.useCallback)(r=>{if(!n||!e||r.dragging)return;var t=e.getData(r.pixel);if(t instanceof Uint8ClampedArray){var a=t&&t[3]>0;n.getTargetElement().style.cursor=a?"pointer":""}},[e,n]);(0,u.useEffect)(()=>{if(!!n)return n.on("pointermove",o),n.on("singleclick",s),()=>{n.un("pointermove",o),n.un("singleclick",s)}},[n,o,s])},rm=e=>{var r,t,a,n=e.layer,i=e.onLockSuccess,l=void 0===i?()=>{}:i,s=e.onLockError,c=void 0===s?()=>{}:s,m=e.onCreate,g=void 0===m?()=>{}:m,v=(0,f._)((0,u.useState)(!1),2),h=v[0],y=v[1],j=eW(),x=rf(),b=A(),w=(0,M.S)(),S=(0,k.useTranslation)().t,_=O(e=>e.editFeature.userEditMode);rp(n,(r=(0,d._)(function(e){var r,t;return(0,p.Jh)(this,function(a){switch(a.label){case 0:if(!(e.features.length&&(_.includes("UPDATE")||_.includes("DELETE"))))return[3,6];if(r=e.features[0],!n||!r)return[2];if(!q().wfsLockFeatureEnabled)return[3,5];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,x({layer:n,feature:r})];case 2:if(!(t=a.sent()))return[2];return b((0,eC.hr)(r)),l(t),[3,4];case 3:return c(a.sent()),[3,4];case 4:return[3,6];case 5:b((0,eC.hr)(r)),a.label=6;case 6:return[2]}})}),function(e){return r.apply(this,arguments)}));var C=(t=(0,d._)(function(){var e,r,t,a,i;return(0,p.Jh)(this,function(l){switch(l.label){case 0:if(!w||!n)return[2];l.label=1;case 1:return l.trys.push([1,3,4,5]),y(!0),[4,j(n)];case 2:if(!(t=l.sent()))return[2];switch(null==(a=null===(r=t.featureTypes[0])||void 0===r?void 0:null===(e=r.properties)||void 0===e?void 0:e.find(e=>eJ(e.type)))?void 0:a.type){case"gml:MultiPoint":return[2,"MultiPoint"];case"gml:Point":return[2,"Point"];case"gml:MultiLineString":return[2,"MultiLineString"];case"gml:LineString":return[2,"LineString"];case"gml:MultiPolygon":return[2,"MultiPolygon"];case"gml:Polygon":return[2,"Polygon"];case"xsd:boolean":case"xsd:date":case"xsd:int":case"xsd:number":case"xsd:string":case void 0:return[2]}return[3,5];case 3:return i=l.sent(),L.Z.error(i),[3,5];case 4:return y(!1),[7];case 5:return[2]}})}),function(){return t.apply(this,arguments)});var E=(a=(0,d._)(function(){var e;return(0,p.Jh)(this,function(r){switch(r.label){case 0:return[4,C()];case 1:if(!(e=r.sent()))return[2];return b((0,eC.hr)({type:"Feature",properties:{},geometry:{type:e,coordinates:[]}})),g(),[2]}})}),function(){return a.apply(this,arguments)});return(0,o.jsxs)("div",{className:"edit-feature-switch",children:[_.includes("CREATE")&&(0,o.jsxs)(o.Fragment,{children:[_.includes("UPDATE")&&(0,o.jsx)("div",{children:S("EditFeatureSwitch.usageHint")}),(0,o.jsx)(eN.ZP,{loading:h,onClick:E,children:S("EditFeatureSwitch.createFeature")})]}),!_.includes("CREATE")&&(_.includes("UPDATE")||_.includes("DELETE"))&&(0,o.jsx)("div",{children:S("EditFeatureSwitch.limitedUsageHint")})]})},rg=e=>{var r,t,a=(0,n._)({},(0,i._)(e)),c=(0,k.useTranslation)().t,m=(0,f._)((0,u.useState)(),2),v=m[0],h=m[1],y=(0,f._)((0,u.useState)(!1),2),j=y[0],x=y[1],b=(0,f._)((0,u.useState)(c("EditFeatureDrawer.featureEditor")),2),w=b[0],S=b[1],_=O(e=>e.editFeatureDrawerOpen),C=O(e=>e.editFeature.layerId),E=O(e=>e.editFeature.feature),N=O(e=>e.editFeature.formDirty),F=(0,M.S)(),P=A(),Z=eK(),D=ei();(0,u.useEffect)(()=>{if(!!F&&!!C){var e=T.C.getLayerByOlUid(F,C);if(!e||!(0,X.us)(e)){L.Z.warn(`Could not find layer with id ${C}`);return}S(`${c("EditFeatureDrawer.featureEditor")} - ${e.get("name")}`),h(e)}},[F,C,c]);var U=(r=(0,d._)(function(){var e,r,t;return(0,p.Jh)(this,function(a){switch(a.label){case 0:if(!v||!E||!E.id||!q().wfsLockFeatureEnabled)return[2];a.label=1;case 1:return a.trys.push([1,4,,5]),(e=new(H())).setId(E.id),[4,Z({layer:v,deleteFeatures:[],upsertFeatures:[e]})];case 2:if(!(r=a.sent()))return[2];return[4,D({layer:v,transaction:r})];case 3:return a.sent(),[3,5];case 4:return t=a.sent(),L.Z.error("Error while releasing the lock on the feature: ",t),[3,5];case 5:return[2]}})}),function(){return r.apply(this,arguments)});var I=(t=(0,d._)(function(){return(0,p.Jh)(this,function(e){switch(e.label){case 0:return[4,U()];case 1:return e.sent(),P((0,eq.Cp)()),P((0,eC.uQ)(!1)),P((0,eC.mc)()),x(!1),[2]}})}),function(){return t.apply(this,arguments)});return(0,o.jsxs)(eH,(0,s._)((0,l._)({className:"map-drawer edit-feature-drawer",onClose:()=>{v&&E&&N?g.Z.confirm({maskClosable:!1,title:c("EditFeatureDrawer.closeDrawerWarnTitle"),content:c("EditFeatureDrawer.closeDrawerWarnContent"),okType:"danger",onOk:I}):I()},open:_,title:w},a),{children:[!v&&(0,o.jsx)(W.Z,{message:c("EditFeatureDrawer.noLayerFoundError"),type:"error",showIcon:!0}),j&&(0,o.jsx)(W.Z,{message:c("EditFeatureDrawer.isFeatureLockedErrorMsg"),type:"error",showIcon:!0}),v&&C&&!E&&(0,o.jsx)(rm,{layer:v,onLockSuccess:()=>{x(!1)},onLockError:()=>{x(!0)},onCreate:()=>{x(!1)}}),v&&E&&(0,o.jsx)(rd,{feature:E,layer:v})]}))},rv=t("11843"),rh=t("51614"),ry=t.n(rh),rj=t("39988"),rx=t.n(rj),rb=t("21473"),rw=t("79670"),rS=t.n(rw),r_=e=>{var r,t,a=(0,n._)({},(0,i._)(e)),c=B(),d=(0,k.useTranslation)().t,f=O(e=>e.legal),p=(0,M.S)(),m=(e,r)=>{c.forEach(t=>{if((n=t.integration)&&"footer"===n.placement&&(null===(a=t.integration)||void 0===a?void 0:a.placementOrientation)===e){var a,n,i,l=t.key,s=t.wrappedComponent;r.splice((null===(i=t.integration)||void 0===i?void 0:i.insertionIndex)||0,0,(0,o.jsx)(s,{},l))}})};if((0,u.useEffect)(()=>{if(!(!p||p.getControls().getArray().find(e=>e instanceof rx())))p.addControl(new(rx())({target:"scale-line-container"}))},[p]),(0,u.useEffect)(()=>{if(!(!p||p.getControls().getArray().find(e=>e instanceof ry())))p.addControl(new(ry())({coordinateFormat:(0,rb.createStringXY)(2),projection:p.getView().getProjection(),target:"mouse-position"}))},[p]),!p)return(0,o.jsx)(o.Fragment,{});var g=()=>{window.open(f.contact,"_blank")},v=()=>{window.open(f.imprint,"_blank")},h=()=>{window.open(f.privacy,"_blank")};return(0,o.jsxs)("div",(0,s._)((0,l._)({className:"footer"},a),{children:[(0,o.jsx)("div",{className:"item-container left-items",children:(m("left",r=[(0,o.jsx)("div",{id:"scale-line-container","aria-label":"scale-line"},"scale-line-container"),(0,o.jsx)(rv.Z,{type:"vertical"},"scale-line-divider"),(0,o.jsxs)("div",{className:"scale-combo","aria-label":"scale-combo",children:[d("Footer.scale"),":\xa0",(0,o.jsx)(rS(),{"aria-label":"scalecombo-dropdown"}),(0,o.jsx)(rv.Z,{type:"vertical"})]},"scale-combo-container"),(0,o.jsxs)("div",{className:"reference-system","aria-label":"reference-system",children:[d("Footer.refSystem"),": ",p.getView().getProjection().getCode(),(0,o.jsx)(rv.Z,{type:"vertical"})]},"reference-system-container"),(0,o.jsxs)("div",{className:"mouse-position-wrapper",children:[d("Footer.mousePosition"),":\xa0",(0,o.jsx)("div",{id:"mouse-position",className:"mouse-position","aria-label":"mouse-position"})]},"mouse-position-container")]),r)}),(0,o.jsx)("div",{className:"item-container right-items",children:(t=[(0,o.jsx)(eN.ZP,{onClick:g,type:"link",children:d("Footer.contact")},"open-contact"),(0,o.jsx)(eN.ZP,{onClick:v,type:"link",children:d("Footer.imprint")},"open-imprint"),(0,o.jsx)(eN.ZP,{onClick:h,type:"link",children:d("Footer.privacypolicy")},"open-privacy")],c.length>0&&m("right",t),t)})]}))},rC="documentationbutton",rE=e=>{var r=e.className,t=r?`${rC} ${r}`:rC;return(0,o.jsx)(Z(),{type:"link",onClick:()=>window.open("/gis-docs","_blank"),className:t,icon:(0,o.jsx)(eZ.G,{icon:eP.FDd})})},rk=t("1695"),rL=()=>{var e,r=(0,M.S)(),t=(0,k.useTranslation)().t;return(0,u.useCallback)((e=(0,d._)(function(e,a){var n,i,l,s;return(0,p.Jh)(this,function(o){switch(o.label){case 0:if(!r)return[2];return[4,(0,rk.AH)({bounded:a?1:void 0,viewBox:a?null==a?void 0:a.toString():void 0,countryCodes:"",nominatimBaseUrl:(null===(n=q().search)||void 0===n?void 0:n.nominatimUrl)||"https://nominatim.openstreetmap.org/search?"})(e)];case 1:return i=o.sent(),l=new(e5()),s=null==i?void 0:i.features.filter(e=>!ew()(null==e?void 0:e.properties.geojson)).map(e=>{var t=l.readFeature(e.properties.geojson,{dataProjection:"EPSG:4326",featureProjection:r.getView().getProjection()});if(!Array.isArray(t))return t.set("title",e.properties.display_name),t}).filter(e=>void 0!==e),[2,[{title:t("useNominatimSearchEngine.title"),features:null!=s?s:[]}]]}})}),function(r,t){return e.apply(this,arguments)}),[r,t])},rN=t("7739"),rF=t.n(rN),rT=t("60319"),rP=t.n(rT),rZ=e=>e.map(e=>`(${e.trim()}^4 OR *${e.trim()}*^2 OR ${e.trim()}~1)`).join(" AND "),rM=e=>{var r=e.searchValue,t=e.map,a=r.trim().replaceAll(/[()\\\-_.//]/g," ").split(" ").map(e=>e.trim()).filter(e=>""!==e),n=[],i=t.getAllLayers().filter(e=>e.get("searchable"));return Object.entries(rF()(i,e=>{var r;return null===(r=e.get("searchConfig"))||void 0===r?void 0:r.attributes})).forEach(e=>{var r=(0,f._)(e,2),t=r[0],i=r[1].filter(e=>(0,X.us)(e)).map(e=>{var r,t;return null===(t=e.getSource())||void 0===t?void 0:null===(r=t.getParams())||void 0===r?void 0:r.LAYERS}).map(e=>`featureType:"${e}"`).join(" OR "),l=`(${i}) AND (${rZ(a)})`;n.push({query:l,fieldList:"undefined"!==t?t.split(",").join(" "):void 0})}),n},rD=()=>{var e,r=(0,en.Z)();return(0,u.useCallback)((e=(0,d._)(function(e){var t,a,n,i,s,o,u,c,d,f;return(0,p.Jh)(this,function(p){switch(p.label){case 0:return n={q:e.query,rows:null!==(t=e.rowsPerQuery)&&void 0!==t?t:100,defType:null!==(a=e.queryParser)&&void 0!==a?a:"edismax"},e.fieldList?n.qf=e.fieldList:n.qf=null!==(i=e.coreName)&&void 0!==i?i:"search",e.viewBox&&(s=`geometry:[${e.viewBox[1]},${e.viewBox[0]} TO ${e.viewBox[3]},${e.viewBox[2]}]`,n.fq=s),e.useSolrHighlighting&&(n.hl=!0,n["hl.fl"]="*",n["hl.tag.pre"]=null!==(o=e.tagPre)&&void 0!==o?o:"<b>",n["hl.tag.post"]=null!==(u=e.tagPost)&&void 0!==u?u:"</b>",n["hl.requireFieldMatch"]=null===(c=e.requireFieldMatch)||void 0===c||c),d={"Content-Type":"application/json"},[4,fetch(e.searchUrl,{method:"POST",headers:(0,l._)({},d,(0,ea.a)(null==r?void 0:r.getKeycloak())),body:JSON.stringify(n)})];case 1:if(!(f=p.sent()).ok)throw Error("Failed to execute Solr query");return[4,f.json()];case 2:return[2,p.sent()]}})}),function(r){return e.apply(this,arguments)}),[r])},rA=e=>"fulfilled"===e.status,rO=e=>"rejected"===e.status,rU=()=>{var e,r=(0,M.S)(),t=rD(),a=(0,u.useCallback)((e,r)=>e.replace(/{\s*(\w+?)\s*}/g,(e,t)=>{var a;return(null===(a=r[t])||void 0===a?void 0:a.toString())||""}),[]),n=(0,u.useCallback)((e,t,n)=>{if(!r)return"";var i=T.C.getLayerByNameParam(r,t.featureType[0]),l=null==i?void 0:i.get("searchConfig"),s=["category","id","featureType","geometry","search"],o="";if(null==l?void 0:l.displayTemplate)return a(l.displayTemplate,t);if(n){var u=Object.keys(n).filter(e=>!s.includes(e));if(u.length>0){var c=n[u[0]];return`${c} [${u[0]}]`}}return Object.keys(t).filter(e=>!s.includes(e)).forEach(r=>{var a,n=null===(a=t[r])||void 0===a?void 0:a.toString();!o&&n.toLowerCase().indexOf(e.toLowerCase())>-1&&(o=`${n} [${r}]`)}),!o&&(o=t.id),o},[r,a]);return(0,u.useCallback)((e=(0,d._)(function(e,a){var i,s,o,u,c,d,f,m,g,v,h,y,j,x,b,w,S,_,C,E,k,N,F,P,Z,M,D,A,O,U,I,G,R;return(0,p.Jh)(this,function(p){switch(p.label){case 0:if(!r)return[2];u=null!==(o=null===(i=q().search)||void 0===i?void 0:i.solrBasePath)&&void 0!==o?o:"/search/query",c=rM({searchValue:e,map:r}),d=[],f=!0,m=!1,g=void 0;try{for(v=c[Symbol.iterator]();!(f=(h=v.next()).done);f=!0)y=h.value,d.push(t({searchUrl:u,query:y.query,fieldList:y.fieldList,rowsPerQuery:null===(x=q().search)||void 0===x?void 0:null===(j=x.solrQueryConfig)||void 0===j?void 0:j.rowsPerQuery,queryParser:null===(w=q().search)||void 0===w?void 0:null===(b=w.solrQueryConfig)||void 0===b?void 0:b.queryParser,coreName:null===(S=q().search)||void 0===S?void 0:S.coreName,useSolrHighlighting:null===(_=q().search)||void 0===_?void 0:_.useSolrHighlighting,tagPre:null===(E=q().search)||void 0===E?void 0:null===(C=E.solrQueryConfig)||void 0===C?void 0:C.tagPre,tagPost:null===(N=q().search)||void 0===N?void 0:null===(k=N.solrQueryConfig)||void 0===k?void 0:k.tagPost,requireFieldMatch:null===(P=q().search)||void 0===P?void 0:null===(F=P.solrQueryConfig)||void 0===F?void 0:F.requireFieldMatch,viewBox:a}))}catch(e){m=!0,g=e}finally{try{!f&&null!=v.return&&v.return()}finally{if(m)throw g}}return[4,Promise.allSettled(d)];case 1:return M=(Z=p.sent().map(e=>({value:rA(e)?e.value:void 0,reason:rO(e)?e.reason:void 0,status:e.status}))).filter(e=>"fulfilled"===e.status),Z.filter(e=>"rejected"===e.status).map(e=>{L.Z.error("Error while fetching the solr results for layer ",e.reason)}),D=M.flatMap(e=>{var r,t;return null===(t=e.value)||void 0===t?void 0:null===(r=t.response)||void 0===r?void 0:r.docs}).filter(e=>e),A=Object.assign({},...M.map(e=>{var r;return null===(r=e.value)||void 0===r?void 0:r.highlighting})),O=new(rP()),U=[],(null===(s=q().search)||void 0===s?void 0:s.groupByCategory)?I=rF()(D,e=>{var r;return null==e?void 0:null===(r=e.category)||void 0===r?void 0:r[0]}):(G=r.getAllLayers().filter(e=>e.get("searchable")),R=D.map(e=>{var r,t=null===(r=G.filter(e=>(0,X.us)(e)).find(r=>{var t,a,n;return(null===(a=r.getSource())||void 0===a?void 0:null===(t=a.getParams())||void 0===t?void 0:t.LAYERS)===(null==e?void 0:null===(n=e.featureType)||void 0===n?void 0:n[0])}))||void 0===r?void 0:r.get("name");return(0,l._)({layerTitle:t},e)}),I=rF()(R,e=>null==e?void 0:e.layerTitle)),Object.keys(I).forEach(t=>{var a=I[t].map(t=>{if(!!(null==t?void 0:null===(s=t.geometry)||void 0===s?void 0:s[0])){var a=t.id,i=O.readGeometry(t.geometry[0],{dataProjection:"EPSG:4326",featureProjection:r.getView().getProjection()}),l=new(H())({geometry:i});if(l.set("title",n(e,t,null==A?void 0:A[a])),null===(o=t.featureType)||void 0===o?void 0:o[0]){var s,o,u,c,d=T.C.getLayerByNameParam(r,null===(c=t.featureType)||void 0===c?void 0:c[0]);d&&(l.set("layer",d),u=d.get("name"))}else u=a.substring(0,a.lastIndexOf("_"));return l.set("ftName",u),l}}).filter(e=>e);U.push({title:t,features:a})}),[2,U]}})}),function(r,t){return e.apply(this,arguments)}),[t,n,r])},rI=t("76849"),rG=t("62481"),rR=e=>"fulfilled"===e.status,r$=e=>"rejected"===e.status,rB=()=>{var e,r=(0,M.S)(),t=e0(),a=(0,u.useCallback)((e,r)=>e.replace(/{\s*(\w+?)\s*}/g,(e,t)=>r.getProperties()[t]||""),[]),n=(0,u.useCallback)((e,r,t)=>{var n=null==t?void 0:t.get("searchConfig");if(null==n?void 0:n.displayTemplate)return a(n.displayTemplate,r);var i=["category","id","featureType","geometry","search"],l=!0,s=!1,o=void 0;try{for(var u,c=Object.entries(r.getProperties())[Symbol.iterator]();!(l=(u=c.next()).done);l=!0){var d=(0,f._)(u.value,2),p=d[0],m=d[1];if(!i.includes(p)){var g=null==m?void 0:m.toString();if(g.toLowerCase().indexOf(null==e?void 0:e.toLowerCase())>-1)return`${g} [${p}]`}}}catch(e){s=!0,o=e}finally{try{!l&&null!=c.return&&c.return()}finally{if(s)throw o}}return r.getId()},[a]);return(0,u.useCallback)((e=(0,d._)(function(e,a){var i,l,s,o,u,c,d,f,m,g,v,h,y,j,x,b,w,S,_,C,E;return(0,p.Jh)(this,function(p){switch(p.label){case 0:if(!r)return[2];if(0===(i=r.getAllLayers().filter(e=>e.get("searchable"))).length)return L.Z.warn("No queryable layer found."),[2];l=[],s=[],o=!0,u=!1,c=void 0;try{for(d=i[Symbol.iterator]();!(o=(f=d.next()).done);o=!0){if(m=f.value,!(0,X.us)(m)){L.Z.warn("Layer type not supported in search: ",m);continue}if(!((g=null==m?void 0:m.get("searchConfig"))&&g.attributes)){L.Z.warn("No search configuration given for layer: ",m);continue}v=g.attributes.map(r=>(0,rI.like)(r,`*${e}*`,"*",".","!",!1)),l.push(t({layer:m,filter:1===v.length?v[0]:(0,rI.or)(...v),bbox:a?(0,rG.transformExtent)(a,"EPSG:4326",r.getView().getProjection()):void 0,maxFeatures:10,propertyNames:g.attributes})),s.push(m)}}catch(e){u=!0,c=e}finally{try{!o&&null!=d.return&&d.return()}finally{if(u)throw c}}return[4,Promise.allSettled(l)];case 1:y=(h=p.sent().map((e,r)=>({value:rR(e)?e.value:void 0,reason:r$(e)?e.reason:void 0,status:e.status,layer:s[r]}))).filter(e=>"fulfilled"===e.status),h.filter(e=>"rejected"===e.status).map(e=>{L.Z.error(`Error while fetching the layer search results for layer "${e.layer.get("name")}": `,e.reason)}),j=new(e5()),x=[],b=!0,w=!1,S=void 0;try{for(_=function(){var t=E.value,a=j.readFeatures(t.value,{featureProjection:r.getView().getProjection()});a.forEach(r=>{r.set("title",n(e,r,t.layer)),r.set("layer",t.layer)}),x.push({title:t.layer.get("name"),features:a})},C=y[Symbol.iterator]();!(b=(E=C.next()).done);b=!0)_()}catch(e){w=!0,S=e}finally{try{!b&&null!=C.return&&C.return()}finally{if(w)throw S}}return[2,x]}})}),function(r,t){return e.apply(this,arguments)}),[t,n,r])},rV=t("91754"),rz=t("45540"),rJ=t("71136"),rW=t("81316"),rK=t("87044"),rq=t("14622"),rY=t("40440"),rH=t("89686"),rX=t.n(rH),rQ=t("22336"),r0=t.n(rQ),r1=t("28513"),r2=t.n(r1),r3=t("83713"),r4=t.n(r3),r5=t("35674"),r7=t("86955"),r6=t.n(r7),r9=e=>{var r,t,a=e.geocoderSearchEngine,n=e.dataSearchEngine,i=(0,M.S)(),l=(0,k.useTranslation)().t,s=(0,u.useRef)(null),c=(0,f._)((0,u.useState)(!!a),2),m=c[0],g=c[1],h=(0,f._)((0,u.useState)(!!n),2),y=h[0],j=h[1],b=(0,f._)((0,u.useState)(null===(t=null===(r=q().search)||void 0===r?void 0:r.defaultUseViewBox)||void 0===t||t),2),w=b[0],S=b[1],_=(0,f._)((0,u.useState)(""),2),C=_[0],E=_[1],N=(0,f._)((0,u.useState)(!1),2),F=N[0],T=N[1],P=(0,f._)((0,u.useState)(!1),2),Z=P[0],D=P[1],A=(0,f._)((0,u.useState)(!1),2),O=A[0],U=A[1],I=(0,f._)((0,u.useState)([]),2),G=I[0],R=I[1];(0,u.useEffect)(()=>(window.addEventListener("mousedown",$),()=>{window.removeEventListener("mousedown",$)}),[]);var $=e=>{for(var r=e.target;r;)r=r.parentNode;if(!(s.current&&s.current.contains(e.target)))D(!1)},B=(0,u.useMemo)(()=>{var e={items:[{label:(0,o.jsx)(eg.Z,{checked:w,onChange:e=>S(e.target.checked),children:l("MultiSearch.searchInViewBox")}),key:"viewbox"}]};return a&&e.items.push({label:(0,o.jsx)(eg.Z,{checked:m,onChange:e=>g(e.target.checked),children:l("MultiSearch.searchGeocoder")}),key:"geocoder"}),n&&e.items.push({label:(0,o.jsx)(eg.Z,{checked:y,onChange:e=>j(e.target.checked),children:l("MultiSearch.searchData")}),key:"data"}),e},[w,l,a,n,m,y]),V=(0,u.useCallback)((0,d._)(function(){var e,r,t,l,s,o,u,c,d,f,g,v;return(0,p.Jh)(this,function(p){switch(p.label){case 0:if(!i||!m&&!y)return[2];if(t=null!==(r=null===(e=q().search)||void 0===e?void 0:e.minChars)&&void 0!==r?r:3,C.length<t)return z(),[2];if(T(!0),w&&(o=null==i?void 0:i.getView().getProjection(),(u=null==i?void 0:null===(s=i.getView())||void 0===s?void 0:s.calculateExtent())&&(l=(0,rG.transformExtent)(u,o,"EPSG:4326"))),c=[],!(y&&n))return[3,5];p.label=1;case 1:return p.trys.push([1,3,4,5]),[4,n(C,l)];case 2:if(!(d=p.sent()))throw Error("No response from data search engine.");return c.push(...d),[3,5];case 3:return f=p.sent(),L.Z.error("Error while data search: \n",f),[3,5];case 4:return!m&&T(!1),[7];case 5:if(!(m&&a))return[3,10];p.label=6;case 6:return p.trys.push([6,8,9,10]),[4,a(C,l)];case 7:if(!(g=p.sent()))throw Error("No response from geocoder search engine.");return c.push(...g),[3,10];case 8:return v=p.sent(),L.Z.error("Error while geocoder search: \n",v),[3,10];case 9:return T(!1),[7];case 10:return R(c.every(e=>0===e.features.length)?[]:c),D(!0),[2]}})}),[i,m,y,C,w,n,a]);(0,u.useEffect)(()=>{var e,r,t=setTimeout(()=>{V()},null!==(r=null===(e=q().search)||void 0===e?void 0:e.delay)&&void 0!==r?r:1e3);return()=>clearTimeout(t)},[V]);var z=()=>{R([])},J=e=>{var r=e.feature.get("layer");if(!!(null==r?void 0:r.get("editable")))return[(0,o.jsx)(o.Fragment,{})]},W=(0,u.useMemo)(()=>new(r4())({stroke:new(r2())({color:"rgb(255,0,0)",width:2}),fill:new(r0())({color:"rgba(255,255,255, 0.5)"}),image:new(rX())({radius:10,fill:new(r0())({color:"rgba(255,255,255, 0.5)"}),stroke:new(r2())({color:"rgb(255,0,0)",width:3})})}),[]);return(0,o.jsxs)("div",{className:"multi-search",ref:s,children:[(0,o.jsxs)(rK.Z.Compact,{children:[(0,o.jsx)(v.Z,{value:C,disabled:!m&&!y,onChange:e=>{T(""!==e.target.value),E(e.target.value)},allowClear:!0,onFocus:()=>D(!0),placeholder:m&&y?l("MultiSearch.searchPlaceholder"):!m&&y?l("MultiSearch.searchPlaceholderDataOnly"):m&&!y?l("MultiSearch.searchPlaceholderGeocoderOnly"):void 0,prefix:(0,o.jsx)(rV.Z,{}),suffix:F?(0,o.jsx)(rz.Z,{}):null}),(0,o.jsx)(rq.Z,{menu:B,trigger:["click"],onOpenChange:U,open:O,children:(0,o.jsx)(rY.Z,{title:l("MultiSearch.settingsTooltip"),placement:"right",children:(0,o.jsx)(eN.ZP,{icon:(0,o.jsx)(rJ.Z,{})})})})]}),(()=>{if(C.length<2||!Z||F||!G)return null;var e=G.length;if(0===e)return(0,o.jsx)("div",{className:"no-search-result-div",children:(0,o.jsx)(rW.Z,{image:rW.Z.PRESENTED_IMAGE_SIMPLE})});var r=e=>{var r,t=null==e?void 0:null===(r=e.feature)||void 0===r?void 0:r.get("layer");t&&i&&!t.getVisible()&&(t.setVisible(!0),r5.k.setParentsVisible(i,i.getLayerGroup().getLayers(),(0,x.getUid)(t)))},t=e=>{var r,t,a,n=null===(r=e.feature.getGeometry())||void 0===r?void 0:r.getExtent(),l=null!==(a=null===(t=document.getElementsByClassName("tool-menu")[0])||void 0===t?void 0:t.clientWidth)&&void 0!==a?a:0;n&&(null==i||i.getView().fit(n,{size:i.getSize(),padding:[0,0,0,l]}))};return(0,o.jsx)(r6(),{searchResults:G,numTotal:e,accordion:!0,searchTerms:C.split(" "),actionsCreator:J,layerStyle:W,onClick:e=>{var a;D(!1),t(e),(null===(a=q().search)||void 0===a?void 0:a.activateLayerOnClick)&&r(e)}})})()]})},r8=e=>{var r=(0,n._)({},(0,i._)(e)),t=O(e=>e.searchEngines.includes("nominatim")),a=O(e=>e.searchEngines.includes("solr")),s=O(e=>e.searchEngines.includes("wfs")),u=rB(),c=rU(),d=rL();return t||a||s?(0,o.jsx)("div",{className:"search","aria-label":"search-field",children:(0,o.jsx)(r9,(0,l._)({"aria-label":"search",geocoderSearchEngine:(()=>{if(t)return d})(),dataSearchEngine:(()=>{if(a&&s){L.Z.warn("Both solr and wfs search are configured. Only one of them can be used at the same time.");return}return a?c:s?u:void 0})()},r))}):(L.Z.warn("Neither nominatim, solr nor wfs search is configured."),(0,o.jsx)(o.Fragment,{}))},te=t("88495"),tr=e=>{var r=e.email,t=e.size,a=e.rating,n=e.defaultImage,i=e.force,l=(void 0===r?"":r).toLowerCase(),s=(0,te.md5)(l),o=`https://www.gravatar.com/avatar/${s}?s=${void 0===t?80:t}&r=${void 0===a?"g":a}&d=${void 0===n?"identicon":n}`;return void 0!==i&&i&&(o=`${o}&f=y`),o},tt=t("51108"),ta=()=>"9.0.0",tn=e=>{var r,t=e.opener,a=(0,ep._)(e,["opener"]),n=(0,k.useTranslation)().t,i=O(e=>e.appInfo),d=O(e=>e.logoPath),p=O(e=>e.description),m=(0,f._)((0,u.useState)(!1),2),v=m[0],h=m[1],y=()=>{h(!v)};return r=t?c().cloneElement(t,{onClick:y}):(0,o.jsx)("button",{onClick:y,children:"Open"}),(0,o.jsxs)(o.Fragment,{children:[r,(0,o.jsxs)(g.Z,(0,s._)((0,l._)({className:"application-info",title:n("ApplicationInfo.title"),centered:!0,open:v,onOk:y,onCancel:y,footer:null},a),{children:[(0,o.jsx)("img",{className:"logo",src:d}),(0,o.jsx)("div",{className:"description",children:p}),(0,o.jsx)(tt.Z,{title:n("ApplicationInfo.clientVersionTitle"),value:ta()}),i.version&&i.buildTime&&(0,o.jsx)(tt.Z,{title:n("ApplicationInfo.backendVersionTitle"),value:`${i.version} (${i.buildTime})`})]}))]})},ti=t("60205"),tl=e=>{var r=e.className,t=e.imageSrc,a=e.userMenu,n=e.userName,i=e.style,u=(0,ep._)(e,["className","imageSrc","userMenu","userName","style"]),c="userchip",d=()=>ek()(n)?n.split(" ").map(e=>{var r;return null!==(r=e[0])&&void 0!==r?r:""}).join("").toUpperCase():"??",f=()=>{var e=r?`${r} ${c}`:c;return(0,o.jsxs)("div",{className:e,style:i,children:[(0,o.jsx)(ti.C,(0,s._)((0,l._)({src:t,size:"large",className:"userimage"},u),{children:t?"":d()})),(0,o.jsx)("span",{className:"username",children:n})]})};return(null==a?void 0:a.items)?(0,o.jsx)(rq.Z,{menu:a,trigger:["click"],getPopupContainer:()=>document.getElementsByClassName(c)[0],children:f()}):f()},ts=()=>{var e,r=(0,k.useTranslation)().t,t=(0,f._)((0,u.useState)(),2),a=t[0],n=t[1],i=(0,en.Z)(),l=null==i?void 0:i.getKeycloak(),s=O(e=>e.user);(0,u.useEffect)(()=>{var e;(e=(0,d._)(function(){return(0,p.Jh)(this,function(e){switch(e.label){case 0:return[4,null==l?void 0:l.createLoginUrl()];case 1:return n(e.sent()),[2]}})}),function(){return e.apply(this,arguments)})()},[l]);var c=e=>{switch(e.key){case"settings":l&&l.accountManagement();break;case"info":break;case"login":l&&l.login();break;case"logout":l&&l.logout({redirectUri:a})}};return e3()(s)?(0,o.jsx)(o.Fragment,{}):(0,o.jsx)(tl,{size:"small",imageSrc:tr({email:(null===(e=s.providerDetails)||void 0===e?void 0:e.email)||"",size:28}),userName:(0,o.jsx)(eZ.G,{icon:eP.gc2}),userMenu:(()=>{var e={key:"login",icon:(0,o.jsx)(eZ.G,{icon:eP.Yem}),label:r("UserMenu.loginMenuTitle")},t={key:"username",label:(0,o.jsx)("div",{className:"user-name","aria-label":"user-name",children:(0,o.jsx)("span",{children:null===(f=s.providerDetails)||void 0===f?void 0:f.username})})},a={type:"divider"},n={key:"settings",icon:(0,o.jsx)(eZ.G,{icon:eP.gNZ}),label:r("UserMenu.settingsMenuTitle")},i={key:"info",icon:(0,o.jsx)(eZ.G,{icon:eP.YHc}),label:(0,o.jsx)(tn,{opener:(0,o.jsx)("span",{className:"info-opener","aria-label":"info-opener",children:r("UserMenu.infoMenuTitle")})})},u={key:"logout",icon:(0,o.jsx)(eZ.G,{icon:eP.HEx}),label:(0,o.jsx)("div",{"aria-label":"login",children:r("UserMenu.logoutMenuTitle")})},d=[];if(e3()(s))(null===(p=q().keycloak)||void 0===p?void 0:p.enabled)&&d.push(e),d.push(i);else{var f,p,m,g,v,h=null==l?void 0:null===(v=l.tokenParsed)||void 0===v?void 0:null===(g=v.resource_access)||void 0===g?void 0:null===(m=g.account)||void 0===m?void 0:m.roles,y=Array.isArray(h)&&h.indexOf("manage-account")>-1;d.push(...y?[t,a,n,i,a,u]:[t,a,i,a,u])}return{items:d,onClick:c}})()})},to=e=>{var r,t,a,u=(0,n._)({},(0,i._)(e)),c=O(e=>e.title),d=O(e=>e.logoPath),f=B(),p=(e,r)=>{f.forEach(t=>{if((n=t.integration)&&"header"===n.placement&&(null===(a=t.integration)||void 0===a?void 0:a.placementOrientation)===e){var a,n,i,l=t.key,s=t.wrappedComponent;r.splice((null===(i=t.integration)||void 0===i?void 0:i.insertionIndex)||0,0,(0,o.jsx)(s,{},l))}})},m=()=>{if(q().documentationButtonVisible)return(0,o.jsx)("div",{"aria-label":"documentation-button",children:(0,o.jsx)(rE,{type:"link"},"documentation-button")},"documentation-button")},g=()=>(0,o.jsx)("div",{"aria-label":"user-menu",children:(0,o.jsx)(ts,{},"user-menu")},"user-menu");return(0,o.jsxs)("div",(0,s._)((0,l._)({className:"header"},u),{children:[(0,o.jsx)("div",{className:"item-container left-items",children:(p("left",r=[(0,o.jsx)("img",{className:"logo","aria-label":"logo",src:d},"logo"),(0,o.jsx)("div",{className:"title","aria-label":"title",children:c},"title")]),r)}),(0,o.jsx)("div",{className:"item-container center-items",children:(p("center",t=[(0,o.jsx)(r8,{"aria-label":"search-input",name:"search-input",className:"search-input"},"search")]),t)}),(0,o.jsx)("div",{className:"item-container right-items",children:(p("right",a=[m(),g()].filter(e=>void 0!==e)),a)})]}))},tu=t("29097"),tc=t("32757"),td=t.n(tc),tf=t("23578"),tp=t("91885"),tm=e=>{var r=e.layer,t=(0,ep._)(e,["layer"]),a=(0,f._)((0,u.useState)(!1),2),n=a[0],i=a[1],c=(0,f._)((0,u.useState)(),2),m=c[0],g=c[1],v=(0,f._)((0,u.useState)(),2),h=v[0],y=v[1],j=(0,en.Z)(),x=(0,k.useTranslation)().t,b=(0,u.useCallback)((0,d._)(function(){var e;return(0,p.Jh)(this,function(t){switch(t.label){case 0:if(t.trys.push([0,2,3,4]),i(!0),g(""),!r||!r.get("shogunId"))throw Error("No layer provided or the layer has no shogunId set");return[4,null==j?void 0:j.layer().findOne(r.get("shogunId"))];case 1:return y(t.sent()),[3,4];case 2:return e=t.sent(),L.Z.error(e),g(x("LayerConfiguration.errorMessage")),[3,4];case 3:return i(!1),[7];case 4:return[2]}})}),[x,j,r]);return((0,u.useEffect)(()=>{b()},[b]),m)?(0,o.jsx)(W.Z,{type:"error",closable:!0,message:m}):(0,o.jsx)(tp.Z,{spinning:n,children:(0,o.jsx)("pre",(0,s._)((0,l._)({className:"layer-configuration"},t),{children:(0,o.jsx)("code",{children:JSON.stringify(h,null,"  ")})}))})},tg=e=>{var r=e.layer,t=(0,ep._)(e,["layer"]),a=(0,f._)((0,u.useState)(!1),2),n=a[0],i=a[1],c=(0,f._)((0,u.useState)(),2),m=c[0],g=c[1],v=(0,f._)((0,u.useState)(),2),h=v[0],y=v[1],j=(0,en.Z)(),x=(0,k.useTranslation)().t,b=(0,u.useCallback)((0,d._)(function(){var e;return(0,p.Jh)(this,function(t){switch(t.label){case 0:if(!r||!(0,X.us)(r))return[2];t.label=1;case 1:return t.trys.push([1,3,4,5]),i(!0),y(""),g(void 0),[4,F.Z.getWmsCapabilitiesByLayer(r,{headers:(0,l._)({},r.get("useBearerToken")?(0,l._)({},(0,ea.a)(null==j?void 0:j.getKeycloak())):void 0)})];case 2:return g(t.sent()),[3,5];case 3:return e=t.sent(),L.Z.error(e),y(x("LayerDetails.errorMessage")),[3,5];case 4:return i(!1),[7];case 5:return[2]}})}),[x,j,r]);(0,u.useEffect)(()=>{b()},[b]);var w=()=>{var e;if(!!r&&!!(0,X.us)(r))return null===(e=r.getSource())||void 0===e?void 0:e.getParams().LAYERS},S=()=>{if(!!r&&!!(0,X.us)(r)){if(r.getSource()instanceof ee()&&(e=r.getSource().getUrl()),r.getSource()instanceof et()){var e,t=r.getSource().getUrls();e=t?t[0]:void 0}if(e)return N.V.createValidGetCapabilitiesRequest(e,"WMS","1.3.0")}},_=()=>{var e,r,t,a=null==m?void 0:null===(r=m.Capability)||void 0===r?void 0:null===(e=r.Layer)||void 0===e?void 0:e.Layer,n=w();return Array.isArray(a)?(t=null==a?void 0:a.find(e=>(null==e?void 0:e.Name)===n),t):a},C=()=>{var e=_();if(!!e&&!!e.EX_GeographicBoundingBox)return[e.EX_GeographicBoundingBox.westBoundLongitude,e.EX_GeographicBoundingBox.southBoundLatitude,e.EX_GeographicBoundingBox.eastBoundLongitude,e.EX_GeographicBoundingBox.northBoundLatitude].join(", ")},E=()=>{var e=_();if(!!e)return e.MinScaleDenominator},T=()=>{var e=_();if(!!e)return e.MaxScaleDenominator},P=()=>{var e=_();if(!!e)return e.Abstract},Z=()=>{var e;return null==m?void 0:null===(e=m.Service)||void 0===e?void 0:e.Abstract},M=()=>{var e,r;return null==m?void 0:null===(r=m.Service)||void 0===r?void 0:null===(e=r.ContactInformation)||void 0===e?void 0:e.ContactElectronicMailAddress},D=()=>{var e=_();if(!!e)return e.Title},A=()=>{var e;return null==m?void 0:null===(e=m.Service)||void 0===e?void 0:e.AccessConstraints};return h?(0,o.jsx)(W.Z,{type:"error",closable:!0,message:h}):(0,o.jsx)(tp.Z,{spinning:n,children:(0,o.jsxs)(em.Z,(0,s._)((0,l._)({className:"layer-details",layout:"horizontal",size:"small",labelAlign:"left",labelWrap:!0,labelCol:{flex:"150px"}},t),{children:[(0,o.jsx)(em.Z.Item,{name:"layerName",label:x("LayerDetails.layerNameLabel"),children:(0,o.jsx)("span",{children:w()?w():x("LayerDetails.noDataPlaceholder")})}),(0,o.jsx)(em.Z.Item,{name:"layerTitle",label:x("LayerDetails.layerTitleLabel"),children:(0,o.jsx)("span",{children:D()?D():x("LayerDetails.noDataPlaceholder")})}),(0,o.jsx)(em.Z.Item,{name:"service-abstract",label:x("LayerDetails.serviceAbstractLabel"),children:(0,o.jsx)("span",{children:Z()?Z():x("LayerDetails.noDataPlaceholder")})}),(0,o.jsx)(em.Z.Item,{name:"abstract",label:x("LayerDetails.abstractLabel"),children:(0,o.jsx)("span",{children:P()?P():x("LayerDetails.noDataPlaceholder")})}),(0,o.jsx)(em.Z.Item,{name:"accessConstraints",label:x("LayerDetails.accessConstraintsLabel"),children:(0,o.jsx)("span",{children:A()?A():x("LayerDetails.noDataPlaceholder")})}),(0,o.jsx)(em.Z.Item,{name:"CapabilitiesUrl",label:x("LayerDetails.capabilitiesUrlLabel"),children:(0,o.jsx)("a",{href:S(),children:S()})}),(0,o.jsx)(em.Z.Item,{name:"contact",label:x("LayerDetails.contactLabel"),children:M()?(0,o.jsx)("a",{href:`mailto:${M()}`,children:M()}):(0,o.jsx)("span",{children:x("LayerDetails.noDataPlaceholder")})}),(0,o.jsx)(em.Z.Item,{name:"minScale",label:x("LayerDetails.minScaleLabel"),children:(0,o.jsx)("span",{children:E()?E():x("LayerDetails.noDataPlaceholder")})}),(0,o.jsx)(em.Z.Item,{name:"maxScale",label:x("LayerDetails.maxScaleLabel"),children:(0,o.jsx)("span",{children:T()?T():x("LayerDetails.noDataPlaceholder")})}),(0,o.jsx)(em.Z.Item,{name:"bbox",label:x("LayerDetails.bboxLabel"),children:(0,o.jsx)("span",{children:C()?C():x("LayerDetails.noDataPlaceholder")})})]}))})},tv=e=>{var r=(0,n._)({},(0,i._)(e)),t=(0,f._)((0,u.useState)(),2),a=t[0],c=t[1],d=(0,f._)((0,u.useState)(!1),2),p=d[0],m=d[1],v=O(e=>e.layerDetailsModal.visible),h=O(e=>e.layerDetailsModal.layerId),y=A(),j=(0,M.S)(),x=(0,k.useTranslation)().t;return(0,u.useEffect)(()=>{if(!j)return;if(!h){c(void 0);return}var e=T.C.getLayerByOlUid(j,h);if(e instanceof td())c(e)},[j,h]),(0,o.jsxs)(g.Z,(0,s._)((0,l._)({className:"layer-details-modal",title:(0,o.jsxs)("div",{className:"title-group",children:[(0,o.jsx)("span",{children:x("LayerDetailsModal.title",{layerName:null==a?void 0:a.get("name")})}),(null==a?void 0:a.get("shogunId"))&&(0,o.jsx)(rY.Z,{title:x(p?"LayerDetailsModal.internalConfigurationButtonTooltipPressed":"LayerDetailsModal.internalConfigurationButtonTooltip"),children:(0,o.jsx)(eN.ZP,{type:"link",className:p?"pressed":"",icon:(0,o.jsx)(tu.Z,{}),onClick:()=>{m(!p)}})})]}),open:v,onCancel:()=>{y((0,tf.Cp)()),y((0,tf.uF)(void 0))},width:800,footer:!1},r),{children:[(0,o.jsx)(tg,{layer:a,hidden:p}),(null==a?void 0:a.get("shogunId"))&&(0,o.jsx)(tm,{layer:a,hidden:!p})]}))},th=t("8321"),ty=t("34353"),tj=t.n(ty),tx=()=>{var e=(0,k.useTranslation)().t,r=(0,M.S)(),t=(0,f._)((0,u.useState)(!1),2),a=t[0],n=t[1],i=O(e=>e.mapToolbarVisible.visible),s={tooltipPlacement:"left",tooltipProps:{mouseEnterDelay:.5}};return(0,o.jsx)(o.Fragment,{children:i&&(0,o.jsxs)(rt,{id:"map-toolbar",alignment:"vertical",role:"toolbar",children:[r&&(0,o.jsx)(tj(),(0,l._)({"aria-label":"zoom-in",tooltip:e("MapToolbar.zoomInTooltip"),icon:(0,o.jsx)(eZ.G,{icon:eP.r8p})},s)),r&&(0,o.jsx)(tj(),(0,l._)({"aria-label":"zoom-out",tooltip:e("MapToolbar.zoomOutTooltip"),delta:-1,icon:(0,o.jsx)(eZ.G,{icon:eP.Kl4})},s)),r&&(0,o.jsx)(th.GeoLocationButton,(0,l._)({"aria-label":"geolocation",showMarker:!0,follow:!0,pressed:a,onChange:()=>n(!a),tooltip:e("MapToolbar.geoLocation"),icon:(0,o.jsx)(eZ.G,{icon:eP.iUi}),pressedIcon:(0,o.jsx)(eZ.G,{icon:eP.GrN})},s))]})})},tb=t("63161"),tw=t("59250"),tS=t("96459"),t_=e=>{var r=(0,n._)({},(0,i._)(e)),t=(0,f._)((0,u.useState)({name:"Default Style",rules:[{name:"Area",symbolizers:[{kind:"Fill",color:"#00b72b",outlineOpacity:.8,opacity:.5,fillOpacity:.8,outlineWidth:2,outlineColor:"#00b72b"}]},{name:"Line",symbolizers:[{kind:"Line",color:"#00b72b",width:2,opacity:.8}]},{name:"Point",symbolizers:[{kind:"Mark",wellKnownName:"circle",color:"#00b72b",strokeColor:"#00b72b",strokeOpacity:.8,opacity:.5,radius:7}],filter:["==","label","undefined"]},{name:"Text",symbolizers:[{kind:"Text",label:"{{label}}",size:12,font:["sans-serif"],opacity:.8,color:"#00b72b",offset:[5,5],haloColor:"#00b72b",haloWidth:1}],filter:["!=","label","undefined"]}]}),2),a=t[0],s=t[1],c=(0,M.S)();return(0,u.useEffect)(()=>{if(!!a&&!!c){var e,r=new tS.Z,t=T.C.getLayerByName(c,"react-geo_digitize");(e=(0,d._)(function(){var e,n,i,l,s,o,u,c,d,f,m,g,v,h;return(0,p.Jh)(this,function(p){switch(p.label){case 0:s=!0,o=!1,u=void 0,p.label=1;case 1:p.trys.push([1,6,7,8]),c=a.rules[Symbol.iterator](),p.label=2;case 2:if(s=(d=c.next()).done)return[3,5];return m={name:"",rules:[f=d.value]},[4,r.writeStyle(m)];case 3:if(!(g=p.sent()).output)return[2];"Fill"===f.symbolizers[0].kind&&(e=g.output),"Text"===f.symbolizers[0].kind&&(l=g.output),"Line"===f.symbolizers[0].kind&&(n=g.output),"Mark"===f.symbolizers[0].kind&&(i=g.output),p.label=4;case 4:return s=!0,[3,2];case 5:return[3,8];case 6:return v=p.sent(),o=!0,u=v,[3,8];case 7:try{!s&&null!=c.return&&c.return()}finally{if(o)throw u}return[7];case 8:return h=(r,t)=>{var a,s=null===(a=r.getGeometry())||void 0===a?void 0:a.getType();if(!!s){if(["MultiPolygon","Polygon","Circle"].includes(s))return"function"==typeof e?e(r,t):e;if(["MultiLineString","LineString"].includes(s))return"function"==typeof n?n(r,t):n;if(["MultiPoint","Point"].includes(s))return r.get("label")?"function"==typeof l?l(r,t):l:"function"==typeof i?i(r,t):i}},t.setStyle(h),[2]}})}),function(){return e.apply(this,arguments)})()}},[a,c]),(0,o.jsx)(tw.U,(0,l._)({style:a,onStyleChange:s},r))},tC=e=>{var r=(0,n._)({},(0,i._)(e)),t=A(),a=O(e=>e.stylingDrawerVisibility),u=(0,k.useTranslation)().t;return(0,o.jsx)(eY.Z,(0,s._)((0,l._)({title:u("StylingDrawer.title"),placement:"right",onClose:()=>{t((0,tb.ah)(!1))},open:a,rootClassName:"color-pick-drawer",maskClosable:!1,mask:!1},r),{children:(0,o.jsx)(t_,{})}))},tE=t("98930"),tk=t("1581"),tL=t.n(tk),tN=t("37669"),tF=t("12416"),tT=t("41354"),tP=t("2803"),tZ=t("50755"),tM=h.Z.Option,tD=()=>{var e=Object.keys(tZ.Z.services.resourceStore.data);return(0,o.jsx)("div",{className:"language-select","aria-label":"language-selector",children:(0,o.jsx)(h.Z,{defaultValue:tZ.Z.language||"en",onChange:e=>{tZ.Z.changeLanguage(e)},children:e.map(e=>(0,o.jsx)(tM,{value:e,children:e.toUpperCase()},e))})})},tA=t("68428"),tO=t("97691"),tU=t("32446"),tI=t("33411"),tG=t("20640"),tR=t.n(tG),t$=t("86977"),tB=()=>{var e=(0,M.S)(),r=(0,u.useMemo)(()=>["layerConfig","isExternalLayer","isUploadedLayer","groupName"],[]),t=(0,k.useTranslation)().t,a=e?r5.k.getLink(e,";",e=>e.get("name"),e=>(e instanceof E()||e instanceof _())&&e.getVisible(),r):"",n=(0,f._)((0,u.useState)(a),2),i=n[0],l=n[1],s=`Hey,\r
check out the layer-composition I created:\r
\r
${i}`;return(0,u.useEffect)(()=>{if(!!e){var t=[],a=e=>e.get("name"),n=e=>(e instanceof E()||e instanceof _())&&e.getVisible(),i=()=>{l(r5.k.getLink(e,";",a,n,r))},s=()=>{e.getAllLayers().filter(e=>e.get("isExternalLayer")||e.get("isUploadedLayer")).forEach(e=>{var r=e.get("layerConfig");r&&(r.clientConfig?r.clientConfig.opacity=e.getOpacity():r.clientConfig={opacity:e.getOpacity()},e.set("layerConfig",r))}),i()},o=e=>{var r=e.getLayers().getArray(),a=!0,n=!1,l=void 0;try{for(var u,c=r[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var d=u.value;if(d instanceof w())o(d);else{var f=d.on("change:visible",i),p=d.on("change:opacity",s);t.push(f,p)}}}catch(e){n=!0,l=e}finally{try{!a&&null!=c.return&&c.return()}finally{if(n)throw l}}},u=e.getView().on("change:center",i),c=e.getView().on("change:resolution",i);return o(e.getLayerGroup()),s(),()=>{(0,t$.unByKey)(u),(0,t$.unByKey)(c),(0,t$.unByKey)(t)}}},[r,e,t]),(0,o.jsxs)("div",{className:"permalink-wrapper",children:[(0,o.jsxs)("div",{className:"icons",children:[(0,o.jsx)(rY.Z,{title:t("Permalink.whatsAppTooltip"),children:(0,o.jsx)(tA.Z,{onClick:function(){var e=new URL("https://wa.me");e.searchParams.set("text",s),window.open(e)}})}),(0,o.jsx)(rY.Z,{title:t("Permalink.mailTooltip"),children:(0,o.jsx)(tO.Z,{onClick:function(){var e=new URL("mailto:");e.searchParams.set("subject","SHOGun Web-GIS"),e.searchParams.set("body",s),window.open(e.toString().replace(/\+/g,"%20"),"_self")}})})]}),(0,o.jsxs)("div",{className:"link","aria-label":"permalink-url",children:[(0,o.jsx)(v.Z,{value:i,readOnly:!0}),(0,o.jsx)(rY.Z,{title:t("Permalink.copyTooltip"),children:(0,o.jsx)(tU.Z,{onClick:function(){tR()(i)?tI.ZP.info(t("Permalink.copiedToClipboard")):tI.ZP.info(t("Permalink.copyToClipboardFailed"))}})})]})]})},tV=t("59418"),tz=t("57795"),tJ=t("55002"),tW=t("99865"),tK=t("19867"),tq=t("16827"),tY=t("86954"),tH=t("50122"),tX=t("97955"),tQ=t("11032");class t0 extends tQ.N{serialize(e,r){var t=super.serialize(e,r);return t.baseURL.startsWith("/geoserver/ows")&&(t.baseURL=`http://shogun-geoserver:8080${t.baseURL}`),t.baseURL.startsWith("/geoserver/SHOGUN")&&(t.baseURL=`http://shogun-geoserver:8080${t.baseURL}`),t}}var t1=t0,t2=class e extends t1{serialize(e,r){var t=(0,l._)({tileSize:[512,512]},r),a=e.getSource();if(!!a&&!!this.validateSource(a))return(0,l._)({},super.serialize(e,t),{type:tX.n.TYPE_WMS},r)}},t3=e=>{var r=e.value,t=e.id,a=e.placeholder,n=e.maxLength,i=(0,ep._)(e,["value","id","placeholder","maxLength"]),s=A();return(0,u.useEffect)(()=>{!ew()(t)&&s((0,tH.eV)({[t]:r}))},[r,t,s]),(0,o.jsx)(v.Z,(0,l._)({id:t,value:r,placeholder:a,maxLength:n,showCount:!!(n&&n>1)},i))},t4=e=>{var r=e.printManager,t=e.onValueChange,a=e.placeholder,n=e.value,i=(0,ep._)(e,["printManager","onValueChange","placeholder","value"]),c=(0,f._)((0,u.useState)(n),2),d=c[0],p=c[1],m=(0,u.useRef)(d);return(0,u.useEffect)(()=>{m.current=n},[n]),(0,u.useEffect)(()=>{r&&(r.setLayout(d),m.current!==d&&t())},[r,d,t,n]),(0,u.useEffect)(()=>{p(n)},[n]),(0,o.jsx)(h.Z,(0,s._)((0,l._)({placeholder:void 0===a?"Bitte w\xe4hlen Sie eine Vorlage aus":a,value:d,onChange:p},i),{children:null==r?void 0:r.getLayouts().map(e=>(0,o.jsx)(h.Z.Option,{value:e.name,children:e.name},e.name))}))},t5=e=>{var r=e.printManager,t=e.placeholder,a=e.value,n=e.outputFormats,i=(0,ep._)(e,["printManager","placeholder","value","outputFormats"]),c=(0,f._)((0,u.useState)(a),2),d=c[0],p=c[1];return(0,u.useEffect)(()=>{r&&r.setOutputFormat(d)},[r,d]),(0,u.useEffect)(()=>{p(a)},[a]),(0,o.jsx)(h.Z,(0,s._)((0,l._)({placeholder:t,value:d,onChange:p},i),{children:n.map(e=>(0,o.jsx)(h.Z.Option,{value:e,children:e.toLocaleUpperCase()},e))}))},t7=e=>{var r=e.printManager,t=e.placeholder,a=e.value,n=(0,ep._)(e,["printManager","placeholder","value"]),i=(0,f._)((0,u.useState)(a),2),c=i[0],d=i[1];return(0,u.useEffect)(()=>{r&&r.setDpi(c)},[r,c]),(0,u.useEffect)(()=>{d(a)},[a]),(0,o.jsx)(h.Z,(0,s._)((0,l._)({placeholder:t,value:c,onChange:d},n),{children:null==r?void 0:r.getDpis().map(e=>(0,o.jsx)(h.Z.Option,{value:e,children:`${e} DPI`},e))}))},t6=t("25764"),t9=e=>{var r=e.printManager,t=e.placeholder,a=e.value,n=(0,ep._)(e,["printManager","placeholder","value"]),i=(0,M.S)(),c=(0,f._)((0,u.useState)(0),2),d=c[0],p=c[1];return(0,u.useEffect)(()=>{r&&d&&r.setScale(d)},[r,d]),(0,u.useEffect)(()=>{var e=()=>{var e=r.getScale();e&&p(e)},t=null==i?void 0:i.getInteractions().getArray().find(e=>e.get("name")===t6.C.TRANSFORM_INTERACTION_NAME);if(r&&t)return t.on("scaling",e),()=>{t.on("scaling",e)}},[r,i]),(0,u.useEffect)(()=>{a&&p(a)},[a]),(0,o.jsx)(h.Z,(0,s._)((0,l._)({placeholder:t,value:d,onChange:p},n),{children:null==r?void 0:r.getScales().map(e=>(0,o.jsx)(h.Z.Option,{value:e,children:`1 : ${e.toLocaleString()}`},e))}))};t("26398").j.getLegendGraphicUrl=e=>{if(e.get("legendUrl"))return e.get("legendUrl");if(e.getSource()instanceof et()||e.getSource()instanceof ee()){var r=e.get("customPrintLegendParams"),t=e.getSource(),a=t.getParams(),n=a.LAYERS,i=a.VERSION,s=a.FORMAT,o=t instanceof ee()?t.getUrl():t.getUrls()[0];o.startsWith("/geoserver/ows")&&(o=`http://shogun-geoserver:8080${o}`);var u=(0,l._)({LAYER:n.split(",")[0],VERSION:i||"1.3.0",SERVICE:"WMS",REQUEST:"GetLegendGraphic",FORMAT:s||"image/png"},r),c=Object.keys(u).map(e=>`${encodeURIComponent(e)}=${encodeURIComponent(u[e])}`).join("&");return o.startsWith("/geoserver/SHOGUN")?(o=`http://shogun-geoserver:8080${o}/service?`,`${o}${c}`):o.endsWith("?")?`${o}${c}`:`${o}?${c}`}return""};var t8=e=>{var r,t,a=e.active,n=e.customPrintScales,i=void 0===n?[]:n,c=e.layerBlackList,m=void 0===c?[]:c,g=e.outputFormats,v=(0,ep._)(e,["active","customPrintScales","layerBlackList","outputFormats"]),h=(0,f._)(em.Z.useForm(),1)[0],y=(0,k.useTranslation)(),j=y.t,x=y.i18n,b=(0,M.S)(),S=A(),_=x.language,C=(0,en.Z)(),E=O(e=>e.print.customMapParams),N=O(e=>e.print.customParams),F=O(e=>e.print.printApp),P=(0,f._)((0,u.useState)(null),2),Z=P[0],D=P[1],U=(0,f._)((0,u.useState)(!1),2),I=U[0],G=U[1],R=(0,f._)((0,u.useState)(null),2),$=R[0],B=R[1],V=(0,u.useCallback)(e=>{if(!!b){var r=e.get("name");return r&&!m.includes(r)&&e.getVisible()&&!(e instanceof w())&&T.C.layerInResolutionRange(e,b)}},[b,m]),z=(0,u.useCallback)(e=>{if(ew()(b))return!1;var r=e.get("name"),t=!m.includes(r),a=!e.get("hideLegendInPrint"),n=e.getVisible()&&T.C.layerInResolutionRange(e,b),i=!(e instanceof w());if(t&&a&&n&&i){var l=null==b?void 0:b.getView().getResolution();return l&&e.set("customPrintLegendParams",{SCALE:T.C.getScaleForResolution(l,"m")}),!0}return!1},[b,m]),J=(0,u.useCallback)(e=>b?T.C.getAllLayers(b).filter(r=>{var t=r.get("name");return t&&!t.includes("react-geo")&&r.getVisible()&&!(r instanceof w())&&r!==e}):[],[b]),K=(0,u.useCallback)(e=>{var r=e.getExtentLayer();if(!r)return"";var t=J(r),a=[];return t.filter(e=>{var r,t;return e.getSource&&(null===(r=e.getSource())||void 0===r?void 0:r.getAttributions)&&(null===(t=e.getSource())||void 0===t?void 0:t.getAttributions())}).forEach(e=>{var r=tY.Z.getLayerAttributionsText(e,",",!0);!a.includes(r)&&a.push(r)}),a.join(", ").trim()},[J]),Y=(0,u.useCallback)((0,d._)(function(){var e,r,t,a,n,s,o,u,c;return(0,p.Jh)(this,function(d){switch(d.label){case 0:if(ew()(b))return[2];n={url:(null===(e=q().print)||void 0===e?void 0:e.url)||"/print",map:b,customPrintScales:null==b?void 0:null===(a=b.getView())||void 0===a?void 0:null===(t=a.getResolutions())||void 0===t?void 0:null===(r=t.map(e=>{var r,t,a=null==b?void 0:null===(t=b.getView())||void 0===t?void 0:null===(r=t.getProjection())||void 0===r?void 0:r.getUnits();if(void 0!==e){var n=T.C.getScaleForResolution(e,a);if(void 0!==n)return T.C.roundScale(n)}}).filter(e=>void 0!==e))||void 0===r?void 0:r.reverse(),timeout:6e4,layerFilter:V,headers:(0,l._)({},(0,ea.a)(null==C?void 0:C.getKeycloak())),transformOpts:{rotate:!1},serializers:[new tW.o,new tz.o,new tJ.S,new tK.g,new tq.N,new t1,new t2],legendFilter:z},i.length>0&&(n=(0,l._)({},n,{customPrintScales:i.toReversed()})),s=new tV.C(n),d.label=1;case 1:return d.trys.push([1,8,,9]),[4,s.init()];case 2:if(d.sent(),u=s.getPrintApps(),F)return[3,5];if(!(u&&_&&u.includes(_)))return[3,4];return[4,s.setPrintApp(_)];case 3:d.sent(),d.label=4;case 4:return[3,7];case 5:return[4,s.setPrintApp(F)];case 6:d.sent(),d.label=7;case 7:return s.setOutputFormat(s.getOutputFormats()[0]),s.setDpi(s.getDpis()[0]),s.setLayout(null===(o=s.getLayouts()[0])||void 0===o?void 0:o.name),[2,s];case 8:return c=d.sent(),B(()=>j("PrintForm.managerErrorMessage")),L.Z.error("Could not initialize print manager: ",c),[3,9];case 9:return[2]}})}),[b,V,C,z,i,F,_,j]);(0,u.useEffect)(()=>{Z&&S((0,tH.eV)({attributions:K(Z)}))},[S,K,Z]),(0,eM.b)((0,d._)(function(){var e;return(0,p.Jh)(this,function(r){switch(r.label){case 0:if(!a)return[3,3];if(Z)return[3,2];return h.resetFields(),[4,Y()];case 1:(e=r.sent())&&D(e),r.label=2;case 2:return[3,4];case 3:null==Z||Z.shutdownManager(),D(null),r.label=4;case 4:return[2]}})}),[Z,a,Y,h]),(0,u.useEffect)(()=>{Z&&(N&&Z.setCustomParams(N),E&&Z.setCustomMapParams(E))},[Z,N,E]);var H=(r=(0,d._)(function(){var e,r;return(0,p.Jh)(this,function(t){switch(t.label){case 0:if(t.trys.push([0,2,3,4]),B(null),G(!0),!Z)return[2];return[4,Z.print(!1)];case 1:if(!(e=t.sent()))throw Error("No download URL available, the job has failed.");return window.open(e),[3,4];case 2:return r=t.sent(),B(j("PrintForm.printJobErrorMsg")||null),L.Z.error(r),[3,4];case 3:return G(!1),[7];case 4:return[2]}})}),function(){return r.apply(this,arguments)});return(0,o.jsxs)("div",{className:"print","aria-label":"print-form",children:[$&&(0,o.jsx)(W.Z,{className:"print-alert",message:$,type:"error",closable:!0,showIcon:!0,onClose:()=>{B(null)}}),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(em.Z,(0,s._)((0,l._)({form:h,className:"print-form",labelAlign:"left",labelCol:{flex:"90px"}},v),{children:(null==Z?void 0:Z.isInitiated())&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(em.Z.Item,{"aria-label":"print-title",name:"title",label:j("PrintForm.title"),initialValue:j("PrintForm.initialTitle"),children:(0,o.jsx)(t3,{"aria-label":"print-title-input",maxLength:50,placeholder:j("PrintForm.titlePlaceholder")})}),(0,o.jsx)(em.Z.Item,{"aria-label":"print-comment",name:"comment",label:j("PrintForm.comment"),children:(0,o.jsx)(t3,{"aria-label":"print-comment-input",maxLength:200,placeholder:j("PrintForm.commentPlaceholder")})}),(0,o.jsx)(em.Z.Item,{"aria-label":"print-layout",name:"layout",label:j("PrintForm.layout"),initialValue:null==Z?void 0:null===(t=Z.getLayouts()[0])||void 0===t?void 0:t.name,children:(0,o.jsx)(t4,{"aria-label":"print-layout-input",printManager:Z,onValueChange:()=>{h.setFieldValue("dpi",null==Z?void 0:Z.getDpis()[0])}})}),(0,o.jsx)(em.Z.Item,{"aria-label":"print-scale",name:"scale",label:j("PrintForm.scale"),initialValue:null==Z?void 0:Z.getClosestScaleToFitMap(),children:(0,o.jsx)(t9,{"aria-label":"print-scale-input",printManager:Z})}),(0,o.jsx)(em.Z.Item,{"aria-label":"print-dpi",name:"dpi",label:j("PrintForm.dpi"),initialValue:Z.getDpis()[0],children:(0,o.jsx)(t7,{"aria-label":"print-dpi-input",printManager:Z,placeholder:j("PrintForm.resolutionPlaceholder")})}),(0,o.jsx)(em.Z.Item,{"aria-label":"print-format",name:"format",label:j("PrintForm.format"),initialValue:"pdf",children:(0,o.jsx)(t5,{"aria-label":"print-format-input",printManager:Z,outputFormats:void 0===g?["pdf","png"]:g,placeholder:j("PrintForm.outputFormatPlaceholder")})})]})})),(0,o.jsx)(eN.ZP,{"aria-label":"create-print",className:"print-button tool-menu-button",disabled:!(null==Z?void 0:Z.isInitiated()),icon:(0,o.jsx)(eZ.G,{icon:eP.q7m}),loading:I,onClick:H,children:j("PrintForm.downloadBtnText")})]})]})},ae=t("5737"),ar=t("71230"),at=t("49840"),aa=t.n(at),an=t("49288"),ai=e=>{var r=e.keyName,t=e.onChange,a=void 0===t?()=>{}:t,n=e.options,i=(0,k.useTranslation)().t;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(em.Z.Item,{name:[r,"name"],rules:[{required:!0,message:i("AttributionRow.missingKey")},e=>{var r=e.getFieldsValue;return{validator(e,t){var a=r(!0);return a.fields&&Object.entries(a.fields).filter(e=>{var r=(0,f._)(e,2)[1];return(null==r?void 0:r.name)===t}).length>1?Promise.reject(Error(i("AttributionRow.keyInUse"))):Promise.resolve()}}}],children:(0,o.jsx)(an.Z,{placeholder:i("AttributionRow.keyPlaceholder"),onChange:e=>{a(e)},options:null==n?void 0:n.map(e=>({value:e}))})}),(0,o.jsx)(em.Z.Item,{name:[r,"value"],rules:[{required:!0,message:i("AttributionRow.missingValue")}],children:(0,o.jsx)(v.Z,{placeholder:i("AttributionRow.valuePlaceholder"),onChange:e=>{a(e.target.value)}})})]})},al=e=>{var r,t=e.selectedFeature,a=(0,ep._)(e,["selectedFeature"]),n=(0,f._)((0,u.useState)(!0),2),i=n[0],c=n[1],g=(0,f._)((0,u.useState)([]),2),v=g[0],h=g[1],y=(0,f._)((0,u.useState)([]),2),j=y[0],x=y[1],b=(0,f._)(m.ZP.useNotification(),2)[1],w=(0,f._)(em.Z.useForm(),1)[0],S=(0,M.S)(),_=void 0!==t,C=(0,k.useTranslation)().t,E=(0,u.useCallback)(e=>{var r,t=null===(r=e.fields)||void 0===r?void 0:r.map(e=>{var r;return null==e?void 0:null===(r=e.name)||void 0===r?void 0:r.toLowerCase()}).filter(e=>void 0!==e);x(v.filter(e=>!(null==t?void 0:t.includes(e.toLowerCase()))))},[v]);(0,u.useEffect)(()=>{if(!!S){var e,r=null==t?void 0:t.getProperties();if(w.setFieldValue("fields",[]),r){var a=Object.entries(Object.fromEntries(Object.entries(r).filter(e=>!((0,f._)(e,2)[1]instanceof aa())).map(e=>{var r=(0,f._)(e,2);return[r[0],r[1]]}))).map(e=>{var r=(0,f._)(e,2);return{name:r[0],value:r[1]}});w.setFieldValue("fields",a)}var n=null===(e=rr.w.getDigitizeLayer(S).getSource())||void 0===e?void 0:e.getFeatures(),i=new Set;null==n||n.forEach(e=>{Object.keys(e.getProperties()).forEach(r=>{!(e.get(r)instanceof aa())&&i.add(r)})}),h(Array.from(i))}},[t,w,S]);var N=(e,r)=>{e(r)};var F=(r=(0,d._)(function(){var e;return(0,p.Jh)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,w.validateFields()];case 1:return r.sent(),c(!0),[3,3];case 2:return e=r.sent(),c(!1),L.Z.error(e),[3,3];case 3:return[2]}})}),function(){return r.apply(this,arguments)}),T=(e,r)=>e.map(e=>(0,o.jsxs)("div",{className:"attribute-row",children:[(0,o.jsx)(ai,{keyName:e.name,onChange:F,options:j},e.key),(0,o.jsxs)(eR.Z,{title:C("AttributionPopConfirm.title"),okText:C("AttributionPopConfirm.okText"),cancelText:C("AttributionPopConfirm.cancelText"),placement:"topRight",onConfirm:()=>{m.ZP.destroy(),m.ZP.info({message:C("notificationDeleteText.title"),description:C("notificationDeleteText.info"),placement:"top",duration:6}),N(r,e.name)},children:[b,(0,o.jsx)(eN.ZP,{className:"remove-attribute-button",type:"primary",danger:!0,icon:(0,o.jsx)(eZ.G,{icon:ae.El_})})]})]},e.key));return(0,o.jsxs)(eY.Z,(0,s._)((0,l._)({title:C("Attribution.title"),className:"attribution-drawer",placement:"right",mask:!1,maskClosable:!1,closable:!1,open:_},a),{children:[!t&&(0,o.jsx)(o.Fragment,{children:C("Attribution.select")}),(0,o.jsx)(ar.Z,{children:(0,o.jsxs)(em.Z,{onFinish:e=>{if(!!t){for(var r in m.ZP.destroy(),m.ZP.success({message:C("notificationApplyText.title"),placement:"top",duration:3.5}),t.getProperties())!(t.get(r)instanceof aa())&&t.unset(r);e.fields&&Object.values(e.fields).forEach(e=>{if(!!(null==e?void 0:e.name))t.set(e.name,e.value)})}},autoComplete:"off",form:w,onValuesChange:(e,r)=>{E(r)},children:[(0,o.jsx)(em.Z.List,{name:"fields",children:(e,r)=>{var a=r.add,n=r.remove;return(0,o.jsxs)(o.Fragment,{children:[T(e,n),(0,o.jsx)(em.Z.Item,{children:t?(0,o.jsx)(eN.ZP,{type:"dashed",onClick:()=>{a()},className:"add-attribute-button",icon:(0,o.jsx)(eZ.G,{icon:eP.r8p}),children:C("Attribution.add")}):(0,o.jsx)(o.Fragment,{})})]})}}),(0,o.jsx)(em.Z.Item,{children:(0,o.jsx)(eN.ZP,{className:"submit-attributes-button",type:"primary",htmlType:"submit",disabled:!i,hidden:!t,children:C("Attribution.submit")})})]})})]}))},as=t("92848"),ao=g.Z.confirm,au="deleteallbutton",ac=e=>{var r=e.className,t=e.digitizeLayer,a=(0,ep._)(e,["className","digitizeLayer"]),n=(0,f._)((0,u.useState)(null),2),i=n[0],s=n[1],c=(0,M.S)(),d=(0,k.useTranslation)().t;if((0,u.useEffect)(()=>{if(!!c)t?s([t]):s([rr.w.getDigitizeLayer(c)])},[c,t]),!i)return null;var p=r?`${au} ${r}`:au;return(0,o.jsx)(Z(),(0,l._)({onClick:()=>{ao({title:d("DeleteAllButton.deleteAll"),content:d("DeleteAllButton.confirmMessage"),icon:(0,o.jsx)(as.Z,{}),onOk(){var e;null===(e=i[0].getSource())||void 0===e||e.clear()}})},className:p},a))},ad=eL.Z.Dragger,af=e=>{var r=e.className,t=e.footer,a=e.width,n=e.onCancel,i=e.onSuccess,c=e.onFailure,d=(0,ep._)(e,["className","footer","width","onCancel","onSuccess","onFailure"]),p=(0,f._)((0,u.useState)(!1),2),m=p[0],v=p[1],h=(0,f._)((0,u.useState)(""),2),y=h[0],j=h[1],x=(0,M.S)(),b=(0,k.useTranslation)().t,w=["json","geojson"],S=["application/json","application/geo+json","application/geojson"];return(0,o.jsxs)(g.Z,(0,s._)((0,l._)({title:b("ImportDataModal.title"),onCancel:e=>{j(""),v(!1),null==n||n(e)},className:void 0===r?"import-data-modal":r,width:void 0===a?600:a,footer:void 0!==t&&t},d),{children:[y&&(0,o.jsx)(W.Z,{message:y,closable:!0,type:"error"}),(0,o.jsx)(tp.Z,{spinning:m,children:(0,o.jsxs)(ad,{customRequest:e=>{var r=e.file,t=e.onSuccess,a=e.onError;if(r instanceof File&&!!x){var n=new FileReader;n.onload=()=>{try{var e=new(e5())().readFeatures(n.result,{featureProjection:x.getView().getProjection()});null==t||t(e)}catch(e){null==a||a(e),L.Z.error("Error while reading the file: ",e)}},n.readAsText(r)}},accept:[...w.map(e=>`.${e}`),S].join(","),maxCount:1,showUploadList:!1,beforeUpload:e=>{var r=e.type,t=e.name.split(".").pop();return j(""),!!(S.includes(r)&&(!t||w.includes(t)))||(j(b("ImportDataModal.error.supportedFormats",{supportedFormats:S.join(", ")})),!1)},onChange:e=>{var r=e.file.status,t=e.file.response;if(!!x)if("uploading"===r)v(!0);else if("done"===r){var a=rr.w.getDigitizeLayer(x).getSource();null==a||a.addFeatures(t||[]),v(!1),tI.ZP.success(b("ImportDataModal.success")),null==i||i(t||[])}else"error"===r&&(v(!1),j(b("ImportDataModal.error.parsing")),null==c||c(e.file.error))},children:[(0,o.jsx)("p",{className:"ant-upload-drag-icon",children:(0,o.jsx)(eZ.G,{icon:eP.cf$})}),(0,o.jsx)("p",{className:"ant-upload-text",children:b("ImportDataModal.description")}),(0,o.jsx)("p",{className:"ant-upload-hint",children:b("ImportDataModal.hint")})]})})]}))},ap=()=>{var e=A(),r=(0,k.useTranslation)().t,t=O(e=>e.stylingDrawerVisibility);return(0,o.jsx)(eN.ZP,{type:"link",onClick:()=>{e((0,tb.ah)(!t))},icon:(0,o.jsx)(eZ.G,{icon:eP.XsY}),children:r(t?"StylingDrawer.closeColorPalette":"StylingDrawer.openColorPalette")})},am=e=>{var r=e.showDrawPoint,t=e.showDrawLine,a=e.showDrawPolygon,n=e.showDrawCircle,i=e.showDrawRectangle,l=e.showDrawAnnotation,s=e.showModifyFeatures,c=e.showUploadFeatures,d=e.showDeleteFeatures,p=(0,f._)((0,u.useState)(),2),m=p[0],g=p[1],v=(0,f._)((0,u.useState)(),2),h=v[0],y=v[1],j=(0,f._)((0,u.useState)(!1),2),x=j[0],b=j[1],w=(0,k.useTranslation)().t,S=(0,M.S)(),_=(0,u.useCallback)((e,r)=>{y(r),"draw-modify"!==r&&g(void 0)},[]),C=(0,u.useCallback)(e=>{e.selected.length>0?g(e.selected[0]):g(void 0)},[]),E=()=>{b(!1)};return S?(0,o.jsxs)("div",{className:"draw-tools",children:[(0,o.jsxs)(re.ToggleGroup,{selected:h,onChange:_,children:[r?(0,o.jsxs)(e9(),{value:"draw-point",drawType:"Point",type:"link",pressed:!1,children:[(0,o.jsx)(eZ.G,{icon:eP.diR}),(0,o.jsx)("span",{className:"draw-point",children:w("Draw.point")})]},"draw-point"):(0,o.jsx)(o.Fragment,{}),t?(0,o.jsxs)(e9(),{value:"draw-line",drawType:"LineString",type:"link",children:[(0,o.jsx)(eZ.G,{icon:eP.hx$}),(0,o.jsx)("span",{className:"draw-line",children:w("Draw.line")})]},"draw-line"):(0,o.jsx)(o.Fragment,{}),a?(0,o.jsxs)(e9(),{value:"draw-polygon",drawType:"Polygon",type:"link",children:[(0,o.jsx)(eZ.G,{icon:eP.Kak}),(0,o.jsx)("span",{className:"draw-polygon",children:w("Draw.polygon")})]},"draw-polygon"):(0,o.jsx)(o.Fragment,{}),n?(0,o.jsxs)(e9(),{value:"draw-circle",drawType:"Circle",type:"link",children:[(0,o.jsx)(eZ.G,{icon:eP.IJ7}),(0,o.jsx)("span",{className:"draw-circle",children:w("Draw.circle")})]},"draw-circle"):(0,o.jsx)(o.Fragment,{}),i?(0,o.jsxs)(e9(),{value:"draw-rectangle",drawType:"Rectangle",type:"link",children:[(0,o.jsx)(eZ.G,{icon:eP.pL1}),(0,o.jsx)("span",{className:"draw-rectangle",children:w("Draw.rectangle")})]},"draw-rectangle"):(0,o.jsx)(o.Fragment,{}),l?(0,o.jsxs)(e9(),{value:"draw-text",drawType:"Text",type:"link",children:[(0,o.jsx)(eZ.G,{icon:eP.yGG}),(0,o.jsx)("span",{className:"draw-text",children:w("Draw.text")})]},"draw-text"):(0,o.jsx)(o.Fragment,{}),(0,o.jsx)(ap,{},"styling"),s?(0,o.jsxs)(e8.ModifyButton,{value:"draw-modify",type:"link",onFeatureSelect:C,children:[(0,o.jsx)(eZ.G,{icon:eP.Yai}),(0,o.jsx)("span",{className:"draw-modify",children:w("Draw.modify")})]},"draw-modify"):(0,o.jsx)(o.Fragment,{}),d?(0,o.jsxs)(e7.DeleteButton,{value:"draw-delete",type:"link",children:[(0,o.jsx)(eZ.G,{icon:eP.xf2}),(0,o.jsx)("span",{className:"draw-delete",children:w("Draw.delete")})]},"draw-delete"):(0,o.jsx)(o.Fragment,{})]}),d?(0,o.jsxs)(ac,{value:"draw-delete-all",type:"link",children:[(0,o.jsx)(eZ.G,{icon:eP.$aW}),(0,o.jsx)("span",{className:"draw-delete-all",children:w("DeleteAllButton.deleteAll")})]}):(0,o.jsx)(o.Fragment,{}),c?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(eN.ZP,{onClick:()=>{b(!0)},"aria-label":"draw-upload",type:"link",icon:(0,o.jsx)(eZ.G,{icon:eP.cf$}),children:(0,o.jsx)("span",{className:"draw-upload",children:w("Draw.upload")})}),(0,o.jsx)(af,{open:x,onCancel:E,onSuccess:E})]}):(0,o.jsx)(o.Fragment,{}),c?(0,o.jsxs)(Z(),{value:"draw-export",onClick:()=>{var e=[];if(S){var r,t=S.getView().getProjection().getCode(),a=null===(r=rr.w.getDigitizeLayer(S).getSource())||void 0===r?void 0:r.getFeatures();if(a&&a.length>0){a.forEach(r=>{var a,n=r.clone();null===(a=n.getGeometry())||void 0===a||a.transform(t,"EPSG:4326"),e.push(n)});var n=new Blob([new(e5())().writeFeatures(e)],{type:"application/geo+json"}),i=window.URL.createObjectURL(n),l=document.createElement("a");l.href=i,l.setAttribute("download","exportedFeatures.geojson"),document.body.appendChild(l),l.click(),document.body.removeChild(l)}}},type:"link",children:[(0,o.jsx)(eZ.G,{icon:eP.q7m}),(0,o.jsx)("span",{className:"draw-export",children:w("Draw.export")})]}):(0,o.jsx)(o.Fragment,{}),(0,o.jsx)(al,{selectedFeature:m})]}):(0,o.jsx)(o.Fragment,{})},ag=t("96486"),av=t("71764"),ah=t("60878"),ay=t("80982"),aj=t.n(ay),ax=t("93349"),ab=t.n(ax),aw=e=>{var r=(0,M.S)(),t=(0,u.useCallback)((0,d._)(function(){var t,a,n,i,l;return(0,p.Jh)(this,function(s){return!r||T.C.getLayerByName(r,e.layerName)?[2]:(t=new(ab()),a=new(r0())({color:"rgba(255, 255, 255, 0.15)"}),n=new(r2())({color:"rgba(209, 70, 47, 1)",width:2}),i=new(r4())({fill:a,stroke:n,image:new(rX())({radius:5,fill:a,stroke:n})}),(l=new(aj())({source:t,style:i})).set("name",e.layerName),r.addLayer(l),[2])})}),[r,e.layerName]),a=(0,u.useCallback)(()=>{if(!r)return;var t=T.C.getLayerByName(r,e.layerName);if(!!t)r.removeLayer(t)},[r,e.layerName]);(0,u.useEffect)(()=>(t(),()=>a()),[a,t])},aS=t("1445"),a_=t("66678"),aC=t.n(a_),aE=e=>{var r=e.exportFilter,t=e.features,a=e.layer,n=e.selectedFeature,i=(0,ep._)(e,["exportFilter","features","layer","selectedFeature"]),s=(0,k.useTranslation)().t,u=A(),c=(0,M.S)(),d=O(e=>e.featureInfo.activeCopyTools),p=O(e=>e.editFeature.userEditMode),m=p.includes("CREATE")||p.includes("DELETE")||p.includes("UPDATE"),g=null==a?void 0:a.get("editable");return(0,o.jsxs)("div",{className:"pagination-toolbar",children:[(0,o.jsx)(aS.Z,(0,l._)({simple:!0,total:t.length,size:"small",pageSize:1},i)),(0,o.jsxs)("div",{className:"copy-buttons",children:[m&&(0,o.jsx)(rY.Z,{title:s(g?"PaginationToolbar.editFeature":"PaginationToolbar.editDisabled"),children:(0,o.jsx)(eN.ZP,{type:"text",size:"small",onClick:()=>{if(!!a&&!!c){var e=new(e5())().writeFeature(n);try{var r=JSON.parse(e),t=rr.w.getDigitizeLayer(c);if(!t)return;var i=t.getSource();if(!i)return;if(i.clear(),i.addFeature(n),(0,ec.isEmpty)(i.getExtent()))return;c.getView().fit(i.getExtent(),{padding:[150,150,150,150]}),u((0,eC.vN)((0,x.getUid)(a))),u((0,eC.hr)(r)),u((0,eq.$Z)())}catch(e){L.Z.error("Could not parse GeoJSON: ",e)}}},icon:(0,o.jsx)(eZ.G,{icon:eP.Xcf}),disabled:!g})},"edit"),(null==d?void 0:d.includes(tN.r1.COPY_AS_GEOJSON))&&(0,o.jsx)(rY.Z,{title:s("PaginationToolbar.copyAsGeoJson"),children:(0,o.jsx)(eN.ZP,{type:"text",size:"small",onClick:()=>{if(!!n){var e=n.clone();if(r){var t=Object.entries(e.getProperties()),a=t.filter(e=>{var t=(0,f._)(e,2);return r(t[0],t[1])}),i=!0,l=!1,s=void 0;try{for(var o,u=t[Symbol.iterator]();!(i=(o=u.next()).done);i=!0){var c=(0,f._)(o.value,2),d=c[0];if(!(c[1]instanceof aa()))e.unset(d)}}catch(e){l=!0,s=e}finally{try{!i&&null!=u.return&&u.return()}finally{if(l)throw s}}e.setProperties(Object.fromEntries(a))}tR()(new(e5())().writeFeature(e))}},icon:(0,o.jsx)(eZ.G,{icon:eP.E9T})})}),(null==d?void 0:d.includes(tN.r1.COPY_AS_OBJECT))&&(0,o.jsx)(rY.Z,{title:s("PaginationToolbar.copyAsObject"),children:(0,o.jsx)(eN.ZP,{type:"text",size:"small",onClick:()=>{if(!!n){var e=Object.entries(aC()(n.getProperties())).filter(e=>!((0,f._)(e,2)[1]instanceof aa()));r&&(e=e.filter(e=>{var t=(0,f._)(e,2);return r(t[0],t[1])})),tR()(JSON.stringify(Object.fromEntries(e)))}},icon:(0,o.jsx)(eZ.G,{icon:eP.OGB})})})]})]})},ak=e=>{var r=e.features,t=e.layerName,a=e.layer,n=e.tabConfig,i=(0,ep._)(e,["features","layerName","layer","tabConfig"]),s=(0,f._)((0,u.useState)(1),2),c=s[0],d=s[1],p=(0,f._)((0,u.useState)(),2),m=p[0],g=p[1],v=(0,f._)((0,u.useState)("0"),2),h=v[0],y=v[1],j=(0,M.S)(),x=`selection-layer-${t}`;aw({layerName:x}),(0,u.useEffect)(()=>{if(!j)return;var e,t=T.C.getLayerByName(j,x);if(!!t)null===(e=t.getSource())||void 0===e||e.clear(),d(1),r.length>0&&(y("0"),g(r[0]))},[r,j,x]),(0,u.useEffect)(()=>{if(!m||!j)return;var e,r,t=T.C.getLayerByName(j,x);if(!!t)null===(e=t.getSource())||void 0===e||e.clear(),null===(r=t.getSource())||void 0===r||r.addFeature(m)},[m,j,x]);if(!n||!m)return(0,o.jsx)(o.Fragment,{});var b=n.filter(e=>!ew()(e)).map((e,r)=>({label:e.title,key:`${r}`,forceRender:!0,children:(0,o.jsx)(eU,{name:e.title,feature:m,formConfig:e.children})}));return(0,o.jsxs)("div",{className:"feature-info-tabs",children:[(0,o.jsx)(aE,{current:c,exportFilter:e=>{var r=!1,t=!0,a=!1,i=void 0;try{for(var l,s=n[Symbol.iterator]();!(t=(l=s.next()).done);t=!0){var o=l.value;if(!!o.children){var u=!0,c=!1,d=void 0;try{for(var f,p=o.children[Symbol.iterator]();!(u=(f=p.next()).done);u=!0)if(f.value.propertyName===e){r=!0;break}}catch(e){c=!0,d=e}finally{try{!u&&null!=p.return&&p.return()}finally{if(c)throw d}}}}}catch(e){a=!0,i=e}finally{try{!t&&null!=s.return&&s.return()}finally{if(a)throw i}}return r},features:r,layer:a,onChange:e=>{if(!(e<1))d(e),g(r[e-1])},selectedFeature:m}),(0,o.jsx)(rn.Z,(0,l._)({items:b,activeKey:h,defaultActiveKey:"0",onTabClick:e=>{y(e)}},i))]})},aL=t("88666"),aN=t.n(aL),aF=e=>{var r=e.features,t=e.layerName,a=e.layer,n=(0,ep._)(e,["features","layerName","layer"]),i=(0,f._)((0,u.useState)(),2),s=i[0],c=i[1],d=(0,f._)((0,u.useState)(),2),p=d[0],m=d[1],g=(0,f._)((0,u.useState)([]),2),v=g[0],h=g[1],y=(0,M.S)(),j=(0,k.useTranslation)().t,x=`selection-layer-${t}`;aw({layerName:x}),(0,u.useEffect)(()=>{if(!y)return;var e,t=T.C.getLayerByName(y,x);if(!!t)null===(e=t.getSource())||void 0===e||e.clear(),c(1),r.length>0&&m(r[0])},[r,y,x]),(0,u.useEffect)(()=>{if(!p||!y)return;var e,r,t=T.C.getLayerByName(y,x);if(!!t)h(Object.entries(p.getProperties()).filter(e=>(0,f._)(e,2)[1]instanceof aa()).map(e=>(0,f._)(e,1)[0])),null===(e=t.getSource())||void 0===e||e.clear(),null===(r=t.getSource())||void 0===r||r.addFeature(p)},[p,y,x]);var b=e=>{c(e),m(r[e-1])};if(!p)return(0,o.jsx)(o.Fragment,{});var w=p.getKeys().filter(e=>!v.includes(e.toLocaleLowerCase()));return(0,o.jsx)(aN(),(0,l._)({className:"property-grid",feature:p,attributeFilter:w,size:"small",sticky:!0,title:()=>(0,o.jsx)(aE,{features:r,selectedFeature:p,current:s,layer:a,onChange:b}),columns:[{title:j("FeaturePropertyGrid.key"),dataIndex:"attributeName",key:"attributeName",width:"50%",ellipsis:!0,defaultSortOrder:"ascend",sorter:(e,r)=>e.key.localeCompare(r.key)},{title:j("FeaturePropertyGrid.value"),dataIndex:"attributeValue",key:"attributeValue",width:"50%",ellipsis:!0}],scroll:{scrollToFirstRowOnChange:!0,y:"calc(100% - 90px)"}},n))},aT=e=>{var r=(0,n._)({},(0,i._)(e)),t=(0,k.useTranslation)().t,a=(0,M.S)(),s=(0,en.Z)(),c=B(),d=A(),p=(0,f._)((0,u.useState)([]),2),m=p[0],g=p[1],v=(0,f._)((0,u.useState)(void 0),2),h=v[0],y=v[1],j=O(e=>e.featureInfo.enabled),x=e=>!!e.get("hoverable")&&(!!(e instanceof _()&&e.getSource()instanceof ee())||e instanceof E()&&e.getSource()instanceof et()),b=(0,u.useCallback)(()=>{if(!!a)g(T.C.getAllLayers(a,x).filter(e=>e.getVisible()))},[a]);if((0,u.useEffect)(()=>{if(!!a){b();var e=T.C.getAllLayers(a,x);return e.forEach(e=>e.on("change:visible",b)),()=>{e.forEach(e=>e.un("change:visible",b))}}},[a,b]),!a)return(0,o.jsx)(o.Fragment,{});var w=e=>{y(e)},S=e=>a.getAllLayers().findIndex(r=>{if((0,X.us)(r)){var t=r.getSource(),a=C(null==t?void 0:t.getParams().LAYERS);return C(e)===a}return!1}),C=e=>e.split(":").length>1?e.split(":")[1]:e.split(":")[0];return j?(0,o.jsx)("div",{className:"feature-info-panel",children:(0,o.jsx)(av.CoordinateInfo,(0,l._)({featureCount:10,queryLayers:m,resultRenderer:e=>{var r=e.features,n=e.loading;if(0===r.length)return(0,o.jsx)("span",{className:"usage-hint",children:t("FeatureInfo.usageHint")});var i=[];return Object.entries((0,ag.groupBy)(r,"featureType")).forEach(e=>{var r=(0,f._)(e,2),t=r[0],n=r[1],l=!1,s=n.map(e=>e.feature),u=a.getAllLayers(),d=S(t),p=u[d];c.forEach(e=>{var r;if((r=e.integration)&&"feature-info"===r.placement&&(Array.isArray(e.integration.layers)&&e.integration.layers.includes(t)||!e.integration.layers)){var a=e.key,n=e.wrappedComponent;i.push({label:t,index:d,key:t,children:(0,o.jsx)(n,{},a)}),l=!0}}),!l&&i.push({label:(null==p?void 0:p.get("name"))||t,index:d,key:t,children:(0,o.jsx)("div",{children:(null==p?void 0:p.get("featureInfoFormConfig"))?(0,o.jsx)(ak,{tabConfig:null==p?void 0:p.get("featureInfoFormConfig"),features:s,layerName:t,layer:p}):(0,o.jsx)(aF,{features:s,layerName:t,layer:p})},t)})}),i.sort((e,r)=>r.index-e.index),(0,o.jsx)(tp.Z,{spinning:n,children:(0,o.jsx)(rn.Z,{destroyInactiveTabPane:!0,items:i,activeKey:h,defaultActiveKey:i[0].key,onTabClick:w})})},fetchOpts:e=>({headers:(0,l._)({},e.get("useBearerToken")?(0,l._)({},(0,ea.a)(null==s?void 0:s.getKeycloak())):void 0)}),onSuccess:e=>{var r=e.features,t=(0,ag.groupBy)(r,"featureType"),a=(0,ag.mapValues)(t,e=>e.map(e=>e.feature)),n={},i=!0,l=!1,s=void 0;try{for(var o,u=Object.entries(a)[Symbol.iterator]();!(i=(o=u.next()).done);i=!0){var c=(0,f._)(o.value,2),p=c[0],m=c[1];n[p]=new(e5())().writeFeatures(m)}}catch(e){l=!0,s=e}finally{try{!i&&null!=u.return&&u.return()}finally{if(l)throw s}}var g=r.map(e=>({layerName:e.featureType,index:S(e.featureType)})).sort((e,r)=>r.index-e.index);g.length>0&&y(g[0].layerName),d((0,ah.wl)(n))},drillDown:!0},r))}):(0,o.jsx)(o.Fragment,{})},aP=t("78493"),aZ=t.n(aP),aM=t("51404"),aD=t("34066"),aA=t.n(aD),aO=t("26944"),aU=t.n(aO),aI=e=>{var r,t=e.layer,a=(0,ep._)(e,["layer"]),n=(0,f._)((0,u.useState)(null===(r=t.getSource())||void 0===r?void 0:r.getParams().TIME),2),i=n[0],s=n[1],c=(0,f._)((0,u.useState)(),2),d=c[0],p=c[1],m=(0,f._)((0,u.useState)(),2),g=m[0],v=m[1],h=(0,f._)((0,u.useState)(),2),y=h[0],j=h[1],x=(0,k.useTranslation)().t;return(0,u.useEffect)(()=>{var e,r=t.get("dimension");if(!r)return;if(r.values&&(e=r.values.split(",")),!!e&&0!==e.length){p(e[0]),v(e[e.length-1]),s(e[e.length-1]);var a={};if(e.forEach(e=>{a[e]=eu()(e).format("YYYY-MM-DD")}),j(a),"current"===e.default){var n=[NaN,""];Object.values(a).forEach(e=>{var r=eu()().diff(eu()(e));r<n[0]&&(n=[r,e])}),s(n[1])}}},[t]),(0,o.jsxs)("div",{className:"wms-time-slider",children:[(0,o.jsxs)(rv.Z,{children:[(0,o.jsx)(eZ.G,{icon:eP.SZw}),x("WmsTimeSlider.title")]}),y&&d&&g?(0,o.jsx)(aU(),(0,l._)({formatString:"",defaultValue:"",min:d,max:g,marks:y,value:i,onChange:e=>{var r;s(e),null===(r=t.getSource())||void 0===r||r.updateParams({TIME:e})}},a)):(0,o.jsx)("span",{children:x("WmsTimeSlider.default")})]})},aG=e=>{var r,t,a,n=e.layer,i=e.visibleLegendsIds,c=e.setVisibleLegendsIds,g=(0,ep._)(e,["layer","visibleLegendsIds","setVisibleLegendsIds"]),v=(0,f._)((0,u.useState)(!1),2),h=v[0],y=v[1],j=(0,f._)((0,u.useState)(!1),2),b=j[0],S=j[1],_=A(),C=(0,en.Z)(),E=(0,M.S)(),N=(0,k.useTranslation)().t,F=null!==(a=n.get("downloadConfig"))&&void 0!==a?a:null,P=O(e=>e.editFeature.userEditMode),Z=O(e=>e.layerTree.metadataVisible);var D=(r=(0,d._)(function(){var e,r;return(0,p.Jh)(this,function(t){switch(t.label){case 0:if(!E)return[2];S(!0),t.label=1;case 1:return t.trys.push([1,3,4,5]),[4,tY.Z.getExtentForLayer(n,{headers:n.get("useBearerToken")?(0,l._)({},(0,ea.a)(null==C?void 0:C.getKeycloak())):{}})];case 2:return e=t.sent(),e=(0,rG.transformExtent)(e,"EPSG:4326",E.getView().getProjection()),E.getView().fit(e),[3,5];case 3:return r=t.sent(),L.Z.error(r),m.ZP.error({message:N("LayerTreeContextMenu.extentError")}),[3,5];case 4:return S(!1),[7];case 5:return[2]}})}),function(){return r.apply(this,arguments)}),U=e=>E?I(E.getLayerGroup()).filter(r=>r.getLayers().getArray().includes(e)):[],I=e=>{var r=[e],t=!0,a=!1,n=void 0;try{for(var i,l=e.getLayers().getArray()[Symbol.iterator]();!(t=(i=l.next()).done);t=!0){var s=i.value;s instanceof w()&&r.push(...I(s))}}catch(e){a=!0,n=e}finally{try{!t&&null!=l.return&&l.return()}finally{if(a)throw n}}return r},G=e=>{U(e).forEach(r=>r.getLayers().remove(e))},R=()=>{if(!!E){G(n);var e=T.C.getLayerByName(E,N("AddLayerModal.externalWmsFolder")),r=T.C.getLayerByName(E,N("UploadDataModal.uploadedDataFolder"));e&&0===e.getLayers().getLength()&&G(e),r&&0===r.getLayers().getLength()&&G(r)}};var $=(t=(0,d._)(function(e){var r,t;return(0,p.Jh)(this,function(a){switch(a.label){case 0:if(!n)return[2];return[4,fetch(e,{method:"GET",headers:(0,l._)({},n.get("useBearerToken")?(0,l._)({},(0,ea.a)(null==C?void 0:C.getKeycloak())):void 0)})];case 1:return[4,a.sent().blob()];case 2:return r=a.sent(),(t=document.createElement("a")).href=URL.createObjectURL(r),t.setAttribute("download",n.get("name")),t.click(),[2]}})}),function(e){return t.apply(this,arguments)}),B=[];if((0,X.us)(n)&&B.push({label:(0,o.jsx)(tp.Z,{spinning:b,children:N("LayerTreeContextMenu.layerZoomToExtent")}),key:"zoomToExtent"}),(0,X.us)(n)&&n.getVisible()){var V=i.includes((0,x.getUid)(n));B.push({label:V?N("LayerTreeContextMenu.hideLegend"):N("LayerTreeContextMenu.showLegend"),key:"toggleLegend"})}if((n.get("isExternalLayer")||n.get("isUploadedLayer"))&&B.push({label:N("LayerTreeContextMenu.removeLayer"),key:"removeExternal"}),F){var z=F.map(e=>{var r;return{label:N("LayerTreeContextMenu.downloadLayer",{formatName:null!==(r=e.formatName)&&void 0!==r?r:"XML"}),key:`downloadLayer|${encodeURI(e.downloadUrl)}`}});B.push(...z)}return n.get("editable")&&(P.includes("CREATE")||P.includes("UPDATE")||P.includes("DELETE"))&&B.push({label:N("LayerTreeContextMenu.editLayer"),key:"editLayer"}),Z&&B.push({label:N("LayerTreeContextMenu.layerDetails"),key:"layerDetails"}),(0,o.jsx)("div",{"aria-label":"layer-context",children:(0,o.jsx)(rq.Z,(0,s._)((0,l._)({menu:{items:B,onClick:e=>{switch((null==e?void 0:e.key.startsWith("downloadLayer"))&&$(decodeURI(e.key.split("|")[1])),null==e?void 0:e.key){case"zoomToExtent":D();break;case"removeExternal":R();break;case"toggleLegend":var r=(0,x.getUid)(n),t=[...i];t.includes(r)?t.splice(t.indexOf(r),1):t.push(r),c(t);break;case"editLayer":_((0,eC.hr)(null)),_((0,eC.vN)((0,x.getUid)(n))),_((0,eq.$Z)());break;case"layerDetails":_((0,tf.uF)((0,x.getUid)(n))),_((0,tf.$Z)())}y(!1)}},placement:"bottomLeft",onOpenChange:y,open:h,trigger:["click"]},g),{children:(0,o.jsx)(eZ.G,{icon:eP.iV1})}))})},aR=()=>(0,o.jsxs)("div",{className:"layer-node-title-loading-animation",children:[(0,o.jsx)("span",{className:"dot-one",children:"."}),(0,o.jsx)("span",{className:"dot-two",children:"."}),(0,o.jsx)("span",{className:"dot-three",children:"."})]}),a$=e=>{var r,t,a=(0,n._)({},(0,i._)(e)),s=(0,M.S)(),c=(0,en.Z)(),d=(0,k.useTranslation)().t,p=null==s?void 0:s.getAllLayers().map(e=>(0,x.getUid)(e)),m=null!==(r=O(e=>e.layerTree.showLegends))&&void 0!==r&&r,g=null!==(t=O(e=>e.layerTree.layerIconsVisible))&&void 0!==t&&t,v=(0,f._)((0,u.useState)(m&&null!=p?p:[]),2),h=v[0],y=v[1],j=(0,f._)((0,u.useState)({}),2),b=j[0],S=j[1],C=(0,f._)((0,u.useState)(),2),L=C[0],N=C[1],F=(0,u.useCallback)(()=>{if(!!s)T.C.getAllLayers(s).forEach(e=>{if(e instanceof td()){var r=e.getSource();r instanceof et()&&(!r.hasListener("tileloadstart")&&r.on("tileloadstart",U),!r.hasListener("tileloadend")&&!r.hasListener("tileloaderror")&&r.on(["tileloadend","tileloaderror"],I)),r instanceof ee()&&(!r.hasListener("imageloadstart")&&r.on("imageloadstart",U),!r.hasListener("imageloadend")&&!r.hasListener("imageloaderror")&&r.on(["imageloadend","imageloaderror"],I))}})},[s]),P=(0,u.useCallback)(()=>{var e=null==s?void 0:s.getAllLayers().map(e=>(0,x.getUid)(e));(null==e?void 0:e.length)!==(null==p?void 0:p.length)&&F()},[s,p,F]),Z=(0,u.useMemo)(()=>({scale:L,LEGEND_OPTIONS:"fontAntiAliasing:true;forceLabels:on",TRANSPARENT:!0}),[L]),D=(0,u.useMemo)(()=>(0,l._)({},(0,ea.a)(null==c?void 0:c.getKeycloak())),[c]),A=(0,u.useCallback)(e=>{var r=e.map.getView(),t=r.getProjection().getUnits()||"m",a=r.getResolution();N(a?T.C.getScaleForResolution(a,t):void 0)},[]);(0,u.useEffect)(()=>{if(!!s)return s.on("moveend",A),()=>{s.un("moveend",A)}},[s,A]),(0,u.useEffect)(()=>{if(!!s)return F(),s.getLayers().on("change",P),()=>{T.C.getAllLayers(s).forEach(e=>{if(e instanceof td()){var r=e.getSource();r.hasListener("tileloadstart")&&r.un("tileloadstart",U),r.hasListener("tileloadend")&&r.un("tileloadend",I),r.hasListener("tileloaderror")&&r.un("tileloaderror",I)}}),s.getLayers().un("change",P)}},[s,F,P]);var U=e=>{S(r=>{var t=(0,x.getUid)(e.target),a=structuredClone(r);return a[t]&&a[t].loaded>=a[t].loading?(a[t].loading=1,a[t].loaded=0,a[t].percent=0,a):(!a[t]&&(a[t]={loading:0,loaded:0,percent:0}),a[t].loading=Number.isInteger(a[t].loading)?a[t].loading+1:1,a)})},I=e=>{S(r=>{var t=(0,x.getUid)(e.target),a=structuredClone(r);!a[t]&&(a[t]={loading:0,loaded:0,percent:0}),a[t].loaded=Number.isInteger(a[t].loaded)?a[t].loaded+1:1;var n=Math.round(a[t].loaded/a[t].loading*100);return n>a[t].percent&&(a[t].percent=n),a})};return s?(0,o.jsx)(aZ(),(0,l._)({"aria-label":"layertree",className:"layertree",nodeTitleRenderer:e=>{if(!!s){var r,t=e instanceof td()&&(0,x.getUid)(e.getSource())?null===(r=b[(0,x.getUid)(e.getSource())])||void 0===r?void 0:r.percent:100;return e instanceof w()?(0,o.jsx)("div",{"aria-label":"layer-group",children:e.get("name")}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{className:"tree-node-header","aria-label":"tree-node-header",children:[(0,o.jsxs)("span",{"aria-label":"layer-name",className:"layer-name",children:[e.get("name"),(0,o.jsx)("span",{className:"loading-dots",children:t<100&&(0,o.jsx)(aR,{})}),(0,o.jsxs)("span",{className:"layer-icons-group",children:[e.get("searchable")&&g&&(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(rY.Z,{title:d("ToolMenu.searchable"),children:(0,o.jsx)(eZ.G,{icon:eP.Y$T,className:"layer-icon"})})}),e.get("hoverable")&&e.get("visible")&&g&&(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(rY.Z,{title:d("ToolMenu.queryable"),children:(0,o.jsx)(eZ.G,{icon:eP.DBf,className:"layer-icon"})})}),e.get("editable")&&g&&(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(rY.Z,{title:d("ToolMenu.editable"),children:(0,o.jsx)(eZ.G,{icon:eP.IwR,className:"layer-icon"})})})]})]}),(e instanceof E()||e instanceof _())&&(0,o.jsx)("div",{"aria-label":"layer-context-menu",children:(0,o.jsx)(aG,{layer:e,visibleLegendsIds:h,setVisibleLegendsIds:y})})]}),e.get("visible")&&(0,o.jsx)("div",{className:"layer-transparency","aria-label":"transparency-slider",onClick:e=>e.stopPropagation(),onDragStart:e=>{e.stopPropagation(),e.preventDefault()},draggable:!0,children:(0,o.jsx)(aA(),{tooltip:{formatter:e=>`${d("LayerTree.transparency")}: ${e}%`},layer:e})}),e.get("visible")&&"WMSTIME"===e.get("type")&&(0,o.jsx)("div",{className:"layer-time-slider",children:(0,o.jsx)(aI,{layer:e})}),e.get("visible")&&(0,X.us)(e)&&h.includes((0,x.getUid)(e))&&(0,o.jsx)(aM.Legend,{layer:e,errorMsg:d("LayerTree.noLegendAvailable"),extraParams:Z,headers:e.get("useBearerToken")&&D})]})}},filterFunction:e=>{var r;return e.getLayers?!e.get("hideInLayerTree"):!(e.getSource&&(null===(r=e.getSource())||void 0===r?void 0:r.forEachFeature))},draggable:!0},a)):(0,o.jsx)(o.Fragment,{})},aB=t("55738"),aV=e=>{var r=e.showMeasureDistance,t=e.showMeasureArea,a=(0,k.useTranslation)().t,n=(0,M.S)(),i=(0,f._)((0,u.useState)(),2),l=i[0],s=i[1];return n?(0,o.jsxs)(re.ToggleGroup,{className:"measure-tools",selected:l,onChange:(e,r)=>{s(r)},children:[r?(0,o.jsxs)(aB.MeasureButton,{geodesic:!0,value:"line",measureType:"line",type:"link",continueLineMsg:a("Measure.clicktodrawline"),children:[(0,o.jsx)(eZ.G,{icon:eP.SoD}),(0,o.jsx)("span",{className:"measure-text",children:a("Measure.line")})]}):(0,o.jsx)(o.Fragment,{}),t?(0,o.jsxs)(aB.MeasureButton,{geodesic:!0,value:"poly",measureType:"polygon",type:"link",continuePolygonMsg:a("Measure.clicktodrawarea"),children:[(0,o.jsx)(eZ.G,{icon:eP.ubJ}),(0,o.jsx)("span",{className:"measure-text",children:a("Measure.area")})]}):(0,o.jsx)(o.Fragment,{})]}):(0,o.jsx)(o.Fragment,{})},az=e=>{var r,t=e.collapseWidth,a=void 0===t?40:t,n=e.minWidth,i=void 0===n?240:n,c=e.maxWidth,d=void 0===c?600:c,p=(0,ep._)(e,["collapseWidth","minWidth","maxWidth"]),m=(0,k.useTranslation)().t,g=(0,M.S)(),v=B(),h=A(),y=O(e=>e.toolMenu.availableTools),j=O(e=>e.toolMenu.activeKeys),x=(0,en.Z)(),b=null==x?void 0:x.getKeycloak(),w=(0,f._)((0,u.useState)(!1),2),S=w[0],_=w[1],C=(0,f._)((0,u.useState)([]),2),E=C[0],L=C[1],N=(0,f._)((0,u.useState)(!1),2),F=N[0],T=N[1],P=(0,f._)((0,u.useState)(320),2),Z=P[0],D=P[1],I=(0,f._)((0,u.useState)(Z),2),G=I[0],R=I[1];(0,u.useEffect)(()=>{var e=window.matchMedia("only screen and (max-width: 450px) and (orientation: portrait),only screen and (max-width: 750px) and (orientation: landscape), only screen and (max-width: 580px)"),r=RegExp("/Mobile|iP(hone|od|ad)|Android|BlackBerry|IEMobile|Kindle|NetFront|Silk-Accelerated|(hpw|web)OS|Fennec|Minimo|Opera M(obi|ini)|Blazer|Dolfin|Dolphin|Skyfire|Zune/");(e.matches||r.test(window.navigator.userAgent))&&(_(!0),D(a))},[a]),(0,u.useEffect)(()=>{E.length<1&&(y.includes("default")?L(["measure_tools","draw_tools","feature_info","print","tree","permalink","language_selector"]):L(y))},[E,y]),(0,u.useEffect)(()=>{var e=["print","measure_tools","draw_tools","feature_info","tree"];if(e.filter(e=>j.includes(e)).length>1){var r=j.slice(0,j.length-1).reverse().find(r=>e.includes(r));r&&h((0,tT.wG)(j.filter(e=>e!==r)))}h((0,tN.$f)(j.includes("feature_info"))),h((0,tF.cm)(j.includes("tree")))},[j,h]);var $=O(e=>e.layerTree.activeUploadTools),V=e=>{switch(e){case"measure_tools":return{icon:eP.KxN,title:m("ToolMenu.measure"),wrappedComponent:(0,o.jsx)(aV,{showMeasureDistance:y.includes("default")||y.includes("measure_tools_distance"),showMeasureArea:y.includes("default")||y.includes("measure_tools_area")})};case"draw_tools":return{icon:eP.q2v,title:m("ToolMenu.draw"),wrappedComponent:(0,o.jsx)(am,{showDrawPoint:y.includes("default")||y.includes("draw_tools_point"),showDrawLine:y.includes("default")||y.includes("draw_tools_line"),showDrawPolygon:y.includes("default")||y.includes("draw_tools_polygon"),showDrawCircle:y.includes("default")||y.includes("draw_tools_circle"),showDrawRectangle:y.includes("default")||y.includes("draw_tools_rectangle"),showDrawAnnotation:y.includes("default")||y.includes("draw_tools_annotation"),showModifyFeatures:y.includes("default")||y.includes("draw_tools_modify"),showUploadFeatures:y.includes("default")||y.includes("draw_tools_upload"),showDownloadFeatures:y.includes("default")||y.includes("draw_tools_download"),showDeleteFeatures:y.includes("default")||y.includes("draw_tools_delete"),showStyleFeatures:y.includes("default")||y.includes("draw_tools_style")})};case"feature_info":return{icon:eP.DBf,title:m("ToolMenu.featureInfo"),wrappedComponent:(0,o.jsx)(aT,{})};case"print":return{icon:eP.kwI,title:m("ToolMenu.print"),wrappedComponent:g?(0,o.jsx)(t8,{active:j.includes("print"),layerBlackList:["react-geo_measure","hoverVectorLayer"]}):(0,o.jsx)(o.Fragment,{})};case"tree":var r,t,a;return{icon:eP.aC2,title:m("ToolMenu.layertree"),wrappedComponent:(0,o.jsxs)("div",{className:"tree-wrapper",children:[(0,o.jsx)(a$,{}),(null==$?void 0:$.includes(tF.Sv.addWMS))&&(0,o.jsx)(eN.ZP,{className:"add-wms-button tool-menu-button",icon:(0,o.jsx)(eZ.G,{icon:eP.r8p}),onClick:()=>h((0,U.$Z)()),children:m("ToolMenu.addWms")}),b&&(null===(a=q().geoserver)||void 0===a?void 0:null===(t=a.upload)||void 0===t?void 0:null===(r=t.authorizedRoles)||void 0===r?void 0:r.some(e=>b.hasResourceRole(e,b.clientId)))&&(null==$?void 0:$.includes(tF.Sv.dataUpload))&&(0,o.jsx)(eN.ZP,{className:"upload-data-button tool-menu-button",icon:(0,o.jsx)(eZ.G,{icon:eP.cf$}),onClick:()=>h((0,tP.$Z)()),children:m("ToolMenu.uploadData")})]})};case"permalink":return{icon:eP.M6U,title:m("Permalink.title"),wrappedComponent:(0,o.jsx)(tB,{})};case"language_selector":return{icon:eP.BCn,title:m("ToolMenu.languageSelect"),wrappedComponent:(0,o.jsx)(tD,{})}}},z=(0,u.useCallback)(()=>{T(!0)},[]),J=(0,u.useCallback)(()=>{T(!1)},[]),W=(0,u.useCallback)(e=>{if(F&&!S){var r=e.clientX-document.body.offsetLeft;r>i&&r<d&&(D(r),R(r))}},[F,S,i,d]);return(0,u.useEffect)(()=>(document.addEventListener("mousemove",W),document.addEventListener("mouseup",J),()=>{document.removeEventListener("mousemove",W),document.removeEventListener("mouseup",J)}),[W,J]),(0,o.jsxs)("div",{"aria-label":"tool-menu",className:`tool-menu ${S?"collapsed":""}`,style:{width:Z},children:[(0,o.jsx)(tE.Z,(0,l._)({expandIconPosition:"end",activeKey:j,destroyInactivePanel:!0,onChange:e=>{_(!1),h((0,tT.wG)(tL()(e))),S&&D(G)},items:(r=[],E.forEach(e=>{var t=V(e);if(!!t){var a=t.icon,n=t.title,i=t.wrappedComponent;r.push({key:e,label:(0,o.jsxs)(o.Fragment,{children:[a?(0,o.jsx)(eZ.G,{icon:a}):void 0,(0,o.jsx)("span",{children:n})]}),children:i})}}),v&&v.forEach(e=>{var t;if((t=e.integration)&&"tool-menu"===t.placement){var a=e.key,n=e.wrappedComponent,i=e.integration,u=i.label,c=i.insertionIndex,d=i.icon,f=(0,ep._)(e.integration,["label","insertionIndex","icon"]),p=(0,s._)((0,l._)({key:a,label:(0,o.jsxs)(o.Fragment,{children:[d?(0,o.jsx)(eZ.G,{icon:d}):void 0,(0,o.jsx)("span",{children:m(void 0===u?"Plugin":u)})]})},f),{children:(0,o.jsx)(n,{})});r.splice(c||0,0,p)}}),r)},p)),(0,o.jsx)(rY.Z,{placement:"right",title:S?m("ToolMenu.expand"):m("ToolMenu.collapse"),children:(0,o.jsx)(eN.ZP,{className:"collapse-btn","aria-label":"collapse-button",icon:S?(0,o.jsx)(eZ.G,{icon:eP._tD}):(0,o.jsx)(eZ.G,{icon:eP.A35}),onClick:()=>{h((0,tT.wG)([])),_(!S),S?D(G):D(a)}})}),S?(0,o.jsx)(o.Fragment,{}):(0,o.jsx)("div",{className:"dynamicWidth",onMouseDown:z})]})},aJ=t("28837"),aW=t("47613"),aK=eL.Z.Dragger,aq=e=>{var r,t,a,c,m=(0,n._)({},(0,i._)(e)),v=(0,f._)((0,u.useState)(""),2),h=v[0],y=v[1],j=(0,f._)((0,u.useState)(""),2),x=j[0],b=j[1],S=(0,f._)((0,u.useState)(!1),2),_=S[0],C=S[1],E=O(e=>e.uploadDataModal.visible),N=O(e=>e.user),F=A(),P=(0,M.S)(),Z=(0,en.Z)(),D=(0,k.useTranslation)().t,U=e=>{if(!!P){var r=D("UploadDataModal.uploadedDataFolder"),t=T.C.getLayerByName(P,r);if(!t){t=new(w())({layers:[],properties:{name:r}});var a=P.getLayerGroup().getLayers();a.insertAt((null==a?void 0:a.getLength())||0,t)}!t.getLayers().getArray().includes(e)&&t.getLayers().push(e)}};var I=(r=(0,d._)(function(e){var r,t,a,n,i,o;return(0,p.Jh)(this,function(u){switch(u.label){case 0:return t=e.baseUrl,a=e.workspace,n=e.storeName,i=e.layerName,o=e.file,[4,fetch(`${t}/rest/workspaces/${a}/coveragestores/${n}/file.geotiff?configure=none`,{method:"PUT",headers:(0,s._)((0,l._)({},(0,ea.a)(null==Z?void 0:Z.getKeycloak())),{"Content-Type":"image/tiff"}),body:o})];case 1:if(!u.sent().ok)throw Error(D("UploadDataModal.error.general",{fileName:o.name}));return[4,fetch(`${t}/rest/workspaces/${a}/coveragestores/${n}/coverages`,{method:"POST",headers:(0,s._)((0,l._)({},(0,ea.a)(null==Z?void 0:Z.getKeycloak())),{"Content-Type":"application/json"}),body:JSON.stringify({coverage:{enabled:!0,name:i,nativeName:i,title:i,keywords:{string:["User upload",`Uploaded by ${null===(r=N.providerDetails)||void 0===r?void 0:r.username}`]}}})})];case 2:if(!u.sent().ok)throw Error(D("UploadDataModal.error.general",{fileName:o.name}));return[2]}})}),function(e){return r.apply(this,arguments)});var G=(t=(0,d._)(function(e){var r,t,a,n,i,o,u,c,d;return(0,p.Jh)(this,function(p){switch(p.label){case 0:return t=e.baseUrl,a=e.workspace,n=e.storeName,i=e.layerName,o=e.file,[4,aJ.Shapefile.load(o)];case 1:if(u=p.sent(),c="",d={attribute:[]},1!==Object.entries(u).length)throw Error(D("UploadDataModal.error.zipContent"));return Object.entries(u).forEach(e=>{var r=(0,f._)(e,2),t=r[0],a=r[1];c=t;var n=a.parse("dbf",{properties:!1});d.attribute=n.fields.map(e=>({name:e.name,minOccurs:0,maxOccurs:1,nillable:!0,binding:V(e.type),length:e.length}));var i=a.parse("shx");d.attribute.push({name:"the_geom",minOccurs:0,maxOccurs:1,nillable:!0,binding:B(i.header.type)})}),[4,fetch(`${t}/rest/workspaces/${a}/datastores/${n}/file.shp?configure=none`,{method:"PUT",headers:(0,s._)((0,l._)({},(0,ea.a)(null==Z?void 0:Z.getKeycloak())),{"Content-Type":"application/zip"}),body:o})];case 2:if(!p.sent().ok)throw Error(D("UploadDataModal.error.general",{fileName:o.name}));return[4,fetch(`${t}/rest/workspaces/${a}/datastores/${n}/featuretypes`,{method:"POST",headers:(0,s._)((0,l._)({},(0,ea.a)(null==Z?void 0:Z.getKeycloak())),{"Content-Type":"application/json"}),body:JSON.stringify({featureType:{enabled:!0,name:i,nativeName:c,title:i,attributes:d,keywords:{string:["User upload",`Uploaded by ${null===(r=N.providerDetails)||void 0===r?void 0:r.username}`]}}})})];case 3:if(!p.sent().ok)throw Error(D("UploadDataModal.error.general",{fileName:o.name}));return[2]}})}),function(e){return t.apply(this,arguments)});var R=(a=(0,d._)(function(e){var r,t,a,n,i,l,s,o,u,c,d,f,m;return(0,p.Jh)(this,function(p){switch(p.label){case 0:n=e.onError,i=e.onSuccess,s=(l=e.file).name.split("."),o=l.type,u=(null===(r=q().geoserver)||void 0===r?void 0:r.base)||"/geoserver",c=(null===(a=q().geoserver)||void 0===a?void 0:null===(t=a.upload)||void 0===t?void 0:t.workspace)||"SHOGUN",d=`${s[0]}_${Date.now()}`.toUpperCase(),f={file:l,baseUrl:u,workspace:c,storeName:d,layerName:d},p.label=1;case 1:if(p.trys.push([1,6,,7]),"image/tiff"!==o)return[3,3];return[4,I(f)];case 2:p.sent(),p.label=3;case 3:if("application/zip"!==o)return[3,5];return[4,G(f)];case 4:p.sent(),p.label=5;case 5:return i&&i({baseUrl:u,workspace:c,layerName:d}),[3,7];case 6:return m=p.sent(),n&&n({name:"UploadError",message:m instanceof Error?m.message:D("UploadDataModal.error.general",{fileName:l.name})}),[3,7];case 7:return[2]}})}),function(e){return a.apply(this,arguments)});var $=(c=(0,d._)(function(e){var r,t,a;return(0,p.Jh)(this,function(n){if("uploading"===(r=e.file).status&&C(!0),"done"===r.status){if(!Z||!r.response)return[2];t={name:r.response.layerName,type:"TILEWMS",clientConfig:{hoverable:!0},sourceConfig:{url:`${r.response.baseUrl}/ows?`,layerNames:`${r.response.workspace}:${r.response.layerName}`,useBearerToken:!0}},(a=new aW.Z({client:Z}).parseTileLayer(t)).set("layerConfig",t),a.set("isUploadedLayer",!0),a.set("groupName",D("UploadDataModal.uploadedDataFolder")),U(a),b(D("UploadDataModal.success",{fileName:r.name,layerName:r.response.layerName})),C(!1)}else"error"===r.status&&(C(!1),L.Z.error(r.error),r.error&&r.error.message?y(r.error.message):y(D("UploadDataModal.error.general",{fileName:r.name})));return[2]})}),function(e){return c.apply(this,arguments)}),B=e=>({0:null,1:"org.locationtech.jts.geom.Point",3:"org.locationtech.jts.geom.LineString",5:"org.locationtech.jts.geom.Polygon",8:"org.locationtech.jts.geom.MultiPoint",11:"org.locationtech.jts.geom.Point",13:"org.locationtech.jts.geom.LineString",15:"org.locationtech.jts.geom.Polygon",18:"org.locationtech.jts.geom.MultiPoint",21:"org.locationtech.jts.geom.Point",23:"org.locationtech.jts.geom.LineString",25:"org.locationtech.jts.geom.Polygon",28:"org.locationtech.jts.geom.MultiPoint",31:null})[e],V=e=>{switch(e){case"C":return"java.lang.String";case"D":return"java.util.Date";case"N":return"java.lang.Long";case"F":return"java.lang.Double";case"L":return"java.lang.Boolean";default:return null}};return(0,o.jsxs)(g.Z,(0,s._)((0,l._)({className:"upload-data-modal",title:D("UploadDataModal.title"),open:E,onCancel:()=>{y(""),b(""),F((0,tP.Cp)())},width:600,footer:!1},m),{children:[x&&(0,o.jsx)(W.Z,{message:x,closable:!0,type:"success"}),h&&(0,o.jsx)(W.Z,{message:h,closable:!0,type:"error"}),(0,o.jsx)(tp.Z,{spinning:_,children:(0,o.jsxs)(aK,{customRequest:R,accept:"image/tiff,application/zip",maxCount:1,showUploadList:!1,beforeUpload:e=>{var r,t,a=(null===(t=q().geoserver)||void 0===t?void 0:null===(r=t.upload)||void 0===r?void 0:r.limit)||2e8,n=e.type,i=e.size;if(y(""),b(""),i>a)return y(D("UploadDataModal.error.maxSize",{maxSize:a/1e6})),!1;var l=["application/zip","image/tiff"];return!!l.includes(n)||(y(D("UploadDataModal.error.supportedFormats",{supportedFormats:l.join(", ")})),!1)},onChange:$,children:[(0,o.jsx)("p",{className:"ant-upload-drag-icon",children:(0,o.jsx)(eZ.G,{icon:eP.cf$})}),(0,o.jsx)("p",{className:"ant-upload-text",children:D("UploadDataModal.description")}),(0,o.jsx)("p",{className:"ant-upload-hint",children:D("UploadDataModal.hint")})]})})]}))};var aY=(a=(0,d._)(function(){var e,r,t,a,n,i,l,s,o,u,d,f,m,g,v,h,y,j,x;return(0,p.Jh)(this,function(b){switch(b.label){case 0:var S;if(e=(0,M.S)(),r=(0,en.Z)(),S=window.location.search,t=c().useMemo(()=>new URLSearchParams(S),[S]),a=(0,k.useTranslation)().t,n=t.get("layers"),!e)return[2];if(i=e=>e.get("name"),l=e=>e instanceof E()||e instanceof _(),!(s=r5.k.applyLink(e,";",i,l)))return[2];o=r=>{var t=new(w())({layers:[]});t.set("name",r);var a=e.getLayerGroup().getLayers();return a.insertAt((null==a?void 0:a.getLength())||0,t),t},b.label=1;case 1:if(b.trys.push([1,10,,11]),u=JSON.parse(s),!r)throw Error("Client is not available");d=new aW.Z({client:r}),f=!0,m=!1,g=void 0,b.label=2;case 2:b.trys.push([2,7,8,9]),v=function(){var r,t,i,l,s;return(0,p.Jh)(this,function(u){switch(u.label){case 0:if(r=y.value,e3()(null==r?void 0:r.layerConfig))return[3,2];return t=r.layerConfig,[4,d.parseLayer(t)];case 1:if(!(i=u.sent()))return[2,"continue"];if(r.isExternalLayer&&i.set("isExternalLayer",r.isExternalLayer),r.isUploadedLayer&&i.set("isUploadedLayer",r.isUploadedLayer),i.set("groupName",r.groupName),i.set("layerConfig",r.layerConfig),i.setVisible(!!(null==n?void 0:n.split(";").some(e=>e===t.name))),!(i.get("isExternalLayer")||i.get("isUploadedLayer")))return[2,"continue"];l=void 0,i.get("groupName")?!(l=T.C.getLayerByName(e,i.get("groupName")))&&(l=o(i.get("groupName"))):!(l=null===(s=T.C.getLayersByProperty(e,"isExternalLayerGroup",!0))||void 0===s?void 0:s[0])&&(l=o(a("AddLayerModal.externalWmsFolder"))).set("isExternalLayerGroup",!0),!T.C.getLayerByName(e,i.get("name"))&&l.getLayers().push(i),u.label=2;case 2:return[2]}})},h=u[Symbol.iterator](),b.label=3;case 3:if(f=(y=h.next()).done)return[3,6];return[5,(0,p.XA)(v())];case 4:b.sent(),b.label=5;case 5:return f=!0,[3,3];case 6:return[3,9];case 7:return j=b.sent(),m=!0,g=j,[3,9];case 8:try{!f&&null!=h.return&&h.return()}finally{if(m)throw g}return[7];case 9:return[3,11];case 10:return x=b.sent(),L.Z.error(x),[3,11];case 11:return[2]}})}),function(){return a.apply(this,arguments)}),aH=e=>{var r=(0,n._)({},(0,i._)(e));return aY(),(0,u.useEffect)(()=>{var e=document.querySelectorAll(".loadmask")[0];e&&e.classList.add("loadmask-hidden")},[]),(0,o.jsxs)("div",(0,s._)((0,l._)({className:"App"},r),{children:[(0,o.jsx)(to,{}),(0,o.jsx)(V,{}),(0,o.jsx)(az,{}),(0,o.jsx)(tx,{}),(0,o.jsx)(r_,{}),(0,o.jsx)(J,{}),(0,o.jsx)(I,{}),(0,o.jsx)(aq,{}),(0,o.jsx)(rg,{}),(0,o.jsx)(tv,{}),(0,o.jsx)(tC,{})]}))},aX=aH},10562:function(){},96281:function(){}}]);
//# sourceMappingURL=681.ef7fe3c53e763365.js.map