"use strict";(self.webpackChunk_terrestris_shogun_gis_client=self.webpackChunk_terrestris_shogun_gis_client||[]).push([["6156"],{25249:function(e,t,n){n.r(t),n.d(t,{default:function(){return V},GeoLocationButton:function(){return T}});var r=n(76395),a=n.n(r),o=n(69843),i=n.n(o),s=n(66046),u=n.n(s),c=n(62918),l=n.n(c),g=n(94934),f=n.n(g),d=n(25188),m=n.n(d),h=n(15516),p=n.n(h),b=n(17936),M=n(70038),w=n.n(M),y=n(36528),v=n.n(y),A=n(97562),C=n.n(A),$=class{static radToDeg=e=>360*e/(2*Math.PI);static degToRad=e=>e*Math.PI*2/360;static mod=e=>(e%(2*Math.PI)+2*Math.PI)%(2*Math.PI)},k=n(30126),E=n(38254),P=n.p+"6afbd13a3ce1b95d.png",_=n.p+"3380da3c8b677218.png",I=n(70198),N=n(53529);let T=({className:e,enableTracking:t=!1,follow:n=!1,onError:o=()=>void 0,onGeoLocationChange:s=()=>void 0,pressed:c,showMarker:g=!0,trackingOptions:d,...h})=>{(({active:e,enableTracking:t=!1,follow:n=!1,onError:a,onGeoLocationChange:o,showMarker:s=!1,trackingOptions:c={enableHighAccuracy:!0,maximumAge:1e4,timeout:6e5}})=>{let g=(0,k.A)(),[d,h]=(0,r.useState)(),M=(0,r.useMemo)(()=>new(f())([],"XYZM"),[]),y=(0,r.useMemo)(()=>new(u()),[]);(0,E.c)(()=>new(p())({properties:{name:"react-geo_geolocationlayer"},source:new(w())({features:[y]}),style:e=>{let t=e.get("heading"),n=Number.isFinite(t)&&0!==t?P:_,r=Number.isFinite(t)&&0!==t?t*Math.PI/180:0;return[new(C())({image:new(v())({rotation:r,src:n})})]}}),[],s&&e);let A=(0,r.useCallback)(e=>{let t=e.target,n=t.getPosition()??[0,0],r=t.getAccuracy(),a=t.getHeading()||0,i=t.getSpeed()||0,s=n[0],u=n[1],c=M.getCoordinates(),l=c[c.length-1],g=l&&l[2];if(g){let e=a-$.mod(g);Math.abs(e)>Math.PI&&(e=-(e>=0?1:-1)*(2*Math.PI-Math.abs(e))),a=g+e}M.appendCoordinate([s,u,a,Date.now()]),M.setCoordinates(M.getCoordinates().slice(-20));let f={position:n,accuracy:r,heading:a,speed:i};h(f),o?.(f)},[M,o]),I=(0,r.useMemo)(()=>e?new(l())({projection:g?.getView().getProjection()}):void 0,[e,g]),N=(0,r.useCallback)((e,t,n)=>{let r=(g?.getSize()??[0,0])[1];return[e[0]-Math.sin(t)*r*n/4,e[1]+Math.cos(t)*r*n/4]},[g]);return(0,r.useEffect)(()=>{if(!a||!I)return;let e=I.on("error",a);return()=>{(0,b.unByKey)(e)}},[I]),(0,r.useEffect)(()=>{if(!I)return;let e=I.on("change",A);return()=>{(0,b.unByKey)(e)}},[I,A]),(0,r.useEffect)(()=>{I?.setTracking(t)},[t,I]),(0,r.useEffect)(()=>{I?.setTrackingOptions(c)},[I,c]),(0,r.useEffect)(()=>{let e=Date.now()-750;e=Math.max(e,0);let t=M.getCoordinateAtM(e,!0);if(!i()(t)&&(n&&(g?.getView().setCenter(N([t[0],t[1]],-t[2],g?.getView().getResolution()??0)),g?.getView().setRotation(-t[2])),s)){let e=new(m())([t[0],t[1]]);y.setGeometry(e)}},[d,s,n,g,M,N,y])})({active:!!c,enableTracking:c&&t,follow:n,onError:o,onGeoLocationChange:s,showMarker:g,trackingOptions:d});let M=e?`${e} ${I.$}geolocationbutton`:`${I.$}geolocationbutton`;return a().createElement(N.A,{pressed:c,className:M,...h})};var V=T},53529:function(e,t,n){var r=n(76395),a=n.n(r),o=n(54440),i=n(74097),s=n(70198);t.A=({type:e="primary",pressed:t=!1,tooltipProps:n={mouseEnterDelay:1.5},className:r,tooltip:u,tooltipPlacement:c,pressedIcon:l,icon:g,children:f,value:d,onClick:m,onChange:h=()=>void 0,...p})=>{let b=`${s.$}togglebutton`,M=r?`${r} ${b}`:b,w="";return t&&(w=" btn-pressed"),a().createElement(o.A,{title:u,placement:c,...n},a().createElement(i.Ay,{type:e,onClick:e=>{m&&(m(e),e.defaultPrevented)||h(e,d)},onChange:h,className:`${M}${w}`,"aria-pressed":t,icon:t?l:g,...p},f))}},70198:function(e,t,n){n.d(t,{$:function(){return r}});let r="react-geo-"},73645:function(e,t,n){var r=n(76395);t.A=n.n(r)().createContext(null)},30126:function(e,t,n){n.d(t,{k:function(){return o}});var r=n(76395),a=n(73645);let o=()=>(0,r.useContext)(a.A);t.A=o},38254:function(e,t,n){n.d(t,{c:function(){return i}});var r=n(76395),a=n(2543),o=n(30126);let i=(e,t,n)=>{let i=(0,o.A)(),[s,u]=(0,r.useState)();return(0,r.useEffect)(()=>{if(!i)return;let t=e();if(t)return i.addLayer(t),u(t),()=>{i.removeLayer(t),u(void 0)}},[i,...t]),(0,r.useEffect)(()=>{!s||(0,a.isNil)(n)||s.setVisible(n)},[s,n]),s};t.A=i}}]);
//# sourceMappingURL=6156.d2746e933f5b7381.js.map