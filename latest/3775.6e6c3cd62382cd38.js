"use strict";(self.webpackChunk_terrestris_shogun_gis_client=self.webpackChunk_terrestris_shogun_gis_client||[]).push([["3775"],{25249:function(e,t,n){n.r(t),n.d(t,{default:function(){return N},GeoLocationButton:function(){return D}});var a=n(76395),r=n.n(a),o=n(69843),i=n.n(o),s=n(66046),c=n.n(s),u=n(62918),l=n.n(u),g=n(94934),f=n.n(g),d=n(25188),h=n.n(d),m=n(15516),p=n.n(m),b=n(17936),M=n(70038),w=n.n(M),y=n(36528),k=n.n(y),C=n(97562),$=n.n(C),P=class{static radToDeg=e=>360*e/(2*Math.PI);static degToRad=e=>e*Math.PI*2/360;static mod=e=>(e%(2*Math.PI)+2*Math.PI)%(2*Math.PI)},A=n(30126),E=n(38254),_=n.p+"6afbd13a3ce1b95d.png",v=n.p+"3380da3c8b677218.png",I=n(70198),T=n(53529);let D=({className:e,enableTracking:t=!1,follow:n=!1,onChange:o,onError:s=()=>void 0,onGeoLocationChange:u=()=>void 0,pressed:g,showMarker:d=!0,trackingOptions:m,onPressedChange:M,...y})=>{let[C,D]=(0,a.useState)(!1),N="boolean"==typeof g,S=N?!!g:C;(({active:e,enableTracking:t=!1,follow:n=!1,onError:r,onGeoLocationChange:o,showMarker:s=!1,trackingOptions:u={enableHighAccuracy:!0,maximumAge:1e4,timeout:6e5}})=>{let g=(0,A.A)(),[d,m]=(0,a.useState)(),M=(0,a.useMemo)(()=>new(f())([],"XYZM"),[]),y=(0,a.useMemo)(()=>new(c()),[]);(0,E.c)(()=>new(p())({properties:{name:"react-geo_geolocationlayer"},source:new(w())({features:[y]}),style:e=>{let t=e.get("heading"),n=Number.isFinite(t)&&0!==t?_:v,a=Number.isFinite(t)&&0!==t?t*Math.PI/180:0;return[new($())({image:new(k())({rotation:a,src:n})})]}}),[],s&&e);let C=(0,a.useCallback)(e=>{let t=e.target,n=t.getPosition()??[0,0],a=t.getAccuracy(),r=t.getHeading()||0,i=t.getSpeed()||0,s=n[0],c=n[1],u=M.getCoordinates(),l=u[u.length-1],g=l&&l[2];if(g){let e=r-P.mod(g);Math.abs(e)>Math.PI&&(e=-(e>=0?1:-1)*(2*Math.PI-Math.abs(e))),r=g+e}M.appendCoordinate([s,c,r,Date.now()]),M.setCoordinates(M.getCoordinates().slice(-20));let f={position:n,accuracy:a,heading:r,speed:i};m(f),o?.(f)},[M,o]),I=(0,a.useMemo)(()=>{if(!e||!g)return;let n=new(l())({projection:g.getView().getProjection(),trackingOptions:u});return t&&n.setTracking(!0),n},[e,g,u,t]),T=(0,a.useCallback)((e,t,n)=>{let a=(g?.getSize()??[0,0])[1];return[e[0]-Math.sin(t)*a*n/4,e[1]+Math.cos(t)*a*n/4]},[g]);return(0,a.useEffect)(()=>{if(!r||!I)return;let e=I.on("error",()=>{r()});return()=>{(0,b.unByKey)(e)}},[I,r]),(0,a.useEffect)(()=>{if(!I)return;let e=I.on("change",C);return()=>{(0,b.unByKey)(e)}},[I,C]),(0,a.useEffect)(()=>{if(I)return I.setTracking(t),()=>{I.setTracking(!1)}},[t,I]),(0,a.useEffect)(()=>{I&&I.setTrackingOptions(u)},[I,u]),(0,a.useEffect)(()=>{let e=Date.now()-750;e=Math.max(e,0);let t=M.getCoordinateAtM(e,!0);if(!i()(t)&&(n&&(g?.getView().setCenter(T([t[0],t[1]],-t[2],g?.getView().getResolution()??0)),g?.getView().setRotation(-t[2])),s)){let e=new(h())([t[0],t[1]]);y.setGeometry(e)}},[d,s,n,g,M,T,y])})({active:S,enableTracking:S&&t,follow:n,onError:s,onGeoLocationChange:u,showMarker:d,trackingOptions:m});let V=e?`${e} ${I.$}geolocationbutton`:`${I.$}geolocationbutton`;return r().createElement(T.A,{pressed:S,className:V,onChange:(e,t)=>{N?M?.(!S):D(e=>{let t=!e;return M?.(t),t}),o?.(e,t)},...y})};var N=D},53529:function(e,t,n){var a=n(76395),r=n.n(a),o=n(54440),i=n(74097),s=n(70198);t.A=({type:e="primary",pressed:t=!1,tooltipProps:n={mouseEnterDelay:1.5},className:a,tooltip:c,tooltipPlacement:u,pressedIcon:l,icon:g,children:f,value:d,onClick:h,onChange:m=()=>void 0,...p})=>{let b=`${s.$}togglebutton`,M=a?`${a} ${b}`:b,w="";return t&&(w=" btn-pressed"),r().createElement(o.A,{title:c,placement:u,...n},r().createElement(i.Ay,{type:e,onClick:e=>{h&&(h(e),e.defaultPrevented)||m(e,d)},onChange:m,className:`${M}${w}`,"aria-pressed":t,icon:t?l:g,...p},f))}},70198:function(e,t,n){n.d(t,{$:function(){return a}});let a="react-geo-"}}]);
//# sourceMappingURL=3775.6e6c3cd62382cd38.js.map