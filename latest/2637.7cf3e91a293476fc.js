"use strict";(self.webpackChunk_terrestris_shogun_gis_client=self.webpackChunk_terrestris_shogun_gis_client||[]).push([["2637"],{94428:function(e,t,r){r.r(t);var a=r(76395),l=r.n(a),n=r(73319),s=r(1882),o=r.n(s),i=r(94092),u=r(99138),g=r.n(u),c=r(17936),f=r(92813),y=r(18635),d=r(30126),p=r(70198);let h=`${p.$}layertree`;t.default=({className:e,layerGroup:t,nodeTitleRenderer:r,filterFunction:s,onLayerVisibilityChanged:u,checkable:p=!0,draggable:k=!0,...L})=>{let[b,A]=(0,a.useState)([]),[C,v]=(0,a.useState)([]),m=(0,d.A)(),_=(0,a.useCallback)(()=>{if(!m)return[];let e=(t?y.A.getAllLayers(t):y.A.getAllLayers(m)).filter(e=>!(e instanceof g())&&e.getVisible());return s&&(e=e.filter(s)),e.map(i.getUid)},[s,t,m]),E=(0,a.useCallback)(e=>o()(r)?r(e):e.get("name"),[r]),B=(0,a.useCallback)(e=>{let t;if(m&&(!s||0!==[e].filter(s).length)){if(e instanceof g()){let r=e.getLayers().getArray();s&&(r=r.filter(s)),t=r.map(e=>B(e)).filter(e=>void 0!==e).toReversed()}return{key:(0,i.getUid)(e),title:l().createElement("div",{draggable:!0,onClick:e=>e.stopPropagation()},E(e)),className:y.A.layerInResolutionRange(e,m)?"":"out-of-range",children:t}}},[m,E,s]),U=(0,a.useCallback)(()=>m?(t||m.getLayerGroup()).getLayers().getArray().map(e=>B(e)).filter(e=>void 0!==e).toReversed():[],[t,m,B]),I=(0,a.useCallback)(()=>{v(U())},[U]),P=(0,a.useCallback)((e,t)=>{e instanceof g()?e.getLayers().forEach(e=>{P(e,t)}):e.setVisible(t)},[]),$=(0,a.useCallback)(()=>{A(_())},[_]),w=(0,a.useCallback)(()=>{v(U()),$()},[$,U]);(0,a.useEffect)(()=>{w()},[w]);let D=(0,a.useCallback)(e=>{if(s&&0===[e].filter(s).length)return[];let t=[];if(t.push(e.on("propertychange",w)),e instanceof g()){let r=e.getLayers();for(let a of(t.push(r.on("add",w)),t.push(r.on("remove",w)),t.push(e.on("change:layers",w)),r.getArray()))t.push(...D(a))}else t.push(e.on("change:visible",$));return t},[s,w,$]),N=(0,a.useCallback)(()=>m?D(t||m.getLayerGroup()):[],[t,m,D]);(0,a.useEffect)(()=>{let e=N();return()=>{(0,c.unByKey)(e)}},[C,N]),(0,a.useEffect)(()=>{if(!m)return;let e=m.getView().on("change:resolution",I);return()=>{(0,c.unByKey)(e)}},[m,I]);let R=(0,a.useCallback)((e,t)=>{if(!m)return;let r=t.node.key,a=t.checked;if(!r)return;let l=y.A.getLayerByOlUid(m,r);l?(P(l,a),o()(u)&&u(l,a)):f.A.error("Layer is not defined")},[m,P,u]),G=(0,a.useCallback)(e=>{let t=e.node.key,r=e.dragNode.key,a=e.node.pos.split("-"),l=e.dropPosition,n=l-parseInt(a[a.length-1],10);if(!m)return;let s=y.A.getLayerByOlUid(m,r);if(!s)return void f.A.error("dragLayer is not defined");let o=y.A.getLayerByOlUid(m,t);if(!o)return void f.A.error("dropLayer is not defined");let i=y.A.getLayerPositionInfo(s,m);if(!i||!i?.groupLayer)return;let u=y.A.getLayerPositionInfo(o,m);if(!u||!u?.groupLayer)return;let c=i.groupLayer.getLayers(),d=u.groupLayer.getLayers();c.remove(s);let p=d.getArray().findIndex(e=>e===o);-1===n?l===d.getLength()-1?d.push(s):d.insertAt(p+1,s):0===n?o instanceof g()&&o.getLayers().push(s):1===n&&d.insertAt(p,s)},[m]),K=(0,a.useCallback)(e=>{let t=e.dropNode;return!(0===e.dropPosition&&!t.children)},[]),O=e?`${e} ${h}`:h;return l().createElement(n.A,{className:O,checkedKeys:b,onCheck:R,onDrop:G,allowDrop:K,selectable:!1,checkable:p,draggable:k,treeData:C,...L})}},70198:function(e,t,r){r.d(t,{$:function(){return a}});let a="react-geo-"},92813:function(e,t,r){var a=r(73065);let l=r.n(a)().getLogger("app-logger");l.setLevel("DEBUG"),t.A=l}}]);
//# sourceMappingURL=2637.7cf3e91a293476fc.js.map