"use strict";(self.webpackChunk_terrestris_shogun_gis_client=self.webpackChunk_terrestris_shogun_gis_client||[]).push([["5860"],{54616:function(e,t,r){r.r(t),r.d(t,{CollectionEvent:function(){return h}});var s=r(274),i=r(85215),n=r(43354);let a="length";class h extends n.default{constructor(e,t,r){super(e),this.element=t,this.index=r}}class u extends i.default{constructor(e,t){if(super(),this.on,this.once,this.un,t=t||{},this.unique_=!!t.unique,this.array_=e||[],this.unique_)for(let e=0,t=this.array_.length;e<t;++e)this.assertUnique_(this.array_[e],e);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(e){for(let t=0,r=e.length;t<r;++t)this.push(e[t]);return this}forEach(e){let t=this.array_;for(let r=0,s=t.length;r<s;++r)e(t[r],r,t)}getArray(){return this.array_}item(e){return this.array_[e]}getLength(){return this.get(a)}insertAt(e,t){if(e<0||e>this.getLength())throw Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t),this.array_.splice(e,0,t),this.updateLength_(),this.dispatchEvent(new h(s.A.ADD,t,e))}pop(){return this.removeAt(this.getLength()-1)}push(e){this.unique_&&this.assertUnique_(e);let t=this.getLength();return this.insertAt(t,e),this.getLength()}remove(e){let t=this.array_;for(let r=0,s=t.length;r<s;++r)if(t[r]===e)return this.removeAt(r)}removeAt(e){if(e<0||e>=this.getLength())return;let t=this.array_[e];return this.array_.splice(e,1),this.updateLength_(),this.dispatchEvent(new h(s.A.REMOVE,t,e)),t}setAt(e,t){if(e>=this.getLength())return void this.insertAt(e,t);if(e<0)throw Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t,e);let r=this.array_[e];this.array_[e]=t,this.dispatchEvent(new h(s.A.REMOVE,r,e)),this.dispatchEvent(new h(s.A.ADD,t,e))}updateLength_(){this.set(a,this.array_.length)}assertUnique_(e,t){for(let r=0,s=this.array_.length;r<s;++r)if(this.array_[r]===e&&r!==t)throw Error("Duplicate item added to a unique collection")}}t.default=u},274:function(e,t){t.A={ADD:"add",REMOVE:"remove"}},13931:function(e,t,r){function s(e,t,r,s,i,n,a){let h=new XMLHttpRequest;h.open("GET","function"==typeof e?e(r,s,i):e,!0),"arraybuffer"==t.getType()&&(h.responseType="arraybuffer"),h.withCredentials=!1,h.onload=function(e){if(!h.status||h.status>=200&&h.status<300){let e=t.getType();try{let s;"text"==e||"json"==e?s=h.responseText:"xml"==e?s=h.responseXML||h.responseText:"arraybuffer"==e&&(s=h.response),s?n(t.readFeatures(s,{extent:r,featureProjection:i}),t.readProjection(s)):a()}catch{a()}}else a()},h.onerror=a,h.send()}function i(e,t){return function(r,i,n,a,h){s(e,t,r,i,n,(e,t)=>{this.addFeatures(e),void 0!==a&&a(e)},()=>{this.changed(),void 0!==h&&h()})}}r.d(t,{m8:function(){return s},nF:function(){return i}})},98027:function(e,t,r){r.r(t),r.d(t,{all:function(){return i},bbox:function(){return n},tile:function(){return a}});var s=r(21128);function i(e,t){return[[-1/0,-1/0,1/0,1/0]]}function n(e,t){return[e]}function a(e){return function(t,r,i){let n=e.getZForResolution((0,s.fromUserResolution)(r,i)),a=e.getTileRangeForExtentAndZ((0,s.fromUserExtent)(t,i),n),h=[],u=[n,0,0];for(u[1]=a.minX;u[1]<=a.maxX;++u[1])for(u[2]=a.minY;u[2]<=a.maxY;++u[2])h.push((0,s.toUserExtent)(e.getTileCoordExtent(u),i));return h}}},98550:function(e,t,r){r.r(t);var s=r(85215),i=r(21128);class n extends s.default{constructor(e){super(),this.projection=(0,i.get)(e.projection),this.attributions_=a(e.attributions),this.attributionsCollapsible_=e.attributionsCollapsible??!0,this.loading=!1,this.state_=void 0!==e.state?e.state:"ready",this.wrapX_=void 0!==e.wrapX&&e.wrapX,this.interpolate_=!!e.interpolate,this.viewResolver=null,this.viewRejector=null;const t=this;this.viewPromise_=new Promise(function(e,r){t.viewResolver=e,t.viewRejector=r})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(e){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(e){this.attributions_=a(e),this.changed()}setState(e){this.state_=e,this.changed()}}function a(e){return e?"function"==typeof e?e:(Array.isArray(e)||(e=[e]),t=>e):null}t.default=n},84143:function(e,t,r){r.r(t),r.d(t,{VectorSourceEvent:function(){return A}});var s=r(54616),i=r(274),n=r(8959),a=r(19487),h=r(17229),u=r(43354),o=r(55506),l=r(17353),d=r(85752),f=r(13931),_=r(29991),c=r(98027),g=r(53495),E=r(35473),m=r(79027),p=r(94092),x=r(98550),v=r(38159);class A extends u.default{constructor(e,t,r){super(e),this.feature=t,this.features=r}}class R extends x.default{constructor(e){let t,r;e=e||{},super({attributions:e.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:void 0===e.wrapX||e.wrapX}),this.on,this.once,this.un,this.loader_=_.VOID,this.format_=e.format||null,this.overlaps_=void 0===e.overlaps||e.overlaps,this.url_=e.url,void 0!==e.loader?this.loader_=e.loader:void 0!==this.url_&&((0,h.v)(this.format_,"`format` must be set when `url` is set"),this.loader_=(0,f.nF)(this.url_,this.format_)),this.strategy_=void 0!==e.strategy?e.strategy:c.all;const i=void 0===e.useSpatialIndex||e.useSpatialIndex;this.featuresRtree_=i?new m.A:null,this.loadedExtentsRtree_=new m.A,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null,Array.isArray(e.features)?r=e.features:e.features&&(r=(t=e.features).getArray()),i||void 0!==t||(t=new s.default(r)),void 0!==r&&this.addFeaturesInternal(r),void 0!==t&&this.bindFeaturesCollection_(t)}addFeature(e){this.addFeatureInternal(e),this.changed()}addFeatureInternal(e){let t=(0,p.getUid)(e);if(!this.addToIndex_(t,e)){this.featuresCollection_&&this.featuresCollection_.remove(e);return}this.setupChangeEvents_(t,e);let r=e.getGeometry();if(r){let t=r.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(t,e)}else this.nullGeometryFeatures_[t]=e;this.dispatchEvent(new A(v.A.ADDFEATURE,e))}setupChangeEvents_(e,t){t instanceof E.default||(this.featureChangeKeys_[e]=[(0,l.KT)(t,o.default.CHANGE,this.handleFeatureChange_,this),(0,l.KT)(t,n.A.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(e,t){let r=!0;if(void 0!==t.getId()){let e=String(t.getId());if(e in this.idIndex_)if(t instanceof E.default){let s=this.idIndex_[e];s instanceof E.default?Array.isArray(s)?s.push(t):this.idIndex_[e]=[s,t]:r=!1}else r=!1;else this.idIndex_[e]=t}return r&&((0,h.v)(!(e in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[e]=t),r}addFeatures(e){this.addFeaturesInternal(e),this.changed()}addFeaturesInternal(e){let t=[],r=[],s=[];for(let t=0,s=e.length;t<s;t++){let s=e[t],i=(0,p.getUid)(s);this.addToIndex_(i,s)&&r.push(s)}for(let e=0,i=r.length;e<i;e++){let i=r[e],n=(0,p.getUid)(i);this.setupChangeEvents_(n,i);let a=i.getGeometry();if(a){let e=a.getExtent();t.push(e),s.push(i)}else this.nullGeometryFeatures_[n]=i}if(this.featuresRtree_&&this.featuresRtree_.load(t,s),this.hasListener(v.A.ADDFEATURE))for(let e=0,t=r.length;e<t;e++)this.dispatchEvent(new A(v.A.ADDFEATURE,r[e]))}bindFeaturesCollection_(e){let t=!1;this.addEventListener(v.A.ADDFEATURE,function(r){t||(t=!0,e.push(r.feature),t=!1)}),this.addEventListener(v.A.REMOVEFEATURE,function(r){t||(t=!0,e.remove(r.feature),t=!1)}),e.addEventListener(i.A.ADD,e=>{t||(t=!0,this.addFeature(e.element),t=!1)}),e.addEventListener(i.A.REMOVE,e=>{t||(t=!0,this.removeFeature(e.element),t=!1)}),this.featuresCollection_=e}clear(e){if(e){for(let e in this.featureChangeKeys_)this.featureChangeKeys_[e].forEach(l.JH);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_)for(let e in this.featuresRtree_.forEach(e=>{this.removeFeatureInternal(e)}),this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[e]);this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};let t=new A(v.A.CLEAR);this.dispatchEvent(t),this.changed()}forEachFeature(e){if(this.featuresRtree_)return this.featuresRtree_.forEach(e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureAtCoordinateDirect(e,t){let r=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(r,function(r){let s=r.getGeometry();if(s instanceof E.default||s.intersectsCoordinate(e))return t(r)})}forEachFeatureInExtent(e,t){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(e,t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureIntersectingExtent(e,t){return this.forEachFeatureInExtent(e,function(r){let s=r.getGeometry();if(s instanceof E.default||s.intersectsExtent(e)){let e=t(r);if(e)return e}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let e;return this.featuresCollection_?e=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(e=this.featuresRtree_.getAll(),(0,g.p)(this.nullGeometryFeatures_)||(0,a.X$)(e,Object.values(this.nullGeometryFeatures_))),e}getFeaturesAtCoordinate(e){let t=[];return this.forEachFeatureAtCoordinateDirect(e,function(e){t.push(e)}),t}getFeaturesInExtent(e,t){return this.featuresRtree_?t&&t.canWrapX()&&this.getWrapX()?[].concat(...(0,d.wrapAndSliceX)(e,t).map(e=>this.featuresRtree_.getInExtent(e))):this.featuresRtree_.getInExtent(e):this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(e,t){let r=e[0],s=e[1],i=null,n=[NaN,NaN],a=1/0,h=[-1/0,-1/0,1/0,1/0];return t=t||_.TRUE,this.featuresRtree_.forEachInExtent(h,function(e){if(t(e)){let t=e.getGeometry(),u=a;if((a=t instanceof E.default?0:t.closestPointXY(r,s,n,a))<u){i=e;let t=Math.sqrt(a);h[0]=r-t,h[1]=s-t,h[2]=r+t,h[3]=s+t}}}),i}getExtent(e){return this.featuresRtree_.getExtent(e)}getFeatureById(e){let t=this.idIndex_[e.toString()];return void 0!==t?t:null}getFeatureByUid(e){let t=this.uidIndex_[e];return void 0!==t?t:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(e){let t=e.target,r=(0,p.getUid)(t),s=t.getGeometry();if(s){let e=s.getExtent();r in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[r],this.featuresRtree_&&this.featuresRtree_.insert(e,t)):this.featuresRtree_&&this.featuresRtree_.update(e,t)}else r in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(t),this.nullGeometryFeatures_[r]=t);let i=t.getId();if(void 0!==i){let e=i.toString();this.idIndex_[e]!==t&&(this.removeFromIdIndex_(t),this.idIndex_[e]=t)}else this.removeFromIdIndex_(t),this.uidIndex_[r]=t;this.changed(),this.dispatchEvent(new A(v.A.CHANGEFEATURE,t))}hasFeature(e){let t=e.getId();return void 0!==t?t in this.idIndex_:(0,p.getUid)(e)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&(0,g.p)(this.nullGeometryFeatures_):!this.featuresCollection_||0===this.featuresCollection_.getLength()}loadFeatures(e,t,r){let s=this.loadedExtentsRtree_,i=this.strategy_(e,t,r);for(let e=0,n=i.length;e<n;++e){let n=i[e];s.forEachInExtent(n,function(e){return(0,d.containsExtent)(e.extent,n)})||(++this.loadingExtentsCount_,this.dispatchEvent(new A(v.A.FEATURESLOADSTART)),this.loader_.call(this,n,t,r,e=>{--this.loadingExtentsCount_,this.dispatchEvent(new A(v.A.FEATURESLOADEND,void 0,e))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new A(v.A.FEATURESLOADERROR))}),s.insert(n,{extent:n.slice()}))}this.loading=!(this.loader_.length<4)&&this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(e){let t=this.loadedExtentsRtree_,r=t.forEachInExtent(e,function(t){if((0,d.equals)(t.extent,e))return t});r&&t.remove(r)}removeFeatures(e){let t=!1;for(let r=0,s=e.length;r<s;++r)t=this.removeFeatureInternal(e[r])||t;t&&this.changed()}removeFeature(e){!e||this.removeFeatureInternal(e)&&this.changed()}removeFeatureInternal(e){let t=(0,p.getUid)(e);if(!(t in this.uidIndex_))return!1;t in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[t]:this.featuresRtree_&&this.featuresRtree_.remove(e);let r=this.featureChangeKeys_[t];r?.forEach(l.JH),delete this.featureChangeKeys_[t];let s=e.getId();if(void 0!==s){let t=s.toString(),r=this.idIndex_[t];r===e?delete this.idIndex_[t]:Array.isArray(r)&&(r.splice(r.indexOf(e),1),1===r.length&&(this.idIndex_[t]=r[0]))}return delete this.uidIndex_[t],this.hasListener(v.A.REMOVEFEATURE)&&this.dispatchEvent(new A(v.A.REMOVEFEATURE,e)),!0}removeFromIdIndex_(e){for(let t in this.idIndex_)if(this.idIndex_[t]===e){delete this.idIndex_[t];break}}setLoader(e){this.loader_=e}setUrl(e){(0,h.v)(this.format_,"`format` must be set when `url` is set"),this.url_=e,this.setLoader((0,f.nF)(e,this.format_))}setOverlaps(e){this.overlaps_=e,this.changed()}}t.default=R},38159:function(e,t){t.A={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"}},79027:function(e,t,r){var s=r(37831),i=r(85752),n=r(53495),a=r(94092);t.A=class{constructor(e){this.rbush_=new s.A(e),this.items_={}}insert(e,t){let r={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:t};this.rbush_.insert(r),this.items_[(0,a.getUid)(t)]=r}load(e,t){let r=Array(t.length);for(let s=0,i=t.length;s<i;s++){let i=e[s],n=t[s],h={minX:i[0],minY:i[1],maxX:i[2],maxY:i[3],value:n};r[s]=h,this.items_[(0,a.getUid)(n)]=h}this.rbush_.load(r)}remove(e){let t=(0,a.getUid)(e),r=this.items_[t];return delete this.items_[t],null!==this.rbush_.remove(r)}update(e,t){let r=this.items_[(0,a.getUid)(t)],s=[r.minX,r.minY,r.maxX,r.maxY];(0,i.equals)(s,e)||(this.remove(t),this.insert(e,t))}getAll(){return this.rbush_.all().map(function(e){return e.value})}getInExtent(e){let t={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]};return this.rbush_.search(t).map(function(e){return e.value})}forEach(e){return this.forEach_(this.getAll(),e)}forEachInExtent(e,t){return this.forEach_(this.getInExtent(e),t)}forEach_(e,t){let r;for(let s=0,i=e.length;s<i&&!(r=t(e[s]));s++);return r}isEmpty(){return(0,n.p)(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(e){let t=this.rbush_.toJSON();return(0,i.createOrUpdate)(t.minX,t.minY,t.maxX,t.maxY,e)}concat(e){for(let t in this.rbush_.load(e.rbush_.all()),e.items_)this.items_[t]=e.items_[t]}}}}]);
//# sourceMappingURL=5860.276c907009a6aca2.js.map