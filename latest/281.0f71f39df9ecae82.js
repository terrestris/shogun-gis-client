"use strict";(self.webpackChunk_terrestris_shogun_gis_client=self.webpackChunk_terrestris_shogun_gis_client||[]).push([["281"],{51365:function(e,t,r){r.r(t),r.d(t,{default:function(){return q},MeasureButton:function(){return j}});var n=r(76395),o=r.n(n),a=r(21834),l=r.n(a),i=r(55482),c=r.n(i),s=r(94934),u=r.n(s),f=r(1592),g=r.n(f),m=r(81802),d=r.n(m),p=r(27436),y=r.n(p),v=r(30100),w=r.n(v),C=r(15516),k=r.n(C),A=r(25194),$=r.n(A),b=r(70038),h=r.n(b),E=r(40542),S=r.n(E),M=r(47312),L=r.n(M),P=r(66922),_=r.n(P),O=r(97562),N=r.n(O),R=r(20191);let D="react-util-";var I=r(30126),G=r(92712),H=r(38254),T=r(42502),B=r(70198),x=r(53529);let K=`${B.$}measurebutton`,j=({measureType:e="line",measureLayerName:t="react-geo_measure",fillColor:r="rgba(255, 0, 0, 0.5)",strokeColor:a="rgba(255, 0, 0, 0.8)",showMeasureInfoOnClickedPoints:i=!1,showHelpTooltip:s=!0,decimalPlacesInTooltips:f=2,multipleDrawing:m=!1,continuePolygonMsg:p="Click to draw area",continueLineMsg:v="Click to draw line",continueAngleMsg:C="Click to draw angle",clickToDrawText:A="Click to measure",measureTooltipCssClasses:b={tooltip:`${B.$}measure-tooltip`,tooltipDynamic:`${B.$}measure-tooltip-dynamic`,tooltipStatic:`${B.$}measure-tooltip-static`},pressed:E=!1,geodesic:M=!0,measureRadius:P=!1,className:O,...j})=>{(({measureType:e,measureLayerName:t="react-util-measure",fillColor:r="rgba(255, 0, 0, 0.5)",strokeColor:o="rgba(255, 0, 0, 0.8)",showMeasureInfoOnClickedPoints:a=!1,showHelpTooltip:i=!0,decimalPlacesInTooltips:s=2,multipleDrawing:f=!1,continuePolygonMsg:m="Click to draw area",continueLineMsg:p="Click to draw line",continueAngleMsg:v="Click to draw angle",clickToDrawText:C="Click to measure",measureTooltipCssClasses:A={tooltip:`${D}measure-tooltip`,tooltipDynamic:`${D}measure-tooltip-dynamic`,tooltipStatic:`${D}measure-tooltip-static`},active:b=!1,geodesic:E=!0,measureRadius:M=!1})=>{let[P,O]=(0,n.useState)(),B=(0,n.useRef)(),x=(0,n.useRef)(),K=(0,n.useRef)([]),j=(0,I.A)(),q=(0,H.A)(()=>new(k())({properties:{name:t},source:new(h())({features:new(l())}),style:new(N())({fill:new(L())({color:r}),stroke:new(_())({color:o,width:2}),image:new(S())({radius:7,fill:new(L())({color:r})})})}),[t,r,o,r],b),z=(0,G.h)(()=>new(w())({source:q?.getSource()||void 0,type:(e=>{switch(e){case"line":case"angle":default:return"MultiLineString";case"polygon":return"MultiPolygon";case"circle":return"Circle"}})(e),maxPoints:"angle"===e?2:void 0,style:new(N())({fill:new(L())({color:r}),stroke:new(_())({color:o,lineDash:[10,10],width:2}),image:new(S())({radius:5,stroke:new(_())({color:o}),fill:new(L())({color:r})})}),freehandCondition:()=>!1}),[e,q,r,o,r],b),F=(0,n.useCallback)(()=>{j&&B.current&&(j.removeOverlay(B.current),B.current=void 0)},[j]),J=(0,n.useCallback)(()=>{if(j&&K.current.length>0){for(let e of K.current)j.removeOverlay(e);K.current=[]}},[j]),Q=(0,n.useCallback)(()=>{j&&x.current&&(j.removeOverlay(x.current),x.current=void 0)},[j]),U=(0,n.useCallback)(()=>{F(),J(),Q(),q?.getSource()?.clear()},[q,F,J,Q]);(0,n.useEffect)(()=>{if(b)return()=>{U()}},[b,U]);let V=(0,n.useCallback)(()=>{j&&!x.current&&(x.current=new($())({element:document.createElement("div"),offset:[15,0],positioning:"center-left",className:A?.tooltip??""}),j.addOverlay(x.current))},[j,A?.tooltip]),W=(0,n.useCallback)(()=>{j&&!B.current&&(B.current=new($())({element:document.createElement("div"),offset:[0,-15],positioning:"bottom-center",className:A?`${A.tooltip} ${A.tooltipDynamic}`:""}),j.addOverlay(B.current))},[j,B,A]),X=(0,n.useCallback)(()=>{let t,r;if(!B.current||!P||!j)return;let n=P.getGeometry();if(n instanceof d()?n=n.getPolygons()[0]:n instanceof g()&&(n=n.getLineStrings()[0]),n instanceof c()){if(M){let e=R.A.getAreaOfCircle(n,j),r=Math.pow(10,s),o=Math.round(n.getRadius()*r)/r;t=`${o.toString()} m`,e>1e6*Math.PI&&(t=Math.round(n.getRadius()/1e3*r)/r+" km")}else t=R.A.formatArea(n,j,s,E);r=n.getCenter()}else if(n instanceof y())t=R.A.formatArea(n,j,s,E),r=n.getInteriorPoint().getCoordinates();else{if(!(n instanceof u()))return;r=n.getLastCoordinate(),"line"===e?t=R.A.formatLength(n,j,s,E):"angle"===e&&(t=R.A.formatAngle(n,0))}let o=B.current.getElement();t&&o&&(o.innerHTML=t),B.current.setPosition(r)},[s,P,E,j,e,M]),Y=(0,n.useCallback)(e=>{j&&(f||U(),O(e.feature))},[U,j,f]),Z=(0,n.useCallback)(t=>{if(!P||!j)return;let r=P.getGeometry();r instanceof d()&&(r=r.getPolygons()[0]),r instanceof g()&&(r=r.getLineStrings()[0]);let n="line"===e?R.A.formatLength(r,j,s,E):R.A.formatArea(r,j,s,E);if(parseInt(n,10)>0){let e=document.createElement("div");A&&(e.className=`${A.tooltip} ${A.tooltipStatic}`),e.innerHTML=n;let r=new($())({element:e,offset:[0,-15],positioning:"bottom-center"});j.addOverlay(r),r.setPosition(t),K.current.push(r)}},[s,P,E,j,A,e]),ee=(0,n.useCallback)(t=>{if(f&&Z(t.feature.getGeometry().getLastCoordinate()),(f||a)&&("line"===e||"polygon"===e))F();else{let e=B.current?.getElement();e&&A&&(e.className=`${A.tooltip} ${A.tooltipStatic}`),B.current?.setOffset([0,-7])}X(),O(void 0),(f||a)&&("line"===e||"polygon"===e)&&(B.current=void 0,W())},[Z,W,A,e,f,F,a,X]),et=(0,n.useCallback)(t=>{if(!x.current)return;let r=x.current?.getElement();if(!r)return;let n=C;"polygon"===e?n=m:"line"===e?n=p:"angle"===e&&(n=v),r.innerHTML=n??"",x.current.setPosition(t)},[C,v,p,m,x,e]),er=(0,n.useCallback)(e=>{!e.dragging&&b&&et(e.coordinate)},[et,b]),en=(0,n.useCallback)(t=>{a&&"line"===e&&Z(t.coordinate)},[Z,e,a]);return(0,T.A)(z,e=>e.on("drawstart",e=>{Y?.(e)}),[z,Y]),(0,T.A)(z,e=>e.on("drawend",e=>{ee?.(e)}),[z,ee]),(0,T.A)(j,e=>e.on("pointermove",e=>{er?.(e)}),[j,er]),(0,T.A)(j,e=>e.on("click",e=>{en?.(e)}),[j,en]),(0,n.useEffect)(()=>{W(),i&&V()},[V,W,i]),(0,T.A)(P,e=>e.getGeometry()?.on("change",()=>{X?.()}),[P,X])})({active:E,measureType:e,measureLayerName:t,fillColor:r,strokeColor:a,showMeasureInfoOnClickedPoints:i,showHelpTooltip:s,decimalPlacesInTooltips:f,multipleDrawing:m,continuePolygonMsg:p,continueLineMsg:v,continueAngleMsg:C,clickToDrawText:A,measureTooltipCssClasses:b,geodesic:M,measureRadius:P});let q=O?`${O} ${K}`:K;return o().createElement(x.A,{pressed:E,className:q,...j})};var q=j},53529:function(e,t,r){var n=r(76395),o=r.n(n),a=r(54440),l=r(74097),i=r(70198);t.A=({type:e="primary",pressed:t=!1,tooltipProps:r={mouseEnterDelay:1.5},className:n,tooltip:c,tooltipPlacement:s,pressedIcon:u,icon:f,children:g,value:m,onClick:d,onChange:p=()=>void 0,...y})=>{let v=`${i.$}togglebutton`,w=n?`${n} ${v}`:v,C="";return t&&(C=" btn-pressed"),o().createElement(a.A,{title:c,placement:s,...r},o().createElement(l.Ay,{type:e,onClick:e=>{d&&(d(e),e.defaultPrevented)||p(e,m)},onChange:p,className:`${w}${C}`,"aria-pressed":t,icon:t?u:f,...y},g))}},70198:function(e,t,r){r.d(t,{$:function(){return n}});let n="react-geo-"},92712:function(e,t,r){r.d(t,{h:function(){return l}});var n=r(76395),o=r(2543),a=r(30126);let l=(e,t,r)=>{let l=(0,a.A)(),[i,c]=(0,n.useState)();return(0,n.useEffect)(()=>{if(!l)return;let t=e();if(t)return c(t),l.addInteraction(t),()=>{l.removeInteraction(t),c(void 0)}},[...t,l]),(0,n.useEffect)(()=>{!i||(0,o.isNil)(r)||i.setActive(r)},[i,r]),i}},42502:function(e,t,r){r.d(t,{R:function(){return a}});var n=r(76395),o=r(17936);let a=(e,t,r,a)=>{(0,n.useEffect)(()=>{if(!e||!1===a)return;let r=(Array.isArray(e)?e:[e]).flatMap(e=>{let r=t(e);return Array.isArray(r)?r:[r]}).filter(e=>void 0!==e);return()=>{for(let e of r)(0,o.unByKey)(e)}},[e,a,t,...r])};t.A=a}}]);
//# sourceMappingURL=281.0f71f39df9ecae82.js.map