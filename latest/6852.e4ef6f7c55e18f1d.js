"use strict";(self.webpackChunk_terrestris_shogun_gis_client=self.webpackChunk_terrestris_shogun_gis_client||[]).push([["6852"],{76464:function(e,t,r){var n=r(14293),a=r.n(n),o=r(22771),i=r.n(o),l=r(74022);class u{static getLength(e,t,r=!0,n=6371008.8,a=6){let o=Math.pow(10,a);if(!r)return Math.round(e.getLength()*o)/o;{let r={projection:t.getView().getProjection().getCode(),radius:n};return(0,l.getLength)(e,r)}}static formatLength(e,t,r,n=!0){let a=Math.pow(10,r),o=u.getLength(e,t,n);return o>1e3?Math.round(o/1e3*a)/a+" km":o>1?Math.round(o*a)/a+" m":Math.round(1e3*o*a)/a+" mm"}static getArea(e,t,r=!0,n=6371008.8){if(!r)return e.getArea();{let r={projection:t.getView().getProjection().getCode(),radius:n};return(0,l.getArea)(e,r)}}static getAreaOfCircle(e,t){if(a()(t.getView().getProjection()))return NaN;if(!["radians","degrees"].includes(t.getView().getProjection().getUnits()))return Math.PI*Math.pow(e.getRadius(),2);{let t=e.getRadius(),r=2*Math.PI*40589753129677.44;return r*(1-Math.cos(t/6371008.8))}}static formatArea(e,t,r,n=!0){let a,o=Math.pow(10,r);return(a=e instanceof i()?u.getAreaOfCircle(e,t):u.getArea(e,t,n))>1e4?Math.round(a/1e6*o)/o+" km<sup>2</sup>":a>.01?Math.round(a*o)/o+" m<sup>2</sup>":Math.round(1e6*a*o)/o+" mm<sup>2</sup>"}static angle(e,t){let r=e[0]-t[0],n=Math.atan2(e[1]-t[1],r);return 180/Math.PI*n}static angle360(e,t){let r=u.angle(e,t);return r<0&&(r=360+r),r}static makeClockwise(e){return 360-e}static makeZeroDegreesAtNorth(e){let t=e+90;return t>360&&(t-=360),t}static formatAngle(e,t=2){let r=e.getCoordinates(),n=r.length;if(n<2)return"";let a=r[n-1],o=r[n-2],i=u.angle360(o,a);return i=u.makeZeroDegreesAtNorth(i),i=u.makeClockwise(i),`${i.toFixed(t)}\xb0`}}t.Z=u},54647:function(e,t,r){r.r(t),r.d(t,{default:function(){return B},MeasureButton:function(){return T}});var n=r(9948),a=r.n(n),o=r(47387),i=r.n(o),l=r(22771),u=r.n(l),c=r(12162),s=r.n(c),f=r(91657),g=r.n(f),d=r(33782),m=r.n(d),p=r(2087),h=r.n(p),w=r(16333),C=r.n(w),k=r(35586),v=r.n(k),y=r(18428),M=r.n(y),Z=r(41357),b=r.n(Z),$=r(99956),A=r.n($),P=r(76823),E=r.n(P),L=r(23173),S=r.n(L),N=r(50268),O=r.n(N),_=r(76464);let I="react-util-";var D=r(39660),R=r(18429),j=r(49968),x=r(4667),V=r(35703),G=r(32022);let H=`${V.M}measurebutton`,T=({measureType:e="line",measureLayerName:t="react-geo_measure",fillColor:r="rgba(255, 0, 0, 0.5)",strokeColor:o="rgba(255, 0, 0, 0.8)",showMeasureInfoOnClickedPoints:l=!1,showHelpTooltip:c=!0,decimalPlacesInTooltips:f=2,multipleDrawing:d=!1,continuePolygonMsg:p="Click to draw area",continueLineMsg:w="Click to draw line",continueAngleMsg:k="Click to draw angle",clickToDrawText:y="Click to measure",measureTooltipCssClasses:Z={tooltip:`${V.M}measure-tooltip`,tooltipDynamic:`${V.M}measure-tooltip-dynamic`,tooltipStatic:`${V.M}measure-tooltip-static`},pressed:$=!1,geodesic:P=!0,measureRadius:L=!1,className:N,...T})=>{(({measureType:e,measureLayerName:t="react-util-measure",fillColor:r="rgba(255, 0, 0, 0.5)",strokeColor:a="rgba(255, 0, 0, 0.8)",showMeasureInfoOnClickedPoints:o=!1,showHelpTooltip:l=!0,decimalPlacesInTooltips:c=2,multipleDrawing:f=!1,continuePolygonMsg:d="Click to draw area",continueLineMsg:p="Click to draw line",continueAngleMsg:w="Click to draw angle",clickToDrawText:k="Click to measure",measureTooltipCssClasses:y={tooltip:`${I}measure-tooltip`,tooltipDynamic:`${I}measure-tooltip-dynamic`,tooltipStatic:`${I}measure-tooltip-static`},active:Z=!1,geodesic:$=!0,measureRadius:P=!1})=>{let[L,N]=(0,n.useState)(),V=(0,n.useRef)(),G=(0,n.useRef)(),H=(0,n.useRef)([]),T=(0,D.Z)(),B=(0,j.Z)(()=>new(v())({properties:{name:t},source:new(b())({features:new(i())}),style:new(O())({fill:new(E())({color:r}),stroke:new(S())({color:a,width:2}),image:new(A())({radius:7,fill:new(E())({color:r})})})}),[t,r,a,r],Z),F=(0,R.$)(()=>new(C())({source:B?.getSource()||void 0,type:(e=>{switch(e){case"line":case"angle":default:return"MultiLineString";case"polygon":return"MultiPolygon";case"circle":return"Circle"}})(e),maxPoints:"angle"===e?2:void 0,style:new(O())({fill:new(E())({color:r}),stroke:new(S())({color:a,lineDash:[10,10],width:2}),image:new(A())({radius:5,stroke:new(S())({color:a}),fill:new(E())({color:r})})}),freehandCondition:()=>!1}),[e,B,r,a,r],Z),K=(0,n.useCallback)(()=>{T&&V.current&&(T.removeOverlay(V.current),V.current=void 0)},[T]),U=(0,n.useCallback)(()=>{if(T&&H.current.length>0){for(let e of H.current)T.removeOverlay(e);H.current=[]}},[T]),q=(0,n.useCallback)(()=>{T&&G.current&&(T.removeOverlay(G.current),G.current=void 0)},[T]),z=(0,n.useCallback)(()=>{K(),U(),q(),B?.getSource()?.clear()},[B,K,U,q]);(0,n.useEffect)(()=>{if(Z)return()=>{z()}},[Z,z]);let J=(0,n.useCallback)(()=>{T&&!G.current&&(G.current=new(M())({element:document.createElement("div"),offset:[15,0],positioning:"center-left",className:y?.tooltip??""}),T.addOverlay(G.current))},[T,y?.tooltip]),Q=(0,n.useCallback)(()=>{T&&!V.current&&(V.current=new(M())({element:document.createElement("div"),offset:[0,-15],positioning:"bottom-center",className:y?`${y.tooltip} ${y.tooltipDynamic}`:""}),T.addOverlay(V.current))},[T,V,y]),W=(0,n.useCallback)(()=>{let t,r;if(!V.current||!L||!T)return;let n=L.getGeometry();if(n instanceof m()?n=n.getPolygons()[0]:n instanceof g()&&(n=n.getLineStrings()[0]),n instanceof u()){if(P){let e=_.Z.getAreaOfCircle(n,T),r=Math.pow(10,c),a=Math.round(n.getRadius()*r)/r;t=`${a.toString()} m`,e>1e6*Math.PI&&(t=Math.round(n.getRadius()/1e3*r)/r+" km")}else t=_.Z.formatArea(n,T,c,$);r=n.getCenter()}else if(n instanceof h())t=_.Z.formatArea(n,T,c,$),r=n.getInteriorPoint().getCoordinates();else{if(!(n instanceof s()))return;r=n.getLastCoordinate(),"line"===e?t=_.Z.formatLength(n,T,c,$):"angle"===e&&(t=_.Z.formatAngle(n,0))}let a=V.current.getElement();t&&a&&(a.innerHTML=t),V.current.setPosition(r)},[c,L,$,T,e,P]),X=(0,n.useCallback)(e=>{T&&(f||z(),N(e.feature))},[z,T,f]),Y=(0,n.useCallback)(t=>{if(!L||!T)return;let r=L.getGeometry();r instanceof m()&&(r=r.getPolygons()[0]),r instanceof g()&&(r=r.getLineStrings()[0]);let n="line"===e?_.Z.formatLength(r,T,c,$):_.Z.formatArea(r,T,c,$);if(parseInt(n,10)>0){let e=document.createElement("div");y&&(e.className=`${y.tooltip} ${y.tooltipStatic}`),e.innerHTML=n;let r=new(M())({element:e,offset:[0,-15],positioning:"bottom-center"});T.addOverlay(r),r.setPosition(t),H.current.push(r)}},[c,L,$,T,y,e]),ee=(0,n.useCallback)(t=>{if(f&&Y(t.feature.getGeometry().getLastCoordinate()),(f||o)&&("line"===e||"polygon"===e))K();else{let e=V.current?.getElement();e&&y&&(e.className=`${y.tooltip} ${y.tooltipStatic}`),V.current?.setOffset([0,-7])}W(),N(void 0),(f||o)&&("line"===e||"polygon"===e)&&(V.current=void 0,Q())},[Y,Q,y,e,f,K,o,W]),et=(0,n.useCallback)(t=>{if(!G.current)return;let r=G.current?.getElement();if(!r)return;let n=k;"polygon"===e?n=d:"line"===e?n=p:"angle"===e&&(n=w),r.innerHTML=n??"",G.current.setPosition(t)},[k,w,p,d,G,e]),er=(0,n.useCallback)(e=>{!e.dragging&&Z&&et(e.coordinate)},[et,Z]),en=(0,n.useCallback)(t=>{o&&"line"===e&&Y(t.coordinate)},[Y,e,o]);return(0,x.Z)(F,e=>e.on("drawstart",e=>{X?.(e)}),[F,X]),(0,x.Z)(F,e=>e.on("drawend",e=>{ee?.(e)}),[F,ee]),(0,x.Z)(T,e=>e.on("pointermove",e=>{er?.(e)}),[T,er]),(0,x.Z)(T,e=>e.on("click",e=>{en?.(e)}),[T,en]),(0,n.useEffect)(()=>{Q(),l&&J()},[J,Q,l]),(0,x.Z)(L,e=>e.getGeometry()?.on("change",()=>{W?.()}),[L,W])})({active:$,measureType:e,measureLayerName:t,fillColor:r,strokeColor:o,showMeasureInfoOnClickedPoints:l,showHelpTooltip:c,decimalPlacesInTooltips:f,multipleDrawing:d,continuePolygonMsg:p,continueLineMsg:w,continueAngleMsg:k,clickToDrawText:y,measureTooltipCssClasses:Z,geodesic:P,measureRadius:L});let B=N?`${N} ${H}`:H;return a().createElement(G.Z,{pressed:$,className:B,...T})};var B=T},32022:function(e,t,r){var n=r(9948),a=r.n(n),o=r(40440),i=r(76534),l=r(35703);t.Z=({type:e="primary",pressed:t=!1,tooltipProps:r={mouseEnterDelay:1.5},className:n,tooltip:u,tooltipPlacement:c,pressedIcon:s,icon:f,children:g,value:d,onClick:m,onChange:p=()=>void 0,...h})=>{let w=`${l.M}togglebutton`,C=n?`${n} ${w}`:w,k="";return t&&(k=" btn-pressed"),a().createElement(o.Z,{title:u,placement:c,...r},a().createElement(i.ZP,{type:e,onClick:e=>{m&&(m(e),e.defaultPrevented)||p(e,d)},onChange:p,className:`${C}${k}`,"aria-pressed":t,icon:t?s:f,...h},g))}},35703:function(e,t,r){r.d(t,{M:function(){return n}});let n="react-geo-"},33071:function(e,t,r){var n=r(9948);t.Z=r.n(n)().createContext(null)},39660:function(e,t,r){r.d(t,{S:function(){return o}});var n=r(9948),a=r(33071);let o=()=>(0,n.useContext)(a.Z);t.Z=o},18429:function(e,t,r){r.d(t,{$:function(){return i}});var n=r(9948),a=r(96486),o=r(39660);let i=(e,t,r)=>{let i=(0,o.Z)(),[l,u]=(0,n.useState)();return(0,n.useEffect)(()=>{if(!i)return;let t=e();if(t)return u(t),i.addInteraction(t),()=>{i.removeInteraction(t),u(void 0)}},[...t,i]),(0,n.useEffect)(()=>{!l||(0,a.isNil)(r)||l.setActive(r)},[l,r]),l}},49968:function(e,t,r){r.d(t,{n:function(){return i}});var n=r(9948),a=r(96486),o=r(39660);let i=(e,t,r)=>{let i=(0,o.Z)(),[l,u]=(0,n.useState)();return(0,n.useEffect)(()=>{if(!i)return;let t=e();if(t)return i.addLayer(t),u(t),()=>{i.removeLayer(t),u(void 0)}},[i,...t]),(0,n.useEffect)(()=>{!l||(0,a.isNil)(r)||l.setVisible(r)},[l,r]),l};t.Z=i},4667:function(e,t,r){r.d(t,{N:function(){return o}});var n=r(9948),a=r(42893);let o=(e,t,r,o)=>{(0,n.useEffect)(()=>{if(!e||!1===o)return;let r=(Array.isArray(e)?e:[e]).flatMap(e=>{let r=t(e);return Array.isArray(r)?r:[r]}).filter(e=>void 0!==e);return()=>{for(let e of r)(0,a.unByKey)(e)}},[e,o,t,...r])};t.Z=o}}]);
//# sourceMappingURL=6852.e4ef6f7c55e18f1d.js.map