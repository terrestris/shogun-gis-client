"use strict";(self.webpackChunk_terrestris_shogun_gis_client=self.webpackChunk_terrestris_shogun_gis_client||[]).push([["6852"],{76464:function(e,t,r){var n=r(14293),a=r.n(n),o=r(69880),i=r.n(o),l=r(91949);class u{static getLength(e,t,r=!0,n=6371008.8,a=6){let o=Math.pow(10,a);if(!r)return Math.round(e.getLength()*o)/o;{let r={projection:t.getView().getProjection().getCode(),radius:n};return(0,l.getLength)(e,r)}}static formatLength(e,t,r,n=!0){let a,o=Math.pow(10,r),i=u.getLength(e,t,n);return i>1e3?Math.round(i/1e3*o)/o+" km":i>1?Math.round(i*o)/o+" m":Math.round(1e3*i*o)/o+" mm"}static getArea(e,t,r=!0,n=6371008.8){if(!r)return e.getArea();{let r={projection:t.getView().getProjection().getCode(),radius:n};return(0,l.getArea)(e,r)}}static getAreaOfCircle(e,t){if(a()(t.getView().getProjection()))return NaN;if(!["radians","degrees"].includes(t.getView().getProjection().getUnits()))return Math.PI*Math.pow(e.getRadius(),2);{let t=e.getRadius(),r=2*Math.PI*40589753129677.44;return r*(1-Math.cos(t/6371008.8))}}static formatArea(e,t,r,n=!0){let a,o,l=Math.pow(10,r);return(a=e instanceof i()?u.getAreaOfCircle(e,t):u.getArea(e,t,n))>1e4?Math.round(a/1e6*l)/l+" km<sup>2</sup>":a>.01?Math.round(a*l)/l+" m<sup>2</sup>":Math.round(1e6*a*l)/l+" mm<sup>2</sup>"}static angle(e,t){let r=e[0]-t[0],n=Math.atan2(e[1]-t[1],r);return 180/Math.PI*n}static angle360(e,t){let r=u.angle(e,t);return r<0&&(r=360+r),r}static makeClockwise(e){return 360-e}static makeZeroDegreesAtNorth(e){let t=e+90;return t>360&&(t-=360),t}static formatAngle(e,t=2){let r=e.getCoordinates(),n=r.length;if(n<2)return"";let a=r[n-1],o=r[n-2],i=u.angle360(o,a);return i=u.makeZeroDegreesAtNorth(i),i=u.makeClockwise(i),`${i.toFixed(t)}\xb0`}}t.Z=u},54647:function(e,t,r){r.r(t),r.d(t,{MeasureButton:function(){return B},default:function(){return F}});var n=r(9948),a=r.n(n),o=r(41291),i=r.n(o),l=r(69880),u=r.n(l),c=r(99655),s=r.n(c),g=r(82422),f=r.n(g),d=r(71527),m=r.n(d),p=r(65518),h=r.n(p),w=r(45627),k=r.n(w),C=r(80982),y=r.n(C),v=r(93776),M=r.n(v),b=r(93349),Z=r.n(b),$=r(89686),A=r.n($),P=r(22336),E=r.n(P),L=r(28513),N=r.n(L),S=r(83713),O=r.n(S),_=r(76464);let I="react-util-";var D=r(39660),R=r(18429),j=r(49968),V=r(4667),G=({measureType:e,measureLayerName:t="react-util-measure",fillColor:r="rgba(255, 0, 0, 0.5)",strokeColor:a="rgba(255, 0, 0, 0.8)",showMeasureInfoOnClickedPoints:o=!1,showHelpTooltip:l=!0,decimalPlacesInTooltips:c=2,multipleDrawing:g=!1,continuePolygonMsg:d="Click to draw area",continueLineMsg:p="Click to draw line",continueAngleMsg:w="Click to draw angle",clickToDrawText:C="Click to measure",measureTooltipCssClasses:v={tooltip:`${I}measure-tooltip`,tooltipDynamic:`${I}measure-tooltip-dynamic`,tooltipStatic:`${I}measure-tooltip-static`},active:b=!1,geodesic:$=!0,measureRadius:P=!1})=>{let[L,S]=(0,n.useState)(),G=(0,n.useRef)(),x=(0,n.useRef)(),H=(0,n.useRef)([]),T=(0,D.Z)(),B=(0,j.Z)(()=>new(y())({properties:{name:t},source:new(Z())({features:new(i())}),style:new(O())({fill:new(E())({color:r}),stroke:new(N())({color:a,width:2}),image:new(A())({radius:7,fill:new(E())({color:r})})})}),[t,r,a,r],b),F=(0,R.$)(()=>new(k())({source:B?.getSource()||void 0,type:(e=>{switch(e){case"line":case"angle":default:return"MultiLineString";case"polygon":return"MultiPolygon";case"circle":return"Circle"}})(e),maxPoints:"angle"===e?2:void 0,style:new(O())({fill:new(E())({color:r}),stroke:new(N())({color:a,lineDash:[10,10],width:2}),image:new(A())({radius:5,stroke:new(N())({color:a}),fill:new(E())({color:r})})}),freehandCondition:()=>!1}),[e,B,r,a,r],b),K=(0,n.useCallback)(()=>{T&&G.current&&(T.removeOverlay(G.current),G.current=void 0)},[T]),U=(0,n.useCallback)(()=>{if(T&&H.current.length>0){for(let e of H.current)T.removeOverlay(e);H.current=[]}},[T]),q=(0,n.useCallback)(()=>{T&&x.current&&(T.removeOverlay(x.current),x.current=void 0)},[T]),z=(0,n.useCallback)(()=>{K(),U(),q(),B?.getSource()?.clear()},[B,K,U,q]);(0,n.useEffect)(()=>{if(b)return()=>{z()}},[b,z]);let J=(0,n.useCallback)(()=>{T&&!x.current&&(x.current=new(M())({element:document.createElement("div"),offset:[15,0],positioning:"center-left",className:v?.tooltip??""}),T.addOverlay(x.current))},[T,v?.tooltip]),Q=(0,n.useCallback)(()=>{T&&!G.current&&(G.current=new(M())({element:document.createElement("div"),offset:[0,-15],positioning:"bottom-center",className:v?`${v.tooltip} ${v.tooltipDynamic}`:""}),T.addOverlay(G.current))},[T,G,v]),W=(0,n.useCallback)(()=>{let t,r;if(!G.current||!L||!T)return;let n=L.getGeometry();if(n instanceof m()?n=n.getPolygons()[0]:n instanceof f()&&(n=n.getLineStrings()[0]),n instanceof u()){if(P){let e=_.Z.getAreaOfCircle(n,T),r=Math.pow(10,c),a=Math.round(n.getRadius()*r)/r;t=`${a.toString()} m`,e>1e6*Math.PI&&(t=Math.round(n.getRadius()/1e3*r)/r+" km")}else t=_.Z.formatArea(n,T,c,$);r=n.getCenter()}else if(n instanceof h())t=_.Z.formatArea(n,T,c,$),r=n.getInteriorPoint().getCoordinates();else{if(!(n instanceof s()))return;r=n.getLastCoordinate(),"line"===e?t=_.Z.formatLength(n,T,c,$):"angle"===e&&(t=_.Z.formatAngle(n,0))}let a=G.current.getElement();t&&a&&(a.innerHTML=t),G.current.setPosition(r)},[c,L,$,T,e,P]),X=(0,n.useCallback)(e=>{T&&(g||z(),S(e.feature))},[z,T,g]),Y=(0,n.useCallback)(t=>{if(!L||!T)return;let r=L.getGeometry();r instanceof m()&&(r=r.getPolygons()[0]),r instanceof f()&&(r=r.getLineStrings()[0]);let n="line"===e?_.Z.formatLength(r,T,c,$):_.Z.formatArea(r,T,c,$);if(parseInt(n,10)>0){let e=document.createElement("div");v&&(e.className=`${v.tooltip} ${v.tooltipStatic}`),e.innerHTML=n;let r=new(M())({element:e,offset:[0,-15],positioning:"bottom-center"});T.addOverlay(r),r.setPosition(t),H.current.push(r)}},[c,L,$,T,v,e]),ee=(0,n.useCallback)(t=>{if(g&&Y(t.feature.getGeometry().getLastCoordinate()),(g||o)&&("line"===e||"polygon"===e))K();else{let e=G.current?.getElement();e&&v&&(e.className=`${v.tooltip} ${v.tooltipStatic}`),G.current?.setOffset([0,-7])}W(),S(void 0),(g||o)&&("line"===e||"polygon"===e)&&(G.current=void 0,Q())},[Y,Q,v,e,g,K,o,W]),et=(0,n.useCallback)(t=>{if(!x.current)return;let r=x.current?.getElement();if(!r)return;let n=C;"polygon"===e?n=d:"line"===e?n=p:"angle"===e&&(n=w),r.innerHTML=n??"",x.current.setPosition(t)},[C,w,p,d,x,e]),er=(0,n.useCallback)(e=>{!e.dragging&&b&&et(e.coordinate)},[et,b]),en=(0,n.useCallback)(t=>{o&&"line"===e&&Y(t.coordinate)},[Y,e,o]);return(0,V.Z)(F,e=>e.on("drawstart",e=>{X?.(e)}),[F,X]),(0,V.Z)(F,e=>e.on("drawend",e=>{ee?.(e)}),[F,ee]),(0,V.Z)(T,e=>e.on("pointermove",e=>{er?.(e)}),[T,er]),(0,V.Z)(T,e=>e.on("click",e=>{en?.(e)}),[T,en]),(0,n.useEffect)(()=>{Q(),l&&J()},[J,Q,l]),(0,V.Z)(L,e=>e.getGeometry()?.on("change",()=>{W?.()}),[L,W]),null},x=r(35703),H=r(32022);let T=`${x.M}measurebutton`,B=({measureType:e="line",measureLayerName:t="react-geo_measure",fillColor:r="rgba(255, 0, 0, 0.5)",strokeColor:n="rgba(255, 0, 0, 0.8)",showMeasureInfoOnClickedPoints:o=!1,showHelpTooltip:i=!0,decimalPlacesInTooltips:l=2,multipleDrawing:u=!1,continuePolygonMsg:c="Click to draw area",continueLineMsg:s="Click to draw line",continueAngleMsg:g="Click to draw angle",clickToDrawText:f="Click to measure",measureTooltipCssClasses:d={tooltip:`${x.M}measure-tooltip`,tooltipDynamic:`${x.M}measure-tooltip-dynamic`,tooltipStatic:`${x.M}measure-tooltip-static`},pressed:m=!1,geodesic:p=!0,measureRadius:h=!1,className:w,...k})=>{G({active:!!m,measureType:e,measureLayerName:t,fillColor:r,strokeColor:n,showMeasureInfoOnClickedPoints:o,showHelpTooltip:i,decimalPlacesInTooltips:l,multipleDrawing:u,continuePolygonMsg:c,continueLineMsg:s,continueAngleMsg:g,clickToDrawText:f,measureTooltipCssClasses:d,geodesic:p,measureRadius:h});let C=w?`${w} ${T}`:T;return a().createElement(H.Z,{pressed:m,className:C,...k})};var F=B},32022:function(e,t,r){var n=r(40440),a=r(76534),o=r(9948),i=r.n(o),l=r(35703);t.Z=({type:e="primary",pressed:t=!1,tooltipProps:r={mouseEnterDelay:1.5},className:o,tooltip:u,tooltipPlacement:c,pressedIcon:s,icon:g,children:f,value:d,onClick:m,onChange:p=()=>{},...h})=>{let w=`${l.M}togglebutton`,k=o?`${o} ${w}`:w,C="";return t&&(C=" btn-pressed"),i().createElement(n.Z,{title:u,placement:c,...r},i().createElement(a.ZP,{type:e,onClick:e=>{m&&(m(e),e.defaultPrevented)||p(e,d)},onChange:p,className:`${k}${C}`,"aria-pressed":t,icon:t?s:g,...h},f))}},35703:function(e,t,r){r.d(t,{M:function(){return n}});let n="react-geo-"},18429:function(e,t,r){r.d(t,{$:function(){return i}});var n=r(9948),a=r(96486),o=r(39660);let i=(e,t,r)=>{let i=(0,o.Z)(),[l,u]=(0,n.useState)();return(0,n.useEffect)(()=>{if(!i)return;let t=e();if(t)return u(t),i.addInteraction(t),()=>{i.removeInteraction(t),u(void 0)}},[...t,i]),(0,n.useEffect)(()=>{!l||(0,a.isNil)(r)||l.setActive(r)},[l,r]),l}},49968:function(e,t,r){r.d(t,{n:function(){return i}});var n=r(9948),a=r(96486),o=r(39660);let i=(e,t,r)=>{let i=(0,o.Z)(),[l,u]=(0,n.useState)();return(0,n.useEffect)(()=>{if(!i)return;let t=e();if(t)return i.addLayer(t),u(t),()=>{i.removeLayer(t),u(void 0)}},[i,...t]),(0,n.useEffect)(()=>{!l||(0,a.isNil)(r)||l.setVisible(r)},[l,r]),l};t.Z=i},4667:function(e,t,r){r.d(t,{N:function(){return o}});var n=r(9948),a=r(86977);let o=(e,t,r,o)=>{(0,n.useEffect)(()=>{if(!e||!1===o)return;let r=(Array.isArray(e)?e:[e]).flatMap(e=>{let r=t(e);return Array.isArray(r)?r:[r]}).filter(e=>void 0!==e);return()=>{for(let e of r)(0,a.unByKey)(e)}},[e,o,t,...r])};t.Z=o}}]);
//# sourceMappingURL=6852.5b9adcbcee518317.js.map