"use strict";(self.webpackChunk_terrestris_shogun_gis_client=self.webpackChunk_terrestris_shogun_gis_client||[]).push([["6717"],{54072:function(t,e,i){i.d(e,{Ps:function(){return S},ZP:function(){return L},r6:function(){return O}});var n=i("9520"),r=i("73381"),s=i("11256"),a=i("2022"),o=i("35211"),u=i("56245"),l=i("52209");function h(t){return Array.isArray(t)?Math.min(...t):t}var g=i("21915"),c=i("13002");class d extends a.ZP{constructor(t,e,i,n,r,a,h){let c=t.getExtent();c&&t.canWrapX()&&((c=c.slice())[0]=-1/0,c[2]=1/0);let d=e.getExtent();d&&e.canWrapX()&&((d=d.slice())[0]=-1/0,d[2]=1/0);let _=d?(0,g.getIntersection)(i,d):i,E=(0,g.getCenter)(_),R=(0,l.aA)(t,e,E,n),f=o.m,m=new u.Z(t,e,_,c,R*f,n),I=m.calculateSourceExtent(),p=(0,g.isEmpty)(I)?null:a(I,R,r),A=p?s.default.IDLE:s.default.EMPTY,O=p?p.getPixelRatio():1;super(i,n,O,A),this.targetProj_=e,this.maxSourceExtent_=c,this.triangulation_=m,this.targetResolution_=n,this.targetExtent_=i,this.sourceImage_=p,this.sourcePixelRatio_=O,this.interpolate_=h,this.canvas_=null,this.sourceListenerKey_=null}disposeInternal(){this.state==s.default.LOADING&&this.unlistenSource_(),super.disposeInternal()}getImage(){return this.canvas_}getProjection(){return this.targetProj_}reproject_(){let t=this.sourceImage_.getState();if(t==s.default.LOADED){let t=(0,g.getWidth)(this.targetExtent_)/this.targetResolution_,e=(0,g.getHeight)(this.targetExtent_)/this.targetResolution_;this.canvas_=(0,l.sY)(t,e,this.sourcePixelRatio_,h(this.sourceImage_.getResolution()),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0,void 0,this.interpolate_,!0)}this.state=t,this.changed()}load(){if(this.state==s.default.IDLE){this.state=s.default.LOADING,this.changed();let t=this.sourceImage_.getState();t==s.default.LOADED||t==s.default.ERROR?this.reproject_():(this.sourceListenerKey_=(0,c.oL)(this.sourceImage_,r.default.CHANGE,t=>{let e=this.sourceImage_.getState();(e==s.default.LOADED||e==s.default.ERROR)&&(this.unlistenSource_(),this.reproject_())}),this.sourceImage_.load())}}unlistenSource_(){(0,c.bN)(this.sourceListenerKey_),this.sourceListenerKey_=null}}var _=i("71405"),E=i("14431"),R=i("21882"),f=i("5374"),m=i("79682");let I={IMAGELOADSTART:"imageloadstart",IMAGELOADEND:"imageloadend",IMAGELOADERROR:"imageloaderror"};class p extends n.default{constructor(t,e){super(t),this.image=e}}class A extends _.default{constructor(t){super({attributions:t.attributions,projection:t.projection,state:t.state,interpolate:void 0===t.interpolate||t.interpolate}),this.on,this.once,this.un,this.loader=t.loader||null,this.resolutions_=void 0!==t.resolutions?t.resolutions:null,this.reprojectedImage_=null,this.reprojectedRevision_=0,this.image=null,this.wantedExtent_,this.wantedResolution_,this.static_=!!t.loader&&0===t.loader.length,this.wantedProjection_=null}getResolutions(){return this.resolutions_}setResolutions(t){this.resolutions_=t}findNearestResolution(t){let e=this.getResolutions();if(e){let i=(0,m.h7)(e,t,0);t=e[i]}return t}getImage(t,e,i,n){let r=this.getProjection();if(!r||!n||(0,f.equivalent)(r,n))return r&&(n=r),this.getImageInternal(t,e,i,n);if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&(0,f.equivalent)(this.reprojectedImage_.getProjection(),n)&&this.reprojectedImage_.getResolution()==e&&(0,g.equals)(this.reprojectedImage_.getExtent(),t))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new d(r,n,t,e,i,(t,e,i)=>this.getImageInternal(t,e,i,r),this.getInterpolate()),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}getImageInternal(t,e,i,n){if(this.loader){let s=S(t,e,i,1),o=this.findNearestResolution(e);if(this.image&&(this.static_||this.wantedProjection_===n&&(this.wantedExtent_&&(0,g.containsExtent)(this.wantedExtent_,s)||(0,g.containsExtent)(this.image.getExtent(),s))&&(this.wantedResolution_&&h(this.wantedResolution_)===o||h(this.image.getResolution())===o)))return this.image;this.wantedProjection_=n,this.wantedExtent_=s,this.wantedResolution_=o,this.image=new a.ZP(s,o,i,this.loader),this.image.addEventListener(r.default.CHANGE,this.handleImageChange.bind(this))}return this.image}handleImageChange(t){let e;let i=t.target;switch(i.getState()){case s.default.LOADING:this.loading=!0,e=I.IMAGELOADSTART;break;case s.default.LOADED:this.loading=!1,e=I.IMAGELOADEND;break;case s.default.ERROR:this.loading=!1,e=I.IMAGELOADERROR;break;default:return}this.hasListener(e)&&this.dispatchEvent(new p(e,i))}}function O(t,e){t.getImage().src=e}function S(t,e,i,n){let r=e/i,s=(0,g.getCenter)(t),a=(0,R.mD)((0,g.getWidth)(t)/r,E.L),o=(0,R.mD)((0,g.getHeight)(t)/r,E.L),u=(0,R.mD)((n-1)*a/2,E.L),l=(0,R.mD)((n-1)*o/2,E.L);return(0,g.getForViewAndSize)(s,r,0,[a+2*u,o+2*l])}var L=A},14431:function(t,e,i){i.d(e,{L:function(){return n}});let n=4},49081:function(t,e,i){i.d(e,{Ke:function(){return R},Q4:function(){return _},QL:function(){return f},YT:function(){return m},eQ:function(){return g},jt:function(){return E}});var n=i(14431),r=i(78487),s=i(79313),a=i(2022),o=i(21882),u=i(21915),l=i(5374),h=i(54072);let g="1.3.0",c=[101,101];function d(t,e,i,n,a){a.WIDTH=i[0],a.HEIGHT=i[1];let o=n.getAxisOrientation(),u=(0,s.n)(a.VERSION,"1.3")>=0;a[u?"CRS":"SRS"]=n.getCode();let l=u&&o.startsWith("ne")?[e[1],e[0],e[3],e[2]]:e;return a.BBOX=l.join(","),(0,r.B5)(t,a)}function _(t,e,i,r,s,a,l){a=Object.assign({REQUEST:"GetMap"},a);let h=e/i,g=[(0,o.NM)((0,u.getWidth)(t)/h,n.L),(0,o.NM)((0,u.getHeight)(t)/h,n.L)];if(1!=i)switch(l){case"geoserver":let c=90*i+.5|0;"FORMAT_OPTIONS"in a?a.FORMAT_OPTIONS+=";dpi:"+c:a.FORMAT_OPTIONS="dpi:"+c;break;case"mapserver":a.MAP_RESOLUTION=90*i;break;case"carmentaserver":case"qgis":a.DPI=90*i;break;default:throw Error("Unknown `serverType` configured")}return d(s,t,g,r,a)}function E(t,e){return Object.assign({REQUEST:e,SERVICE:"WMS",VERSION:g,FORMAT:"image/png",STYLES:"",TRANSPARENT:!0},t)}function R(t){let e=void 0===t.hidpi||t.hidpi,i=(0,l.get)(t.projection||"EPSG:3857"),n=t.ratio||1.5,r=t.load||a.Jx,s=t.crossOrigin??null;return(a,o,u)=>{a=(0,h.Ps)(a,o,u,n),1!=u&&(!e||void 0===t.serverType)&&(u=1);let l=_(a,o,u,i,t.url,E(t.params,"GetMap"),t.serverType),g=new Image;return g.crossOrigin=s,r(g,l).then(t=>({image:t,extent:a,pixelRatio:u}))}}function f(t,e,i){if(void 0===t.url)return;let r=(0,l.get)(t.projection||"EPSG:3857"),a=(0,u.getForViewAndSize)(e,i,0,c),h={QUERY_LAYERS:t.params.LAYERS,INFO_FORMAT:"application/json"};Object.assign(h,E(t.params,"GetFeatureInfo"),t.params);let g=(0,o.GW)((e[0]-a[0])/i,n.L),_=(0,o.GW)((a[3]-e[1])/i,n.L),R=(0,s.n)(h.VERSION,"1.3")>=0;return h[R?"I":"X"]=g,h[R?"J":"Y"]=_,d(t.url,a,c,r,h)}function m(t,e){if(void 0===t.url)return;let i={SERVICE:"WMS",VERSION:g,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(void 0!==e){let n=(0,l.get)(t.projection||"EPSG:3857").getMetersPerUnit()||1;i.SCALE=e*n/28e-5}if(Object.assign(i,t.params),void 0!==t.params&&void 0===i.LAYER){let t=i.LAYERS;if(!(!Array.isArray(t)||1!==t.length))return;i.LAYER=t}return(0,r.B5)(t.url,i)}},49179:function(t,e,i){function n(){throw Error("Unimplemented abstract method.")}i.r(e),i.d(e,{VERSION:function(){return a},abstract:function(){return n},getUid:function(){return s}});let r=0;function s(t){return t.ol_uid||(t.ol_uid=String(++r))}let a="10.3.1"}}]);
//# sourceMappingURL=6717.244d96ee61b507fc.js.map