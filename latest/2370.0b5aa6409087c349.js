"use strict";(self.webpackChunk_terrestris_shogun_gis_client=self.webpackChunk_terrestris_shogun_gis_client||[]).push([["2370"],{64289:function(e,t,r){r.r(t);var a=r(9948),l=r.n(a),n=r(20741),s=r(23560),i=r.n(s),o=r(49179),u=r(55405),g=r.n(u),c=r(42893),f=r(12038),y=r(54388),d=r(39660),p=r(35703);let h=`${p.M}layertree`;t.default=({className:e,layerGroup:t,nodeTitleRenderer:r,filterFunction:s,onLayerVisibilityChanged:u,checkable:p=!0,draggable:k=!0,...L})=>{let[b,C]=(0,a.useState)([]),[Z,v]=(0,a.useState)([]),m=(0,d.Z)(),A=(0,a.useCallback)(()=>{if(!m)return[];let e=(t?y.Z.getAllLayers(t):y.Z.getAllLayers(m)).filter(e=>!(e instanceof g())&&e.getVisible());return s&&(e=e.filter(s)),e.map(o.getUid)},[s,t,m]),_=(0,a.useCallback)(e=>i()(r)?r(e):e.get("name"),[r]),E=(0,a.useCallback)(e=>{let t;if(m&&(!s||0!==[e].filter(s).length)){if(e instanceof g()){let r=e.getLayers().getArray();s&&(r=r.filter(s)),t=r.map(e=>E(e)).filter(e=>void 0!==e).toReversed()}return{key:(0,o.getUid)(e),title:l().createElement("div",{draggable:!0,onClick:e=>e.stopPropagation()},_(e)),className:y.Z.layerInResolutionRange(e,m)?"":"out-of-range",children:t}}},[m,_,s]),B=(0,a.useCallback)(()=>m?(t||m.getLayerGroup()).getLayers().getArray().map(e=>E(e)).filter(e=>void 0!==e).toReversed():[],[t,m,E]),I=(0,a.useCallback)(()=>{v(B())},[B]),P=(0,a.useCallback)((e,t)=>{e instanceof g()?e.getLayers().forEach(e=>{P(e,t)}):e.setVisible(t)},[]),U=(0,a.useCallback)(()=>{C(A())},[A]),w=(0,a.useCallback)(()=>{v(B()),U()},[U,B]);(0,a.useEffect)(()=>{w()},[w]);let N=(0,a.useCallback)(e=>{if(s&&0===[e].filter(s).length)return[];let t=[];if(t.push(e.on("propertychange",w)),e instanceof g()){let r=e.getLayers();for(let a of(t.push(r.on("add",w)),t.push(r.on("remove",w)),t.push(e.on("change:layers",w)),r.getArray()))t.push(...N(a))}else t.push(e.on("change:visible",U));return t},[s,w,U]),R=(0,a.useCallback)(()=>m?N(t||m.getLayerGroup()):[],[t,m,N]);(0,a.useEffect)(()=>{let e=R();return()=>{(0,c.unByKey)(e)}},[Z,R]),(0,a.useEffect)(()=>{if(!m)return;let e=m.getView().on("change:resolution",I);return()=>{(0,c.unByKey)(e)}},[m,I]);let D=(0,a.useCallback)((e,t)=>{if(!m)return;let r=t.node.key,a=t.checked;if(!r)return;let l=y.Z.getLayerByOlUid(m,r);if(!l)return void f.Z.error("Layer is not defined");P(l,a),i()(u)&&u(l,a)},[m,P,u]),K=(0,a.useCallback)(e=>{let t=e.node.key,r=e.dragNode.key,a=e.node.pos.split("-"),l=e.dropPosition,n=l-parseInt(a[a.length-1],10);if(!m)return;let s=y.Z.getLayerByOlUid(m,r);if(!s)return void f.Z.error("dragLayer is not defined");let i=y.Z.getLayerByOlUid(m,t);if(!i)return void f.Z.error("dropLayer is not defined");let o=y.Z.getLayerPositionInfo(s,m);if(!o||!o?.groupLayer)return;let u=y.Z.getLayerPositionInfo(i,m);if(!u||!u?.groupLayer)return;let c=o.groupLayer.getLayers(),d=u.groupLayer.getLayers();c.remove(s);let p=d.getArray().findIndex(e=>e===i);-1===n?l===d.getLength()-1?d.push(s):d.insertAt(p+1,s):0===n?i instanceof g()&&i.getLayers().push(s):1===n&&d.insertAt(p,s)},[m]),O=(0,a.useCallback)(e=>{let t=e.dropNode;return!(0===e.dropPosition&&!t.children)},[]),V=e?`${e} ${h}`:h;return l().createElement(n.Z,{className:V,checkedKeys:b,onCheck:D,onDrop:K,allowDrop:O,selectable:!1,checkable:p,draggable:k,treeData:Z,...L})}},35703:function(e,t,r){r.d(t,{M:function(){return a}});let a="react-geo-"}}]);
//# sourceMappingURL=2370.0b5aa6409087c349.js.map