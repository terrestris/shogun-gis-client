{"version":3,"file":"2852.44fc9785f1b71c2f.js","sources":["webpack://@terrestris/shogun-gis-client/./node_modules/@terrestris/react-geo/dist/Button/DrawButton/DrawButton.js","webpack://@terrestris/shogun-gis-client/./node_modules/@terrestris/react-util/dist/Hooks/useDraw/useDraw.js"],"sourcesContent":["import * as React from 'react';\nimport { useCallback, useState } from 'react';\nimport { useDraw } from '@terrestris/react-util/dist/Hooks/useDraw/useDraw';\nimport useMap from '@terrestris/react-util/dist/Hooks/useMap/useMap';\nimport { usePropOrDefault } from '@terrestris/react-util/dist/Hooks/usePropOrDefault/usePropOrDefault';\nimport { DigitizeUtil } from '@terrestris/react-util/dist/Util/DigitizeUtil';\nimport { CSS_PREFIX } from '../../constants';\nimport { FeatureLabelModal } from '../../FeatureLabelModal/FeatureLabelModal';\nimport ToggleButton from '../ToggleButton/ToggleButton';\n/**\n * The className added to this component.\n */\nconst defaultClassName = `${CSS_PREFIX}drawbutton`;\n/**\n * The DrawButton.\n */\nconst DrawButton = ({ className, digitizeLayer, drawInteractionConfig, drawStyle, drawType, maxLabelLineLength, modalPromptCancelButtonText = 'Cancel', modalPromptOkButtonText = 'Ok', modalPromptTitle = 'Label', onDrawEnd, onDrawStart, onModalLabelCancel, onModalLabelOk, pressed, ...passThroughProps }) => {\n    const map = useMap();\n    const layer = usePropOrDefault(digitizeLayer, () => map ? DigitizeUtil.getDigitizeLayer(map) : undefined, [map]);\n    /**\n     * Currently drawn feature which should be represented as label or post-it.\n     */\n    const [digitizeTextFeature, setDigitizeTextFeature] = useState(null);\n    const onDrawEndInternal = useCallback((evt) => {\n        if (drawType === 'Text') {\n            evt.feature.set('isLabel', true);\n            setDigitizeTextFeature(evt.feature);\n        }\n        onDrawEnd?.(evt);\n    }, [drawType, onDrawEnd]);\n    useDraw({\n        onDrawEnd: onDrawEndInternal,\n        digitizeLayer: layer,\n        drawInteractionConfig,\n        drawStyle,\n        drawType: drawType === 'Text' ? 'Point' : drawType,\n        onDrawStart,\n        active: !!pressed\n    });\n    const finalClassName = className\n        ? `${defaultClassName} ${className}`\n        : defaultClassName;\n    const btnWrapperClass = `${CSS_PREFIX}digitize-button-wrapper`;\n    let modal = null;\n    if (digitizeTextFeature) {\n        const onModalLabelOkInternal = () => {\n            onModalLabelOk?.(digitizeTextFeature);\n            setDigitizeTextFeature(null);\n        };\n        const onModalLabelCancelInternal = () => {\n            layer?.getSource()?.removeFeature(digitizeTextFeature);\n            setDigitizeTextFeature(null);\n            onModalLabelCancel?.();\n            digitizeLayer?.getSource()?.removeFeature(digitizeTextFeature);\n            setDigitizeTextFeature(null);\n        };\n        modal = (React.createElement(FeatureLabelModal, { feature: digitizeTextFeature, onOk: onModalLabelOkInternal, onCancel: onModalLabelCancelInternal, title: modalPromptTitle, okText: modalPromptOkButtonText, cancelText: modalPromptCancelButtonText, maxLabelLineLength: maxLabelLineLength }));\n    }\n    return (React.createElement(\"span\", { className: btnWrapperClass },\n        React.createElement(ToggleButton, { className: finalClassName, pressed: pressed, ...passThroughProps }),\n        modal));\n};\nexport default DrawButton;\n//# sourceMappingURL=DrawButton.js.map","import * as OlEventConditions from 'ol/events/condition';\nimport OlInteractionDraw, { createBox } from 'ol/interaction/Draw';\nimport { DigitizeUtil } from '../../Util/DigitizeUtil';\nimport useMap from '../useMap/useMap';\nimport { useOlInteraction } from '../useOlInteraction/useOlInteraction';\nimport { useOlListener } from '../useOlListener/useOlListener';\nimport { usePropOrDefault } from '../usePropOrDefault/usePropOrDefault';\nexport const useDraw = ({ active, digitizeLayer, drawInteractionConfig, drawStyle, drawType, onDrawEnd, onDrawStart }) => {\n    const map = useMap();\n    const layer = usePropOrDefault(digitizeLayer, () => map ? DigitizeUtil.getDigitizeLayer(map) : undefined, [map]);\n    const drawInteraction = useOlInteraction(() => {\n        if (!map || !layer) {\n            return undefined;\n        }\n        let geometryFunction;\n        let type;\n        if (drawType === 'Rectangle') {\n            geometryFunction = createBox();\n            type = 'Circle';\n        }\n        else {\n            type = drawType;\n        }\n        const newInteraction = new OlInteractionDraw({\n            source: layer.getSource() || undefined,\n            type: type,\n            geometryFunction: geometryFunction,\n            style: drawStyle ?? DigitizeUtil.defaultDigitizeStyleFunction,\n            freehandCondition: OlEventConditions.never,\n            ...(drawInteractionConfig ?? {})\n        });\n        newInteraction.set('name', `react-util-draw-interaction-${drawType}`);\n        return newInteraction;\n    }, [map, layer, drawType, drawStyle, drawInteractionConfig], active);\n    useOlListener(drawInteraction, i => i.on('drawend', (evt) => {\n        onDrawEnd?.(evt);\n    }), [drawInteraction, onDrawEnd]);\n    useOlListener(drawInteraction, i => i.on('drawstart', (evt) => {\n        onDrawStart?.(evt);\n    }), [drawInteraction, onDrawStart]);\n};\nexport default useDraw;\n//# sourceMappingURL=useDraw.js.map"],"names":["m","t","e"],"mappings":"yUAYA,IAAM,EAAmB,CAAC,EAAE,GAAU,CAAC,UAAU,CAAC,CAkDlD,MA9CmB,CAAC,CAAE,WAAS,CAAE,eAAa,CAAE,uBAAqB,CAAE,WAAS,CAAE,UAAQ,CAAE,oBAAkB,CAAE,8BAA8B,QAAQ,CAAE,0BAA0B,IAAI,CAAE,mBAAmB,OAAO,CAAE,WAAS,CAAE,aAAW,CAAE,oBAAkB,CAAE,gBAAc,CAAE,SAAO,CAAE,GAAG,EAAkB,IAC1S,IAAM,EAAM,UACN,EAAQ,QAAiB,EAAe,IAAM,EAAM,oBAA6B,CAAC,GAAO,OAAW,CAAC,EAAI,EAIzG,CAAC,EAAqB,EAAuB,CAAG,eAAS,MAQ/D,ACvBmB,EAAC,CAAE,QAAM,CAAE,eAAa,CAAE,uBAAqB,CAAE,WAAS,CAAE,UAAQ,CAAE,WAAS,CAAE,aAAW,CAAE,IACjH,IAAMA,EAAM,UACN,EAAQ,QAAiB,EAAe,IAAMA,EAAM,oBAA6B,CAACA,GAAO,OAAW,CAACA,EAAI,EACzG,EAAkB,QAAiB,SAIjC,EACAC,EAJJ,GAAI,CAACD,GAAO,CAAC,EACT,MAIA,AAAa,eAAb,GACA,EAAmB,kBACnBC,EAAO,UAGPA,EAAO,EAEX,IAAM,EAAiB,GAAI,MAAkB,CACzC,OAAQ,EAAM,SAAS,IAAM,OAC7B,KAAMA,EACN,iBAAkB,EAClB,MAAO,GAAa,gCAAyC,CAC7D,kBAAmB,OAAuB,CAC1C,GAAI,GAAyB,CAAC,CAAC,AACnC,GAEA,OADA,EAAe,GAAG,CAAC,OAAQ,CAAC,4BAA4B,EAAE,EAAS,CAAC,EAC7D,CACX,EAAG,CAACD,EAAK,EAAO,EAAU,EAAW,EAAsB,CAAE,GAC7D,QAAc,EAAiB,GAAK,EAAE,EAAE,CAAC,UAAW,AAACE,IACjD,IAAYA,EAChB,GAAI,CAAC,EAAiB,EAAU,EAChC,QAAc,EAAiB,GAAK,EAAE,EAAE,CAAC,YAAa,AAACA,IACnD,IAAcA,EAClB,GAAI,CAAC,EAAiB,EAAY,CACtC,GDVY,CACJ,UARsB,kBAAY,AAACA,IAClB,SAAb,IACAA,EAAI,OAAO,CAAC,GAAG,CAAC,UAAW,IAC3B,EAAuBA,EAAI,OAAO,GAEtC,IAAYA,EAChB,EAAG,CAAC,EAAU,EAAU,EAGpB,cAAe,EACf,wBACA,YACA,SAAU,AAAa,SAAb,EAAsB,QAAU,EAC1C,cACA,OAAQ,CAAC,CAAC,CACd,GACA,IAAM,EAAiB,EACjB,CAAC,EAAE,EAAiB,CAAC,EAAE,EAAU,CAAC,CAClC,EACA,EAAkB,CAAC,EAAE,GAAU,CAAC,uBAAuB,CAAC,CAC1D,EAAQ,KAeZ,OAdI,GAYA,GAAS,eAAmB,CAAC,GAAiB,CAAE,CAAE,QAAS,EAAqB,KAXjD,KAC3B,IAAiB,GACjB,EAAuB,KAC3B,EAQ8G,SAP3E,KAC/B,GAAO,aAAa,cAAc,GAClC,EAAuB,MACvB,MACA,GAAe,aAAa,cAAc,GAC1C,EAAuB,KAC3B,EACoJ,MAAO,EAAkB,OAAQ,EAAyB,WAAY,EAA6B,mBAAoB,CAAmB,EAAE,EAE5R,eAAmB,CAAC,OAAQ,CAAE,UAAW,CAAgB,EAC7D,eAAmB,CAAC,GAAY,CAAE,CAAE,UAAW,EAAgB,QAAS,EAAS,GAAG,CAAgB,AAAC,GACrG,EACR,C"}