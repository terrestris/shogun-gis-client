{"version":3,"file":"9485.454df6efca72f372.js","sources":["webpack://@terrestris/shogun-gis-client/./node_modules/ol/Disposable.js","webpack://@terrestris/shogun-gis-client/./node_modules/ol/array.js","webpack://@terrestris/shogun-gis-client/./node_modules/ol/events/Event.js","webpack://@terrestris/shogun-gis-client/./node_modules/ol/events/EventType.js","webpack://@terrestris/shogun-gis-client/./node_modules/ol/events/Target.js","webpack://@terrestris/shogun-gis-client/./node_modules/ol/functions.js","webpack://@terrestris/shogun-gis-client/./node_modules/ol/obj.js","webpack://@terrestris/shogun-gis-client/./node_modules/ol/resolution.js","webpack://@terrestris/shogun-gis-client/./node_modules/ol/reproj/Image.js","webpack://@terrestris/shogun-gis-client/./node_modules/ol/source/Image.js","webpack://@terrestris/shogun-gis-client/./node_modules/ol/source/common.js","webpack://@terrestris/shogun-gis-client/./node_modules/ol/source/wms.js","webpack://@terrestris/shogun-gis-client/./node_modules/ol/util.js"],"sourcesContent":["/**\n * @module ol/Disposable\n */\n\n/**\n * @classdesc\n * Objects that need to clean up after themselves.\n */\nclass Disposable {\n  constructor() {\n    /**\n     * The object has already been disposed.\n     * @type {boolean}\n     * @protected\n     */\n    this.disposed = false;\n  }\n\n  /**\n   * Clean up.\n   */\n  dispose() {\n    if (!this.disposed) {\n      this.disposed = true;\n      this.disposeInternal();\n    }\n  }\n\n  /**\n   * Extension point for disposable objects.\n   * @protected\n   */\n  disposeInternal() {}\n}\n\nexport default Disposable;\n","/**\n * @module ol/array\n */\n\n/**\n * Performs a binary search on the provided sorted list and returns the index of the item if found. If it can't be found it'll return -1.\n * https://github.com/darkskyapp/binary-search\n *\n * @param {Array<*>} haystack Items to search through.\n * @param {*} needle The item to look for.\n * @param {Function} [comparator] Comparator function.\n * @return {number} The index of the item if found, -1 if not.\n */\nexport function binarySearch(haystack, needle, comparator) {\n  let mid, cmp;\n  comparator = comparator || ascending;\n  let low = 0;\n  let high = haystack.length;\n  let found = false;\n\n  while (low < high) {\n    /* Note that \"(low + high) >>> 1\" may overflow, and results in a typecast\n     * to double (which gives the wrong results). */\n    mid = low + ((high - low) >> 1);\n    cmp = +comparator(haystack[mid], needle);\n\n    if (cmp < 0.0) {\n      /* Too low. */\n      low = mid + 1;\n    } else {\n      /* Key found or too high */\n      high = mid;\n      found = !cmp;\n    }\n  }\n\n  /* Key not found. */\n  return found ? low : ~low;\n}\n\n/**\n * Compare function sorting arrays in ascending order.  Safe to use for numeric values.\n * @param {*} a The first object to be compared.\n * @param {*} b The second object to be compared.\n * @return {number} A negative number, zero, or a positive number as the first\n *     argument is less than, equal to, or greater than the second.\n */\nexport function ascending(a, b) {\n  return a > b ? 1 : a < b ? -1 : 0;\n}\n\n/**\n * Compare function sorting arrays in descending order.  Safe to use for numeric values.\n * @param {*} a The first object to be compared.\n * @param {*} b The second object to be compared.\n * @return {number} A negative number, zero, or a positive number as the first\n *     argument is greater than, equal to, or less than the second.\n */\nexport function descending(a, b) {\n  return a < b ? 1 : a > b ? -1 : 0;\n}\n\n/**\n * {@link module:ol/tilegrid/TileGrid~TileGrid#getZForResolution} can use a function\n * of this type to determine which nearest resolution to use.\n *\n * This function takes a `{number}` representing a value between two array entries,\n * a `{number}` representing the value of the nearest higher entry and\n * a `{number}` representing the value of the nearest lower entry\n * as arguments and returns a `{number}`. If a negative number or zero is returned\n * the lower value will be used, if a positive number is returned the higher value\n * will be used.\n * @typedef {function(number, number, number): number} NearestDirectionFunction\n * @api\n */\n\n/**\n * @param {Array<number>} arr Array in descending order.\n * @param {number} target Target.\n * @param {number|NearestDirectionFunction} direction\n *    0 means return the nearest,\n *    > 0 means return the largest nearest,\n *    < 0 means return the smallest nearest.\n * @return {number} Index.\n */\nexport function linearFindNearest(arr, target, direction) {\n  if (arr[0] <= target) {\n    return 0;\n  }\n\n  const n = arr.length;\n  if (target <= arr[n - 1]) {\n    return n - 1;\n  }\n\n  if (typeof direction === 'function') {\n    for (let i = 1; i < n; ++i) {\n      const candidate = arr[i];\n      if (candidate === target) {\n        return i;\n      }\n      if (candidate < target) {\n        if (direction(target, arr[i - 1], candidate) > 0) {\n          return i - 1;\n        }\n        return i;\n      }\n    }\n    return n - 1;\n  }\n\n  if (direction > 0) {\n    for (let i = 1; i < n; ++i) {\n      if (arr[i] < target) {\n        return i - 1;\n      }\n    }\n    return n - 1;\n  }\n\n  if (direction < 0) {\n    for (let i = 1; i < n; ++i) {\n      if (arr[i] <= target) {\n        return i;\n      }\n    }\n    return n - 1;\n  }\n\n  for (let i = 1; i < n; ++i) {\n    if (arr[i] == target) {\n      return i;\n    }\n    if (arr[i] < target) {\n      if (arr[i - 1] - target < target - arr[i]) {\n        return i - 1;\n      }\n      return i;\n    }\n  }\n  return n - 1;\n}\n\n/**\n * @param {Array<*>} arr Array.\n * @param {number} begin Begin index.\n * @param {number} end End index.\n */\nexport function reverseSubArray(arr, begin, end) {\n  while (begin < end) {\n    const tmp = arr[begin];\n    arr[begin] = arr[end];\n    arr[end] = tmp;\n    ++begin;\n    --end;\n  }\n}\n\n/**\n * @param {Array<VALUE>} arr The array to modify.\n * @param {!Array<VALUE>|VALUE} data The elements or arrays of elements to add to arr.\n * @template VALUE\n */\nexport function extend(arr, data) {\n  const extension = Array.isArray(data) ? data : [data];\n  const length = extension.length;\n  for (let i = 0; i < length; i++) {\n    arr[arr.length] = extension[i];\n  }\n}\n\n/**\n * @param {Array<VALUE>} arr The array to modify.\n * @param {VALUE} obj The element to remove.\n * @template VALUE\n * @return {boolean} If the element was removed.\n */\nexport function remove(arr, obj) {\n  const i = arr.indexOf(obj);\n  const found = i > -1;\n  if (found) {\n    arr.splice(i, 1);\n  }\n  return found;\n}\n\n/**\n * @param {Array<any>|Uint8ClampedArray} arr1 The first array to compare.\n * @param {Array<any>|Uint8ClampedArray} arr2 The second array to compare.\n * @return {boolean} Whether the two arrays are equal.\n */\nexport function equals(arr1, arr2) {\n  const len1 = arr1.length;\n  if (len1 !== arr2.length) {\n    return false;\n  }\n  for (let i = 0; i < len1; i++) {\n    if (arr1[i] !== arr2[i]) {\n      return false;\n    }\n  }\n  return true;\n}\n\n/**\n * Sort the passed array such that the relative order of equal elements is preserved.\n * See https://en.wikipedia.org/wiki/Sorting_algorithm#Stability for details.\n * @param {Array<*>} arr The array to sort (modifies original).\n * @param {!function(*, *): number} compareFnc Comparison function.\n * @api\n */\nexport function stableSort(arr, compareFnc) {\n  const length = arr.length;\n  const tmp = Array(arr.length);\n  let i;\n  for (i = 0; i < length; i++) {\n    tmp[i] = {index: i, value: arr[i]};\n  }\n  tmp.sort(function (a, b) {\n    return compareFnc(a.value, b.value) || a.index - b.index;\n  });\n  for (i = 0; i < arr.length; i++) {\n    arr[i] = tmp[i].value;\n  }\n}\n\n/**\n * @param {Array<*>} arr The array to test.\n * @param {Function} [func] Comparison function.\n * @param {boolean} [strict] Strictly sorted (default false).\n * @return {boolean} Return index.\n */\nexport function isSorted(arr, func, strict) {\n  const compare = func || ascending;\n  return arr.every(function (currentVal, index) {\n    if (index === 0) {\n      return true;\n    }\n    const res = compare(arr[index - 1], currentVal);\n    return !(res > 0 || (strict && res === 0));\n  });\n}\n","/**\n * @module ol/events/Event\n */\n\n/**\n * @classdesc\n * Stripped down implementation of the W3C DOM Level 2 Event interface.\n * See https://www.w3.org/TR/DOM-Level-2-Events/events.html#Events-interface.\n *\n * This implementation only provides `type` and `target` properties, and\n * `stopPropagation` and `preventDefault` methods. It is meant as base class\n * for higher level events defined in the library, and works with\n * {@link module:ol/events/Target~Target}.\n */\nclass BaseEvent {\n  /**\n   * @param {string} type Type.\n   */\n  constructor(type) {\n    /**\n     * @type {boolean}\n     */\n    this.propagationStopped;\n\n    /**\n     * @type {boolean}\n     */\n    this.defaultPrevented;\n\n    /**\n     * The event type.\n     * @type {string}\n     * @api\n     */\n    this.type = type;\n\n    /**\n     * The event target.\n     * @type {Object}\n     * @api\n     */\n    this.target = null;\n  }\n\n  /**\n   * Prevent default. This means that no emulated `click`, `singleclick` or `doubleclick` events\n   * will be fired.\n   * @api\n   */\n  preventDefault() {\n    this.defaultPrevented = true;\n  }\n\n  /**\n   * Stop event propagation.\n   * @api\n   */\n  stopPropagation() {\n    this.propagationStopped = true;\n  }\n}\n\n/**\n * @param {Event|import(\"./Event.js\").default} evt Event\n */\nexport function stopPropagation(evt) {\n  evt.stopPropagation();\n}\n\n/**\n * @param {Event|import(\"./Event.js\").default} evt Event\n */\nexport function preventDefault(evt) {\n  evt.preventDefault();\n}\n\nexport default BaseEvent;\n","/**\n * @module ol/events/EventType\n */\n\n/**\n * @enum {string}\n * @const\n */\nexport default {\n  /**\n   * Generic change event. Triggered when the revision counter is increased.\n   * @event module:ol/events/Event~BaseEvent#change\n   * @api\n   */\n  CHANGE: 'change',\n\n  /**\n   * Generic error event. Triggered when an error occurs.\n   * @event module:ol/events/Event~BaseEvent#error\n   * @api\n   */\n  ERROR: 'error',\n\n  BLUR: 'blur',\n  CLEAR: 'clear',\n  CONTEXTMENU: 'contextmenu',\n  CLICK: 'click',\n  DBLCLICK: 'dblclick',\n  DRAGENTER: 'dragenter',\n  DRAGOVER: 'dragover',\n  DROP: 'drop',\n  FOCUS: 'focus',\n  KEYDOWN: 'keydown',\n  KEYPRESS: 'keypress',\n  LOAD: 'load',\n  RESIZE: 'resize',\n  TOUCHMOVE: 'touchmove',\n  WHEEL: 'wheel',\n};\n","/**\n * @module ol/events/Target\n */\nimport Disposable from '../Disposable.js';\nimport {VOID} from '../functions.js';\nimport {clear} from '../obj.js';\nimport Event from './Event.js';\n\n/**\n * @typedef {EventTarget|Target} EventTargetLike\n */\n\n/**\n * @classdesc\n * A simplified implementation of the W3C DOM Level 2 EventTarget interface.\n * See https://www.w3.org/TR/2000/REC-DOM-Level-2-Events-20001113/events.html#Events-EventTarget.\n *\n * There are two important simplifications compared to the specification:\n *\n * 1. The handling of `useCapture` in `addEventListener` and\n *    `removeEventListener`. There is no real capture model.\n * 2. The handling of `stopPropagation` and `preventDefault` on `dispatchEvent`.\n *    There is no event target hierarchy. When a listener calls\n *    `stopPropagation` or `preventDefault` on an event object, it means that no\n *    more listeners after this one will be called. Same as when the listener\n *    returns false.\n */\nclass Target extends Disposable {\n  /**\n   * @param {*} [target] Default event target for dispatched events.\n   */\n  constructor(target) {\n    super();\n\n    /**\n     * @private\n     * @type {*}\n     */\n    this.eventTarget_ = target;\n\n    /**\n     * @private\n     * @type {Object<string, number>|null}\n     */\n    this.pendingRemovals_ = null;\n\n    /**\n     * @private\n     * @type {Object<string, number>|null}\n     */\n    this.dispatching_ = null;\n\n    /**\n     * @private\n     * @type {Object<string, Array<import(\"../events.js\").Listener>>|null}\n     */\n    this.listeners_ = null;\n  }\n\n  /**\n   * @param {string} type Type.\n   * @param {import(\"../events.js\").Listener} listener Listener.\n   */\n  addEventListener(type, listener) {\n    if (!type || !listener) {\n      return;\n    }\n    const listeners = this.listeners_ || (this.listeners_ = {});\n    const listenersForType = listeners[type] || (listeners[type] = []);\n    if (!listenersForType.includes(listener)) {\n      listenersForType.push(listener);\n    }\n  }\n\n  /**\n   * Dispatches an event and calls all listeners listening for events\n   * of this type. The event parameter can either be a string or an\n   * Object with a `type` property.\n   *\n   * @param {import(\"./Event.js\").default|string} event Event object.\n   * @return {boolean|undefined} `false` if anyone called preventDefault on the\n   *     event object or if any of the listeners returned false.\n   * @api\n   */\n  dispatchEvent(event) {\n    const isString = typeof event === 'string';\n    const type = isString ? event : event.type;\n    const listeners = this.listeners_ && this.listeners_[type];\n    if (!listeners) {\n      return;\n    }\n\n    const evt = isString ? new Event(event) : /** @type {Event} */ (event);\n    if (!evt.target) {\n      evt.target = this.eventTarget_ || this;\n    }\n    const dispatching = this.dispatching_ || (this.dispatching_ = {});\n    const pendingRemovals =\n      this.pendingRemovals_ || (this.pendingRemovals_ = {});\n    if (!(type in dispatching)) {\n      dispatching[type] = 0;\n      pendingRemovals[type] = 0;\n    }\n    ++dispatching[type];\n    let propagate;\n    for (let i = 0, ii = listeners.length; i < ii; ++i) {\n      if ('handleEvent' in listeners[i]) {\n        propagate = /** @type {import(\"../events.js\").ListenerObject} */ (\n          listeners[i]\n        ).handleEvent(evt);\n      } else {\n        propagate = /** @type {import(\"../events.js\").ListenerFunction} */ (\n          listeners[i]\n        ).call(this, evt);\n      }\n      if (propagate === false || evt.propagationStopped) {\n        propagate = false;\n        break;\n      }\n    }\n    if (--dispatching[type] === 0) {\n      let pr = pendingRemovals[type];\n      delete pendingRemovals[type];\n      while (pr--) {\n        this.removeEventListener(type, VOID);\n      }\n      delete dispatching[type];\n    }\n    return propagate;\n  }\n\n  /**\n   * Clean up.\n   * @override\n   */\n  disposeInternal() {\n    this.listeners_ && clear(this.listeners_);\n  }\n\n  /**\n   * Get the listeners for a specified event type. Listeners are returned in the\n   * order that they will be called in.\n   *\n   * @param {string} type Type.\n   * @return {Array<import(\"../events.js\").Listener>|undefined} Listeners.\n   */\n  getListeners(type) {\n    return (this.listeners_ && this.listeners_[type]) || undefined;\n  }\n\n  /**\n   * @param {string} [type] Type. If not provided,\n   *     `true` will be returned if this event target has any listeners.\n   * @return {boolean} Has listeners.\n   */\n  hasListener(type) {\n    if (!this.listeners_) {\n      return false;\n    }\n    return type\n      ? type in this.listeners_\n      : Object.keys(this.listeners_).length > 0;\n  }\n\n  /**\n   * @param {string} type Type.\n   * @param {import(\"../events.js\").Listener} listener Listener.\n   */\n  removeEventListener(type, listener) {\n    if (!this.listeners_) {\n      return;\n    }\n    const listeners = this.listeners_[type];\n    if (!listeners) {\n      return;\n    }\n    const index = listeners.indexOf(listener);\n    if (index !== -1) {\n      if (this.pendingRemovals_ && type in this.pendingRemovals_) {\n        // make listener a no-op, and remove later in #dispatchEvent()\n        listeners[index] = VOID;\n        ++this.pendingRemovals_[type];\n      } else {\n        listeners.splice(index, 1);\n        if (listeners.length === 0) {\n          delete this.listeners_[type];\n        }\n      }\n    }\n  }\n}\n\nexport default Target;\n","/**\n * @module ol/functions\n */\n\nimport {equals as arrayEquals} from './array.js';\n\n/**\n * Always returns true.\n * @return {boolean} true.\n */\nexport function TRUE() {\n  return true;\n}\n\n/**\n * Always returns false.\n * @return {boolean} false.\n */\nexport function FALSE() {\n  return false;\n}\n\n/**\n * A reusable function, used e.g. as a default for callbacks.\n *\n * @return {void} Nothing.\n */\nexport function VOID() {}\n\n/**\n * Wrap a function in another function that remembers the last return.  If the\n * returned function is called twice in a row with the same arguments and the same\n * this object, it will return the value from the first call in the second call.\n *\n * @param {function(...any): ReturnType} fn The function to memoize.\n * @return {function(...any): ReturnType} The memoized function.\n * @template ReturnType\n */\nexport function memoizeOne(fn) {\n  /** @type {ReturnType} */\n  let lastResult;\n\n  /** @type {Array<any>|undefined} */\n  let lastArgs;\n\n  let lastThis;\n\n  /**\n   * @this {*} Only need to know if `this` changed, don't care what type\n   * @return {ReturnType} Memoized value\n   */\n  return function () {\n    const nextArgs = Array.prototype.slice.call(arguments);\n    if (!lastArgs || this !== lastThis || !arrayEquals(nextArgs, lastArgs)) {\n      lastThis = this;\n      lastArgs = nextArgs;\n      lastResult = fn.apply(this, arguments);\n    }\n    return lastResult;\n  };\n}\n\n/**\n * @template T\n * @param {function(): (T | Promise<T>)} getter A function that returns a value or a promise for a value.\n * @return {Promise<T>} A promise for the value.\n */\nexport function toPromise(getter) {\n  function promiseGetter() {\n    let value;\n    try {\n      value = getter();\n    } catch (err) {\n      return Promise.reject(err);\n    }\n    if (value instanceof Promise) {\n      return value;\n    }\n    return Promise.resolve(value);\n  }\n  return promiseGetter();\n}\n","/**\n * @module ol/obj\n */\n\n/**\n * Removes all properties from an object.\n * @param {Object<string, unknown>} object The object to clear.\n */\nexport function clear(object) {\n  for (const property in object) {\n    delete object[property];\n  }\n}\n\n/**\n * Determine if an object has any properties.\n * @param {Object} object The object to check.\n * @return {boolean} The object is empty.\n */\nexport function isEmpty(object) {\n  let property;\n  for (property in object) {\n    return false;\n  }\n  return !property;\n}\n","/**\n * @module ol/resolution\n */\n\n/**\n * @typedef {number|Array<number>} ResolutionLike\n */\n\n/**\n * @param {ResolutionLike} resolution Resolution.\n * @return {number} Resolution.\n */\nexport function fromResolutionLike(resolution) {\n  if (Array.isArray(resolution)) {\n    return Math.min(...resolution);\n  }\n  return resolution;\n}\n","/**\n * @module ol/reproj/Image\n */\n\nimport ImageWrapper from '../Image.js';\nimport ImageState from '../ImageState.js';\nimport EventType from '../events/EventType.js';\nimport {listen, unlistenByKey} from '../events.js';\nimport {\n  getCenter,\n  getHeight,\n  getIntersection,\n  getWidth,\n  isEmpty,\n} from '../extent.js';\nimport {\n  calculateSourceResolution,\n  render as renderReprojected,\n} from '../reproj.js';\nimport {fromResolutionLike} from '../resolution.js';\nimport Triangulation from './Triangulation.js';\nimport {ERROR_THRESHOLD} from './common.js';\n\n/**\n * @typedef {function(import(\"../extent.js\").Extent, number, number) : import(\"../Image.js\").default} FunctionType\n */\n\n/**\n * @classdesc\n * Class encapsulating single reprojected image.\n * See {@link module:ol/source/Image~ImageSource}.\n */\nclass ReprojImage extends ImageWrapper {\n  /**\n   * @param {import(\"../proj/Projection.js\").default} sourceProj Source projection (of the data).\n   * @param {import(\"../proj/Projection.js\").default} targetProj Target projection.\n   * @param {import(\"../extent.js\").Extent} targetExtent Target extent.\n   * @param {number} targetResolution Target resolution.\n   * @param {number} pixelRatio Pixel ratio.\n   * @param {FunctionType} getImageFunction\n   *     Function returning source images (extent, resolution, pixelRatio).\n   * @param {boolean} interpolate Use linear interpolation when resampling.\n   */\n  constructor(\n    sourceProj,\n    targetProj,\n    targetExtent,\n    targetResolution,\n    pixelRatio,\n    getImageFunction,\n    interpolate,\n  ) {\n    let maxSourceExtent = sourceProj.getExtent();\n    if (maxSourceExtent && sourceProj.canWrapX()) {\n      maxSourceExtent = maxSourceExtent.slice();\n      maxSourceExtent[0] = -Infinity;\n      maxSourceExtent[2] = Infinity;\n    }\n    let maxTargetExtent = targetProj.getExtent();\n    if (maxTargetExtent && targetProj.canWrapX()) {\n      maxTargetExtent = maxTargetExtent.slice();\n      maxTargetExtent[0] = -Infinity;\n      maxTargetExtent[2] = Infinity;\n    }\n\n    const limitedTargetExtent = maxTargetExtent\n      ? getIntersection(targetExtent, maxTargetExtent)\n      : targetExtent;\n\n    const targetCenter = getCenter(limitedTargetExtent);\n    const sourceResolution = calculateSourceResolution(\n      sourceProj,\n      targetProj,\n      targetCenter,\n      targetResolution,\n    );\n\n    const errorThresholdInPixels = ERROR_THRESHOLD;\n\n    const triangulation = new Triangulation(\n      sourceProj,\n      targetProj,\n      limitedTargetExtent,\n      maxSourceExtent,\n      sourceResolution * errorThresholdInPixels,\n      targetResolution,\n    );\n\n    const sourceExtent = triangulation.calculateSourceExtent();\n    const sourceImage = isEmpty(sourceExtent)\n      ? null\n      : getImageFunction(sourceExtent, sourceResolution, pixelRatio);\n    const state = sourceImage ? ImageState.IDLE : ImageState.EMPTY;\n    const sourcePixelRatio = sourceImage ? sourceImage.getPixelRatio() : 1;\n\n    super(targetExtent, targetResolution, sourcePixelRatio, state);\n\n    /**\n     * @private\n     * @type {import(\"../proj/Projection.js\").default}\n     */\n    this.targetProj_ = targetProj;\n\n    /**\n     * @private\n     * @type {import(\"../extent.js\").Extent}\n     */\n    this.maxSourceExtent_ = maxSourceExtent;\n\n    /**\n     * @private\n     * @type {!import(\"./Triangulation.js\").default}\n     */\n    this.triangulation_ = triangulation;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.targetResolution_ = targetResolution;\n\n    /**\n     * @private\n     * @type {import(\"../extent.js\").Extent}\n     */\n    this.targetExtent_ = targetExtent;\n\n    /**\n     * @private\n     * @type {import(\"../Image.js\").default}\n     */\n    this.sourceImage_ = sourceImage;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.sourcePixelRatio_ = sourcePixelRatio;\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.interpolate_ = interpolate;\n\n    /**\n     * @private\n     * @type {HTMLCanvasElement}\n     */\n    this.canvas_ = null;\n\n    /**\n     * @private\n     * @type {?import(\"../events.js\").EventsKey}\n     */\n    this.sourceListenerKey_ = null;\n  }\n\n  /**\n   * Clean up.\n   * @override\n   */\n  disposeInternal() {\n    if (this.state == ImageState.LOADING) {\n      this.unlistenSource_();\n    }\n    super.disposeInternal();\n  }\n\n  /**\n   * @return {HTMLCanvasElement} Image.\n   * @override\n   */\n  getImage() {\n    return this.canvas_;\n  }\n\n  /**\n   * @return {import(\"../proj/Projection.js\").default} Projection.\n   */\n  getProjection() {\n    return this.targetProj_;\n  }\n\n  /**\n   * @private\n   */\n  reproject_() {\n    const sourceState = this.sourceImage_.getState();\n    if (sourceState == ImageState.LOADED) {\n      const width = getWidth(this.targetExtent_) / this.targetResolution_;\n      const height = getHeight(this.targetExtent_) / this.targetResolution_;\n      this.canvas_ = renderReprojected(\n        width,\n        height,\n        this.sourcePixelRatio_,\n        fromResolutionLike(this.sourceImage_.getResolution()),\n        this.maxSourceExtent_,\n        this.targetResolution_,\n        this.targetExtent_,\n        this.triangulation_,\n        [\n          {\n            extent: this.sourceImage_.getExtent(),\n            image: this.sourceImage_.getImage(),\n          },\n        ],\n        0,\n        undefined,\n        this.interpolate_,\n        true,\n      );\n    }\n    this.state = sourceState;\n    this.changed();\n  }\n\n  /**\n   * Load not yet loaded URI.\n   * @override\n   */\n  load() {\n    if (this.state == ImageState.IDLE) {\n      this.state = ImageState.LOADING;\n      this.changed();\n\n      const sourceState = this.sourceImage_.getState();\n      if (sourceState == ImageState.LOADED || sourceState == ImageState.ERROR) {\n        this.reproject_();\n      } else {\n        this.sourceListenerKey_ = listen(\n          this.sourceImage_,\n          EventType.CHANGE,\n          (e) => {\n            const sourceState = this.sourceImage_.getState();\n            if (\n              sourceState == ImageState.LOADED ||\n              sourceState == ImageState.ERROR\n            ) {\n              this.unlistenSource_();\n              this.reproject_();\n            }\n          },\n        );\n        this.sourceImage_.load();\n      }\n    }\n  }\n\n  /**\n   * @private\n   */\n  unlistenSource_() {\n    unlistenByKey(\n      /** @type {!import(\"../events.js\").EventsKey} */ (\n        this.sourceListenerKey_\n      ),\n    );\n    this.sourceListenerKey_ = null;\n  }\n}\n\nexport default ReprojImage;\n","/**\n * @module ol/source/Image\n */\nimport ImageWrapper from '../Image.js';\nimport ImageState from '../ImageState.js';\nimport {linearFindNearest} from '../array.js';\nimport Event from '../events/Event.js';\nimport EventType from '../events/EventType.js';\nimport {\n  containsExtent,\n  equals,\n  getCenter,\n  getForViewAndSize,\n  getHeight,\n  getWidth,\n} from '../extent.js';\nimport {ceil} from '../math.js';\nimport {equivalent} from '../proj.js';\nimport ReprojImage from '../reproj/Image.js';\nimport {fromResolutionLike} from '../resolution.js';\nimport Source from './Source.js';\nimport {DECIMALS} from './common.js';\n\n/**\n * @enum {string}\n */\nexport const ImageSourceEventType = {\n  /**\n   * Triggered when an image starts loading.\n   * @event module:ol/source/Image.ImageSourceEvent#imageloadstart\n   * @api\n   */\n  IMAGELOADSTART: 'imageloadstart',\n\n  /**\n   * Triggered when an image finishes loading.\n   * @event module:ol/source/Image.ImageSourceEvent#imageloadend\n   * @api\n   */\n  IMAGELOADEND: 'imageloadend',\n\n  /**\n   * Triggered if image loading results in an error.\n   * @event module:ol/source/Image.ImageSourceEvent#imageloaderror\n   * @api\n   */\n  IMAGELOADERROR: 'imageloaderror',\n};\n\n/**\n * @typedef {'imageloadend'|'imageloaderror'|'imageloadstart'} ImageSourceEventTypes\n */\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/source/Image~ImageSource} instances are instances of this\n * type.\n */\nexport class ImageSourceEvent extends Event {\n  /**\n   * @param {string} type Type.\n   * @param {import(\"../Image.js\").default} image The image.\n   */\n  constructor(type, image) {\n    super(type);\n\n    /**\n     * The image related to the event.\n     * @type {import(\"../Image.js\").default}\n     * @api\n     */\n    this.image = image;\n  }\n}\n\n/***\n * @template Return\n * @typedef {import(\"../Observable\").OnSignature<import(\"../Observable\").EventTypes, import(\"../events/Event.js\").default, Return> &\n *   import(\"../Observable\").OnSignature<import(\"../ObjectEventType\").Types, import(\"../Object\").ObjectEvent, Return> &\n *   import(\"../Observable\").OnSignature<ImageSourceEventTypes, ImageSourceEvent, Return> &\n *   import(\"../Observable\").CombinedOnSignature<import(\"../Observable\").EventTypes|import(\"../ObjectEventType\").Types\n *     |ImageSourceEventTypes, Return>} ImageSourceOnSignature\n */\n\n/**\n * @typedef {Object} Options\n * @property {import(\"./Source.js\").AttributionLike} [attributions] Attributions.\n * @property {boolean} [interpolate=true] Use interpolated values when resampling.  By default,\n * linear interpolation is used when resampling.  Set to false to use the nearest neighbor instead.\n * @property {import(\"../Image.js\").Loader} [loader] Loader. Can either be a custom loader, or one of the\n * loaders created with a `createLoader()` function ({@link module:ol/source/wms.createLoader wms},\n * {@link module:ol/source/arcgisRest.createLoader arcgisRest}, {@link module:ol/source/mapguide.createLoader mapguide},\n * {@link module:ol/source/static.createLoader static}).\n * @property {import(\"../proj.js\").ProjectionLike} [projection] Projection.\n * @property {Array<number>} [resolutions] Resolutions.\n * @property {import(\"./Source.js\").State} [state] State.\n */\n\n/**\n * @classdesc\n * Base class for sources providing a single image.\n * @fires module:ol/source/Image.ImageSourceEvent\n * @api\n */\nclass ImageSource extends Source {\n  /**\n   * @param {Options} options Single image source options.\n   */\n  constructor(options) {\n    super({\n      attributions: options.attributions,\n      projection: options.projection,\n      state: options.state,\n      interpolate:\n        options.interpolate !== undefined ? options.interpolate : true,\n    });\n\n    /***\n     * @type {ImageSourceOnSignature<import(\"../events\").EventsKey>}\n     */\n    this.on;\n\n    /***\n     * @type {ImageSourceOnSignature<import(\"../events\").EventsKey>}\n     */\n    this.once;\n\n    /***\n     * @type {ImageSourceOnSignature<void>}\n     */\n    this.un;\n\n    /**\n     * @protected\n     * @type {import(\"../Image.js\").Loader}\n     */\n    this.loader = options.loader || null;\n\n    /**\n     * @private\n     * @type {Array<number>|null}\n     */\n    this.resolutions_ =\n      options.resolutions !== undefined ? options.resolutions : null;\n\n    /**\n     * @private\n     * @type {import(\"../reproj/Image.js\").default}\n     */\n    this.reprojectedImage_ = null;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.reprojectedRevision_ = 0;\n\n    /**\n     * @protected\n     * @type {import(\"../Image.js\").default}\n     */\n    this.image = null;\n\n    /**\n     * @private\n     * @type {import(\"../extent.js\").Extent}\n     */\n    this.wantedExtent_;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.wantedResolution_;\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.static_ = options.loader ? options.loader.length === 0 : false;\n\n    /**\n     * @private\n     * @type {import(\"../proj/Projection.js\").default}\n     */\n    this.wantedProjection_ = null;\n  }\n\n  /**\n   * @return {Array<number>|null} Resolutions.\n   * @override\n   */\n  getResolutions() {\n    return this.resolutions_;\n  }\n\n  /**\n   * @param {Array<number>|null} resolutions Resolutions.\n   */\n  setResolutions(resolutions) {\n    this.resolutions_ = resolutions;\n  }\n\n  /**\n   * @protected\n   * @param {number} resolution Resolution.\n   * @return {number} Resolution.\n   */\n  findNearestResolution(resolution) {\n    const resolutions = this.getResolutions();\n    if (resolutions) {\n      const idx = linearFindNearest(resolutions, resolution, 0);\n      resolution = resolutions[idx];\n    }\n    return resolution;\n  }\n\n  /**\n   * @param {import(\"../extent.js\").Extent} extent Extent.\n   * @param {number} resolution Resolution.\n   * @param {number} pixelRatio Pixel ratio.\n   * @param {import(\"../proj/Projection.js\").default} projection Projection.\n   * @return {import(\"../Image.js\").default} Single image.\n   */\n  getImage(extent, resolution, pixelRatio, projection) {\n    const sourceProjection = this.getProjection();\n    if (\n      !sourceProjection ||\n      !projection ||\n      equivalent(sourceProjection, projection)\n    ) {\n      if (sourceProjection) {\n        projection = sourceProjection;\n      }\n\n      return this.getImageInternal(extent, resolution, pixelRatio, projection);\n    }\n    if (this.reprojectedImage_) {\n      if (\n        this.reprojectedRevision_ == this.getRevision() &&\n        equivalent(this.reprojectedImage_.getProjection(), projection) &&\n        this.reprojectedImage_.getResolution() == resolution &&\n        equals(this.reprojectedImage_.getExtent(), extent)\n      ) {\n        return this.reprojectedImage_;\n      }\n      this.reprojectedImage_.dispose();\n      this.reprojectedImage_ = null;\n    }\n\n    this.reprojectedImage_ = new ReprojImage(\n      sourceProjection,\n      projection,\n      extent,\n      resolution,\n      pixelRatio,\n      (extent, resolution, pixelRatio) =>\n        this.getImageInternal(extent, resolution, pixelRatio, sourceProjection),\n      this.getInterpolate(),\n    );\n    this.reprojectedRevision_ = this.getRevision();\n\n    return this.reprojectedImage_;\n  }\n\n  /**\n   * @abstract\n   * @param {import(\"../extent.js\").Extent} extent Extent.\n   * @param {number} resolution Resolution.\n   * @param {number} pixelRatio Pixel ratio.\n   * @param {import(\"../proj/Projection.js\").default} projection Projection.\n   * @return {import(\"../Image.js\").default} Single image.\n   * @protected\n   */\n  getImageInternal(extent, resolution, pixelRatio, projection) {\n    if (this.loader) {\n      const requestExtent = getRequestExtent(extent, resolution, pixelRatio, 1);\n      const requestResolution = this.findNearestResolution(resolution);\n      if (\n        this.image &&\n        (this.static_ ||\n          (this.wantedProjection_ === projection &&\n            ((this.wantedExtent_ &&\n              containsExtent(this.wantedExtent_, requestExtent)) ||\n              containsExtent(this.image.getExtent(), requestExtent)) &&\n            ((this.wantedResolution_ &&\n              fromResolutionLike(this.wantedResolution_) ===\n                requestResolution) ||\n              fromResolutionLike(this.image.getResolution()) ===\n                requestResolution)))\n      ) {\n        return this.image;\n      }\n      this.wantedProjection_ = projection;\n      this.wantedExtent_ = requestExtent;\n      this.wantedResolution_ = requestResolution;\n      this.image = new ImageWrapper(\n        requestExtent,\n        requestResolution,\n        pixelRatio,\n        this.loader,\n      );\n      this.image.addEventListener(\n        EventType.CHANGE,\n        this.handleImageChange.bind(this),\n      );\n    }\n    return this.image;\n  }\n\n  /**\n   * Handle image change events.\n   * @param {import(\"../events/Event.js\").default} event Event.\n   * @protected\n   */\n  handleImageChange(event) {\n    const image = /** @type {import(\"../Image.js\").default} */ (event.target);\n    let type;\n    switch (image.getState()) {\n      case ImageState.LOADING:\n        this.loading = true;\n        type = ImageSourceEventType.IMAGELOADSTART;\n        break;\n      case ImageState.LOADED:\n        this.loading = false;\n        type = ImageSourceEventType.IMAGELOADEND;\n        break;\n      case ImageState.ERROR:\n        this.loading = false;\n        type = ImageSourceEventType.IMAGELOADERROR;\n        break;\n      default:\n        return;\n    }\n    if (this.hasListener(type)) {\n      this.dispatchEvent(new ImageSourceEvent(type, image));\n    }\n  }\n}\n\n/**\n * Default image load function for image sources that use import(\"../Image.js\").Image image\n * instances.\n * @param {import(\"../Image.js\").default} image Image.\n * @param {string} src Source.\n */\nexport function defaultImageLoadFunction(image, src) {\n  /** @type {HTMLImageElement|HTMLVideoElement} */ (image.getImage()).src = src;\n}\n\n/**\n * Adjusts the extent so it aligns with pixel boundaries.\n * @param {import(\"../extent.js\").Extent} extent Extent.\n * @param {number} resolution Reolution.\n * @param {number} pixelRatio Pixel ratio.\n * @param {number} ratio Ratio between request size and view size.\n * @return {import(\"../extent.js\").Extent} Request extent.\n */\nexport function getRequestExtent(extent, resolution, pixelRatio, ratio) {\n  const imageResolution = resolution / pixelRatio;\n  const center = getCenter(extent);\n  const viewWidth = ceil(getWidth(extent) / imageResolution, DECIMALS);\n  const viewHeight = ceil(getHeight(extent) / imageResolution, DECIMALS);\n  const marginWidth = ceil(((ratio - 1) * viewWidth) / 2, DECIMALS);\n  const requestWidth = viewWidth + 2 * marginWidth;\n  const marginHeight = ceil(((ratio - 1) * viewHeight) / 2, DECIMALS);\n  const requestHeight = viewHeight + 2 * marginHeight;\n  return getForViewAndSize(center, imageResolution, 0, [\n    requestWidth,\n    requestHeight,\n  ]);\n}\n\nexport default ImageSource;\n","/**\n * @module ol/source/common\n */\n\n/**\n * Default WMS version.\n * @type {string}\n */\nexport const DEFAULT_WMS_VERSION = '1.3.0';\n\n/**\n * Number of decimal digits to consider in integer values when rounding.\n * @type {number}\n */\nexport const DECIMALS = 4;\n","/**\n * @module ol/source/wms\n */\n\nimport {decode} from '../Image.js';\nimport {getForViewAndSize, getHeight, getWidth} from '../extent.js';\nimport {floor, round} from '../math.js';\nimport {get as getProjection} from '../proj.js';\nimport {compareVersions} from '../string.js';\nimport {appendParams} from '../uri.js';\nimport {getRequestExtent} from './Image.js';\nimport {DECIMALS} from './common.js';\n\n/**\n * Default WMS version.\n * @type {string}\n */\nexport const DEFAULT_VERSION = '1.3.0';\n\n/**\n * @const\n * @type {import(\"../size.js\").Size}\n */\nconst GETFEATUREINFO_IMAGE_SIZE = [101, 101];\n\n/**\n * @api\n * @typedef {'carmentaserver' | 'geoserver' | 'mapserver' | 'qgis'} ServerType\n * Set the server type to use implementation-specific parameters beyond the WMS specification.\n *  - `'carmentaserver'`: HiDPI support for [Carmenta Server](https://www.carmenta.com/en/products/carmenta-server)\n *  - `'geoserver'`: HiDPI support for [GeoServer](https://geoserver.org/)\n *  - `'mapserver'`: HiDPI support for [MapServer](https://mapserver.org/)\n *  - `'qgis'`: HiDPI support for [QGIS](https://qgis.org/)\n */\n\n/**\n * @param {string} baseUrl Base URL.\n * @param {import(\"../extent.js\").Extent} extent Extent.\n * @param {import(\"../size.js\").Size} size Size.\n * @param {import(\"../proj/Projection.js\").default} projection Projection.\n * @param {Object} params WMS params. Will be modified in place.\n * @return {string} Request URL.\n */\nexport function getRequestUrl(baseUrl, extent, size, projection, params) {\n  params['WIDTH'] = size[0];\n  params['HEIGHT'] = size[1];\n\n  const axisOrientation = projection.getAxisOrientation();\n  const v13 = compareVersions(params['VERSION'], '1.3') >= 0;\n  params[v13 ? 'CRS' : 'SRS'] = projection.getCode();\n  const bbox =\n    v13 && axisOrientation.startsWith('ne')\n      ? [extent[1], extent[0], extent[3], extent[2]]\n      : extent;\n  params['BBOX'] = bbox.join(',');\n\n  return appendParams(baseUrl, params);\n}\n\n/**\n * @param {import(\"../extent\").Extent} extent Extent.\n * @param {number} resolution Resolution.\n * @param {number} pixelRatio pixel ratio.\n * @param {import(\"../proj.js\").Projection} projection Projection.\n * @param {string} url WMS service url.\n * @param {Object} params WMS params.\n * @param {import(\"./wms.js\").ServerType} serverType The type of the remote WMS server.\n * @return {string} Image src.\n */\nexport function getImageSrc(\n  extent,\n  resolution,\n  pixelRatio,\n  projection,\n  url,\n  params,\n  serverType,\n) {\n  params = Object.assign({REQUEST: 'GetMap'}, params);\n\n  const imageResolution = resolution / pixelRatio;\n\n  const imageSize = [\n    round(getWidth(extent) / imageResolution, DECIMALS),\n    round(getHeight(extent) / imageResolution, DECIMALS),\n  ];\n\n  if (pixelRatio != 1) {\n    switch (serverType) {\n      case 'geoserver':\n        const dpi = (90 * pixelRatio + 0.5) | 0;\n        if ('FORMAT_OPTIONS' in params) {\n          params['FORMAT_OPTIONS'] += ';dpi:' + dpi;\n        } else {\n          params['FORMAT_OPTIONS'] = 'dpi:' + dpi;\n        }\n        break;\n      case 'mapserver':\n        params['MAP_RESOLUTION'] = 90 * pixelRatio;\n        break;\n      case 'carmentaserver':\n      case 'qgis':\n        params['DPI'] = 90 * pixelRatio;\n        break;\n      default:\n        throw new Error('Unknown `serverType` configured');\n    }\n  }\n\n  const src = getRequestUrl(url, extent, imageSize, projection, params);\n  return src;\n}\n\n/**\n * @param {Object} params WMS params.\n * @param {string} request WMS `REQUEST`.\n * @return {Object} WMS params with required properties set.\n */\nexport function getRequestParams(params, request) {\n  return Object.assign(\n    {\n      'REQUEST': request,\n      'SERVICE': 'WMS',\n      'VERSION': DEFAULT_VERSION,\n      'FORMAT': 'image/png',\n      'STYLES': '',\n      'TRANSPARENT': 'TRUE',\n    },\n    params,\n  );\n}\n\n/**\n * @typedef {Object} LoaderOptions\n * @property {null|string} [crossOrigin] The `crossOrigin` attribute for loaded images.  Note that\n * you must provide a `crossOrigin` value if you want to access pixel data with the Canvas renderer.\n * See https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image for more detail.\n * @property {boolean} [hidpi=true] Use the `ol/Map#pixelRatio` value when requesting\n * the image from the remote server.\n * @property {Object<string,*>} [params] WMS request parameters.\n * At least a `LAYERS` param is required. `STYLES` is\n * `''` by default. `VERSION` is `1.3.0` by default. `WIDTH`, `HEIGHT` and `BBOX` will be set\n * dynamically. `CRS` (`SRS` for WMS version < 1.3.0) will is derived from the `proection` config.\n * @property {import(\"../proj.js\").ProjectionLike} [projection] Projection. Default is 'EPSG:3857'.\n * @property {number} [ratio=1.5] Ratio. `1` means image requests are the size of the map viewport, `2` means\n * twice the width and height of the map viewport, and so on. Must be `1` or higher.\n * @property {import(\"./wms.js\").ServerType} [serverType] The type of\n * the remote WMS server: `mapserver`, `geoserver`, `carmentaserver`, or `qgis`.\n * Only needed if `hidpi` is `true`.\n * @property {string} url WMS service URL.\n * @property {function(HTMLImageElement, string): Promise<import('../DataTile.js').ImageLike>} [load] Function\n * to perform loading of the image. Receives the created `HTMLImageElement` and the desired `src` as argument and\n * returns a promise resolving to the loaded or decoded image. Default is {@link module:ol/Image.decode}.\n */\n\n/**\n * Creates a loader for WMS images.\n * @param {LoaderOptions} options Loader options.\n * @return {import(\"../Image.js\").ImageObjectPromiseLoader} Loader.\n * @api\n */\nexport function createLoader(options) {\n  const hidpi = options.hidpi === undefined ? true : options.hidpi;\n  const projection = getProjection(options.projection || 'EPSG:3857');\n  const ratio = options.ratio || 1.5;\n  const load = options.load || decode;\n  const crossOrigin = options.crossOrigin ?? null;\n\n  return (extent, resolution, pixelRatio) => {\n    extent = getRequestExtent(extent, resolution, pixelRatio, ratio);\n    if (pixelRatio != 1 && (!hidpi || options.serverType === undefined)) {\n      pixelRatio = 1;\n    }\n    const src = getImageSrc(\n      extent,\n      resolution,\n      pixelRatio,\n      projection,\n      options.url,\n      getRequestParams(options.params, 'GetMap'),\n      options.serverType,\n    );\n    const image = new Image();\n    image.crossOrigin = crossOrigin;\n    return load(image, src).then((image) => ({image, extent, pixelRatio}));\n  };\n}\n\n/**\n * Get the GetFeatureInfo URL for the passed coordinate and resolution. Returns `undefined` if the\n * GetFeatureInfo URL cannot be constructed.\n * @param {LoaderOptions} options Options passed the `createWMSLoader()` function. In addition to\n * the params required by the loader, `INFO_FORMAT` should be specified, it defaults to\n * `application/json`. If `QUERY_LAYERS` is not provided, then the layers specified in the `LAYERS`\n * parameter will be used.\n * @param {import(\"../coordinate.js\").Coordinate} coordinate Coordinate.\n * @param {number} resolution Resolution.\n * @return {string|undefined} GetFeatureInfo URL.\n * @api\n */\nexport function getFeatureInfoUrl(options, coordinate, resolution) {\n  if (options.url === undefined) {\n    return undefined;\n  }\n\n  const projectionObj = getProjection(options.projection || 'EPSG:3857');\n\n  const extent = getForViewAndSize(\n    coordinate,\n    resolution,\n    0,\n    GETFEATUREINFO_IMAGE_SIZE,\n  );\n\n  const baseParams = {\n    'QUERY_LAYERS': options.params['LAYERS'],\n    'INFO_FORMAT': 'application/json',\n  };\n  Object.assign(\n    baseParams,\n    getRequestParams(options.params, 'GetFeatureInfo'),\n    options.params,\n  );\n\n  const x = floor((coordinate[0] - extent[0]) / resolution, DECIMALS);\n  const y = floor((extent[3] - coordinate[1]) / resolution, DECIMALS);\n  const v13 = compareVersions(baseParams['VERSION'], '1.3') >= 0;\n  baseParams[v13 ? 'I' : 'X'] = x;\n  baseParams[v13 ? 'J' : 'Y'] = y;\n\n  return getRequestUrl(\n    options.url,\n    extent,\n    GETFEATUREINFO_IMAGE_SIZE,\n    projectionObj,\n    baseParams,\n  );\n}\n\n/**\n * Get the GetLegendGraphic URL, optionally optimized for the passed resolution and possibly\n * including any passed specific parameters. Returns `undefined` if the GetLegendGraphic URL\n * cannot be constructed.\n *\n * @param {LoaderOptions} options Options passed the `createWMSLoader()` function.\n * @param {number} [resolution] Resolution. If not provided, `SCALE` will not be calculated and\n * included in URL.\n * @return {string|undefined} GetLegendGraphic URL.\n * @api\n */\nexport function getLegendUrl(options, resolution) {\n  if (options.url === undefined) {\n    return undefined;\n  }\n\n  const baseParams = {\n    'SERVICE': 'WMS',\n    'VERSION': DEFAULT_VERSION,\n    'REQUEST': 'GetLegendGraphic',\n    'FORMAT': 'image/png',\n  };\n\n  if (resolution !== undefined) {\n    const mpu =\n      getProjection(options.projection || 'EPSG:3857').getMetersPerUnit() || 1;\n    const pixelSize = 0.00028;\n    baseParams['SCALE'] = (resolution * mpu) / pixelSize;\n  }\n\n  Object.assign(baseParams, options.params);\n\n  if (options.params !== undefined && baseParams['LAYER'] === undefined) {\n    const layers = baseParams['LAYERS'];\n    const isSingleLayer = !Array.isArray(layers) || layers.length !== 1;\n    if (!isSingleLayer) {\n      return undefined;\n    }\n    baseParams['LAYER'] = layers;\n  }\n\n  return appendParams(options.url, baseParams);\n}\n","/**\n * @module ol/util\n */\n\n/**\n * @return {never} Any return.\n */\nexport function abstract() {\n  throw new Error('Unimplemented abstract method.');\n}\n\n/**\n * Counter for getUid.\n * @type {number}\n * @private\n */\nlet uidCounter_ = 0;\n\n/**\n * Gets a unique ID for an object. This mutates the object so that further calls\n * with the same object as a parameter returns the same value. Unique IDs are generated\n * as a strictly increasing sequence. Adapted from goog.getUid.\n *\n * @param {Object} obj The object to get the unique ID for.\n * @return {string} The unique ID for the object.\n * @api\n */\nexport function getUid(obj) {\n  return obj.ol_uid || (obj.ol_uid = String(++uidCounter_));\n}\n\n/**\n * OpenLayers version.\n * @type {string}\n */\nexport const VERSION = '10.4.0';\n"],"names":["binarySearch","haystack","needle","comparator","mid","cmp","ascending","low","high","found","a","b","descending","linearFindNearest","arr","target","direction","n","i","candidate","reverseSubArray","begin","end","tmp","extend","data","extension","Array","length","equals","arr1","arr2","len1","isSorted","func","strict","compare","currentVal","index","res","stopPropagation","evt","preventDefault","type","Target","listener","listeners","listenersForType","event","propagate","isString","dispatching","pendingRemovals","ii","pr","undefined","Object","TRUE","FALSE","VOID","memoizeOne","fn","lastResult","lastArgs","lastThis","nextArgs","arguments","toPromise","getter","promiseGetter","value","err","Promise","clear","object","property","isEmpty","fromResolutionLike","resolution","Math","ReprojImage","Image","sourceProj","targetProj","targetExtent","targetResolution","pixelRatio","getImageFunction","interpolate","maxSourceExtent","Infinity","maxTargetExtent","limitedTargetExtent","targetCenter","sourceResolution","errorThresholdInPixels","triangulation","Triangulation","sourceExtent","sourceImage","state","ImageState","sourcePixelRatio","sourceState","width","height","EventType","e","ImageSourceEventType","ImageSourceEvent","Event","image","ImageSource","Source","options","resolutions","idx","extent","projection","sourceProjection","requestExtent","getRequestExtent","requestResolution","defaultImageLoadFunction","src","ratio","imageResolution","center","viewWidth","viewHeight","marginWidth","marginHeight","DECIMALS","DEFAULT_VERSION","GETFEATUREINFO_IMAGE_SIZE","getRequestUrl","baseUrl","size","params","axisOrientation","v13","bbox","getImageSrc","url","serverType","imageSize","dpi","Error","getRequestParams","request","createLoader","hidpi","load","crossOrigin","getFeatureInfoUrl","coordinate","projectionObj","baseParams","x","y","getLegendUrl","mpu","layers","abstract","uidCounter_","getUid","obj","String","VERSION"],"mappings":"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"}