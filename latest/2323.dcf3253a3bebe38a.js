"use strict";(self.webpackChunk_terrestris_shogun_gis_client=self.webpackChunk_terrestris_shogun_gis_client||[]).push([["2323"],{85486:function(t,e,i){i.d(e,{QD:function(){return I},Ay:function(){return S},VV:function(){return R}});var n=i(3783),r=i(80398),s=i(19487),a=i(43354),o=i(55506),u=i(85752),l=i(94966),h=i(58318),g=i(17353),c=i(22482);function d(t){return Array.isArray(t)?Math.min(...t):t}var _=i(73445);class E extends n.Ay{constructor(t,e,i,n,s,a,o){let l=t.getExtent();l&&t.canWrapX()&&((l=l.slice())[0]=-1/0,l[2]=1/0);let h=e.getExtent();h&&e.canWrapX()&&((h=h.slice())[0]=-1/0,h[2]=1/0);const g=h?(0,u.getIntersection)(i,h):i,d=(0,u.getCenter)(g),E=(0,c.KQ)(t,e,d,n),f=new _.A(t,e,g,l,.5*E,n),m=f.calculateSourceExtent(),p=(0,u.isEmpty)(m)?null:a(m,E,s),R=p?r.default.IDLE:r.default.EMPTY,I=p?p.getPixelRatio():1;super(i,n,I,R),this.targetProj_=e,this.maxSourceExtent_=l,this.triangulation_=f,this.targetResolution_=n,this.targetExtent_=i,this.sourceImage_=p,this.sourcePixelRatio_=I,this.interpolate_=o,this.canvas_=null,this.sourceListenerKey_=null}disposeInternal(){this.state==r.default.LOADING&&this.unlistenSource_(),super.disposeInternal()}getImage(){return this.canvas_}getProjection(){return this.targetProj_}reproject_(){let t=this.sourceImage_.getState();if(t==r.default.LOADED){let t=(0,u.getWidth)(this.targetExtent_)/this.targetResolution_,e=(0,u.getHeight)(this.targetExtent_)/this.targetResolution_;this.canvas_=(0,c.XX)(t,e,this.sourcePixelRatio_,d(this.sourceImage_.getResolution()),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0,void 0,this.interpolate_,!0)}this.state=t,this.changed()}load(){if(this.state==r.default.IDLE){this.state=r.default.LOADING,this.changed();let t=this.sourceImage_.getState();t==r.default.LOADED||t==r.default.ERROR?this.reproject_():(this.sourceListenerKey_=(0,g.KT)(this.sourceImage_,o.default.CHANGE,t=>{let e=this.sourceImage_.getState();(e==r.default.LOADED||e==r.default.ERROR)&&(this.unlistenSource_(),this.reproject_())}),this.sourceImage_.load())}}unlistenSource_(){(0,g.JH)(this.sourceListenerKey_),this.sourceListenerKey_=null}}var f=i(98550);class m extends a.default{constructor(t,e){super(t),this.image=e}}class p extends f.default{constructor(t){super({attributions:t.attributions,projection:t.projection,state:t.state,interpolate:void 0===t.interpolate||t.interpolate}),this.on,this.once,this.un,this.loader=t.loader||null,this.resolutions_=void 0!==t.resolutions?t.resolutions:null,this.reprojectedImage_=null,this.reprojectedRevision_=0,this.image=null,this.wantedExtent_,this.wantedResolution_,this.static_=!!t.loader&&0===t.loader.length,this.wantedProjection_=null}getResolutions(){return this.resolutions_}setResolutions(t){this.resolutions_=t}findNearestResolution(t){let e=this.getResolutions();if(e){let i=(0,s.FT)(e,t,0);t=e[i]}return t}getImage(t,e,i,n){let r=this.getProjection();if(!r||!n||(0,h.equivalent)(r,n))return r&&(n=r),this.getImageInternal(t,e,i,n);if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&(0,h.equivalent)(this.reprojectedImage_.getProjection(),n)&&this.reprojectedImage_.getResolution()==e&&(0,u.equals)(this.reprojectedImage_.getExtent(),t))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new E(r,n,t,e,i,(t,e,i)=>this.getImageInternal(t,e,i,r),this.getInterpolate()),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}getImageInternal(t,e,i,r){if(this.loader){let s=I(t,e,i,1),a=this.findNearestResolution(e);if(this.image&&(this.static_||this.wantedProjection_===r&&(this.wantedExtent_&&(0,u.containsExtent)(this.wantedExtent_,s)||(0,u.containsExtent)(this.image.getExtent(),s))&&(this.wantedResolution_&&d(this.wantedResolution_)===a||d(this.image.getResolution())===a)))return this.image;this.wantedProjection_=r,this.wantedExtent_=s,this.wantedResolution_=a,this.image=new n.Ay(s,a,i,this.loader),this.image.addEventListener(o.default.CHANGE,this.handleImageChange.bind(this))}return this.image}handleImageChange(t){let e,i=t.target;switch(i.getState()){case r.default.LOADING:this.loading=!0,e="imageloadstart";break;case r.default.LOADED:this.loading=!1,e="imageloadend";break;case r.default.ERROR:this.loading=!1,e="imageloaderror";break;default:return}this.hasListener(e)&&this.dispatchEvent(new m(e,i))}}function R(t,e){t.getImage().src=e}function I(t,e,i,n){let r=e/i,s=(0,u.getCenter)(t),a=(0,l.mk)((0,u.getWidth)(t)/r,4),o=(0,l.mk)((0,u.getHeight)(t)/r,4),h=(0,l.mk)((n-1)*a/2,4),g=(0,l.mk)((n-1)*o/2,4);return(0,u.getForViewAndSize)(s,r,0,[a+2*h,o+2*g])}var S=p},48103:function(t,e,i){i.d(e,{$q:function(){return m},AE:function(){return d},Eq:function(){return E},W3:function(){return _},jD:function(){return h},y4:function(){return f}});var n=i(3783),r=i(85752),s=i(94966),a=i(58318),o=i(86953),u=i(38928),l=i(85486);let h="1.3.0",g=[101,101];function c(t,e,i,n,r){r.WIDTH=i[0],r.HEIGHT=i[1];let s=n.getAxisOrientation(),a=(0,o.Z)(r.VERSION,"1.3")>=0;return r[a?"CRS":"SRS"]=n.getCode(),r.BBOX=(a&&s.startsWith("ne")?[e[1],e[0],e[3],e[2]]:e).join(","),(0,u.LW)(t,r)}function d(t,e,i,n,a,o,u){o=Object.assign({REQUEST:"GetMap"},o);let l=e/i,h=[(0,s.LI)((0,r.getWidth)(t)/l,4),(0,s.LI)((0,r.getHeight)(t)/l,4)];if(1!=i)switch(u){case"geoserver":let g=90*i+.5|0;"FORMAT_OPTIONS"in o?o.FORMAT_OPTIONS+=";dpi:"+g:o.FORMAT_OPTIONS="dpi:"+g;break;case"mapserver":o.MAP_RESOLUTION=90*i;break;case"carmentaserver":case"qgis":o.DPI=90*i;break;default:throw Error("Unknown `serverType` configured")}return c(a,t,h,n,o)}function _(t,e){return Object.assign({REQUEST:e,SERVICE:"WMS",VERSION:h,FORMAT:"image/png",STYLES:"",TRANSPARENT:"TRUE"},t)}function E(t){let e=void 0===t.hidpi||t.hidpi,i=(0,a.get)(t.projection||"EPSG:3857"),r=t.ratio||1.5,s=t.load||n.D4,o=t.crossOrigin??null;return(n,a,u)=>{n=(0,l.QD)(n,a,u,r),1==u||e&&void 0!==t.serverType||(u=1);let h=d(n,a,u,i,t.url,_(t.params,"GetMap"),t.serverType),g=new Image;return g.crossOrigin=o,s(g,h).then(t=>({image:t,extent:n,pixelRatio:u}))}}function f(t,e,i){if(void 0===t.url)return;let n=(0,a.get)(t.projection||"EPSG:3857"),u=(0,r.getForViewAndSize)(e,i,0,g),l={QUERY_LAYERS:t.params.LAYERS,INFO_FORMAT:"application/json"};Object.assign(l,_(t.params,"GetFeatureInfo"),t.params);let h=(0,s.RI)((e[0]-u[0])/i,4),d=(0,s.RI)((u[3]-e[1])/i,4),E=(0,o.Z)(l.VERSION,"1.3")>=0;return l[E?"I":"X"]=h,l[E?"J":"Y"]=d,c(t.url,u,g,n,l)}function m(t,e){if(void 0===t.url)return;let i={SERVICE:"WMS",VERSION:h,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(void 0!==e&&(i.SCALE=e*((0,a.get)(t.projection||"EPSG:3857").getMetersPerUnit()||1)/28e-5),Object.assign(i,t.params),void 0!==t.params&&void 0===i.LAYER){let t=i.LAYERS;if(!(!Array.isArray(t)||1!==t.length))return;i.LAYER=t}return(0,u.LW)(t.url,i)}},94092:function(t,e,i){function n(){throw Error("Unimplemented abstract method.")}i.r(e),i.d(e,{VERSION:function(){return a},abstract:function(){return n},getUid:function(){return s}});let r=0;function s(t){return t.ol_uid||(t.ol_uid=String(++r))}let a="10.7.0"}}]);
//# sourceMappingURL=2323.dcf3253a3bebe38a.js.map