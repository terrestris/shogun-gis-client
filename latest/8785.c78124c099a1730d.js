"use strict";(self.webpackChunk_terrestris_shogun_gis_client=self.webpackChunk_terrestris_shogun_gis_client||[]).push([["8785"],{33261:function(e,t,i){i.r(t),i.d(t,{optionsFromCapabilities:function(){return c}});var n=i(85752),r=i(21128),o=i(43618),s=i(9095),l=i(38928),a=i(81355);class u extends a.A{constructor(e){const t=void 0!==e.requestEncoding?e.requestEncoding:"KVP",i=e.tileGrid;let n=e.urls;void 0===n&&void 0!==e.url&&(n=(0,l.Uu)(e.url)),super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileClass:e.tileClass,tileGrid:i,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,urls:n,wrapX:void 0!==e.wrapX&&e.wrapX,transition:e.transition,zDirection:e.zDirection}),this.version_=void 0!==e.version?e.version:"1.0.0",this.format_=void 0!==e.format?e.format:"image/jpeg",this.dimensions_=void 0!==e.dimensions?e.dimensions:{},this.layer_=e.layer,this.matrixSet_=e.matrixSet,this.style_=e.style,this.requestEncoding_=t,this.setKey(this.getKeyForDimensions_()),n&&n.length>0&&(this.tileUrlFunction=(0,s.FD)(n.map(this.createFromWMTSTemplate.bind(this))))}setUrls(e){this.urls=e;let t=e.join("\n");this.setTileUrlFunction((0,s.FD)(e.map(this.createFromWMTSTemplate.bind(this))),t)}getDimensions(){return this.dimensions_}getFormat(){return this.format_}getLayer(){return this.layer_}getMatrixSet(){return this.matrixSet_}getRequestEncoding(){return this.requestEncoding_}getStyle(){return this.style_}getVersion(){return this.version_}getKeyForDimensions_(){let e=this.urls?this.urls.slice(0):[];for(let t in this.dimensions_)e.push(t+"-"+this.dimensions_[t]);return e.join("/")}updateDimensions(e){Object.assign(this.dimensions_,e),this.setKey(this.getKeyForDimensions_())}createFromWMTSTemplate(e){let t=this.requestEncoding_,i={layer:this.layer_,style:this.style_,tilematrixset:this.matrixSet_};"KVP"==t&&Object.assign(i,{Service:"WMTS",Request:"GetTile",Version:this.version_,Format:this.format_}),e="KVP"==t?(0,l.LW)(e,i):e.replace(/\{(\w+?)\}/g,function(e,t){return t.toLowerCase()in i?i[t.toLowerCase()]:e});let n=this.tileGrid,r=this.dimensions_;return function(i,o,s){if(!i)return;let a={TileMatrix:n.getMatrixId(i[0]),TileCol:i[1],TileRow:i[2]};Object.assign(a,r);let u=e;return"KVP"==t?(0,l.LW)(u,a):u.replace(/\{(\w+?)\}/g,function(e,t){return encodeURIComponent(a[t])})}}}function c(e,t){let i,s,l=e.Contents.Layer,a=l?.find(function(e){return e.Identifier==t.layer});if(!a)return null;let u=e.Contents.TileMatrixSet;(i=a.TileMatrixSetLink.length>1?"projection"in t?a.TileMatrixSetLink.findIndex(function(e){let i=u.find(function(t){return t.Identifier==e.TileMatrixSet}).SupportedCRS,n=(0,r.get)(i),o=(0,r.get)(t.projection);return n&&o?(0,r.equivalent)(n,o):i==t.projection}):a.TileMatrixSetLink.findIndex(function(e){return e.TileMatrixSet==t.matrixSet}):0)<0&&(i=0);let c=a.TileMatrixSetLink[i].TileMatrixSet,d=a.TileMatrixSetLink[i].TileMatrixSetLimits,f=a.Format[0];"format"in t&&(f=t.format),(i=a.Style.findIndex(function(e){return"style"in t?e.Title==t.style:e.isDefault}))<0&&(i=0);let h=a.Style[i].Identifier,g={};"Dimension"in a&&a.Dimension.forEach(function(e,t,i){let n=e.Identifier,r=e.Default;void 0===r&&(r=e.Value[0]),g[n]=r});let m=e.Contents.TileMatrixSet.find(function(e){return e.Identifier==c}),p=m.SupportedCRS;if(p&&(s=(0,r.get)(p)),"projection"in t){let e=(0,r.get)(t.projection);e&&(!s||(0,r.equivalent)(e,s))&&(s=e)}let T=!1,x=s.getAxisOrientation().startsWith("ne"),S=m.TileMatrix[0],M={MinTileCol:0,MinTileRow:0,MaxTileCol:S.MatrixWidth-1,MaxTileRow:S.MatrixHeight-1};if(d){M=d[d.length-1];let e=m.TileMatrix.find(e=>e.Identifier===M.TileMatrix||m.Identifier+":"+e.Identifier===M.TileMatrix);e&&(S=e)}let _=a.BoundingBox?.find(e=>(0,r.get)(e.crs)&&(0,r.equivalent)((0,r.get)(e.crs),s)),C=28e-5*S.ScaleDenominator/s.getMetersPerUnit(),y=x?[S.TopLeftCorner[1],S.TopLeftCorner[0]]:S.TopLeftCorner,E=S.TileWidth*C,v=S.TileHeight*C,b=_?.extent??m.BoundingBox;b&&x&&(b=[b[1],b[0],b[3],b[2]]);let L=[y[0]+E*M.MinTileCol,y[1]-v*(1+M.MaxTileRow),y[0]+E*(1+M.MaxTileCol),y[1]-v*M.MinTileRow];if(void 0!==b&&!(0,n.containsExtent)(b,L)){let e=a.WGS84BoundingBox,t=(0,r.get)("EPSG:4326").getExtent();if(L=b,e)T=e[0]===t[0]&&e[2]===t[2];else{let e=(0,r.transformExtent)(b,m.SupportedCRS,"EPSG:4326");T=e[0]-1e-10<=t[0]&&e[2]+1e-10>=t[2]}}let w=(0,o.createFromCapabilitiesMatrixSet)(m,L,d),F=[],R=t.requestEncoding;if(R=void 0!==R?R:"","OperationsMetadata"in e&&"GetTile"in e.OperationsMetadata){let t=e.OperationsMetadata.GetTile.DCP.HTTP.Get;for(let e=0,i=t.length;e<i;++e)if(t[e].Constraint){let i=t[e].Constraint.find(function(e){return"GetEncoding"==e.name}).AllowedValues.Value;if(""===R&&(R=i[0]),"KVP"===R)i.includes("KVP")&&F.push(t[e].href);else break}else t[e].href&&(R="KVP",F.push(t[e].href))}return 0===F.length&&(R="REST",a.ResourceURL.forEach(function(e){"tile"===e.resourceType&&(f=e.format,F.push(e.template))})),{urls:F,layer:t.layer,matrixSet:c,format:f,projection:s,requestEncoding:R,tileGrid:w,style:h,dimensions:g,wrapX:T,crossOrigin:t.crossOrigin}}t.default=u},94092:function(e,t,i){function n(){throw Error("Unimplemented abstract method.")}i.r(t),i.d(t,{VERSION:function(){return s},abstract:function(){return n},getUid:function(){return o}});let r=0;function o(e){return e.ol_uid||(e.ol_uid=String(++r))}let s="10.7.0"}}]);
//# sourceMappingURL=8785.c78124c099a1730d.js.map