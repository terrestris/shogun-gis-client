{"version":3,"file":"7917.42339db0df2b1275.js","sources":["webpack://@terrestris/shogun-gis-client/./node_modules/@terrestris/react-geo/dist/Button/ModifyButton/ModifyButton.js","webpack://@terrestris/shogun-gis-client/./node_modules/@terrestris/react-util/dist/Hooks/useModify/useModify.js","webpack://@terrestris/shogun-gis-client/./node_modules/@terrestris/react-util/dist/Hooks/useSelectFeatures/useSelectFeatures.js"],"sourcesContent":["import * as React from 'react';\nimport { useCallback, useState } from 'react';\nimport { useModify } from '@terrestris/react-util/dist/Hooks/useModify/useModify';\nimport { CSS_PREFIX } from '../../constants';\nimport { FeatureLabelModal } from '../../FeatureLabelModal/FeatureLabelModal';\nimport ToggleButton from '../ToggleButton/ToggleButton';\n/**\n * The className added to this component.\n */\nconst defaultClassName = `${CSS_PREFIX}modifybutton`;\nexport const ModifyButton = ({ className, hitTolerance = 5, onFeatureSelect, onModifyStart, onModifyEnd, onTranslateStart, onTranslateEnd, onTranslating, digitizeLayer, selectStyle, selectInteractionConfig, modifyInteractionConfig, translateInteractionConfig, onModalLabelOk, onModalLabelCancel, maxLabelLineLength, modalPromptTitle, modalPromptOkButtonText, modalPromptCancelButtonText, editLabel = true, pressed, ...passThroughProps }) => {\n    const [editLabelFeature, setEditLabelFeature] = useState(null);\n    const onFeatureSelectInternal = useCallback((event) => {\n        if (editLabel) {\n            const labeled = event.selected.find(f => f.get('isLabel'));\n            setEditLabelFeature(labeled || null);\n        }\n        onFeatureSelect?.(event);\n    }, [editLabel, onFeatureSelect]);\n    useModify({\n        selectStyle,\n        selectInteractionConfig,\n        digitizeLayer,\n        onModifyStart,\n        onModifyEnd,\n        onTranslateStart,\n        onTranslateEnd,\n        onTranslating,\n        active: !!pressed,\n        modifyInteractionConfig,\n        translateInteractionConfig,\n        onFeatureSelect: onFeatureSelectInternal,\n        hitTolerance\n    });\n    const finalClassName = className\n        ? `${defaultClassName} ${className}`\n        : defaultClassName;\n    const btnWrapperClass = `${CSS_PREFIX}digitize-button-wrapper`;\n    let modal = null;\n    if (editLabelFeature) {\n        const onModalLabelOkInternal = () => {\n            onModalLabelOk?.(editLabelFeature);\n            setEditLabelFeature(null);\n        };\n        const onModalLabelCancelInternal = () => {\n            onModalLabelCancel?.();\n            setEditLabelFeature(null);\n        };\n        modal = (React.createElement(FeatureLabelModal, { feature: editLabelFeature, onOk: onModalLabelOkInternal, onCancel: onModalLabelCancelInternal, title: modalPromptTitle, okText: modalPromptOkButtonText, cancelText: modalPromptCancelButtonText, maxLabelLineLength: maxLabelLineLength }));\n    }\n    return (React.createElement(\"span\", { className: btnWrapperClass },\n        React.createElement(ToggleButton, { pressed: pressed, className: finalClassName, ...passThroughProps }),\n        modal));\n};\nexport default ModifyButton;\n//# sourceMappingURL=ModifyButton.js.map","import { useEffect, useMemo, useRef } from 'react';\nimport OlCollection from 'ol/Collection';\nimport { singleClick } from 'ol/events/condition';\nimport Modify from 'ol/interaction/Modify';\nimport Translate from 'ol/interaction/Translate';\nimport { DigitizeUtil } from '../../Util/DigitizeUtil';\nimport useMap from '../useMap/useMap';\nimport { useOlInteraction } from '../useOlInteraction/useOlInteraction';\nimport { useOlListener } from '../useOlListener/useOlListener';\nimport { usePropOrDefault } from '../usePropOrDefault/usePropOrDefault';\nimport { useSelectFeatures } from '../useSelectFeatures/useSelectFeatures';\nexport const useModify = ({ active, onFeatureSelect, onModifyStart, onModifyEnd, onTranslateStart, onTranslateEnd, onTranslating, digitizeLayer, selectStyle, selectInteractionConfig, hitTolerance, modifyInteractionConfig, translateInteractionConfig }) => {\n    const map = useMap();\n    const layer = usePropOrDefault(digitizeLayer, () => map ? DigitizeUtil.getDigitizeLayer(map) : null, [map]);\n    const featuresRef = useRef(new OlCollection());\n    const layers = useMemo(() => layer ? [layer] : [], [layer]);\n    useEffect(() => {\n        if (!active) {\n            featuresRef.current.clear();\n        }\n    }, [active]);\n    useSelectFeatures({\n        clearAfterSelect: false,\n        onFeatureSelect,\n        active,\n        layers,\n        selectStyle,\n        selectInteractionConfig,\n        hitTolerance,\n        featuresCollection: featuresRef.current\n    });\n    const translateInteraction = useOlInteraction(() => {\n        const newTranslateInteraction = new Translate({\n            features: featuresRef.current,\n            ...translateInteractionConfig\n        });\n        newTranslateInteraction.set('name', 'react-util-translate-interaction');\n        return newTranslateInteraction;\n    }, [translateInteractionConfig], active);\n    const modifyInteraction = useOlInteraction(() => {\n        const newModifyInteraction = new Modify({\n            features: featuresRef.current,\n            deleteCondition: singleClick,\n            style: selectStyle ?? DigitizeUtil.DEFAULT_SELECT_STYLE,\n            ...modifyInteractionConfig\n        });\n        newModifyInteraction.set('name', 'react-util-modify-interaction');\n        return newModifyInteraction;\n    }, [modifyInteractionConfig], active);\n    useOlListener(modifyInteraction, i => i.on('modifystart', e => onModifyStart?.(e)), [onModifyStart]);\n    useOlListener(modifyInteraction, i => i.on('modifyend', e => onModifyEnd?.(e)), [onModifyEnd]);\n    useOlListener(translateInteraction, i => i.on('translatestart', e => onTranslateStart?.(e)), [onTranslateStart]);\n    useOlListener(translateInteraction, i => i.on('translateend', e => onTranslateEnd?.(e)), [onTranslateEnd]);\n    useOlListener(translateInteraction, i => i.on('translating', e => onTranslating?.(e)), [onTranslating]);\n};\nexport default useModify;\n//# sourceMappingURL=useModify.js.map","import { useEffect } from 'react';\nimport OlCollection from 'ol/Collection';\nimport * as OlEventConditions from 'ol/events/condition';\nimport OlInteractionSelect from 'ol/interaction/Select';\nimport { DigitizeUtil } from '../../Util/DigitizeUtil';\nimport { useOlInteraction } from '../useOlInteraction/useOlInteraction';\nimport { useOlListener } from '../useOlListener/useOlListener';\nimport { usePropOrDefault } from '../usePropOrDefault/usePropOrDefault';\nexport const useSelectFeatures = ({ active, selectStyle, selectInteractionConfig, onFeatureSelect, hitTolerance = 5, layers, clearAfterSelect = false, featuresCollection }) => {\n    const features = usePropOrDefault(featuresCollection, () => new OlCollection(), []);\n    const selectInteraction = useOlInteraction(() => {\n        if (!features) {\n            return undefined;\n        }\n        const newInteraction = new OlInteractionSelect({\n            condition: OlEventConditions.singleClick,\n            features,\n            hitTolerance: hitTolerance,\n            style: selectStyle ?? DigitizeUtil.DEFAULT_SELECT_STYLE,\n            layers: layers,\n            ...(selectInteractionConfig ?? {})\n        });\n        newInteraction.set('name', 'react-util-select-interaction');\n        return newInteraction;\n    }, [features, hitTolerance, selectStyle, layers, selectInteractionConfig], active);\n    useOlListener(selectInteraction, i => i.on('select', e => {\n        if (features && clearAfterSelect) {\n            features.clear();\n        }\n        onFeatureSelect?.(e);\n    }), [features, clearAfterSelect, onFeatureSelect]);\n    useEffect(() => {\n        if (!active && features) {\n            features.clear();\n        }\n    }, [active, features]);\n};\nexport default useSelectFeatures;\n//# sourceMappingURL=useSelectFeatures.js.map"],"names":["e"],"mappings":"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"}