{"version":3,"file":"3759.6f4950fb8b0743b8.js","sources":["webpack://@terrestris/shogun-gis-client/./node_modules/@terrestris/react-geo/dist/Legend/Legend.js","webpack://@terrestris/shogun-gis-client/./node_modules/@terrestris/react-geo/dist/constants.js"],"sourcesContent":["import * as React from 'react';\nimport { useCallback, useEffect, useState } from 'react';\nimport { faCircleNotch } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { Spin } from 'antd';\nimport Logger from '@terrestris/base-util/dist/Logger';\nimport MapUtil from '@terrestris/ol-util/dist/MapUtil/MapUtil';\nimport { CSS_PREFIX } from '../constants';\n/**\n * Get the corresponding legendGraphic of a layer. If layer is configured with\n * \"legendUrl\" this will be used. Otherwise a getLegendGraphic requestString\n * will be created by the MapUtil.\n *\n * @param legendLayer The layer to get the legend graphic request for.\n * @param params The extra params.\n */\nconst getLegendUrl = (legendLayer, params) => {\n    let url;\n    if (legendLayer.get('legendUrl')) {\n        url = legendLayer.get('legendUrl');\n    }\n    else {\n        url = MapUtil.getLegendGraphicUrl(legendLayer, params);\n    }\n    return url;\n};\n/**\n * Class representing the Legend.\n *\n * @class Legend\n * @extends React.Component\n */\nexport const Legend = ({ className, layer, extraParams, onError, errorMsg, headers, loadingMask = true, ...passThroughProps }) => {\n    // eslint-disable-next-line\n    const [imgSrc, setImgSrc] = useState('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=');\n    const [legendUrl, setLegendUrl] = useState(getLegendUrl(layer, extraParams));\n    const [legendError, setLegendError] = useState(false);\n    const [loading, setLoading] = useState(false);\n    const handleError = useCallback((e) => {\n        Logger.warn(`Image error for legend of \"${layer.get('name')}\".`);\n        setLegendError(true);\n        if (onError) {\n            onError(e);\n        }\n    }, [layer, onError]);\n    const setLegendSrc = useCallback(async () => {\n        try {\n            setLoading(true);\n            const response = await fetch(legendUrl, {\n                headers\n            });\n            if (!response.ok) {\n                throw new Error('No successful response returned while getting the legend graphic');\n            }\n            const responseBlob = await response.blob();\n            setImgSrc(previousImgSrc => {\n                URL.revokeObjectURL(previousImgSrc);\n                return URL.createObjectURL(responseBlob);\n            });\n        }\n        catch (error) {\n            Logger.error('Error while setting the img src: ', error);\n            handleError(error);\n        }\n        finally {\n            setLoading(false);\n        }\n    }, [handleError, headers, legendUrl]);\n    useEffect(() => {\n        setLegendSrc();\n    }, [setLegendSrc]);\n    useEffect(() => {\n        setLegendUrl(getLegendUrl(layer, extraParams));\n    }, [layer, extraParams, setLegendSrc]);\n    const alt = layer.get('name')\n        ? layer.get('name') + ' legend'\n        : 'layer legend';\n    return (React.createElement(\"div\", { className: `${CSS_PREFIX}legend ${className ? className : ''}`, ...passThroughProps },\n        React.createElement(Spin, { spinning: loadingMask ? loading : false, indicator: (React.createElement(FontAwesomeIcon, { icon: faCircleNotch })) }, legendError ?\n            React.createElement(\"div\", { className: 'legend-load-error' }, errorMsg)\n            :\n                React.createElement(\"img\", { src: imgSrc, alt: alt, onError: handleError.bind(this) }))));\n};\nexport default Legend;\n//# sourceMappingURL=Legend.js.map","const CSS_PREFIX = 'react-geo-';\nexport { CSS_PREFIX };\n//# sourceMappingURL=constants.js.map"],"names":["e","fetch","Error","URL"],"mappings":"mRAgBA,IAAM,EAAe,CAAC,EAAa,IAE3B,EAAY,GAAG,CAAC,aACV,EAAY,GAAG,CAAC,aAGhB,uBAA2B,CAAC,EAAa,GAU1C,EAAS,CAAC,CAAE,WAAS,CAAE,OAAK,CAAE,aAAW,CAAE,SAAO,CAAE,UAAQ,CAAE,SAAO,CAAE,cAAc,EAAI,CAAE,GAAG,EAAkB,IAEzH,GAAM,CAAC,EAAQ,EAAU,CAAG,eAAS,sHAC/B,CAAC,EAAW,EAAa,CAAG,eAAS,EAAa,EAAO,IACzD,CAAC,EAAa,EAAe,CAAG,eAAS,IACzC,CAAC,EAAS,EAAW,CAAG,eAAS,IACjC,EAAc,kBAAY,AAACA,IAC7B,QAAW,CAAC,CAAC,2BAA2B,EAAE,EAAM,GAAG,CAAC,QAAQ,EAAE,CAAC,EAC/D,EAAe,IACX,GACA,EAAQA,EAEhB,EAAG,CAAC,EAAO,EAAQ,EACb,EAAe,kBAAY,UAC7B,GAAI,CACA,EAAW,IACX,IAAM,EAAW,MAAMC,MAAM,EAAW,CACpC,SACJ,GACA,GAAI,CAAC,EAAS,EAAE,CACZ,MAAM,AAAIC,MAAM,oEAEpB,IAAM,EAAe,MAAM,EAAS,IAAI,GACxC,EAAU,IACNC,IAAI,eAAe,CAAC,GACbA,IAAI,eAAe,CAAC,IAEnC,CACA,MAAOH,EAAO,CACV,SAAY,CAAC,oCAAqCA,GAClD,EAAYA,EAChB,QACQ,CACJ,EAAW,GACf,CACJ,EAAG,CAAC,EAAa,EAAS,EAAU,EACpC,gBAAU,KACN,GACJ,EAAG,CAAC,EAAa,EACjB,gBAAU,KACN,EAAa,EAAa,EAAO,GACrC,EAAG,CAAC,EAAO,EAAa,EAAa,EACrC,IAAM,EAAM,EAAM,GAAG,CAAC,QAChB,EAAM,GAAG,CAAC,QAAU,UACpB,eACN,OAAQ,eAAmB,CAAC,MAAO,CAAE,UAAW,CAAC,EAAE,GAAU,CAAC,OAAO,EAAE,GAAwB,GAAG,CAAC,CAAE,GAAG,CAAgB,AAAC,EACrH,eAAmB,CAAC,GAAI,CAAE,CAAE,SAAU,KAAc,EAAiB,UAAY,eAAmB,CAAC,GAAe,CAAE,CAAE,KAAM,KAAa,AAAC,EAAI,EAAG,EAC/I,eAAmB,CAAC,MAAO,CAAE,UAAW,mBAAoB,EAAG,GAE3D,eAAmB,CAAC,MAAO,CAAE,IAAK,EAAQ,IAAK,EAAK,QAAS,EAAY,IAAI,CAAC,OAAM,IACpG,CACA,WAAe,C,wDCnFf,IAAM,EAAa,Y"}