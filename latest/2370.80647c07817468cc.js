"use strict";(self.webpackChunk_terrestris_shogun_gis_client=self.webpackChunk_terrestris_shogun_gis_client||[]).push([["2370"],{64289:function(e,t,r){r.r(t);var a=r(12038),l=r(54388),n=r(39660),s=r(20741),i=r(23560),o=r.n(i),u=r(49179),g=r(21730),c=r.n(g),f=r(86977),y=r(9948),d=r.n(y),p=r(35703);let h=`${p.M}layertree`;t.default=({className:e,layerGroup:t,nodeTitleRenderer:r,filterFunction:i,onLayerVisibilityChanged:g,checkable:p=!0,draggable:k=!0,...L})=>{let[b,C]=(0,y.useState)([]),[Z,v]=(0,y.useState)([]),m=(0,n.Z)(),A=(0,y.useCallback)(()=>{if(!m)return[];let e=(t?l.Z.getAllLayers(t):l.Z.getAllLayers(m)).filter(e=>!(e instanceof c())&&e.getVisible());return i&&(e=e.filter(i)),e.map(u.getUid)},[i,t,m]),_=(0,y.useCallback)(e=>o()(r)?r(e):e.get("name"),[r]),E=(0,y.useCallback)(e=>{let t;if(m&&(!i||0!==[e].filter(i).length)){if(e instanceof c()){let r=e.getLayers().getArray();i&&(r=r.filter(i)),t=r.map(e=>E(e)).filter(e=>void 0!==e).toReversed()}return{key:(0,u.getUid)(e),title:d().createElement("div",{draggable:!0,onClick:e=>e.stopPropagation()},_(e)),className:l.Z.layerInResolutionRange(e,m)?"":"out-of-range",children:t}}},[m,_,i]),B=(0,y.useCallback)(()=>m?(t||m.getLayerGroup()).getLayers().getArray().map(e=>E(e)).filter(e=>void 0!==e).toReversed():[],[t,m,E]),I=(0,y.useCallback)(()=>{v(B())},[B]),P=(0,y.useCallback)((e,t)=>{e instanceof c()?e.getLayers().forEach(e=>{P(e,t)}):e.setVisible(t)},[]),U=(0,y.useCallback)(()=>{C(A())},[A]),w=(0,y.useCallback)(()=>{v(B()),U()},[U,B]);(0,y.useEffect)(()=>{w()},[w]);let N=(0,y.useCallback)(e=>{if(i&&0===[e].filter(i).length)return[];let t=[];if(t.push(e.on("propertychange",w)),e instanceof c()){let r=e.getLayers();for(let a of(t.push(r.on("add",w)),t.push(r.on("remove",w)),t.push(e.on("change:layers",w)),r.getArray()))t.push(...N(a))}else t.push(e.on("change:visible",U));return t},[i,w,U]),R=(0,y.useCallback)(()=>m?N(t||m.getLayerGroup()):[],[t,m,N]);(0,y.useEffect)(()=>{let e=R();return()=>{(0,f.unByKey)(e)}},[Z,R]),(0,y.useEffect)(()=>{if(!m)return;let e=m.getView().on("change:resolution",I);return()=>{(0,f.unByKey)(e)}},[m,I]);let D=(0,y.useCallback)((e,t)=>{if(!m)return;let r=t.node.key,n=t.checked;if(!r)return;let s=l.Z.getLayerByOlUid(m,r);if(!s)return void a.Z.error("Layer is not defined");P(s,n),o()(g)&&g(s,n)},[m,P,g]),K=(0,y.useCallback)(e=>{let t=e.node.key,r=e.dragNode.key,n=e.node.pos.split("-"),s=e.dropPosition,i=s-parseInt(n[n.length-1],10);if(!m)return;let o=l.Z.getLayerByOlUid(m,r);if(!o)return void a.Z.error("dragLayer is not defined");let u=l.Z.getLayerByOlUid(m,t);if(!u)return void a.Z.error("dropLayer is not defined");let g=l.Z.getLayerPositionInfo(o,m);if(!g||!g?.groupLayer)return;let f=l.Z.getLayerPositionInfo(u,m);if(!f||!f?.groupLayer)return;let y=g.groupLayer.getLayers(),d=f.groupLayer.getLayers();y.remove(o);let p=d.getArray().findIndex(e=>e===u);-1===i?s===d.getLength()-1?d.push(o):d.insertAt(p+1,o):0===i?u instanceof c()&&u.getLayers().push(o):1===i&&d.insertAt(p,o)},[m]),O=(0,y.useCallback)(e=>{let t=e.dropNode;return!(0===e.dropPosition&&!t.children)},[]),V=e?`${e} ${h}`:h;return d().createElement(s.Z,{className:V,checkedKeys:b,onCheck:D,onDrop:K,allowDrop:O,selectable:!1,checkable:p,draggable:k,treeData:Z,...L})}},35703:function(e,t,r){r.d(t,{M:function(){return a}});let a="react-geo-"}}]);
//# sourceMappingURL=2370.80647c07817468cc.js.map