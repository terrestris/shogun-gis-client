"use strict";(self.webpackChunk_terrestris_shogun_gis_client=self.webpackChunk_terrestris_shogun_gis_client||[]).push([["8398"],{85215:function(e,t,i){i.r(t),i.d(t,{ObjectEvent:function(){return u}});var r=i(8959),s=i(52073),n=i(43354),o=i(53495),l=i(94092);class u extends n.default{constructor(e,t,i){super(e),this.key=t,this.oldValue=i}}class a extends s.default{constructor(e){super(),this.on,this.once,this.un,(0,l.getUid)(this),this.values_=null,void 0!==e&&this.setProperties(e)}get(e){let t;return this.values_&&this.values_.hasOwnProperty(e)&&(t=this.values_[e]),t}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(e,t){let i;i=`change:${e}`,this.hasListener(i)&&this.dispatchEvent(new u(i,e,t)),i=r.A.PROPERTYCHANGE,this.hasListener(i)&&this.dispatchEvent(new u(i,e,t))}addChangeListener(e,t){this.addEventListener(`change:${e}`,t)}removeChangeListener(e,t){this.removeEventListener(`change:${e}`,t)}set(e,t,i){let r=this.values_||(this.values_={});if(i)r[e]=t;else{let i=r[e];r[e]=t,i!==t&&this.notify(e,i)}}setProperties(e,t){for(let i in e)this.set(i,e[i],t)}applyProperties(e){e.values_&&Object.assign(this.values_||(this.values_={}),e.values_)}unset(e,t){if(this.values_&&e in this.values_){let i=this.values_[e];delete this.values_[e],(0,o.p)(this.values_)&&(this.values_=null),t||this.notify(e,i)}}}t.default=a},8959:function(e,t){t.A={PROPERTYCHANGE:"propertychange"}},52073:function(e,t,i){i.r(t),i.d(t,{unByKey:function(){return l}});var r=i(55506),s=i(78081),n=i(17353);class o extends s.A{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(r.default.CHANGE)}getRevision(){return this.revision_}onInternal(e,t){if(Array.isArray(e)){let i=e.length,r=Array(i);for(let s=0;s<i;++s)r[s]=(0,n.KT)(this,e[s],t);return r}return(0,n.KT)(this,e,t)}onceInternal(e,t){let i;if(Array.isArray(e)){let r=e.length;i=Array(r);for(let s=0;s<r;++s)i[s]=(0,n.Jz)(this,e[s],t)}else i=(0,n.Jz)(this,e,t);return t.ol_key=i,i}unInternal(e,t){let i=t.ol_key;if(i)l(i);else if(Array.isArray(e))for(let i=0,r=e.length;i<r;++i)this.removeEventListener(e[i],t);else this.removeEventListener(e,t)}}function l(e){if(Array.isArray(e))for(let t=0,i=e.length;t<i;++t)(0,n.JH)(e[t]);else(0,n.JH)(e)}o.prototype.on,o.prototype.once,o.prototype.un,t.default=o},17229:function(e,t,i){i.d(t,{v:function(){return r}});function r(e,t){if(!e)throw Error(t)}},17353:function(e,t,i){i.d(t,{JH:function(){return o},Jz:function(){return n},KT:function(){return s}});var r=i(53495);function s(e,t,i,r,s){if(s){let s=i;i=function(n){return e.removeEventListener(t,i),s.call(r??this,n)}}else r&&r!==e&&(i=i.bind(r));let n={target:e,type:t,listener:i};return e.addEventListener(t,i),n}function n(e,t,i,r){return s(e,t,i,r,!0)}function o(e){e&&e.target&&(e.target.removeEventListener(e.type,e.listener),(0,r.I)(e))}},13931:function(e,t,i){function r(e,t,i,r,s,n,o){let l=new XMLHttpRequest;l.open("GET","function"==typeof e?e(i,r,s):e,!0),"arraybuffer"==t.getType()&&(l.responseType="arraybuffer"),l.withCredentials=!1,l.onload=function(e){if(!l.status||l.status>=200&&l.status<300){let e=t.getType();try{let r;"text"==e||"json"==e?r=l.responseText:"xml"==e?r=l.responseXML||l.responseText:"arraybuffer"==e&&(r=l.response),r?n(t.readFeatures(r,{extent:i,featureProjection:s}),t.readProjection(r)):o()}catch{o()}}else o()},l.onerror=o,l.send()}function s(e,t){return function(i,s,n,o,l){r(e,t,i,s,n,(e,t)=>{this.addFeatures(e),void 0!==o&&o(e)},()=>{this.changed(),void 0!==l&&l()})}}i.d(t,{m8:function(){return r},nF:function(){return s}})},67759:function(e,t,i){i.r(t),i.d(t,{default:function(){return E},defaultLoadFunction:function(){return x}});var r=i(74255),s=i(31644),n=i(84674),o=i(94092);let l=[];class u extends s.A{constructor(e,t,i,r,s){super(e,t,{transition:0}),this.context_=null,this.executorGroups={},this.loadingSourceTiles=0,this.hitDetectionImageData={},this.replayState_={},this.sourceTiles=[],this.errorTileKeys={},this.wantedResolution,this.getSourceTiles=r.bind(void 0,this),this.removeSourceTiles_=s,this.wrappedTileCoord=i}getContext(){return this.context_||(this.context_=(0,n.Y)(1,1,l)),this.context_}hasContext(){return!!this.context_}getImage(){return this.hasContext()?this.getContext().canvas:null}getReplayState(e){let t=(0,o.getUid)(e);return t in this.replayState_||(this.replayState_[t]={dirty:!1,renderedRenderOrder:null,renderedResolution:NaN,renderedRevision:-1,renderedTileResolution:NaN,renderedTileRevision:-1,renderedTileZ:-1}),this.replayState_[t]}load(){this.getSourceTiles()}release(){this.context_&&((0,n.Yg)(this.context_),l.push(this.context_.canvas),this.context_=null),this.removeSourceTiles_(this),this.sourceTiles.length=0,super.release()}}var a=i(6419),h=i(55506),c=i(85752),d=i(13931),f=i(53495),g=i(58318),p=i(5245),v=i(76855),T=i(53800),_=i(97063);class y extends _.A{constructor(e){const t=e.projection||"EPSG:3857",i=e.extent||(0,T.extentFromProjection)(t),r=e.tileGrid||(0,T.createXYZ)({extent:i,maxResolution:e.maxResolution,maxZoom:void 0!==e.maxZoom?e.maxZoom:22,minZoom:e.minZoom,tileSize:e.tileSize||512});super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,interpolate:!0,projection:t,state:e.state,tileGrid:r,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:x,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:void 0===e.wrapX||e.wrapX,transition:e.transition,zDirection:void 0===e.zDirection?1:e.zDirection}),this.format_=e.format?e.format:null,this.tileKeysBySourceTileUrl_={},this.sourceTiles_={},this.overlaps_=void 0==e.overlaps||e.overlaps,this.tileClass=e.tileClass?e.tileClass:a.A,this.tileGrids_={}}getOverlaps(){return this.overlaps_}getSourceTiles(e,t,i){if(i.getState()===r.default.IDLE){i.setState(r.default.LOADING);let s=i.wrappedTileCoord,n=this.getTileGridForProjection(t),o=n.getTileCoordExtent(s),l=s[0],u=n.getResolution(l);(0,c.buffer)(o,-u,o);let a=this.projection;t&&this.projection&&!(0,g.equivalent)(t,a)&&(o=(0,g.transformExtent)(o,t,a));let d=this.tileGrid,p=d.getExtent();p&&(0,c.getIntersection)(o,p,o);let v=u;t&&a&&!(0,g.equivalent)(t,a)&&(v=u/a.getMetersPerUnit()/t.getMetersPerUnit());let T=d.getZForResolution(v,this.zDirection);d.forEachTileCoord(o,T,s=>{let n=this.tileUrlFunction(s,e,t);this.sourceTiles_[n]||(this.sourceTiles_[n]=new this.tileClass(s,n?r.default.IDLE:r.default.EMPTY,n,this.format_,this.tileLoadFunction));let o=this.sourceTiles_[n];i.sourceTiles.push(o),this.tileKeysBySourceTileUrl_[n]||(this.tileKeysBySourceTileUrl_[n]=[]),this.tileKeysBySourceTileUrl_[n].push(i.getKey());let l=o.getState();if(l<r.default.LOADED){let e=t=>{this.handleTileChange(t);let s=o.getState();if(s===r.default.LOADED||s===r.default.ERROR){let t=o.getKey();t in i.errorTileKeys?o.getState()===r.default.LOADED&&delete i.errorTileKeys[t]:i.loadingSourceTiles--,s===r.default.ERROR?i.errorTileKeys[t]=!0:o.removeEventListener(h.default.CHANGE,e),0===i.loadingSourceTiles&&i.setState((0,f.p)(i.errorTileKeys)?r.default.LOADED:r.default.ERROR)}};o.addEventListener(h.default.CHANGE,e),i.loadingSourceTiles++}l===r.default.IDLE&&(o.extent=d.getTileCoordExtent(s),o.projection=this.projection,o.resolution=d.getResolution(s[0]),o.load())}),i.loadingSourceTiles||i.setState(i.sourceTiles.some(e=>e.getState()===r.default.ERROR)?r.default.ERROR:r.default.LOADED)}return i.sourceTiles}removeSourceTiles(e){let t=e.getKey(),i=e.sourceTiles;for(let e=0,r=i.length;e<r;++e){let r=i[e].getTileUrl();if(!this.tileKeysBySourceTileUrl_[r])return;let s=this.tileKeysBySourceTileUrl_[r].indexOf(t);-1!==s&&(this.tileKeysBySourceTileUrl_[r].splice(s,1),0===this.tileKeysBySourceTileUrl_[r].length&&(delete this.tileKeysBySourceTileUrl_[r],delete this.sourceTiles_[r]))}}getTile(e,t,i,s,n){let o=[e,t,i],l=this.getTileCoordForTileUrlFunction(o,n),a=this.getTileGrid().getExtent(),h=this.projection,d=this.getTileGridForProjection(n);if(l&&a){let t=d.getTileCoordExtent(l);(0,c.buffer)(t,-d.getResolution(e),t),(0,c.intersects)(a,!n||!h||(0,g.equivalent)(n,h)?t:(0,g.transformExtent)(t,n,h))||(l=null)}let f=!0;if(null!==l){let t=this.tileGrid,i=d.getResolution(e),r=i;n&&h&&!(0,g.equivalent)(n,h)&&(r=i/h.getMetersPerUnit()/n.getMetersPerUnit());let o=t.getZForResolution(r,1),u=d.getTileCoordExtent(l);(0,c.buffer)(u,-i,u),t.forEachTileCoord(!n||!h||(0,g.equivalent)(n,h)?u:(0,g.transformExtent)(u,n,h),o,e=>{f=f&&!this.tileUrlFunction(e,s,h)})}let p=new u(o,f?r.default.EMPTY:r.default.IDLE,l,this.getSourceTiles.bind(this,s,n),this.removeSourceTiles.bind(this));return p.key=this.getKey(),p}getTileGridForProjection(e){let t=e.getCode(),i=this.tileGrids_[t];if(!i){let r=this.projection;if(null!==r&&!(0,g.equivalent)(r,e))return(0,T.getForProjection)(e);let s=this.tileGrid,n=s.getResolutions().slice(),o=n.map(function(e,t){return s.getOrigin(t)}),l=n.map(function(e,t){return s.getTileSize(t)});for(let e=n.length;e<43;++e)n.push(n[e-1]/2),o.push(o[e-1]),l.push(l[e-1]);i=new v.default({extent:s.getExtent(),origins:o,resolutions:n,tileSizes:l}),this.tileGrids_[t]=i}return i}getTilePixelRatio(e){return e}getTilePixelSize(e,t,i){let r=this.getTileGridForProjection(i),s=(0,p.xq)(r.getTileSize(e),this.tmpSize);return[Math.round(s[0]*t),Math.round(s[1]*t)]}setOverlaps(e){this.overlaps_=e,this.changed()}}var E=y;function x(e,t){e.setLoader(function(i,r,s){(0,d.m8)(t,e.getFormat(),i,r,s,e.onLoad.bind(e),e.onError.bind(e))})}}}]);
//# sourceMappingURL=8398.c85dae5663ab4d57.js.map