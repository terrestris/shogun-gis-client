{"version":3,"file":"1057.0770ac4a448b85b9.js","sources":["webpack://@terrestris/shogun-gis-client/./src/hooks/useAppDispatch.ts","webpack://@terrestris/shogun-gis-client/./src/hooks/useAppSelector.ts","webpack://@terrestris/shogun-gis-client/./src/components/AddLayerModal/index.tsx","webpack://@terrestris/shogun-gis-client/./src/hooks/usePlugins.ts","webpack://@terrestris/shogun-gis-client/./src/components/BasicMapComponent/index.tsx","webpack://@terrestris/shogun-gis-client/./src/plugin/index.ts","webpack://@terrestris/shogun-gis-client/./src/components/CookieBanner/index.tsx","webpack://@terrestris/shogun-gis-client/./src/hooks/useExecuteWfsTransaction.ts","webpack://@terrestris/shogun-gis-client/./src/components/FileUpload/index.tsx","webpack://@terrestris/shogun-gis-client/./src/hooks/useConvertImageUrl.ts","webpack://@terrestris/shogun-gis-client/./src/components/ImageUpload/index.tsx","webpack://@terrestris/shogun-gis-client/./src/components/ToolMenu/FeatureInfo/FeatureInfoForm/index.tsx","webpack://@terrestris/shogun-gis-client/./src/components/ReferenceTable/index.tsx","webpack://@terrestris/shogun-gis-client/./src/components/DisplayField/index.tsx","webpack://@terrestris/shogun-gis-client/./src/components/EditFeatureDrawer/EditReferenceTable/index.tsx","webpack://@terrestris/shogun-gis-client/./src/components/EditFeatureDrawer/EditFeatureForm/index.tsx","webpack://@terrestris/shogun-gis-client/./src/hooks/useExecuteWfsDescribeFeatureType.ts","webpack://@terrestris/shogun-gis-client/./src/hooks/useWriteWfsTransaction.ts","webpack://@terrestris/shogun-gis-client/./src/components/MapDrawer/index.tsx","webpack://@terrestris/shogun-gis-client/./src/hooks/useExecuteGetFeature.ts","webpack://@terrestris/shogun-gis-client/./src/hooks/useGetFitPadding.ts","webpack://@terrestris/shogun-gis-client/./src/components/Toolbar/index.tsx","webpack://@terrestris/shogun-gis-client/./src/components/EditFeatureDrawer/EditFeatureGeometryToolbar/index.tsx","webpack://@terrestris/shogun-gis-client/./src/components/EditFeatureDrawer/EditFeatureTabs/index.tsx","webpack://@terrestris/shogun-gis-client/./src/components/EditFeatureDrawer/DeleteButton/index.tsx","webpack://@terrestris/shogun-gis-client/./src/components/EditFeatureDrawer/ResetButton/index.tsx","webpack://@terrestris/shogun-gis-client/./src/components/FeedbackIcon/index.tsx","webpack://@terrestris/shogun-gis-client/./src/components/EditFeatureDrawer/SaveButton/index.tsx","webpack://@terrestris/shogun-gis-client/./src/components/EditFeatureDrawer/EditFeatureToolbar/index.tsx","webpack://@terrestris/shogun-gis-client/./src/components/EditFeatureDrawer/EditFeatureFullForm/index.tsx","webpack://@terrestris/shogun-gis-client/./src/components/EditFeatureDrawer/EditFeatureSwitch/index.tsx","webpack://@terrestris/shogun-gis-client/./src/hooks/useExecuteWfsTransactionLock.ts","webpack://@terrestris/shogun-gis-client/./src/hooks/useGetFeatureInfo.ts","webpack://@terrestris/shogun-gis-client/./src/components/EditFeatureDrawer/index.tsx","webpack://@terrestris/shogun-gis-client/./src/components/ApplicationInfo/index.tsx","webpack://@terrestris/shogun-gis-client/./src/hooks/useVersion.ts","webpack://@terrestris/shogun-gis-client/./src/components/Footer/index.tsx","webpack://@terrestris/shogun-gis-client/./src/components/DocumentationButton/index.tsx","webpack://@terrestris/shogun-gis-client/./src/components/MultiSearch/index.tsx","webpack://@terrestris/shogun-gis-client/./src/components/SearchField/index.tsx","webpack://@terrestris/shogun-gis-client/./src/hooks/searchEngines/useWfsSearchEngine.ts","webpack://@terrestris/shogun-gis-client/./src/hooks/searchEngines/useSolrSearchEngine.ts","webpack://@terrestris/shogun-gis-client/./src/hooks/useExecuteSolrQuery.ts","webpack://@terrestris/shogun-gis-client/./src/hooks/searchEngines/useNominatimSearchEngine.ts","webpack://@terrestris/shogun-gis-client/./src/utils/generateSolrQuery.ts","webpack://@terrestris/shogun-gis-client/./src/components/UserChip/index.tsx","webpack://@terrestris/shogun-gis-client/./src/components/UserMenu/index.tsx","webpack://@terrestris/shogun-gis-client/./src/utils/getGravatarUrl.ts","webpack://@terrestris/shogun-gis-client/./src/components/Header/index.tsx","webpack://@terrestris/shogun-gis-client/./src/components/LayerDetailsModal/LayerConfiguration/index.tsx","webpack://@terrestris/shogun-gis-client/./src/components/LayerDetailsModal/LayerDetails/index.tsx","webpack://@terrestris/shogun-gis-client/./src/components/LayerDetailsModal/index.tsx","webpack://@terrestris/shogun-gis-client/./src/components/MapToolbar/index.tsx","webpack://@terrestris/shogun-gis-client/./src/components/SearchResultDrawer/AttributeValueCell/index.tsx","webpack://@terrestris/shogun-gis-client/./src/components/SearchResultDrawer/index.tsx","webpack://@terrestris/shogun-gis-client/./src/components/ToolMenu/Draw/StylingDrawerButton/StylingComponent/index.tsx","webpack://@terrestris/shogun-gis-client/./src/components/StylingDrawer/index.tsx","webpack://@terrestris/shogun-gis-client/./src/components/LanguageSelector/index.tsx","webpack://@terrestris/shogun-gis-client/./src/components/Permalink/index.tsx","webpack://@terrestris/shogun-gis-client/./src/components/PrintForm/Serializer/SHOGunMapFishPrintV3WMSSerializer.ts","webpack://@terrestris/shogun-gis-client/./src/components/PrintForm/Serializer/SHOGunMapFishPrintV3TiledWMSSerializer.ts","webpack://@terrestris/shogun-gis-client/./src/components/PrintForm/CustomFieldInput/index.tsx","webpack://@terrestris/shogun-gis-client/./src/components/PrintForm/LayoutSelect/index.tsx","webpack://@terrestris/shogun-gis-client/./src/components/PrintForm/OutputFormatSelect/index.tsx","webpack://@terrestris/shogun-gis-client/./src/components/PrintForm/ResolutionSelect/index.tsx","webpack://@terrestris/shogun-gis-client/./src/components/PrintForm/ScaleSelect/index.tsx","webpack://@terrestris/shogun-gis-client/./src/components/PrintForm/Shared/Shared.ts","webpack://@terrestris/shogun-gis-client/./src/components/PrintForm/index.tsx","webpack://@terrestris/shogun-gis-client/./src/components/ToolMenu/Draw/Attributions/AttributionRow/index.tsx","webpack://@terrestris/shogun-gis-client/./src/components/ToolMenu/Draw/Attributions/index.tsx","webpack://@terrestris/shogun-gis-client/./src/components/ToolMenu/Draw/DeleteAllButton/index.tsx","webpack://@terrestris/shogun-gis-client/./src/components/ToolMenu/Draw/ImportDataModal/index.tsx","webpack://@terrestris/shogun-gis-client/./src/components/ToolMenu/Draw/StylingDrawerButton/index.tsx","webpack://@terrestris/shogun-gis-client/./src/components/ToolMenu/Draw/index.tsx","webpack://@terrestris/shogun-gis-client/./src/hooks/useHighlightVectorLayer.ts","webpack://@terrestris/shogun-gis-client/./src/components/ToolMenu/FeatureInfo/PaginationToolbar/index.tsx","webpack://@terrestris/shogun-gis-client/./src/components/ToolMenu/FeatureInfo/FeatureInfoTabs/index.tsx","webpack://@terrestris/shogun-gis-client/./src/components/ToolMenu/FeatureInfo/FeaturePropertyGrid/index.tsx","webpack://@terrestris/shogun-gis-client/./src/components/ToolMenu/FeatureInfo/index.tsx","webpack://@terrestris/shogun-gis-client/./src/components/WmsTimeSlider/index.tsx","webpack://@terrestris/shogun-gis-client/./src/components/ToolMenu/LayerTree/LayerTreeContextMenu/index.tsx","webpack://@terrestris/shogun-gis-client/./src/components/ToolMenu/LayerTree/LoadingIndicator/index.tsx","webpack://@terrestris/shogun-gis-client/./src/components/ToolMenu/LayerTree/index.tsx","webpack://@terrestris/shogun-gis-client/./src/components/ToolMenu/Measure/index.tsx","webpack://@terrestris/shogun-gis-client/./src/components/ToolMenu/index.tsx","webpack://@terrestris/shogun-gis-client/./src/components/UploadDataModal/index.tsx","webpack://@terrestris/shogun-gis-client/./src/App.tsx","webpack://@terrestris/shogun-gis-client/./src/hooks/useRestoreTransientLayers.ts","webpack://@terrestris/shogun-gis-client/./src/hooks/useQueryParams.ts"],"sourcesContent":["import {\n  useDispatch\n} from 'react-redux';\n\nimport type {\n  AppDispatch\n} from '../store/store';\n\nexport const useAppDispatch = () => useDispatch<AppDispatch>();\n\nexport default useAppDispatch;\n","import {\n  TypedUseSelectorHook,\n  useSelector\n} from 'react-redux';\n\nimport type {\n  RootState\n} from '../store/store';\n\nexport const useAppSelector: TypedUseSelectorHook<RootState> = useSelector;\n\nexport default useAppSelector;\n","import React, {\n  useState,\n  useEffect\n} from 'react';\n\nimport {\n  Input,\n  Modal,\n  ModalProps,\n  notification,\n  Select,\n  Table,\n  Typography\n} from 'antd';\n\nimport {\n  InputStatus\n} from 'antd/lib/_util/statusUtils';\n\nimport {\n  getUid\n} from 'ol';\nimport OlLayerGroup from 'ol/layer/Group';\nimport ImageLayer from 'ol/layer/Image';\nimport TileLayer from 'ol/layer/Tile';\nimport ImageWMSSource from 'ol/source/ImageWMS';\nimport TileWMSSource from 'ol/source/TileWMS';\n\nimport {\n  useTranslation\n} from 'react-i18next';\n\nimport Logger from '@terrestris/base-util/dist/Logger';\nimport { UrlUtil } from '@terrestris/base-util/dist/UrlUtil/UrlUtil';\nimport CapabilitiesUtil from '@terrestris/ol-util/dist/CapabilitiesUtil/CapabilitiesUtil';\nimport { MapUtil } from '@terrestris/ol-util/dist/MapUtil/MapUtil';\n\nimport SimpleButton from '@terrestris/react-geo/dist/Button/SimpleButton/SimpleButton';\nimport {\n  useMap\n} from '@terrestris/react-util/dist/Hooks/useMap/useMap';\n\nimport useAppDispatch from '../../hooks/useAppDispatch';\nimport useAppSelector from '../../hooks/useAppSelector';\nimport {\n  hide\n} from '../../store/addLayerModal';\n\nimport './index.less';\n\nexport type AddLayerModalProps = Partial<ModalProps>;\n\nexport const AddLayerModal: React.FC<AddLayerModalProps> = ({\n  ...restProps\n}): JSX.Element => {\n  const [loading, setLoading] = useState(false);\n  const [layers, setLayers] = useState<(ImageLayer<ImageWMSSource> | TileLayer<TileWMSSource>)[]>([]);\n  const [selectedRowKeys, setSelectedRowKeys] = useState<React.Key[]>([]);\n  const [validationStatus, setValidationStatus] = useState<InputStatus>('');\n  const [url, setUrl] = useState('https://sgx.geodatenzentrum.de/wms_topplus_open');\n  const [sanitizedUrl, setSanitizedUrl] = useState<string>();\n  const [version, setVersion] = useState<string>('1.3.0');\n\n  const isModalVisible = useAppSelector(state => state.addLayerModal.visible);\n\n  const dispatch = useAppDispatch();\n\n  const map = useMap();\n\n  const {\n    t\n  } = useTranslation();\n\n  useEffect(() => {\n    if (!isModalVisible) {\n      return;\n    }\n    setSanitizedUrl(UrlUtil.createValidGetCapabilitiesRequest(url, 'WMS', version));\n  }, [version, isModalVisible, url]);\n\n  const onUrlChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n    const value = evt.target.value;\n    setValidationStatus(UrlUtil.isValid(value.trim()) ? '' : 'error');\n    setUrl(evt.target.value);\n  };\n\n  const getCapabilities = async () => {\n    if (!sanitizedUrl) {\n      return;\n    }\n    try {\n      setLoading(true);\n\n      const capabilities = await CapabilitiesUtil.getWmsCapabilities(sanitizedUrl);\n      const externalLayers = CapabilitiesUtil.getLayersFromWmsCapabilities(capabilities, 'Title');\n\n      setLayers(externalLayers);\n    } catch (error) {\n      notification.error({\n        message: t('AddLayerModal.errorMessage'),\n        description: t('AddLayerModal.errorDescription')\n      });\n\n      Logger.error(error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const closeModal = () => {\n    setSelectedRowKeys([]);\n    setLayers([]);\n    dispatch(hide());\n  };\n\n  const onAddSelected = () => {\n    const layersToAdd = layers.filter(layer => selectedRowKeys.includes(getUid(layer)));\n    addLayers(layersToAdd);\n  };\n\n  const onAddAll = () => {\n    addLayers(layers);\n  };\n\n  const addLayers = (layersToAdd: (ImageLayer<ImageWMSSource> | TileLayer<TileWMSSource>)[]) => {\n    if (!map) {\n      return;\n    }\n\n    const targetFolderName = t('AddLayerModal.externalWmsFolder');\n    let targetGroup = MapUtil.getLayerByName(map, targetFolderName) as OlLayerGroup;\n    const targetGroupAvailableInMap = !!targetGroup;\n\n    if (!targetGroup) {\n      targetGroup = new OlLayerGroup({\n        layers: []\n      });\n      targetGroup.set('name', targetFolderName);\n    }\n\n    layersToAdd.forEach(layerToAdd => {\n      if (!targetGroup.getLayers().getArray().includes(layerToAdd)) {\n        layerToAdd.set('isExternalLayer', true);\n\n        let layerUrl: string | undefined;\n        if (layerToAdd instanceof ImageLayer) {\n          layerUrl = layerToAdd.getSource()?.getUrl();\n        }\n\n        if (layerToAdd instanceof TileLayer) {\n          const urls = layerToAdd.getSource()?.getUrls();\n          layerUrl = urls?.length === 1 ? urls[0] : undefined;\n        }\n\n        const layerConfig = {\n          name: layerToAdd.get('name'),\n          type: layerToAdd instanceof TileLayer ? 'TILEWMS' : 'WMS',\n          opacity: layerToAdd.getOpacity(),\n          sourceConfig: {\n            layerNames: layerToAdd.getSource()?.getParams().LAYERS,\n            url: layerUrl,\n            useBearerToken: false\n          }\n        };\n        layerToAdd.set('layerConfig', layerConfig);\n        targetGroup.getLayers().push(layerToAdd);\n      }\n    });\n\n    if (!targetGroupAvailableInMap) {\n      const existingGroups = map.getLayerGroup().getLayers();\n      existingGroups.insertAt(existingGroups?.getLength() || 0, targetGroup);\n    }\n\n    closeModal();\n  };\n\n  return (\n    <Modal\n      className=\"add-layer-modal\"\n      title={t('AddLayerModal.title')}\n      open={isModalVisible}\n      onCancel={closeModal}\n      width={600}\n      footer={[\n        <SimpleButton\n          aria-label='add-all'\n          key=\"add-all\"\n          disabled={layers?.length < 1}\n          onClick={onAddAll}\n        >\n          {t('AddLayerModal.addAllLayers')}\n        </SimpleButton>,\n        <SimpleButton\n          aria-label='add-selected'\n          key=\"add-selected\"\n          disabled={selectedRowKeys?.length < 1}\n          onClick={onAddSelected}\n        >\n          {t('AddLayerModal.addSelectedLayers')}\n        </SimpleButton>\n      ]}\n      {...restProps}\n    >\n      <span>{t('AddLayerModal.requestWmsGetCapabilitiesInstruction')}</span>\n      <Input.Search\n        aria-label='input-search'\n        className='url-input'\n        placeholder={t('AddLayerModal.inputPlaceholder')}\n        value={url}\n        onChange={onUrlChange}\n        onSearch={getCapabilities}\n        status={validationStatus}\n        enterButton={true}\n        addonBefore={\n          <Select\n            aria-label='select-version'\n            defaultValue='1.3.0'\n            onChange={setVersion}\n            options={[\n              {\n                value: '1.3.0',\n                label: `${t('AddLayerModal.version')} 1.3.0`\n              },\n              {\n                value: '1.1.1',\n                label: `${t('AddLayerModal.version')} 1.1.1`\n              }\n            ]}\n          >\n          </Select>\n        }\n      />\n      {\n        validationStatus !== '' &&\n        <Typography className='error'>\n          {t('AddLayerModal.invalidUrlErrorMsg')}\n        </Typography>\n      }\n      <Table\n        aria-label='wms-table'\n        loading={loading}\n        columns={[\n          {\n            title: t('AddLayerModal.columnTitle'),\n            render: (text: any, record: any) => {\n              return record.get('title');\n            }\n          }\n        ]}\n        scroll={{\n          y: 250\n        }}\n        rowKey={(record: any) => getUid(record)}\n        rowSelection={{\n          selectedRowKeys,\n          onChange: setSelectedRowKeys\n        }}\n        pagination={false}\n        dataSource={layers}\n      />\n    </Modal>\n  );\n};\n\nexport default AddLayerModal;\n","import { useContext } from 'react';\n\nimport PluginContext from '../context/PluginContext';\n\nimport { ClientPluginInternal } from '../plugin';\n\nexport const usePlugins = (): ClientPluginInternal[] => {\n  return useContext(PluginContext);\n};\n\nexport default usePlugins;\n","import React, {\n  useEffect\n} from 'react';\n\nimport { ObjectEvent as OlObjectEvent } from 'ol/Object';\n\nimport {\n  useTranslation\n} from 'react-i18next';\n\nimport { MapUtil } from '@terrestris/ol-util/dist/MapUtil/MapUtil';\n\nimport {\n  BackgroundLayerChooser\n} from '@terrestris/react-geo/dist/BackgroundLayerChooser/BackgroundLayerChooser';\n\nimport {\n  MapComponent,\n  MapComponentProps\n} from '@terrestris/react-geo/dist/Map/MapComponent/MapComponent';\nimport { useMap } from '@terrestris/react-util/dist/Hooks/useMap/useMap';\n\nimport useAppSelector from '../../hooks/useAppSelector';\n\nimport usePlugins from '../../hooks/usePlugins';\n\nimport {\n  isMapIntegration\n} from '../../plugin';\n\nimport './index.less';\n\nexport const BasicMapComponent: React.FC<Partial<MapComponentProps>> = ({\n  ...restProps\n}): JSX.Element => {\n  const map = useMap();\n  const plugins = usePlugins();\n\n  const {\n    t,\n    i18n\n  } = useTranslation();\n\n  const blcVisible = useAppSelector(state => state.backgroundLayerChooser.visible);\n  const allowEmptyBackground = useAppSelector(state => state.backgroundLayerChooser.allowEmptyBackground);\n\n  /**\n   * Updates external layer group name when language changes.\n   */\n  useEffect(() => {\n    if (!map) {\n      return;\n    }\n\n    const targetGroups = MapUtil.getLayersByProperty(map, 'isExternalLayerGroup', true);\n    if (targetGroups?.length !== 1) {\n      return;\n    }\n    const targetGroup = targetGroups[0];\n    const oldName = targetGroups[0].get('name');\n    targetGroup.set('name', t('AddLayerModal.externalWmsFolder'));\n    const changeEvent = new OlObjectEvent('change:layers', 'name', oldName);\n    targetGroup.dispatchEvent(changeEvent);\n  }, [i18n.language, map, t]);\n\n  const pluginComponents: JSX.Element[] = [];\n\n  if (plugins) {\n    plugins.forEach(plugin => {\n      if (isMapIntegration(plugin.integration)) {\n        const {\n          key,\n          wrappedComponent: WrappedPluginComponent\n        } = plugin;\n\n        pluginComponents.push(\n          <WrappedPluginComponent\n            key={key}\n          />\n        );\n      }\n    });\n  }\n\n  if (!map) {\n    return <></>;\n  }\n\n  return (\n    <MapComponent\n      map={map}\n      {...restProps}\n    >\n      {blcVisible &&\n        <BackgroundLayerChooser\n          layers={map.getAllLayers().filter(l => l.get('isBackgroundLayer') === true).reverse()}\n          allowEmptyBackground = {allowEmptyBackground}\n        />\n      }\n      {\n        pluginComponents\n      }\n    </MapComponent>\n  );\n};\n\nexport default BasicMapComponent;\n","import type { IconDefinition } from '@fortawesome/fontawesome-common-types';\n\nimport type {\n  Middleware,\n  Reducer\n} from '@reduxjs/toolkit';\n\nimport { CollapsePanelProps } from 'antd';\nimport type OlMap from 'ol/Map';\n\nimport { SHOGunAPIClient } from '@terrestris/shogun-util/dist/service/SHOGunAPIClient';\n\nexport type ClientPluginLocale = Record<string, {\n  translation: Record<string, any>;\n}>;\n\nexport type PluginConfig = {\n  disabled?: boolean;\n};\n\nexport type ClientPluginComponentProps<T extends PluginConfig = PluginConfig> = {\n  map?: OlMap;\n  client?: SHOGunAPIClient;\n  config?: T;\n};\n\nexport type ClientPluginIntegration = {\n  /**\n   * The main identifier of the integration point of the plugin.\n   */\n  placement: string;\n};\n\nexport type ClientPluginIntegrationToolMenu = ClientPluginIntegration &\n  Omit<CollapsePanelProps, 'key' | 'header'> & {\n    placement: 'tool-menu';\n    /**\n     * The label for the plugin in the tool menu.\n     */\n    label?: string;\n    /**\n     * The insertion index for the plugin in the tool menu, starting from 0 which is on top.\n     */\n    insertionIndex?: number;\n    /**\n     * The icon for the plugin in the tool menu.\n     */\n    icon?: IconDefinition;\n  };\n\nexport type HeaderPlacementOrientation = 'left' | 'center' | 'right';\n\nexport type ClientPluginIntegrationHeader = ClientPluginIntegration & {\n  placement: 'header';\n  /**\n   * The placement orientation for the plugin in the header.\n   */\n  placementOrientation: HeaderPlacementOrientation;\n  /**\n   * The insertion index for the plugin in the header, starting from 0 which is on the left.\n   */\n  insertionIndex?: number;\n};\n\nexport type ClientPluginIntegrationFeatureInfo = ClientPluginIntegration & {\n  placement: 'feature-info';\n  /**\n   * The list of layer names the plugin component should be rendered for. If not\n   * specified, the component will be rendered for all layers.\n   */\n  layers?: string[];\n};\n\nexport type ClientPluginIntegrationMap = ClientPluginIntegration & {\n  placement: 'map';\n};\n\nexport type FooterPlacementOrientation = 'left' | 'right';\n\nexport type ClientPluginIntegrationFooter = ClientPluginIntegration & {\n  placement: 'footer';\n  /**\n  * The placement orientation for the plugin in the footer.\n  */\n  placementOrientation: FooterPlacementOrientation;\n  /**\n  * The insertion index for the plugin in the footer, starting from 0 which is on the left.\n  */\n  insertionIndex?: number;\n};\n\nexport type ClientPluginIntegrationCookieConsent = ClientPluginIntegration & {\n  placement: 'cookie-banner';\n};\n\nexport type ClientPluginIntegrations =\n  | ClientPluginIntegrationToolMenu\n  | ClientPluginIntegrationHeader\n  | ClientPluginIntegrationFeatureInfo\n  | ClientPluginIntegrationMap\n  | ClientPluginIntegrationFooter\n  | ClientPluginIntegrationCookieConsent;\n\nexport type ClientPlugin = {\n  /**\n   * The key of the plugin, usually used for internal references (e.g. element class names) only.\n   */\n  key: string;\n  /**\n   * The definition of the integration point.\n   */\n  integration: ClientPluginIntegrations;\n  /**\n   * The actual component of the plugin.\n   */\n  component: React.FunctionComponent<ClientPluginComponentProps>;\n  /**\n   * The i18n definition to be used in the plugin.\n   */\n  i18n?: ClientPluginLocale;\n  /**\n   * A set of redux reducers to be used in the plugin.\n   */\n  reducers?: Record<string, Reducer>;\n  /**\n   * A set of middlewares that should be added to the store\n   * especially useful for usage of redux-rtk\n   */\n  middlewares?: Middleware[];\n};\n\nexport type ClientPluginInternal = ClientPlugin & {\n  wrappedComponent: React.FunctionComponent<ClientPluginComponentProps>;\n};\n\nexport function isToolMenuIntegration(\n  pluginIntegration: ClientPluginIntegrations\n): pluginIntegration is ClientPluginIntegrationToolMenu {\n  return pluginIntegration && pluginIntegration.placement === 'tool-menu';\n}\n\nexport function isHeaderIntegration(\n  pluginIntegration: ClientPluginIntegrations\n): pluginIntegration is ClientPluginIntegrationHeader {\n  return pluginIntegration && pluginIntegration.placement === 'header';\n}\n\nexport function isFeatureInfoIntegration(\n  pluginIntegration: ClientPluginIntegrations\n): pluginIntegration is ClientPluginIntegrationFeatureInfo {\n  return pluginIntegration && pluginIntegration.placement === 'feature-info';\n}\n\nexport function isMapIntegration(\n  pluginIntegration: ClientPluginIntegrations\n): pluginIntegration is ClientPluginIntegrationMap {\n  return pluginIntegration && pluginIntegration.placement === 'map';\n}\n\nexport function isFooterIntegration(pluginIntegration: ClientPluginIntegrations): pluginIntegration is ClientPluginIntegrationFooter {\n  return pluginIntegration && pluginIntegration.placement === 'footer';\n}\n\nexport function isCookieConsentIntegration(\n  pluginIntegration: ClientPluginIntegrations\n): pluginIntegration is ClientPluginIntegrationCookieConsent {\n  return pluginIntegration && pluginIntegration.placement === 'cookie-banner';\n}\n","import React from 'react';\n\nimport { CookieConsent } from 'react-cookie-consent';\nimport { useTranslation } from 'react-i18next';\n\nimport usePlugins from '../../hooks/usePlugins';\nimport { isCookieConsentIntegration } from '../../plugin';\n\nimport './index.less';\n\nexport const CookieBanner = () => {\n  const plugins = usePlugins();\n\n  const { t } = useTranslation();\n\n  const getPlugin = () => {\n    let cookiePlugin: React.ReactElement | null = null;\n\n    plugins.forEach(plugin => {\n      if (isCookieConsentIntegration(plugin.integration)) {\n        const {\n          key, wrappedComponent: WrappedPluginComponent\n        } = plugin;\n\n        cookiePlugin = <WrappedPluginComponent key={key} />;\n      }\n    });\n\n    return cookiePlugin;\n  };\n\n  return (\n    <CookieConsent\n      disableStyles={true}\n      key=\"default-cookie-consent\"\n      location=\"bottom\"\n      buttonText={t('CookieBanner.button')}\n      cookieName=\"SHOGun-Session-Cookie\"\n      buttonClasses=\"cookie-button\"\n      containerClasses=\"cookie-container\"\n      contentClasses=\"cookie-content\"\n      expires={150}\n    >\n      {getPlugin() ? getPlugin() : t('CookieBanner.info')}\n    </CookieConsent>\n  );\n};\n\nexport default CookieBanner;\n","import {\n  useCallback\n} from 'react';\n\nimport OlSourceImageWMS from 'ol/source/ImageWMS';\nimport OlSourceTileWMS from 'ol/source/TileWMS';\n\nimport {\n  WmsLayer\n} from '@terrestris/ol-util/dist/typeUtils/typeUtils';\n\nimport {\n  getBearerTokenHeader\n} from '@terrestris/shogun-util/dist/security/getBearerTokenHeader';\n\nimport useSHOGunAPIClient from './useSHOGunAPIClient';\n\nexport type ExecuteWfsTransactionOpts = {\n  layer: WmsLayer;\n  transaction: Node;\n};\n\nexport const useExecuteWfsTransaction = () => {\n  const client = useSHOGunAPIClient();\n\n  // TODO Make detection more robust\n  const isFailed = (xmlDoc: Document) => {\n    const errorTagNameCandidates = [\n      'wfs:FAILED',\n      'ows:ExceptionReport'\n    ];\n\n    return errorTagNameCandidates.some(candidate =>\n      xmlDoc.getElementsByTagName(candidate).length > 0);\n  };\n\n  const executeWfsTransaction = useCallback(async (opts: ExecuteWfsTransactionOpts) => {\n    let url;\n\n    const source = opts.layer.getSource();\n    if (source instanceof OlSourceImageWMS) {\n      url = source.getUrl();\n    }\n    if (source instanceof OlSourceTileWMS) {\n      const urls = source.getUrls();\n      url = urls ? urls[0] : undefined;\n    }\n\n    if (!url) {\n      return;\n    }\n\n    if (url.endsWith('?')) {\n      url = url.slice(0, -1);\n    }\n\n    const defaultHeaders = {\n      'Content-Type': 'application/xml'\n    };\n\n    const response = await fetch(url, {\n      method: 'POST',\n      headers: opts.layer?.get('useBearerToken') ? {\n        ...defaultHeaders,\n        ...getBearerTokenHeader(client?.getKeycloak())\n      } : defaultHeaders,\n      body: new XMLSerializer().serializeToString(opts.transaction)\n    });\n\n    if (!response.ok) {\n      throw new Error('No successful response while executing a WFS-Transaction');\n    }\n\n    const responseText = await response.text();\n\n    const parser = new DOMParser();\n    const xmlDoc = parser.parseFromString(responseText, 'text/xml');\n\n    if (isFailed(xmlDoc)) {\n      throw new Error(`Something failed: ${responseText}`);\n    }\n\n    return responseText;\n  }, [client]);\n\n  return executeWfsTransaction;\n};\n\nexport default useExecuteWfsTransaction;\n","import React from 'react';\n\nimport {\n  Upload,\n  Button\n} from 'antd';\n\nimport {\n  UploadFile,\n  UploadProps\n} from 'antd/lib/upload/interface';\n\nimport _isNil from 'lodash/isNil';\n\nimport {\n  useTranslation\n} from 'react-i18next';\n\nimport ShogunFile from '@terrestris/shogun-util/dist/model/File';\nimport {\n  PropertyFormItemEditConfig\n} from '@terrestris/shogun-util/dist/model/Layer';\nimport {\n  getBearerTokenHeader\n} from '@terrestris/shogun-util/dist/security/getBearerTokenHeader';\nimport {\n  getCsrfTokenHeader\n} from '@terrestris/shogun-util/dist/security/getCsrfTokenHeader';\n\nimport useSHOGunAPIClient from '../../hooks/useSHOGunAPIClient';\n\nexport type FileUploadProps = {\n  fieldConfig?: PropertyFormItemEditConfig;\n  readOnly?: boolean;\n} & Partial<UploadProps>;\n\nexport const FileUpload: React.FC<FileUploadProps> = ({\n  readOnly = false,\n  fieldConfig,\n  ...passThroughProps\n}): JSX.Element => {\n\n  const client = useSHOGunAPIClient();\n  const {\n    t\n  } = useTranslation();\n\n  /**\n   * Workaround which allows to download files that need authentication.\n   */\n  const showPreview = async (file: UploadFile<ShogunFile>) => {\n    if (!client) {\n      return;\n    }\n    const { response } = file;\n    const fileName = response?.fileName;\n    const fileUrl = `/files/${response?.fileUuid}`;\n\n    if (_isNil(fileName) || _isNil(response?.fileUuid)) {\n      return;\n    }\n\n    const anchor = document.createElement('a');\n    document.body.appendChild(anchor);\n\n    const opts = {\n      headers: { ... getBearerTokenHeader(client.getKeycloak())}\n    };\n\n    const result = await fetch(fileUrl, opts);\n    const blob = await result.blob();\n    const objectUrl = window.URL.createObjectURL(blob);\n\n    anchor.href = objectUrl;\n    anchor.download = fileName;\n    anchor.click();\n    window.URL.revokeObjectURL(objectUrl);\n  };\n\n  const removeFile = async (file: UploadFile<ShogunFile>) => {\n    const uuid = file?.response?.fileUuid;\n    if (uuid) {\n      const url = `${client?.getBasePath()}files/${uuid}`;\n      return await fetch(url, {\n        method: 'DELETE',\n        credentials: 'same-origin',\n        headers: {\n          ...getCsrfTokenHeader(),\n          ...getBearerTokenHeader(client?.getKeycloak())\n        }\n      });\n    }\n  };\n\n  if (!client) {\n    return <></>;\n  }\n\n  return (\n    <Upload\n      multiple\n      name='file'\n      action='/files/uploadToFileSystem'\n      withCredentials={true}\n      headers={{\n        ...getCsrfTokenHeader(),\n        ...getBearerTokenHeader(client.getKeycloak())\n      }}\n      onRemove={removeFile}\n      onPreview={showPreview}\n      {...fieldConfig?.fieldProps}\n      {...passThroughProps}\n    >\n      {\n        !readOnly && (\n          <Button>{t('FileUpload.upload')}</Button>\n        )\n      }\n    </Upload>\n  );\n};\n\nexport default FileUpload;\n","import {\n  useCallback\n} from 'react';\n\nimport _isNil from 'lodash/isNil';\n\nimport {\n  getBearerTokenHeader\n} from '@terrestris/shogun-util/dist/security/getBearerTokenHeader';\n\nimport useSHOGunAPIClient from './useSHOGunAPIClient';\n\nexport const useConvertImageUrl = () => {\n  const client = useSHOGunAPIClient();\n\n  const imageUrlToBase64 = useCallback(async (url: string) => {\n    if (_isNil(url)) {\n      return Promise.reject(new Error(`Passed url '${url}' is null or undefined`));\n    }\n\n    const response = await fetch(url, {\n      credentials: 'include',\n      headers: {\n        ...getBearerTokenHeader(client?.getKeycloak())\n      }\n    });\n\n    const blob = await response.blob();\n    return new Promise<string>((onSuccess, onError) => {\n      try {\n        const reader = new FileReader() ;\n        reader.onload = function () { onSuccess(this.result as string); };\n        reader.readAsDataURL(blob);\n      } catch (e) {\n        onError(new Error(`Error reading file: ${e}`));\n      }\n    });\n  }, [client]);\n\n  return imageUrlToBase64;\n};\n\nexport default useConvertImageUrl;\n","import React, {\n  useState\n} from 'react';\n\nimport {\n  faPlus\n} from '@fortawesome/free-solid-svg-icons';\nimport {\n  FontAwesomeIcon\n} from '@fortawesome/react-fontawesome';\n\nimport {\n  Upload,\n  Modal\n} from 'antd';\n\nimport {\n  UploadFile,\n  UploadProps\n} from 'antd/lib/upload/interface';\n\nimport _isNil from 'lodash/isNil';\n\nimport {\n  useTranslation\n} from 'react-i18next';\n\nimport { useAsyncEffect } from '@terrestris/react-util/dist/Hooks/useAsyncEffect/useAsyncEffect';\n\nimport ShogunFile from '@terrestris/shogun-util/dist/model/File';\nimport {\n  PropertyFormItemEditConfig\n} from '@terrestris/shogun-util/dist/model/Layer';\nimport {\n  getBearerTokenHeader\n} from '@terrestris/shogun-util/dist/security/getBearerTokenHeader';\nimport {\n  getCsrfTokenHeader\n} from '@terrestris/shogun-util/dist/security/getCsrfTokenHeader';\n\nimport useConvertImageUrl from '../../hooks/useConvertImageUrl';\nimport useSHOGunAPIClient from '../../hooks/useSHOGunAPIClient';\n\nexport type ImageUploadProps = {\n  fieldConfig?: PropertyFormItemEditConfig;\n  readOnly?: boolean;\n  initialFileList?: UploadFile<any>[];\n} & Partial<UploadProps>;\n\nexport const ImageUpload: React.FC<ImageUploadProps> = ({\n  fieldConfig,\n  readOnly = false,\n  initialFileList,\n  ...passThroughProps\n}): JSX.Element => {\n\n  const [mediaPreviewVisible, setMediaPreviewVisible] = useState<boolean>(false);\n  const [previewImage, setPreviewImage] = useState<string>('');\n  const [defaultFileListWithBlob, setDefaultFileListWithBlob] = useState<UploadFile<ShogunFile>[]>();\n\n  const client = useSHOGunAPIClient();\n  const imageUrlToBase64 = useConvertImageUrl();\n  const {\n    t\n  } = useTranslation();\n\n  useAsyncEffect(async () => {\n    if (!initialFileList || initialFileList.length === 0) {\n      return;\n    }\n    const convertDefaultFileList = async (fileList: UploadFile<ShogunFile>[]) => {\n      const fileListPromises = fileList.map(async (val: any) => ({\n        ...val,\n        thumbUrl: await imageUrlToBase64(`${client?.getBasePath()}imagefiles/${val?.response?.fileUuid}/thumbnail`),\n        url: undefined\n      }));\n      return await Promise.all(fileListPromises);\n    };\n    const fl = await convertDefaultFileList(initialFileList);\n    setDefaultFileListWithBlob(fl);\n  }, [initialFileList?.length]);\n\n  /**\n   * Shows preview of clicked uploaded image.\n   * @param {Object} file Image file object.\n   */\n  const showImagePreview = async (file: UploadFile<ShogunFile>) => {\n    const { response } = file;\n    if (_isNil(response) || _isNil(response?.fileUuid)) {\n      return;\n    }\n    const previewImageUrl = `${client?.getBasePath()}imagefiles/${response.fileUuid}`;\n    const img = await imageUrlToBase64(previewImageUrl);\n    setPreviewImage(img);\n    setMediaPreviewVisible(true);\n  };\n\n  const removeFile = async (file: UploadFile<ShogunFile>) => {\n    const uuid = file?.response?.fileUuid;\n    if (uuid) {\n      const url = `${client?.getBasePath()}imagefiles/${uuid}`;\n      return await fetch(url, {\n        method: 'DELETE',\n        credentials: 'same-origin',\n        headers: {\n          ...getCsrfTokenHeader(),\n          ...getBearerTokenHeader(client?.getKeycloak())\n        }\n      });\n    }\n  };\n\n  if (!client) {\n    return <></>;\n  }\n\n  return (\n    <>\n      <Upload\n        accept=\"image/*\"\n        multiple\n        name=\"file\"\n        action={`${client.getBasePath()}imagefiles/uploadToFileSystem`}\n        withCredentials={true}\n        listType=\"picture-card\"\n        headers={{\n          ...getCsrfTokenHeader(),\n          ...getBearerTokenHeader(client.getKeycloak())\n        }}\n        onRemove={removeFile}\n        onPreview={showImagePreview}\n        fileList={readOnly ? defaultFileListWithBlob : undefined}\n        {...fieldConfig?.fieldProps}\n        {...passThroughProps}\n      >\n        {\n          !readOnly && (\n            <div>\n              <FontAwesomeIcon icon={faPlus} />\n              <div style={{ marginTop: 8 }}>{t('ImageUpload.upload')}</div>\n            </div>\n          )\n        }\n      </Upload>\n      <Modal\n        open={mediaPreviewVisible}\n        footer={null}\n        onCancel={() => setMediaPreviewVisible(false)}\n      >\n        <img\n          alt=\"example\"\n          style={{ width: '100%' }}\n          src={previewImage}\n        />\n      </Modal>\n    </>\n  );\n};\n\nexport default ImageUpload;\n","import React, {\n  useEffect\n} from 'react';\n\nimport {\n  Form,\n  FormProps\n} from 'antd';\n\nimport {\n  useForm\n} from 'antd/lib/form/Form';\n\nimport OlFeature from 'ol/Feature';\n\nimport {\n  PropertyFormItemReadConfig\n} from '@terrestris/shogun-util/dist/model/Layer';\n\nimport DisplayField from '../../../DisplayField';\n\nimport './index.less';\n\nexport type FeatureInfoFormProps = FormProps & {\n  feature: OlFeature;\n  formConfig?: PropertyFormItemReadConfig[];\n};\n\nexport const FeatureInfoForm: React.FC<FeatureInfoFormProps> = ({\n  feature,\n  formConfig,\n  ...passThroughProps\n}): JSX.Element => {\n\n  const [form] = useForm();\n\n  useEffect(() => {\n    form.resetFields();\n    form.setFieldsValue(feature.getProperties());\n  }, [feature, form]);\n\n  const createFormItem = (fieldCfg: PropertyFormItemReadConfig) => {\n    return (\n      <Form.Item\n        key={fieldCfg.propertyName}\n        name={fieldCfg.propertyName}\n        label={fieldCfg.displayName ?? fieldCfg.propertyName}\n      >\n        <DisplayField\n          label={fieldCfg.displayName ?? fieldCfg.propertyName}\n          {...fieldCfg.fieldProps}\n        />\n      </Form.Item>\n    );\n  };\n\n  return (\n    <Form\n      className=\"feature-info-form\"\n      form={form}\n      labelCol={{\n        span: 8\n      }}\n      labelAlign=\"left\"\n      labelWrap\n      {...passThroughProps}\n    >\n      {formConfig?.map(createFormItem)}\n    </Form>\n  );\n\n};\n\nexport default FeatureInfoForm;\n","import React, {\n  useState\n} from 'react';\n\nimport {\n  faBoxOpen\n} from '@fortawesome/free-solid-svg-icons';\nimport {\n  FontAwesomeIcon\n} from '@fortawesome/react-fontawesome';\n\nimport {\n  Button,\n  Modal,\n  Table\n} from 'antd';\n\nimport {\n  TableProps\n} from 'antd/lib/table';\n\nimport OlFeature from 'ol/Feature';\n\nimport {\n  useTranslation\n} from 'react-i18next';\n\nimport Logger from '@terrestris/base-util/dist/Logger';\n\nimport {\n  ReferenceConfig\n} from '../DisplayField';\n\nimport FeatureInfoForm from '../ToolMenu/FeatureInfo/FeatureInfoForm';\n\nimport './index.less';\n\nexport type ReferenceDataType = Record<string, any>;\n\nexport type ReferenceTableProps = TableProps<ReferenceDataType> & {\n  value?: string;\n  referenceConfig?: ReferenceConfig;\n};\n\nexport const ReferenceTable: React.FC<ReferenceTableProps> = ({\n  value,\n  referenceConfig,\n  ...passThroughProps\n}) => {\n  const [isModalOpen, setIsModalOpen] = useState<boolean>(false);\n  const [selectedFeature, setSelectedFeature] = useState<OlFeature>();\n\n  const {\n    t\n  } = useTranslation();\n\n  const defaultPropertyName = 'id';\n\n  const resolvePlaceholder = (record: ReferenceDataType) => {\n    if (referenceConfig?.tablePropertyName) {\n      const regex = /{{([^}]*)}}/g;\n\n      if (referenceConfig?.tablePropertyName.match(regex)) {\n        let resolved = referenceConfig?.tablePropertyName;\n        let match;\n\n        // eslint-disable-next-line no-cond-assign\n        while (match = regex.exec(referenceConfig?.tablePropertyName)) {\n          resolved = resolved.replace(match[0], record[match[1]]);\n        }\n\n        return resolved;\n      }\n\n      return record[referenceConfig?.tablePropertyName];\n    }\n\n    if (record[defaultPropertyName]) {\n      return record[defaultPropertyName];\n    }\n  };\n\n  const columns = [{\n    width: '100%',\n    render: (val: any, record: ReferenceDataType) => resolvePlaceholder(record) ?\n      resolvePlaceholder(record) :\n      t('ReferenceTable.defaultRowPlaceholder')\n  }, {\n    render: (val: any, record: ReferenceDataType) => {\n      return (\n        <Button\n          onClick={() => onDetailsClick(val, record)}\n          icon={(\n            <FontAwesomeIcon\n              icon={faBoxOpen}\n            />\n          )}\n        />\n      );\n    }\n  }];\n\n  const getDataSource = () => {\n    if (!value) {\n      return [];\n    }\n\n    try {\n      const parsedValue = JSON.parse(value);\n\n      if (Array.isArray(parsedValue)) {\n        return parsedValue;\n      }\n\n      if (parsedValue === null || parsedValue === undefined || typeof parsedValue === 'number' ||\n        typeof parsedValue === 'boolean' || typeof parsedValue === 'string') {\n        Logger.warn('Unsupported value given');\n        return [];\n      }\n\n      if (typeof parsedValue === 'object') {\n        return [parsedValue];\n      }\n    } catch (error) {\n      Logger.warn('Error while parsing the table data ', error);\n      return [];\n    }\n  };\n\n  const getModalTitle = () => {\n    if (!selectedFeature) {\n      return t('ReferenceTable.defaultModalTitle');\n    }\n\n    const placeholder = resolvePlaceholder(selectedFeature.getProperties());\n\n    if (!placeholder) {\n      return t('ReferenceTable.defaultModalTitle');\n    }\n\n    return `${t('ReferenceTable.modalTitle', {\n      referenceValue: placeholder\n    })}`;\n  };\n\n  const onDetailsClick = (val: any, record: ReferenceDataType) => {\n    const feature = new OlFeature();\n    feature.setProperties(record);\n\n    setSelectedFeature(feature);\n    setIsModalOpen(true);\n  };\n\n  const onCancel = async () => {\n    setIsModalOpen(false);\n    setSelectedFeature(undefined);\n  };\n\n  return (\n    <>\n      <Table\n        size=\"small\"\n        showHeader={false}\n        pagination={false}\n        columns={columns}\n        rowKey={defaultPropertyName}\n        dataSource={getDataSource()}\n        {...passThroughProps}\n      />\n      <Modal\n        className=\"reference-table-modal\"\n        open={isModalOpen}\n        maskClosable={false}\n        footer={null}\n        width={600}\n        destroyOnClose={true}\n        title={getModalTitle()}\n        onCancel={onCancel}\n      >\n        {selectedFeature && (\n          <FeatureInfoForm\n            feature={selectedFeature}\n            formConfig={referenceConfig?.featureInfoFormConfig}\n          />\n        )}\n      </Modal>\n    </>\n  );\n};\n\nexport default ReferenceTable;\n","import React, {\n  FC,\n  JSX\n} from 'react';\n\nimport {\n  Checkbox,\n  Typography,\n  UploadFile\n} from 'antd';\n\nimport dayjs, {\n  Dayjs,\n  isDayjs\n} from 'dayjs';\n\nimport _isString from 'lodash/isString';\nimport {\n  useTranslation\n} from 'react-i18next';\n\nimport Logger from '@terrestris/base-util/dist/Logger';\n\nimport ShogunFile from '@terrestris/shogun-util/dist/model/File';\nimport {\n  PropertyFormItemReadConfig\n} from '@terrestris/shogun-util/dist/model/Layer';\n\nimport { isFileConfig } from '../EditFeatureDrawer/EditFeatureForm';\nimport FileUpload from '../FileUpload';\nimport ImageUpload from '../ImageUpload';\nimport ReferenceTable from '../ReferenceTable';\n\nexport type ValueType = string | number | boolean | Dayjs | Record<string, any>;\nexport type DataType = 'auto' | 'number' | 'boolean' | 'string' | 'date' | 'url' | 'json';\n\nexport type ReferenceConfig = {\n  tablePropertyName?: string;\n  featureInfoFormConfig?: PropertyFormItemReadConfig[];\n};\n\nexport type DisplayFieldProps = {\n  /**\n   * The data type of the value to display. If set to 'auto' (default),\n   * the component tries to guess the data type based on the value. Otherwise\n   * the component will try to enforce the given data type.\n   */\n  dataType?: DataType;\n  /**\n   * A map of values to display instead of the actual value. The key is the\n   * original value and the value is the value to display instead.\n   */\n  valueMap?: Record<string, ValueType>;\n  format?: string;\n  suffix?: string;\n  value?: ValueType | ValueType[];\n  label?: string;\n  referenceConfig?: ReferenceConfig;\n  /**\n   * If set, it displays the given value instead of the URL.\n   */\n  urlDisplayValue?: string;\n};\n\nexport const DisplayField: FC<DisplayFieldProps> = ({\n  dataType = 'auto',\n  valueMap,\n  format = 'DD.MM.YYYY',\n  suffix,\n  value,\n  referenceConfig,\n  urlDisplayValue,\n  ...passThroughProps\n}): JSX.Element => {\n\n  const {\n    i18n\n  } = useTranslation();\n\n  let displayValue: React.ReactNode = '';\n\n  // eslint-disable-next-line no-prototype-builtins\n  if (value && typeof value === 'string' && valueMap?.hasOwnProperty(value)) {\n    value = valueMap[value];\n  }\n\n  if (\n    dataType === 'string' ||\n    (dataType === 'auto' && typeof value === 'string')\n  ) {\n    if (value) {\n      displayValue = value?.toString();\n    }\n  }\n\n  if (\n    dataType === 'boolean' ||\n    (dataType === 'auto' && typeof value === 'boolean' || value === 'false' || value === 'true')\n  ) {\n    return (\n      <Checkbox\n        checked={value !== 'false' && value !== false}\n        disabled\n      />\n    );\n  }\n\n  if (\n    dataType === 'number' ||\n    (dataType === 'auto' && Number.isFinite(value))\n  ) {\n    if (value) {\n      displayValue = new Intl.NumberFormat(i18n.language, {\n        useGrouping: false\n      }).format(Number(value));\n    }\n  }\n\n  if (\n    dataType === 'date' ||\n    (dataType === 'auto' && dayjs(`${value}`).isValid())\n  ) {\n    if (value && (isDayjs(value) || (_isString(value) && dayjs(`${value}`).isValid()))) {\n      displayValue = dayjs(value).format(format);\n    }\n  }\n\n  if (dataType === 'auto' && Array.isArray(value)) {\n    displayValue = value.join(', ');\n  }\n\n  const isUrl = (candidate: string) => {\n    const lowerCandidate = candidate.toLowerCase();\n    const protocols = ['http://', 'https://', 'ftp://', 'mailto:'];\n    return protocols.some(protocol => lowerCandidate.startsWith(protocol));\n  };\n\n  if (\n    dataType === 'url' ||\n    (dataType === 'auto' && _isString(value) && isUrl(value))\n  ) {\n    if (value) {\n      displayValue = (\n        <a\n          href={value?.toString()}\n          target=\"_blank\"\n          rel='noreferrer'\n        >\n          {urlDisplayValue ? urlDisplayValue : value?.toString()}\n        </a>\n      );\n    }\n  }\n\n  const getUpload = (val: ValueType | ValueType[]): UploadFile<ShogunFile>[] | null => {\n    if (!value) {\n      return null;\n    }\n    let v = typeof val !== 'string' ? JSON.stringify(val) : val;\n\n    try {\n      v = JSON.parse(v);\n    } catch (e) {\n      Logger.trace(e);\n      return null;\n    }\n\n    if (typeof v === 'object' && v !== null && isFileConfig(v[0])) {\n      return v as UploadFile<ShogunFile>[];\n    }\n    return null;\n  };\n\n  const uploadValue = value && getUpload(value);\n\n  if (dataType === 'auto' && uploadValue) {\n    if (uploadValue[0].response?.fileType?.startsWith('image/')) {\n      return (\n        <ImageUpload\n          initialFileList={uploadValue}\n          disabled\n          readOnly\n        />\n      );\n    } else {\n      return (\n        <FileUpload\n          defaultFileList={uploadValue}\n          disabled\n          readOnly\n        />\n      );\n    }\n  }\n\n  const isJson = (val: ValueType | ValueType[]): boolean => {\n    let v = typeof val !== 'string' ? JSON.stringify(val) : val;\n\n    try {\n      v = JSON.parse(v);\n    } catch (e) {\n      Logger.trace(e);\n      return false;\n    }\n\n    return typeof v === 'object' && v !== null;\n  };\n\n  if (\n    dataType === 'json' ||\n    dataType === 'auto' && value && isJson(value)\n  ) {\n    return (\n      <ReferenceTable\n        value={typeof value === 'string' ? value : JSON.stringify(value)}\n        referenceConfig={referenceConfig}\n      />\n    );\n  }\n\n  if (suffix) {\n    displayValue = <>{displayValue} {suffix}</>;\n  }\n\n  return (\n    <Typography.Text\n      className=\"displayfield\"\n      {...passThroughProps}\n    >\n      {displayValue}\n    </Typography.Text>\n  );\n};\n\nexport default DisplayField;\n","import React, { useState } from 'react';\n\nimport {\n  faEdit, faPlus, faTrash\n} from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\n\nimport {\n  Button, Modal, Popconfirm, Table\n} from 'antd';\n\nimport {\n  FormInstance, useForm\n} from 'antd/lib/form/Form';\n\nimport {\n  ColumnsType, TableProps\n} from 'antd/lib/table';\n\nimport dayjs from 'dayjs';\nimport { FileInfoList } from 'hooks/useWriteWfsTransaction';\n\nimport _cloneDeep from 'lodash/cloneDeep';\nimport _isFinite from 'lodash/isFinite';\nimport _isString from 'lodash/isString';\n\nimport OlFeature from 'ol/Feature';\nimport { getUid } from 'ol/util';\n\nimport { useTranslation } from 'react-i18next';\n\nimport Logger from '@terrestris/base-util/dist/Logger';\n\nimport { PropertyFormItemEditConfig } from '@terrestris/shogun-util/dist/model/Layer';\n\nimport useConvertImageUrl from '../../../hooks/useConvertImageUrl';\nimport useSHOGunAPIClient from '../../../hooks/useSHOGunAPIClient';\n\nimport EditFeatureForm from '../../EditFeatureDrawer/EditFeatureForm';\n\nimport './index.less';\n\nexport type EditReferenceDataType = {\n  id?: number;\n  internalId?: number;\n  [key: string]: any;\n};\n\nexport type EditReferenceTableProps = Omit<TableProps<EditReferenceDataType>, 'onChange'> & {\n  parentForm: FormInstance<EditReferenceDataType>;\n  propertyName: string;\n  value?: EditReferenceDataType;\n  tablePropertyName?: string;\n  formConfig?: PropertyFormItemEditConfig[];\n  onChange?: (changedValues: EditReferenceDataType[]) => void;\n};\n\nexport const EditReferenceTable: React.FC<EditReferenceTableProps> = ({\n  parentForm,\n  propertyName,\n  value,\n  tablePropertyName,\n  formConfig,\n  onChange = () => {},\n  ...passThroughProps\n}) => {\n  const [isModalOpen, setIsModalOpen] = useState<boolean>(false);\n  const [selectedFeature, setSelectedFeature] = useState<OlFeature>();\n\n  const [form] = useForm<EditReferenceDataType>();\n\n  const {\n    t\n  } = useTranslation();\n\n  const imageUrlToBase64 = useConvertImageUrl();\n  const client = useSHOGunAPIClient();\n\n  const defaultPropertyName = 'id';\n\n  const resolvePlaceholder = (record: EditReferenceDataType): string | number => {\n    if (!tablePropertyName) {\n      return record[defaultPropertyName] ?? '';\n    }\n\n    const regex = /{{([^}]*)}}/g;\n\n    if (!tablePropertyName.match(regex)) {\n      return record[tablePropertyName];\n    }\n\n    let resolved = tablePropertyName;\n    let match;\n\n    // eslint-disable-next-line no-cond-assign\n    while (match = regex.exec(tablePropertyName)) {\n      resolved = resolved.replace(match[0], record[match[1]]);\n    }\n\n    return resolved;\n  };\n\n  const columns: ColumnsType<EditReferenceDataType> = [{\n    width: '100%',\n    defaultSortOrder: 'ascend',\n    sorter: (a, b) => {\n      const valA = resolvePlaceholder(a);\n      const valB = resolvePlaceholder(b);\n\n      if (Number.isFinite(valA) && Number.isFinite(valB)) {\n        return (valA as number) - (valB as number);\n      }\n\n      if (typeof valA === 'string' && typeof valB === 'string') {\n        return valA.localeCompare(valB);\n      }\n\n      return 0;\n    },\n    render: (_: any, record: EditReferenceDataType) => resolvePlaceholder(record)\n  }, {\n    render: (_: any, record: EditReferenceDataType) => {\n      return (\n        <Button\n          onClick={() => onDetailsClick(record)}\n          icon={(\n            <FontAwesomeIcon\n              icon={faEdit}\n            />\n          )}\n        />\n      );\n    }\n  }, {\n    render: (_: any, record: EditReferenceDataType) => {\n      return (\n        <Popconfirm\n          title={t('EditReferenceTable.confirmDeleteTitle')}\n          onConfirm={() => onConfirmDelete(record)}\n          placement=\"bottomRight\"\n        >\n          <Button\n            danger={true}\n            icon={(\n              <FontAwesomeIcon\n                icon={faTrash}\n              />\n            )}\n          />\n        </Popconfirm>\n      );\n    }\n  }];\n\n  const getDataSource = () => {\n    if (!value) {\n      return;\n    }\n\n    if (!Array.isArray(value)) {\n      Logger.warn('Reference value must be of of type array.');\n      return;\n    }\n\n    const valueCopy = _cloneDeep(value);\n    valueCopy.forEach(v => {\n      Object.entries(v).forEach(async ([key, val]) => {\n        const isDate = formConfig?.some(cfg => cfg.propertyName === key && cfg.component === 'DATE');\n        if (isDate && (_isString(val) || _isFinite(val)) && (_isString(value) || _isFinite(value))) {\n          const parsedDate = dayjs(`${value}`);\n          if (parsedDate.isValid()) {\n            v[key] = dayjs(`${val}`);\n          } else {\n            Logger.warn('Could not parse date');\n            v[key] = null;\n          }\n        }\n\n        const isUpload = formConfig?.some(cfg => cfg.propertyName === key && cfg.component === 'UPLOAD');\n        if (isUpload) {\n          if (Array.isArray(v[key])) {\n            const vMap = v[key]?.map(async (upload: FileInfoList) => ({\n              ...upload,\n              thumbUrl: upload.type.startsWith('image')\n                ? await imageUrlToBase64(\n                  `${client?.getBasePath()}imagefiles/${\n                    upload?.response?.fileUuid\n                  }/thumbnail`\n                )\n                : undefined,\n              url: upload.type.startsWith('image') ? undefined : upload.url\n            }));\n            v[key] = await Promise.all(vMap);\n          } else {\n            v[key] = [];\n          }\n        }\n      });\n    });\n\n    const isIdAvailable = valueCopy.every(el => {\n      if (Number.isFinite(el.id)) {\n        return true;\n      }\n\n      return typeof el.id === 'string' && el.id.length > 0;\n    });\n\n    if (!isIdAvailable) {\n      Logger.warn('Not all elements in the referenced array contain an id value. ' +\n        'This might result in unexpected behaviour');\n    }\n\n    return valueCopy;\n  };\n\n  const onAddClick = () => {\n    const feature = new OlFeature();\n    // We need to set a temporarily internal id on the feature to have it\n    // detectable while it's not being saved and has no id property set.\n    feature.set('internalId', getUid(feature));\n\n    form.setFieldsValue(feature.getProperties());\n\n    setSelectedFeature(feature);\n    setIsModalOpen(true);\n  };\n\n  const onConfirmDelete = (record: EditReferenceDataType) => {\n    const parentFormValues = parentForm.getFieldsValue();\n\n    if (!parentFormValues[propertyName]) {\n      Logger.warn(`Could not find the property ${propertyName} in the form values`);\n      return;\n    }\n\n    const deleteCandidates = _cloneDeep(parentFormValues[propertyName]);\n\n    if (!Array.isArray(deleteCandidates)) {\n      Logger.warn('The delete candidate is not of required type array');\n      return;\n    }\n\n    const deleteIdx = deleteCandidates.findIndex(deleteCandidate => {\n      if (Number.isFinite(deleteCandidate.id) && (deleteCandidate.id === record.id)) {\n        return true;\n      }\n\n      return !!(deleteCandidate.internalId && (deleteCandidate.internalId === record.internalId));\n    });\n\n    if (deleteIdx === -1) {\n      Logger.warn(`Could not find the index (${record.id}) to delete`);\n      return;\n    }\n\n    deleteCandidates.splice(deleteIdx, 1);\n\n    onChange(deleteCandidates);\n  };\n\n  const onDetailsClick = (record: EditReferenceDataType) => {\n    const feature = new OlFeature();\n    feature.setProperties(record);\n\n    form.setFieldsValue(feature.getProperties());\n\n    setSelectedFeature(feature);\n    setIsModalOpen(true);\n  };\n\n  const updateReferences = () => {\n    const formValues = _cloneDeep<EditReferenceDataType>(form.getFieldsValue(true));\n\n    let existingReferences: EditReferenceDataType[] = [];\n    if (Array.isArray(parentForm.getFieldValue(propertyName))) {\n      existingReferences = _cloneDeep(parentForm.getFieldValue(propertyName));\n    }\n\n    const targetIdx = existingReferences.findIndex(existingReference => {\n      if (Number.isFinite(existingReference.id) && (existingReference.id === formValues.id)) {\n        return true;\n      }\n\n      return !!(existingReference.internalId && (existingReference.internalId === formValues.internalId));\n    });\n\n    if (targetIdx > -1) {\n      // Update\n      existingReferences[targetIdx] = formValues;\n    } else {\n      // Add\n      existingReferences.push(formValues);\n    }\n\n    if (form.isFieldsTouched()) {\n      onChange(existingReferences);\n    }\n  };\n\n  const onCancel = () => {\n    closeModal();\n  };\n\n  const onOk = async () => {\n    try {\n      await form.validateFields();\n    } catch (error) {\n      Logger.warn('Form validation failed: ', error);\n      return;\n    }\n\n    updateReferences();\n\n    closeModal();\n  };\n\n  const closeModal = () => {\n    form.resetFields();\n\n    setIsModalOpen(false);\n    setSelectedFeature(undefined);\n  };\n\n  return (\n    <>\n      <Button\n        className=\"add-reference-button\"\n        onClick={onAddClick}\n        icon={(\n          <FontAwesomeIcon\n            icon={faPlus}\n          />\n        )}\n      />\n      <Table\n        size=\"small\"\n        showHeader={false}\n        pagination={false}\n        columns={columns}\n        rowKey={defaultPropertyName}\n        dataSource={getDataSource()}\n        {...passThroughProps}\n      />\n      <Modal\n        className=\"edit-reference-table-modal\"\n        open={isModalOpen}\n        maskClosable={false}\n        width={600}\n        destroyOnClose={true}\n        title={`${t('EditReferenceTable.modalTitle', {\n          referenceValue: selectedFeature ?\n            resolvePlaceholder(selectedFeature.getProperties() as EditReferenceDataType) :\n            undefined\n        })}`}\n        onCancel={onCancel}\n        onOk={onOk}\n      >\n        {selectedFeature && (\n          <EditFeatureForm\n            form={form}\n            formConfig={formConfig}\n            applyFormDirty={false}\n          />\n        )}\n      </Modal>\n    </>\n  );\n};\n\nexport default EditReferenceTable;\n","import React from 'react';\n\nimport {\n  Input,\n  InputNumber,\n  DatePicker,\n  Select,\n  Switch,\n  Checkbox,\n  Form,\n  FormItemProps\n} from 'antd';\n\nimport {\n  FormInstance,\n  FormProps\n} from 'antd/lib/form/Form';\nimport {\n  UploadChangeParam,\n  UploadFile\n} from 'antd/lib/upload/interface';\n\nimport _debounce from 'lodash/debounce';\nimport _isNil from 'lodash/isNil';\nimport _isObject from 'lodash/isObject';\n\nimport Logger from '@terrestris/base-util/dist/Logger';\nimport ShogunFile from '@terrestris/shogun-util/dist/model/File';\n\nimport {\n  PropertyFormItemEditConfig,\n  PropertyFormItemEditReferenceTableConfig\n} from '@terrestris/shogun-util/dist/model/Layer';\n\nimport useAppDispatch from '../../../hooks/useAppDispatch';\nimport useAppSelector from '../../../hooks/useAppSelector';\nimport useSHOGunAPIClient from '../../../hooks/useSHOGunAPIClient';\nimport {\n  setFormDirty\n} from '../../../store/editFeature';\nimport DisplayField from '../../DisplayField';\nimport FileUpload from '../../FileUpload';\nimport ImageUpload from '../../ImageUpload';\nimport EditReferenceTable from '../EditReferenceTable';\n\nimport './index.less';\n\nexport type EditFeatureFormProps = FormProps & {\n  form: FormInstance;\n  formConfig?: PropertyFormItemEditConfig[];\n  applyFormDirty?: boolean;\n};\n\nexport function isFileConfig(val: any): val is UploadFile<ShogunFile> {\n  if (_isNil(val)) {\n    return false;\n  }\n\n  return val.uid &&\n    !_isNil(val.name) &&\n    !_isNil(val.type) &&\n    !_isNil(val.uid) &&\n    _isObject(val.response) &&\n    !_isNil(val.response.id) &&\n    !_isNil(val.response.fileUuid) &&\n    !_isNil(val.response.fileName) &&\n    !_isNil(val.response.fileType);\n}\n\nexport const EditFeatureForm: React.FC<EditFeatureFormProps> = ({\n  form,\n  formConfig,\n  applyFormDirty = true,\n  ...passThroughProps\n}): JSX.Element => {\n\n  const client = useSHOGunAPIClient();\n  const dispatch = useAppDispatch();\n\n  const formDirty = useAppSelector(\n    state => state.editFeature.formDirty\n  );\n\n  const createFormItem = (fieldCfg: PropertyFormItemEditConfig): React.ReactNode => {\n    let field: React.ReactNode;\n    if (fieldCfg.readOnly) {\n      field = createReadOnlyComponent(fieldCfg);\n    } else if (fieldCfg.component) {\n      field = createFieldComponent(fieldCfg);\n    } else {\n      Logger.warn('FieldConfig is missing `readOnly`, `component` or `dataType` property.');\n      field = (\n        <Input\n          key={fieldCfg.propertyName}\n          placeholder=\"\"\n        />\n      );\n    }\n\n    const formItemProps: FormItemProps = {\n      rules: []\n    };\n\n    formItemProps.rules = [{\n      required: fieldCfg.required\n    }];\n\n    if ((fieldCfg.component === 'SWITCH' || fieldCfg.component === 'CHECKBOX') && !fieldCfg.readOnly) {\n      formItemProps.valuePropName = 'checked';\n    }\n\n    if (fieldCfg.component === 'UPLOAD' && !fieldCfg.readOnly) {\n      formItemProps.valuePropName = 'fileList';\n      /**\n       * Setting `getValueFromEvent` to provide the proper file list to the antd Upload component.\n       */\n      formItemProps.getValueFromEvent = (e: UploadFile<ShogunFile>[] | UploadChangeParam<UploadFile<ShogunFile>>) => {\n        if (Array.isArray(e)) {\n          return e;\n        }\n        return e?.fileList;\n      };\n    }\n\n    return (\n      <Form.Item\n        key={fieldCfg.propertyName}\n        name={fieldCfg.propertyName}\n        label={fieldCfg.displayName ?? fieldCfg.propertyName}\n        {...formItemProps}\n      >\n        {field}\n      </Form.Item>\n    );\n  };\n\n  const createReadOnlyComponent = (fieldConfig: PropertyFormItemEditConfig): React.ReactNode => {\n    return (\n      <DisplayField\n        {...fieldConfig.fieldProps}\n      />\n    );\n  };\n\n  const createFieldComponent = (fieldCfg: PropertyFormItemEditConfig): React.ReactNode => {\n    if (!client) {\n      return;\n    }\n\n    switch (fieldCfg.component) {\n      case 'CHECKBOX':\n        return (\n          <Checkbox\n            {...fieldCfg?.fieldProps}\n          />\n        );\n      case 'DATE':\n        return (\n          <DatePicker\n            {...fieldCfg?.fieldProps}\n          />\n        );\n      case 'DISPLAY':\n        return (\n          <span {...fieldCfg?.fieldProps} />\n        );\n      case 'INPUT':\n        return (\n          <Input\n            {...fieldCfg?.fieldProps}\n          />\n        );\n      case 'NUMBER':\n        return (\n          <InputNumber\n            {...fieldCfg?.fieldProps}\n          />\n        );\n      case 'SELECT':\n        return (\n          <Select\n            allowClear={true}\n            {...fieldCfg?.fieldProps}\n          />\n        );\n      case 'SWITCH':\n        return (\n          <Switch\n            {...fieldCfg?.fieldProps}\n          />\n        );\n      case 'TEXTAREA':\n        return (\n          <Input.TextArea\n            {...fieldCfg?.fieldProps}\n          />\n        );\n      case 'UPLOAD':\n        if (fieldCfg?.fieldProps?.type === 'IMAGE') {\n          return (\n            <ImageUpload\n              {...fieldCfg?.fieldProps}\n            />\n          );\n        } else {\n          return (\n            <FileUpload\n              {...fieldCfg?.fieldProps}\n            />\n          );\n        }\n      case 'REFERENCE_TABLE': {\n        const referenceTableConfig = (fieldCfg as PropertyFormItemEditReferenceTableConfig);\n\n        return (\n          <EditReferenceTable\n            key={referenceTableConfig.propertyName}\n            tablePropertyName={referenceTableConfig.tablePropertyName}\n            propertyName={referenceTableConfig.propertyName}\n            formConfig={referenceTableConfig.editFormConfig}\n            parentForm={form}\n            {...referenceTableConfig.fieldProps}\n          />\n        );\n      }\n      default:\n        Logger.error(`Component type \"${fieldCfg?.component}\" is not supported`);\n        return <></>;\n    }\n  };\n\n  const onValuesChange = async (changedValues: any) => {\n    if (applyFormDirty && changedValues && !formDirty) {\n      dispatch(setFormDirty(true));\n    }\n  };\n\n  return (\n    <Form\n      className=\"edit-feature-form\"\n      form={form}\n      labelCol={{\n        span: 8\n      }}\n      labelAlign=\"left\"\n      labelWrap\n      onValuesChange={_debounce(onValuesChange, 250)}\n      {...passThroughProps}\n    >\n      { formConfig?.map(createFormItem) }\n    </Form>\n  );\n};\n\nexport default EditFeatureForm;\n","import {\n  useCallback\n} from 'react';\n\nimport OlSourceImageWMS from 'ol/source/ImageWMS';\nimport OlSourceTileWMS from 'ol/source/TileWMS';\n\nimport { UrlUtil } from '@terrestris/base-util/dist/UrlUtil/UrlUtil';\n\nimport {\n  WmsLayer\n} from '@terrestris/ol-util/dist/typeUtils/typeUtils';\n\nimport {\n  getBearerTokenHeader\n} from '@terrestris/shogun-util/dist/security/getBearerTokenHeader';\n\nimport useSHOGunAPIClient from './useSHOGunAPIClient';\n\nexport type LocalGeometryType = 'MultiPoint' | 'Point' | 'MultiLineString' | 'LineString' | 'MultiPolygon' | 'Polygon';\nexport type GeometryType = 'gml:MultiPoint' | 'gml:Point' | 'gml:MultiLineString' | 'gml:LineString' | 'gml:MultiPolygon' | 'gml:Polygon';\n\nexport type Property = {\n  localType: 'int' | 'number' | 'string' | 'boolean' | 'date' | LocalGeometryType;\n  maxOccurs: 0 | 1;\n  minOccurs: 0 | 1;\n  name: string;\n  nillable: boolean;\n  type: 'xsd:int' | 'xsd:number' | 'xsd:string' | 'xsd:boolean' | 'xsd:date' | GeometryType;\n};\n\nexport type FeatureType = {\n  typeName: string;\n  properties: Property[];\n};\n\nexport type DescribeFeatureType = {\n  elementFormDefault: string;\n  featureTypes: FeatureType[];\n  targetNamespace: string;\n  targetPrefix: string;\n};\n\ntype DescribeFeatureTypeCache = Record<string, DescribeFeatureType>;\n\nexport const isGeometryType = (propertyType: string): propertyType is GeometryType => {\n  const geometryTypes = [\n    'gml:MultiPoint',\n    'gml:Point',\n    'gml:MultiLineString',\n    'gml:LineString',\n    'gml:MultiPolygon',\n    'gml:Polygon'\n  ];\n\n  return geometryTypes.includes(propertyType);\n};\n\nexport const useExecuteWfsDescribeFeatureType = () => {\n  const client = useSHOGunAPIClient();\n\n  const cacheKey = 'describeFeatureTypeCache';\n\n  const executeWfsDescribeFeatureType = useCallback(async (layer: WmsLayer) => {\n    let url;\n\n    const source = layer.getSource();\n    if (source instanceof OlSourceImageWMS) {\n      url = source.getUrl();\n    }\n    if (source instanceof OlSourceTileWMS) {\n      const urls = source.getUrls();\n      url = urls ? urls[0] : undefined;\n    }\n\n    if (!url) {\n      return;\n    }\n\n    if (url.endsWith('?')) {\n      url = url.slice(0, -1);\n    }\n\n    const typeName: string | undefined = layer.getSource()?.getParams().LAYERS;\n\n    if (!typeName) {\n      return;\n    }\n\n    // TODO localStorage might be a better choice here, but not sure when to invalidate the cache then.\n    const describeFeatureTypeCache = JSON.parse(sessionStorage.getItem(cacheKey) || '{}') as DescribeFeatureTypeCache;\n\n    const cacheEntry = describeFeatureTypeCache[typeName];\n\n    if (cacheEntry) {\n      return cacheEntry;\n    }\n\n    const params = {\n      SERVICE: 'WFS',\n      REQUEST: 'DescribeFeatureType',\n      VERSION: '2.0.0',\n      OUTPUTFORMAT: 'application/json',\n      TYPENAMES: typeName\n    };\n\n    const defaultHeaders = {\n      'Content-Type': 'application/json'\n    };\n\n    const response = await fetch(`${url}?${UrlUtil.objectToRequestString(params)}`, {\n      method: 'GET',\n      headers: layer.get('useBearerToken') ? {\n        ...defaultHeaders,\n        ...getBearerTokenHeader(client?.getKeycloak())\n      } : defaultHeaders\n    });\n\n    if (!response.ok) {\n      throw new Error('No successful response while executing a WFS-DescribeFeature');\n    }\n\n    const responseJson = await response.json() as DescribeFeatureType;\n\n    describeFeatureTypeCache[typeName] = responseJson;\n\n    sessionStorage.setItem(cacheKey, JSON.stringify(describeFeatureTypeCache));\n\n    return responseJson;\n  }, [client]);\n\n  return executeWfsDescribeFeatureType;\n};\n\nexport default useExecuteWfsDescribeFeatureType;\n","import {\n  useCallback\n} from 'react';\n\nimport {\n  FormInstance\n} from 'antd';\n\nimport ClientConfiguration from 'clientConfig';\n\nimport dayjs from 'dayjs';\nimport _cloneDeep from 'lodash/cloneDeep';\n\nimport {\n  isEmpty\n} from 'ol/extent';\nimport OlFeature from 'ol/Feature';\nimport OlFormatWFS, {\n  WriteTransactionOptions as OlWriteTransactionOptions\n} from 'ol/format/WFS';\n\nimport {\n  WmsLayer\n} from '@terrestris/ol-util/dist/typeUtils/typeUtils';\n\nimport {\n  useMap\n} from '@terrestris/react-util/dist/Hooks/useMap/useMap';\n\nimport {\n  PropertyFormTabConfig,\n  PropertyFormItemEditConfig\n} from '@terrestris/shogun-util/dist/model/Layer';\n\nimport {\n  isFileConfig\n} from '../components/EditFeatureDrawer/EditFeatureForm';\n\nimport useAppSelector from './useAppSelector';\nimport useExecuteWfsDescribeFeatureType, {\n  isGeometryType\n} from './useExecuteWfsDescribeFeatureType';\nimport useSHOGunAPIClient from './useSHOGunAPIClient';\n\nexport type WriteWfsTransactionOpts = {\n  layer: WmsLayer;\n  upsertFeatures?: OlFeature[];\n  deleteFeatures?: OlFeature[];\n  form?: FormInstance;\n};\n\nexport type FileInfoList = {\n  uid: string;\n  lastModified: number;\n  name: string;\n  type: string;\n  url: string;\n  response: {\n    id: number;\n    created: string;\n    fileName: string;\n    fileType: string;\n    fileUuid: string;\n  };\n};\n\nexport const useWriteWfsTransaction = () => {\n  const map = useMap();\n  const executeWfsDescribeFeatureType = useExecuteWfsDescribeFeatureType();\n  const client = useSHOGunAPIClient();\n  const allowedEditMode = useAppSelector(state => state.editFeature.userEditMode);\n\n  const cleanFormValues = useCallback((formValues: Record<string, any>,\n    formConfig: PropertyFormTabConfig<PropertyFormItemEditConfig>[], stringify?: boolean) => {\n    for (const [key, value] of Object.entries(formValues)) {\n      if (Array.isArray(value)) {\n        const cleanedValue = value.map(v => cleanFormValues(v, formConfig));\n        formValues[key] = stringify ? JSON.stringify(cleanedValue) : cleanedValue;\n      }\n\n      // Transform undefined to null values.\n      if (value === undefined) {\n        formValues[key] = null;\n      }\n\n      // Filter out read-only fields.\n      const isReadOnly = formConfig.some(cfg => cfg.children\n        ?.some(child => child.propertyName === key && child.readOnly));\n\n      if (isReadOnly) {\n        delete formValues[key];\n      }\n\n      // Transform moments back to iso string.\n      if (dayjs(value).isValid()) {\n        formValues[key] = value.toISOString();\n      }\n\n      if (Array.isArray(value) && value.length > 0 && isFileConfig(value[0])) {\n        const filePath = value[0].response?.fileType?.startsWith('image/') ? 'imagefiles/' : 'files/';\n        const fileInfoList: FileInfoList[] = value.map((val: FileInfoList) => ({\n          uid: val.uid,\n          lastModified: val.lastModified,\n          name: val.name,\n          type: val.type,\n          url: `${client?.getBasePath()}${filePath}${val.response.fileUuid}`,\n          response: {\n            id: val.response?.id,\n            created: val.response?.created,\n            fileName: val.response?.fileName,\n            fileType: val.response?.fileType,\n            fileUuid: val.response?.fileUuid\n          }\n        }));\n        formValues[key] = JSON.stringify(fileInfoList);\n      }\n    }\n\n    return formValues;\n  }, [client]);\n\n  const writeWfsTransaction = useCallback(async (opts: WriteWfsTransactionOpts) => {\n    if (!map) {\n      return;\n    }\n\n    const inserts: OlFeature[] = [];\n    const updates: OlFeature[] = [];\n    const deletes: OlFeature[] = [];\n\n    const describeFeatureType = await executeWfsDescribeFeatureType(opts.layer);\n\n    if (!describeFeatureType) {\n      return;\n    }\n\n    const formConfig = opts.layer.get('editFormConfig') as PropertyFormTabConfig<PropertyFormItemEditConfig>[];\n\n    const geomProperty = describeFeatureType.featureTypes[0]?.properties\n      ?.find(property => isGeometryType(property.type));\n\n    let overallUpdateMode = false;\n\n    opts.upsertFeatures?.forEach(feature => {\n      const feat = new OlFeature();\n      const geometry = feature.getGeometry()?.clone();\n\n      if (geometry && !isEmpty(geometry.getExtent()) && allowedEditMode?.includes('EDIT_GEOMETRY')) {\n        const geomPropName = geomProperty?.name ?? 'geom';\n        feat.set(geomPropName, geometry);\n        feat.setGeometryName(geomPropName);\n      }\n\n      if (opts.form) {\n        feat.setProperties(cleanFormValues(_cloneDeep(opts.form.getFieldsValue()), formConfig, true));\n      }\n\n      const updateMode = !!feature.getId();\n      overallUpdateMode ||= updateMode;\n      if (updateMode) {\n        feat.setId(feature.getId());\n      }\n      (updateMode ? updates : inserts).push(feat);\n    });\n\n    const transactionOpts: OlWriteTransactionOptions = {\n      featureNS: describeFeatureType.targetNamespace,\n      featurePrefix: describeFeatureType.targetPrefix,\n      featureType: opts.layer.getSource()?.getParams().LAYERS,\n      srsName: map.getView().getProjection().getCode(),\n      version: '1.1.0',\n      nativeElements: []\n    };\n\n    const transaction = new OlFormatWFS().writeTransaction(inserts, updates, deletes, transactionOpts);\n\n    if (overallUpdateMode && ClientConfiguration.wfsLockFeatureEnabled) {\n      const lockId = document.createElementNS('https://www.opengis.net/wfs', 'LockId');\n      lockId.appendChild(document.createTextNode('GeoServer'));\n      transaction.getRootNode()?.appendChild(lockId);\n    }\n\n    return transaction;\n  }, [map, allowedEditMode, executeWfsDescribeFeatureType, cleanFormValues]);\n\n  return writeWfsTransaction;\n};\n\nexport default useWriteWfsTransaction;\n","import React, {\n  useEffect\n} from 'react';\n\nimport {\n  Drawer\n} from 'antd';\n\nimport type {\n  DrawerProps\n} from 'antd/es/drawer';\n\nimport { useMap } from '@terrestris/react-util/dist/Hooks/useMap/useMap';\n\nimport './index.less';\n\nexport type MapDrawerProps = DrawerProps;\n\nexport const MapDrawer: React.FC<MapDrawerProps> = ({\n  open,\n  children,\n  ...passThroughProps\n}) => {\n\n  const map = useMap();\n\n  useEffect(() => {\n    document.querySelectorAll('#map')[0]?.classList.toggle('bisected', !!open);\n  }, [open]);\n\n  const onAfterDrawerOpenChange = () => {\n    map?.updateSize();\n  };\n\n  return (\n    <Drawer\n      rootClassName=\"map-drawer\"\n      mask={false}\n      open={open}\n      placement=\"right\"\n      width={getComputedStyle(document.documentElement).getPropertyValue('--drawerWidth')}\n      afterOpenChange={onAfterDrawerOpenChange}\n      {...passThroughProps}\n    >\n      {children}\n    </Drawer>\n  );\n};\n\nexport default MapDrawer;\n","import {\n  useCallback\n} from 'react';\n\nimport {\n  FeatureCollection\n} from 'geojson';\n\nimport {\n  Extent as OlExtent\n} from 'ol/extent';\nimport OlFormatFilter from 'ol/format/filter/Filter';\nimport OlFormatWFS from 'ol/format/WFS';\nimport OlSourceImageWMS from 'ol/source/ImageWMS';\nimport OlSourceTileWMS from 'ol/source/TileWMS';\n\nimport {\n  WmsLayer\n} from '@terrestris/ol-util/dist/typeUtils/typeUtils';\n\nimport {\n  useMap\n} from '@terrestris/react-util/dist/Hooks/useMap/useMap';\n\nimport {\n  getBearerTokenHeader\n} from '@terrestris/shogun-util/dist/security/getBearerTokenHeader';\n\nimport useExecuteWfsDescribeFeatureType, {\n  isGeometryType\n} from './useExecuteWfsDescribeFeatureType';\nimport useSHOGunAPIClient from './useSHOGunAPIClient';\n\nexport type GetFeatureOpts = {\n  /**\n   * The layer to generate the WFS GetFeature request for.\n   */\n  layer: WmsLayer;\n  /**\n   * The filter to apply to the GetFeature request.\n   */\n  filter?: OlFormatFilter | Element;\n  /**\n   * The properties to return for each feature.\n   */\n  propertyNames?: string[];\n  /**\n   * Maximum number of features to get.\n   */\n  maxFeatures?: number;\n  /**\n   * Extent to use for the BBOX filter. The geometryName option must be set.\n   */\n  bbox?: OlExtent;\n};\n\nexport const useExecuteGetFeature = () => {\n  const client = useSHOGunAPIClient();\n  const map = useMap();\n  const executeWfsDescribeFeatureType = useExecuteWfsDescribeFeatureType();\n\n  const executeGetFeature = useCallback(async (opts: GetFeatureOpts, version = '1.1.0') => {\n    if (!map) {\n      return;\n    }\n\n    const describeFeatureType = await executeWfsDescribeFeatureType(opts.layer);\n\n    if (!describeFeatureType) {\n      return;\n    }\n\n    let url;\n\n    const source = opts.layer.getSource();\n    if (source instanceof OlSourceImageWMS) {\n      url = source.getUrl();\n    }\n    if (source instanceof OlSourceTileWMS) {\n      const urls = source.getUrls();\n      url = urls ? urls[0] : undefined;\n    }\n\n    if (!url) {\n      return;\n    }\n\n    if (url.endsWith('?')) {\n      url = url.slice(0, -1);\n    }\n\n    // We expect a single feature type here since we filter on the feature type\n    // in the describe feature type request.\n    const geomProperty = describeFeatureType.featureTypes[0]?.properties\n      ?.find(property => isGeometryType(property.type));\n\n    const featureRequest = new OlFormatWFS({version: version}).writeGetFeature({\n      srsName: map.getView().getProjection().getCode(),\n      featureNS: describeFeatureType.targetNamespace,\n      featurePrefix: describeFeatureType.targetPrefix,\n      featureTypes: [source?.getParams().LAYERS],\n      outputFormat: 'application/json',\n      maxFeatures: opts.maxFeatures,\n      // Ensure the geometry is always returned.\n      propertyNames: (opts.propertyNames && geomProperty?.name) ? [...opts.propertyNames, geomProperty?.name] : undefined,\n      bbox: opts.bbox,\n      filter: opts.filter instanceof OlFormatFilter ? opts.filter : undefined,\n      geometryName: geomProperty?.name\n    });\n\n    if (featureRequest instanceof Element && opts.filter instanceof Element) {\n      featureRequest.getElementsByTagName('Query')[0].appendChild(opts.filter);\n    }\n\n    const defaultHeaders = {\n      'Content-Type': 'application/json'\n    };\n\n    const response = await fetch(url, {\n      method: 'POST',\n      headers: opts.layer?.get('useBearerToken') ? {\n        ...defaultHeaders,\n        ...getBearerTokenHeader(client?.getKeycloak())\n      } : defaultHeaders,\n      body: new XMLSerializer().serializeToString(featureRequest)\n    });\n\n    if (!response.ok) {\n      throw new Error('No successful response while executing a WFS-GetFeature');\n    }\n\n    return await response.json() as FeatureCollection;\n  }, [client, executeWfsDescribeFeatureType, map]);\n\n  return executeGetFeature;\n};\n\nexport default useExecuteGetFeature;\n","import { useCallback } from 'react';\n\n/**\n * This hook returns a function to calculate padding for the fit method\n * of an ol.View. It considers the menu width, header height, footer height\n * and drawer width if drawerOpen is set to true.\n *\n * It takes a boolean to determine if the drawer is open.\n *\n * The returned function (getFitPadding) computes an array consisting of:\n *   - header height (using the '--headerHeight' CSS property, defaults to 50px if undefined)\n *   - drawer width (using the '--drawerWidth' CSS property, defaults to 450px if undefined and if the drawer is open)\n *   - footer height (using the '--footerHeight' CSS property, defaults to 40px if undefined)\n *   - tool menu width (derived from the width of the element with the 'tool-menu' class)\n *\n * @returns (drawerOpen: boolean) => [number, number, number, number]\n */\nexport const useGetFitPadding = () => {\n\n  const getCssPropertyValue = useCallback((value: string, fallback: number) => {\n    return Number(\n      getComputedStyle(document.body).getPropertyValue(value).replace('px', '')\n    ) || fallback;\n  }, []);\n\n  /**\n   * This function calculates the padding for the fit method of an ol.View.\n   *\n   * @param drawerOpen Include the drawer width in the calculation\n   * @returns [topPadding, rightPadding, bottomPadding, leftPadding]\n   */\n  const getFitPadding = useCallback((drawerOpen = false) => {\n    const toolMenuElement = document.querySelector('.tool-menu');\n    const toolMenuWidth = toolMenuElement?.clientWidth ?? 0;\n\n    const headerHeight = getCssPropertyValue('--headerHeight', 50);\n    const footerHeight = getCssPropertyValue('--footerHeight', 40);\n\n    let drawerWidth = 0;\n    if (drawerOpen) {\n      drawerWidth = getCssPropertyValue('--drawerWidth', 450);\n    }\n\n    return [headerHeight, drawerWidth, footerHeight, toolMenuWidth];\n  }, [getCssPropertyValue]);\n\n  return getFitPadding;\n};\n\nexport default useGetFitPadding;\n","import * as React from 'react';\n\nimport './index.less';\n\ninterface DefaultProps {\n  alignment: 'horizontal' | 'vertical';\n}\n\nexport interface BaseProps extends Partial<DefaultProps> {\n  className?: string;\n}\n\nexport type ToolbarProps = BaseProps & React.HTMLAttributes<HTMLDivElement>;\n\nconst Toolbar: React.FC<ToolbarProps> = ({\n  alignment = 'horizontal',\n  className = '',\n  children,\n  ...passThroughProps\n}) => {\n  const baseClassName = 'toolbar';\n  const finalClassName = className\n    ? `${className} ${baseClassName}`\n    : baseClassName;\n\n  return (\n    <div\n      className={`${finalClassName} ${alignment}-toolbar`}\n      role=\"toolbar\"\n      {...passThroughProps}\n    >\n      {children}\n    </div>\n  );\n};\n\nexport default Toolbar;\n","import React, {\n  useEffect,\n  useMemo,\n  useRef,\n  useState\n} from 'react';\n\nimport {\n  faPencil,\n  faTrash,\n  faDrawPolygon,\n  faUndo\n} from '@fortawesome/free-solid-svg-icons';\nimport {\n  FontAwesomeIcon\n} from '@fortawesome/react-fontawesome';\n\nimport { TooltipPlacement } from 'antd/es/tooltip';\nimport {\n  FeatureCollection,\n  Feature\n} from 'geojson';\nimport { t } from 'i18next';\n\nimport _isEmpty from 'lodash/isEmpty';\n\nimport { isEmpty as isEmptyOlExtent } from 'ol/extent';\nimport OlFormatGeoJson from 'ol/format/GeoJSON';\nimport { DrawEvent as OlDrawEvent } from 'ol/interaction/Draw';\nimport OlLayerVector from 'ol/layer/Vector';\nimport OlSourceVector from 'ol/source/Vector';\n\nimport { DeleteButton } from '@terrestris/react-geo/dist/Button/DeleteButton/DeleteButton';\nimport DrawButton from '@terrestris/react-geo/dist/Button/DrawButton/DrawButton';\nimport { ModifyButton } from '@terrestris/react-geo/dist/Button/ModifyButton/ModifyButton';\nimport SimpleButton from '@terrestris/react-geo/dist/Button/SimpleButton/SimpleButton';\nimport { ToggleGroup } from '@terrestris/react-geo/dist/Button/ToggleGroup/ToggleGroup';\n\nimport { useMap } from '@terrestris/react-util/dist/Hooks/useMap/useMap';\nimport {\n  DigitizeUtil\n} from '@terrestris/react-util/dist/Util/DigitizeUtil';\n\nimport useAppDispatch from '../../../hooks/useAppDispatch';\nimport useAppSelector from '../../../hooks/useAppSelector';\nimport useGetFitPadding from '../../../hooks/useGetFitPadding';\n\nimport {\n  setFormDirty\n} from '../../../store/editFeature';\nimport Toolbar, { ToolbarProps } from '../../Toolbar';\n\nimport './index.less';\n\nexport type EditFeatureGeometryToolbarProps = ToolbarProps & {\n  feature: Feature;\n  historyLength?: number;\n};\n\ntype DrawType = 'Point' | 'LineString' | 'Polygon';\n\ntype EditHistory = {\n  past: FeatureCollection[];\n  future: FeatureCollection[];\n};\nexport const EditFeatureGeometryToolbar: React.FC<EditFeatureGeometryToolbarProps> = ({\n  feature,\n  historyLength = 10\n}) => {\n\n  const editHistory = useRef<EditHistory>({\n    past: [],\n    future: []\n  });\n\n  const map = useMap();\n  const dispatch = useAppDispatch();\n  const getFitPadding = useGetFitPadding();\n\n  const [editLayer, setEditLayer] = useState<OlLayerVector<OlSourceVector>>();\n  const [, setRevision] = useState<number>(0);\n  const [selected, setSelected] = useState<string | undefined>(undefined);\n\n  const gjFormat = useMemo(() => new OlFormatGeoJson(), []);\n\n  const allowedEditMode = useAppSelector(state => state.editFeature.userEditMode);\n  const formDirty = useAppSelector(state => state.editFeature.formDirty);\n\n  useEffect(() => {\n    if (!map) {\n      return;\n    }\n\n    if (!editLayer) {\n      setEditLayer(DigitizeUtil.getDigitizeLayer(map));\n    }\n\n    return () => {\n      if (editLayer) {\n        map?.removeLayer(editLayer);\n      }\n    };\n  }, [editLayer, map]);\n\n  useEffect(() => {\n    const isModified = editHistory.current.past.length > 0;\n    if (isModified && !formDirty) {\n      dispatch(setFormDirty(true));\n    }\n    // we only want to change formDirty state when the editHistory changes\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [dispatch, editHistory.current.past]);\n\n  useEffect(() => {\n    if (editLayer && feature?.id) {\n      editLayer.getSource()?.clear();\n      const olFeat = gjFormat.readFeature(feature);\n\n      if (Array.isArray(olFeat)) {\n        return;\n      }\n\n      const source = editLayer.getSource();\n\n      if (!source) {\n        return;\n      }\n\n      source.addFeature(olFeat);\n      setRevision(r => r + 1);\n\n      if (!isEmptyOlExtent(source.getExtent())) {\n        map?.getView().fit(source.getExtent(), {\n          padding: getFitPadding(true)\n        });\n      }\n    }\n  }, [feature, editLayer, gjFormat, map, getFitPadding]);\n\n  const undoEdit = () => {\n\n    const editSource = editLayer?.getSource();\n    const features = editSource?.getFeatures();\n\n    if (!features) {\n      return;\n    }\n\n    const clone: FeatureCollection = gjFormat.writeFeaturesObject(features);\n    const previousSource = editHistory.current.past[editHistory.current.past.length - 1];\n    if (!_isEmpty(previousSource)) {\n      editSource?.clear();\n      editSource?.addFeatures(gjFormat.readFeatures(previousSource));\n      editHistory.current = {\n        past: editHistory.current.past.slice(0, -1),\n        future: [...editHistory.current.future, clone].slice(-historyLength)\n      };\n      setRevision(r => r + 1);\n    }\n  };\n\n  const redoEdit = () => {\n\n    const editSource = editLayer?.getSource();\n    const features = editSource?.getFeatures();\n\n    if (!features) {\n      return;\n    }\n\n    const clone = gjFormat.writeFeaturesObject(features);\n    const nextSource = editHistory.current.future[editHistory.current.future.length - 1];\n    if (!_isEmpty(nextSource)) {\n      editSource?.clear();\n      editSource?.addFeatures(gjFormat.readFeatures(nextSource));\n\n      editHistory.current = {\n        future: editHistory.current.future.slice(0, -1),\n        past: [...editHistory.current.past, clone].slice(-historyLength)\n      };\n      setRevision(r => r + 1);\n    }\n  };\n\n  const onDrawEnd = (e: OlDrawEvent) => {\n    // overwrite existing geometry of feature\n    if (!feature.geometry.type.toLocaleLowerCase().startsWith('multi')) {\n      const source = editLayer?.getSource();\n      const existingFeature = source?.getFeatures()[0];\n      if (existingFeature) {\n        // drawbutton automatically adds the feature to the source so we need to remove it again\n        source?.once('addfeature', (e2) => source.removeFeature(e2.feature!));\n        existingFeature.setGeometry(e.feature.getGeometry());\n      }\n    }\n    updateRevision();\n  };\n\n  const updateRevision = () => {\n\n    const features = editLayer?.getSource()?.getFeatures();\n\n    if (!features) {\n      return;\n    }\n\n    const clone: FeatureCollection = gjFormat.writeFeaturesObject(features);\n    editHistory.current = {\n      ...editHistory.current,\n      past: [...editHistory.current.past, clone].slice(-10)\n    };\n    setRevision(r => r + 1);\n  };\n\n  const btnTooltipProps = {\n    tooltipPlacement: 'left' as TooltipPlacement,\n    tooltipProps: {\n      mouseEnterDelay: 0.5\n    }\n  };\n\n  if (!editLayer) {\n    return <></>;\n  }\n\n  if (allowedEditMode.includes('EDIT_GEOMETRY')) {\n    return (\n      <Toolbar\n        className=\"geometry-edit-tb\"\n        alignment=\"vertical\"\n      >\n        <ToggleGroup\n          selected={selected}\n          onChange={(_evt: any, value: string | undefined) => {\n            setSelected(value);\n          }}\n        >\n          {\n            allowedEditMode.includes('CREATE') ?\n              <DrawButton\n                value=\"create\"\n                icon={\n                  <FontAwesomeIcon icon={faPencil} />\n                }\n                pressedIcon={\n                  <FontAwesomeIcon icon={faPencil} />\n                }\n                name=\"draw\"\n                digitizeLayer={editLayer}\n                tooltip={t('EditFeatureGeometryToolbar.draw')}\n                drawType={feature.geometry.type as DrawType}\n                onDrawEnd={onDrawEnd}\n                {...btnTooltipProps}\n              />\n              : <></>\n          }\n          {\n            allowedEditMode.includes('UPDATE') ?\n              <ModifyButton\n                value=\"update\"\n                icon={\n                  <FontAwesomeIcon icon={faDrawPolygon} />\n                }\n                pressedIcon={\n                  <FontAwesomeIcon icon={faDrawPolygon} />\n                }\n                name=\"edit\"\n                digitizeLayer={editLayer}\n                tooltip={t('EditFeatureGeometryToolbar.edit')}\n                onModifyStart={updateRevision}\n                onModifyEnd={updateRevision}\n                onTranslateEnd={updateRevision}\n                {...btnTooltipProps}\n              />\n              : <></>\n          }\n          {\n            allowedEditMode.includes('DELETE') ?\n              <DeleteButton\n                value=\"delete\"\n                icon={\n                  <FontAwesomeIcon icon={faTrash} />\n                }\n                pressedIcon={\n                  <FontAwesomeIcon icon={faTrash} />\n                }\n                name=\"delete\"\n                digitizeLayer={editLayer}\n                tooltip={t('EditFeatureGeometryToolbar.delete')}\n                onFeatureRemove={updateRevision}\n                {...btnTooltipProps}\n              />\n              : <></>\n          }\n        </ToggleGroup>\n        <SimpleButton\n          icon={\n            <FontAwesomeIcon icon={faUndo} />\n          }\n          tooltip={t('EditFeatureGeometryToolbar.undo')}\n          onClick={undoEdit}\n          disabled={editHistory.current.past?.length === 0}\n          {...btnTooltipProps}\n        />\n        <SimpleButton\n          icon={\n            <FontAwesomeIcon\n              icon={faUndo}\n              flip=\"horizontal\"\n            />\n          }\n          tooltip={t('EditFeatureGeometryToolbar.redo')}\n          onClick={redoEdit}\n          disabled={editHistory.current.future?.length === 0}\n          {...btnTooltipProps}\n        />\n      </Toolbar>\n    );\n  } else {\n    return <></>;\n  }\n};\n\nexport default EditFeatureGeometryToolbar;\n","import React from 'react';\n\nimport {\n  Tabs,\n  TabsProps\n} from 'antd';\n\nimport {\n  FormInstance\n} from 'antd/lib/form/Form';\n\nimport {\n  Tab\n} from 'rc-tabs/lib/interface';\n\nimport {\n  PropertyFormItemEditConfig,\n  PropertyFormTabConfig\n} from '@terrestris/shogun-util/dist/model/Layer';\n\nimport EditFeatureForm from '../EditFeatureForm';\n\nexport type EditFeatureTabsProps = TabsProps & {\n  tabConfig?: PropertyFormTabConfig<PropertyFormItemEditConfig>[];\n  form: FormInstance;\n  initialValues?: Record<string, any>;\n};\n\nexport const EditFeatureTabs: React.FC<EditFeatureTabsProps> = ({\n  tabConfig,\n  form,\n  initialValues,\n  ...passThroughProps\n}) => {\n\n  const items = tabConfig?.map((config, idx) => {\n    return {\n      label: config.title,\n      key: `${idx}`,\n      forceRender: true,\n      children: (\n        <EditFeatureForm\n          name={config.title}\n          form={form}\n          initialValues={initialValues}\n          formConfig={config.children}\n        />\n      )\n    } as Tab;\n  });\n\n  return (\n    <Tabs\n      items={items}\n      {...passThroughProps}\n    />\n  );\n};\n\nexport default EditFeatureTabs;\n","import React, {\n  useState\n} from 'react';\n\nimport {\n  faTrash\n} from '@fortawesome/free-solid-svg-icons';\nimport {\n  FontAwesomeIcon\n} from '@fortawesome/react-fontawesome';\n\nimport {\n  Button,\n  ButtonProps,\n  Popconfirm\n} from 'antd';\n\nimport {\n  Feature\n} from 'geojson';\n\nimport OlFormatGeoJSON from 'ol/format/GeoJSON';\n\nimport {\n  useTranslation\n} from 'react-i18next';\n\nimport Logger from '@terrestris/base-util/dist/Logger';\n\nimport {\n  WmsLayer,\n  isWmsLayer\n} from '@terrestris/ol-util/dist/typeUtils/typeUtils';\nimport {\n  useMap\n} from '@terrestris/react-util/dist/Hooks/useMap/useMap';\n\nimport useExecuteWfsTransaction from '../../../hooks/useExecuteWfsTransaction';\nimport useWriteWfsTransaction from '../../../hooks/useWriteWfsTransaction';\n\nexport type DeleteButtonProps = ButtonProps & {\n  feature: Feature;\n  layer: WmsLayer;\n  onError?: (error: unknown) => void;\n  onSuccess?: () => void;\n};\n\nexport const DeleteButton: React.FC<DeleteButtonProps> = ({\n  feature,\n  layer,\n  onError = () => {},\n  onSuccess = () => {},\n  ...passThroughProps\n}) => {\n  const [loading, setLoading] = useState<boolean>(false);\n\n  const {\n    t\n  } = useTranslation();\n\n  const map = useMap();\n\n  const writeWfsTransaction = useWriteWfsTransaction();\n  const executeWfsTransaction = useExecuteWfsTransaction();\n\n  const onConfirmDelete = async () => {\n    if (!map) {\n      return;\n    }\n\n    if (!layer || !isWmsLayer(layer)) {\n      return;\n    }\n\n    try {\n      setLoading(true);\n\n      const olFeature = new OlFormatGeoJSON().readFeature(feature);\n\n      const transaction = await writeWfsTransaction({\n        deleteFeatures: Array.isArray(olFeature) ? olFeature : [olFeature],\n        layer: layer\n      });\n\n      if (!transaction) {\n        return;\n      }\n\n      await executeWfsTransaction({\n        layer: layer,\n        transaction: transaction\n      });\n\n      layer.getSource()?.refresh();\n\n      onSuccess();\n    } catch (error) {\n      Logger.error(error);\n\n      onError(error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <Popconfirm\n      title={t('DeleteButton.confirm')}\n      onConfirm={onConfirmDelete}\n      placement='bottomRight'\n    >\n      <Button\n        type='primary'\n        loading={loading}\n        disabled={!feature.id}\n        danger\n        icon={(\n          <FontAwesomeIcon\n            icon={faTrash}\n          />\n        )}\n        {...passThroughProps}\n      >\n        {\n          t('DeleteButton.title')\n        }\n      </Button>\n    </Popconfirm>\n  );\n};\n\nexport default DeleteButton;\n","import React from 'react';\n\nimport {\n  faRotateLeft\n} from '@fortawesome/free-solid-svg-icons';\nimport {\n  FontAwesomeIcon\n} from '@fortawesome/react-fontawesome';\n\nimport {\n  Button,\n  ButtonProps\n} from 'antd';\n\nimport {\n  FormInstance\n} from 'antd/lib/form/Form';\n\nimport {\n  Feature\n} from 'geojson';\n\nimport OlFormatGeoJson from 'ol/format/GeoJSON';\nimport {\n  useTranslation\n} from 'react-i18next';\n\nimport {\n  useMap\n} from '@terrestris/react-util/dist/Hooks/useMap/useMap';\nimport { DigitizeUtil } from '@terrestris/react-util/dist/Util/DigitizeUtil';\n\nimport useAppDispatch from '../../../hooks/useAppDispatch';\nimport {\n  setFormDirty\n} from '../../../store/editFeature';\n\nexport type ResetButtonProps = Omit<ButtonProps, 'form'> & {\n  feature: Feature;\n  form: FormInstance;\n};\n\nexport const ResetButton: React.FC<ResetButtonProps> = ({\n  feature,\n  form,\n  ...passThroughProps\n}) => {\n\n  const {\n    t\n  } = useTranslation();\n\n  const map = useMap();\n\n  const dispatch = useAppDispatch();\n\n  const onClick = () => {\n    form.resetFields();\n    dispatch(setFormDirty(false));\n\n    if (map) {\n      const editLayer = DigitizeUtil.getDigitizeLayer(map);\n      if (editLayer) {\n        editLayer.getSource()?.clear();\n        const format = new OlFormatGeoJson();\n        const olFeat = format.readFeature(feature);\n\n        if (Array.isArray(olFeat)) {\n          return;\n        }\n\n        editLayer.getSource()?.addFeature(olFeat);\n      }\n    }\n  };\n\n  return (\n    <Button\n      type='primary'\n      onClick={onClick}\n      icon={(\n        <FontAwesomeIcon\n          icon={faRotateLeft}\n        />\n      )}\n      {...passThroughProps}\n    >\n      {\n        t('ResetButton.title')\n      }\n    </Button>\n  );\n};\n\nexport default ResetButton;\n","import React from 'react';\n\nimport './index.less';\n\nexport type FeedbackIconProps = {\n  loadComplete: boolean;\n};\n\nexport const FeedbackIcon: React.FC<FeedbackIconProps> = ({\n  loadComplete = false\n}) => {\n\n  return (\n    <div className={loadComplete ? 'feedback-icon' : 'feedback-icon hidden'}>\n      <div className={loadComplete ? 'checkmark' : 'checkmark-hidden'} />\n    </div>\n  );\n};\n\nexport default FeedbackIcon;\n","import React, {\n  useState\n} from 'react';\n\nimport {\n  faFloppyDisk\n} from '@fortawesome/free-solid-svg-icons';\nimport {\n  FontAwesomeIcon\n} from '@fortawesome/react-fontawesome';\n\nimport {\n  Button,\n  ButtonProps\n} from 'antd';\n\nimport {\n  FormInstance\n} from 'antd/lib/form/Form';\n\nimport {\n  useTranslation\n} from 'react-i18next';\n\nimport Logger from '@terrestris/base-util/dist/Logger';\n\nimport {\n  WmsLayer,\n  isWmsLayer\n} from '@terrestris/ol-util/dist/typeUtils/typeUtils';\n\nimport {\n  useMap\n} from '@terrestris/react-util/dist/Hooks/useMap/useMap';\nimport {\n  DigitizeUtil\n} from '@terrestris/react-util/dist/Util/DigitizeUtil';\n\nimport useAppDispatch from '../../../hooks/useAppDispatch';\nimport useAppSelector from '../../../hooks/useAppSelector';\nimport useExecuteWfsTransaction from '../../../hooks/useExecuteWfsTransaction';\nimport useWriteWfsTransaction from '../../../hooks/useWriteWfsTransaction';\nimport {\n  setFormDirty\n} from '../../../store/editFeature';\n\nimport './index.less';\nimport FeedbackIcon from '../../FeedbackIcon';\n\nexport type SaveButtonProps = Omit<ButtonProps, 'form'> & {\n  form: FormInstance;\n  layer: WmsLayer;\n  onError?: (error?: unknown) => void;\n  onSuccess?: (response?: string) => void;\n};\n\nexport const SaveButton: React.FC<SaveButtonProps> = ({\n  form,\n  layer,\n  onError = () => {},\n  onSuccess = () => {},\n  ...passThroughProps\n}) => {\n  const [loading, setLoading] = useState<boolean>(false);\n  const [saveCompleted, setSaveCompleted] = useState(false);\n\n  const map = useMap();\n\n  const writeWfsTransaction = useWriteWfsTransaction();\n  const executeWfsTransaction = useExecuteWfsTransaction();\n\n  const dispatch = useAppDispatch();\n\n  const formDirty = useAppSelector(\n    state => state.editFeature.formDirty\n  );\n\n  const {\n    t\n  } = useTranslation();\n\n  const onClick = async () => {\n    if (!map) {\n      return;\n    }\n\n    if (!layer || !isWmsLayer(layer)) {\n      return;\n    }\n\n    const editLayer = DigitizeUtil.getDigitizeLayer(map);\n\n    if (!editLayer) {\n      Logger.error('Cannot find the digitize layer');\n      onError();\n      return;\n    }\n\n    const features = editLayer.getSource()?.getFeatures();\n\n    if (!features || features.length === 0) {\n      Logger.error('Cannot save feature without geometry');\n      onError(t('SaveButton.errorNoGeometry'));\n      return;\n    }\n\n    try {\n      await form.validateFields();\n    } catch (error) {\n      onError(error);\n      Logger.warn('Validation has failed: ', error);\n      return;\n    }\n\n    try {\n      setLoading(true);\n\n      const transaction = await writeWfsTransaction({\n        upsertFeatures: features,\n        form: form,\n        layer: layer\n      });\n\n      if (!transaction) {\n        return;\n      }\n\n      const result = await executeWfsTransaction({\n        layer: layer,\n        transaction: transaction\n      });\n\n      layer.getSource()?.refresh();\n\n      setSaveCompleted(true);\n      setTimeout(() => {\n        setSaveCompleted(false);\n      }, 3000);\n\n      dispatch(setFormDirty(false));\n\n      onSuccess(result);\n    } catch (error) {\n      Logger.error(error);\n\n      onError(error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <Button\n      className='save-button'\n      type='primary'\n      onClick={onClick}\n      loading={loading}\n      disabled={!formDirty}\n      icon={(\n        <FontAwesomeIcon\n          icon={faFloppyDisk}\n        />\n      )}\n      {...passThroughProps}\n    >\n      {\n        t('SaveButton.title')\n      }\n      <FeedbackIcon loadComplete={saveCompleted} />\n    </Button>\n  );\n};\n\nexport default SaveButton;\n","import React from 'react';\n\nimport {\n  FormInstance\n} from 'antd';\n\nimport {\n  Feature\n} from 'geojson';\n\nimport {\n  WmsLayer\n} from '@terrestris/ol-util/dist/typeUtils/typeUtils';\n\nimport useAppSelector from '../../../hooks/useAppSelector';\n\nimport DeleteButton from '../DeleteButton';\nimport ResetButton from '../ResetButton';\nimport SaveButton from '../SaveButton';\n\nimport './index.less';\n\nexport type EditFeatureToolbarProps = {\n  feature: Feature;\n  layer: WmsLayer;\n  form: FormInstance;\n  onSaveSuccess?: (responseText?: string) => void;\n  onSaveError?: (error: unknown) => void;\n  onDeleteSuccess?: () => void;\n  onDeleteError?: (error: unknown) => void;\n};\n\nexport const EditFeatureToolbar: React.FC<EditFeatureToolbarProps> = ({\n  feature,\n  layer,\n  form,\n  onSaveSuccess = () => {},\n  onSaveError = () => {},\n  onDeleteSuccess = () => {},\n  onDeleteError = () => {}\n}) => {\n  const allowedEditMode = useAppSelector(state => state.editFeature.userEditMode);\n\n  return (\n    <div\n      className='edit-feature-toolbar'\n    >\n      {\n        allowedEditMode.includes('CREATE') ||\n        allowedEditMode.includes('UPDATE') ?\n          <>\n            <ResetButton\n              feature={feature}\n              form={form}\n            />\n            <SaveButton\n              form={form}\n              layer={layer}\n              onSuccess={onSaveSuccess}\n              onError={onSaveError}\n            />\n          </>: <></>\n      }\n      {\n        allowedEditMode.includes('DELETE') &&\n        <DeleteButton\n          feature={feature}\n          layer={layer}\n          onSuccess={onDeleteSuccess}\n          onError={onDeleteError}\n        />\n      }\n    </div>\n  );\n};\n\nexport default EditFeatureToolbar;\n","import React, {\n  ReactNode, useCallback, useEffect, useState\n} from 'react';\n\nimport {\n  Alert, UploadFile\n} from 'antd';\nimport { useForm } from 'antd/lib/form/Form';\n\nimport dayjs from 'dayjs';\nimport { Feature } from 'geojson';\n\nimport { ValidateErrorEntity } from 'rc-field-form/es/interface';\n\nimport { useTranslation } from 'react-i18next';\n\nimport Logger from '@terrestris/base-util/dist/Logger';\n\nimport {\n  isWmsLayer, WmsLayer\n} from '@terrestris/ol-util/dist/typeUtils/typeUtils';\n\nimport { useMap } from '@terrestris/react-util/dist/Hooks/useMap/useMap';\n\nimport ShogunFile from '@terrestris/shogun-util/dist/model/File';\nimport {\n  PropertyFormItemEditConfig, PropertyFormTabConfig\n} from '@terrestris/shogun-util/dist/model/Layer';\n\nimport useAppDispatch from '../../../hooks/useAppDispatch';\nimport useConvertImageUrl from '../../../hooks/useConvertImageUrl';\nimport useExecuteGetFeature from '../../../hooks/useExecuteGetFeature';\nimport useSHOGunAPIClient from '../../../hooks/useSHOGunAPIClient';\n\nimport { setFeature } from '../../../store/editFeature';\n\nimport { isFileConfig } from '../EditFeatureForm';\nimport EditFeatureGeometryToolbar from '../EditFeatureGeometryToolbar';\nimport EditFeatureTabs from '../EditFeatureTabs';\nimport EditFeatureToolbar from '../EditFeatureToolbar';\n\nexport type EditFeatureFullFormProps = {\n  feature: Feature;\n  layer: WmsLayer;\n};\n\nexport const EditFeatureFullForm: React.FC<EditFeatureFullFormProps> = ({\n  feature,\n  layer\n}) => {\n  const {\n    t\n  } = useTranslation();\n  const executeGetFeature = useExecuteGetFeature();\n  const imageUrlToBase64 = useConvertImageUrl();\n\n  const [tabConfig, setTabConfig] = useState<PropertyFormTabConfig<PropertyFormItemEditConfig>[]>();\n  const [initialValues, setInitialValues] = useState<Record<string, any>>();\n  const [errorMsg, setErrorMsg] = useState<string | ReactNode>();\n\n  const [form] = useForm();\n  const map = useMap();\n  const dispatch = useAppDispatch();\n  const client = useSHOGunAPIClient();\n\n  const reloadFeature = useCallback(async (id: string) => {\n    if (!layer || !isWmsLayer(layer)) {\n      return;\n    }\n\n    const root = document.implementation.createDocument(null, 'root');\n    const filter = root.createElement('Filter');\n    const resourceId = root.createElement('ResourceId');\n    resourceId.setAttribute('rid', id);\n    filter.appendChild(resourceId);\n    root.documentElement.appendChild(filter);\n\n    const updatedFeatures = await executeGetFeature({\n      layer: layer,\n      filter: filter\n    },\n    '2.0.0');\n\n    if (\n      updatedFeatures?.features[0]\n    ) {\n      dispatch(setFeature(updatedFeatures?.features[0]));\n    }\n  }, [dispatch, executeGetFeature, layer]);\n\n  const update = useCallback(async () => {\n    if (!map || !client) {\n      return;\n    }\n\n    const editFormConfig = layer.get('editFormConfig') as PropertyFormTabConfig<PropertyFormItemEditConfig>[];\n\n    if (editFormConfig?.length === 0) {\n      Logger.warn(`Layer ${layer.get('name')} has no 'editFormConfig' set`);\n      return;\n    }\n\n    const properties = structuredClone(feature?.properties) || {};\n\n    const setPropertiesPromises = Object.entries(properties).map(async ([key, value]) => {\n      const tabConfigs = editFormConfig?.filter(tabCfg => {\n        return tabCfg.children?.find(formCfg => formCfg.propertyName === key);\n      });\n\n      if (tabConfigs?.length > 1) {\n        Logger.warn(`Property ${key} is configured in multiple tabs. Is this intended?`);\n      }\n\n      if (tabConfigs && tabConfigs[0]) {\n        const isDate = tabConfigs[0].children?.some(cfg => {\n          return cfg.propertyName === key && cfg.component === 'DATE';\n        });\n\n        if (isDate) {\n          const parsedDate = dayjs(value);\n\n          if (parsedDate.isValid()) {\n            properties[key] = parsedDate;\n          } else {\n            Logger.warn('Could not parse date');\n            properties[key] = null;\n          }\n        }\n\n        const isUpload = tabConfigs[0].children?.some(cfg => {\n          return cfg.propertyName === key && cfg.component === 'UPLOAD';\n        });\n\n        if (isUpload) {\n          if (value) {\n            try {\n              const parsedJson = JSON.parse(value);\n              if (!isFileConfig(parsedJson[0])) {\n                throw new Error('File config is no valid SHOGun file.');\n              }\n              const fileList = parsedJson as UploadFile<ShogunFile>[];\n              properties[key] = fileList;\n              const fileListWithBlob = fileList.map(async (val: any) => {\n                const isImageFile = fileList[0].response?.fileType?.startsWith('image/');\n                const thumbUrl = isImageFile ?\n                  await imageUrlToBase64(`${client.getBasePath()}imagefiles/${val?.response?.fileUuid}/thumbnail`) : undefined;\n                return {\n                  ...val,\n                  thumbUrl,\n                  url: isImageFile ? undefined : val.url\n                };\n              });\n\n              properties[key] = await Promise.all(fileListWithBlob);\n            } catch (error) {\n              Logger.error('Could not parse file list from JSON config: ', error);\n              properties[key] = [];\n            }\n          } else {\n            properties[key] = [];\n          }\n        }\n\n        const isReference = tabConfigs[0].children?.some(cfg =>\n          cfg.propertyName === key && cfg.component === 'REFERENCE_TABLE');\n\n        if (isReference) {\n          try {\n            properties[key] = JSON.parse(properties[key]);\n          } catch (error) {\n            Logger.warn('Could not parse the input for the REFERENCE_TABLE', error);\n          }\n        }\n      }\n    });\n\n    await Promise.all(setPropertiesPromises);\n\n    setInitialValues(properties);\n    form.resetFields();\n    form.setFieldsValue(properties);\n\n    setTabConfig(editFormConfig);\n  }, [map, client, layer, feature?.properties, form, imageUrlToBase64]);\n\n  useEffect(() => {\n    update();\n  }, [update]);\n\n  const formatErrorMessage = (error: ValidateErrorEntity): React.ReactNode => {\n    const collectedFieldErrors: string[] = [];\n    const errorFields = error.errorFields || [];\n\n    errorFields.forEach((field) => {\n      if (Array.isArray(field.errors)) {\n        collectedFieldErrors.push(...field.errors);\n      }\n    });\n\n    return collectedFieldErrors.map((line, index) => (\n      <React.Fragment key={index}>\n        {line}\n        {index !== collectedFieldErrors.length - 1 && <br/>}\n      </React.Fragment>\n    ));\n  };\n\n  const onSaveSuccess = (responseText?: string) => {\n    if (!responseText) {\n      return;\n    }\n    setErrorMsg(undefined);\n    const parser = new DOMParser();\n    const xmlDoc = parser.parseFromString(responseText, 'text/xml');\n\n    // get feature id from response\n    const featureId = xmlDoc.getElementsByTagName('ogc:FeatureId');\n    const idString = featureId.item(0)?.getAttribute('fid');\n    if (idString === 'none') {\n      const featId = feature.id;\n      if (!featId) {\n        return;\n      }\n      reloadFeature((featId as string));\n    } else if (idString) {\n      reloadFeature(idString);\n    }\n  };\n\n  const onSaveError = (error?: unknown) => {\n    if (typeof error === 'object' && error !== null && 'errorFields' in error) {\n      const formattedErrorMessage = formatErrorMessage(\n        error as ValidateErrorEntity\n      );\n      setErrorMsg(formattedErrorMessage);\n    } else if (typeof error === 'string') {\n      setErrorMsg(error);\n    } else {\n      setErrorMsg(t('EditFeatureFullForm.saveErrorMsg'));\n    }\n  };\n\n  const onDeleteSuccess = () => {\n    setErrorMsg(undefined);\n    dispatch(setFeature(null));\n  };\n\n  const onDeleteError = () => {\n    setErrorMsg(t('EditFeatureFullForm.deleteErrorMsg'));\n  };\n\n  return (\n    <>\n      <EditFeatureGeometryToolbar\n        feature={feature}\n      />\n      {\n        errorMsg && (\n          <Alert\n            className=\"error-alert\"\n            message={errorMsg}\n            type=\"error\"\n            showIcon\n          />\n        )\n      }\n      <EditFeatureToolbar\n        feature={feature}\n        layer={layer}\n        form={form}\n        onSaveSuccess={onSaveSuccess}\n        onSaveError={onSaveError}\n        onDeleteSuccess={onDeleteSuccess}\n        onDeleteError={onDeleteError}\n      />\n      <EditFeatureTabs\n        tabConfig={tabConfig}\n        initialValues={initialValues}\n        form={form}\n      />\n    </>\n  );\n};\n\nexport default EditFeatureFullForm;\n","import React, {\n  useState\n} from 'react';\n\nimport {\n  Button\n} from 'antd';\n\nimport ClientConfiguration from 'clientConfig';\n\nimport {\n  useTranslation\n} from 'react-i18next';\n\nimport Logger from '@terrestris/base-util/dist/Logger';\n\nimport {\n  WmsLayer\n} from '@terrestris/ol-util/dist/typeUtils/typeUtils';\n\nimport {\n  useMap\n} from '@terrestris/react-util/dist/Hooks/useMap/useMap';\n\nimport useAppDispatch from '../../../hooks/useAppDispatch';\nimport useAppSelector from '../../../hooks/useAppSelector';\nimport useExecuteWfsDescribeFeatureType, {\n  isGeometryType\n} from '../../../hooks/useExecuteWfsDescribeFeatureType';\nimport useExecuteWfsLockFeature from '../../../hooks/useExecuteWfsTransactionLock';\nimport useGetFeatureInfo from '../../../hooks/useGetFeatureInfo';\n\nimport {\n  setFeature\n} from '../../../store/editFeature';\n\nimport './index.less';\n\nexport type EditFeatureSwitchProps = {\n  layer: WmsLayer;\n  onLockSuccess?: (responseText: string) => void;\n  onLockError?: (error: unknown) => void;\n  onCreate?: () => void;\n};\n\nexport const EditFeatureSwitch: React.FC<EditFeatureSwitchProps> = ({\n  layer,\n  onLockSuccess = () => {},\n  onLockError = () => {},\n  onCreate = () => {}\n}) => {\n  const [loading, setLoading] = useState<boolean>(false);\n\n  const executeWfsDescribeFeatureType = useExecuteWfsDescribeFeatureType();\n  const executeWfsLockFeature = useExecuteWfsLockFeature();\n  const dispatch = useAppDispatch();\n  const map = useMap();\n  const {\n    t\n  } = useTranslation();\n\n  const allowedEditMode = useAppSelector(\n    state => state.editFeature.userEditMode\n  );\n\n  useGetFeatureInfo(layer, async (featureCollection) => {\n    if (\n      featureCollection.features.length &&\n      (allowedEditMode.includes('UPDATE') || allowedEditMode.includes('DELETE'))\n    ) {\n\n      const feature = featureCollection.features[0];\n\n      if (!layer || !feature) {\n        return;\n      }\n\n      if (ClientConfiguration.wfsLockFeatureEnabled) {\n        try {\n          const response = await executeWfsLockFeature({\n            layer: layer,\n            feature: feature\n          });\n\n          if (!response) {\n            return;\n          }\n\n          dispatch(setFeature(feature));\n\n          onLockSuccess(response);\n        } catch (error) {\n          onLockError(error);\n        }\n      } else {\n        dispatch(setFeature(feature));\n      }\n    }\n  });\n\n  const getGeometryType = async () => {\n    if (!map || !layer) {\n      return;\n    }\n\n    try {\n      setLoading(true);\n\n      const describeFeatureType = await executeWfsDescribeFeatureType(layer);\n\n      if (!describeFeatureType) {\n        return;\n      }\n\n      // We expect a single featureType here.\n      const geomProperty = describeFeatureType.featureTypes[0]?.properties\n        ?.find(property => isGeometryType(property.type));\n\n      switch (geomProperty?.type) {\n        case 'gml:MultiPoint':\n          return 'MultiPoint';\n        case 'gml:Point':\n          return 'Point';\n        case 'gml:MultiLineString':\n          return 'MultiLineString';\n        case 'gml:LineString':\n          return 'LineString';\n        case 'gml:MultiPolygon':\n          return 'MultiPolygon';\n        case 'gml:Polygon':\n          return 'Polygon';\n        case 'xsd:boolean':\n        case 'xsd:date':\n        case 'xsd:int':\n        case 'xsd:number':\n        case 'xsd:string':\n        case undefined:\n          return;\n        default:\n          break;\n      }\n    } catch (error) {\n      Logger.error(error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const onCreateClick = async () => {\n    const geomType = await getGeometryType();\n\n    if (!geomType) {\n      return;\n    }\n\n    dispatch(setFeature({\n      type: 'Feature',\n      properties: {},\n      geometry: {\n        type: geomType,\n        coordinates: []\n      }\n    }));\n\n    onCreate();\n  };\n\n  return (\n    <div className=\"edit-feature-switch\">\n      {allowedEditMode.includes('CREATE') && (\n        <>\n          {\n            allowedEditMode.includes('UPDATE') &&\n            <div>{t('EditFeatureSwitch.usageHint')}</div>\n          }\n          <Button\n            loading={loading}\n            onClick={onCreateClick}\n          >\n            {t('EditFeatureSwitch.createFeature')}\n          </Button>\n        </>\n      )}\n      {!allowedEditMode.includes('CREATE') &&\n        (allowedEditMode.includes('UPDATE') ||\n        allowedEditMode.includes('DELETE')) && (\n        <div>{t('EditFeatureSwitch.limitedUsageHint')}</div>\n      )}\n    </div>\n  );\n};\n\nexport default EditFeatureSwitch;\n","import {\n  useCallback\n} from 'react';\n\nimport {\n  Feature\n} from 'geojson';\n\nimport OlSourceImageWMS from 'ol/source/ImageWMS';\nimport OlSourceTileWMS from 'ol/source/TileWMS';\n\nimport Logger from '@terrestris/base-util/dist/Logger';\n\nimport {\n  WmsLayer\n} from '@terrestris/ol-util/dist/typeUtils/typeUtils';\n\nimport {\n  getBearerTokenHeader\n} from '@terrestris/shogun-util/dist/security/getBearerTokenHeader';\n\nimport useSHOGunAPIClient from './useSHOGunAPIClient';\n\nexport type ExecuteWfsLockOpts = {\n  layer: WmsLayer;\n  feature: Feature;\n};\n\nexport const useExecuteWfsLockFeature = () => {\n  const client = useSHOGunAPIClient();\n\n  const writeWfsLockFeature = (opts: ExecuteWfsLockOpts) => {\n    const featureId = opts.feature.id;\n    const featureProperties = opts.feature.properties;\n\n    if (!featureId || !featureProperties) {\n      Logger.warn('Either the id of the feature or its properties (or even both) aren\\'t available');\n      return;\n    }\n\n    let id: number;\n    if (typeof featureId === 'number') {\n      id = featureId;\n    } else {\n      id = parseInt(featureId.split('.')[1], 10);\n    }\n\n    const match = Object.entries(featureProperties).find(([, value]) => (value === id || value === id.toString()));\n\n    if (!match) {\n      Logger.warn('Count not detect the id property');\n      return;\n    }\n\n    const idProperty = match[0];\n\n    const typeName = opts.layer.getSource()?.getParams().LAYERS;\n\n    const lockFeatureDoc = document.createElementNS('https://www.opengis.net/wfs/2.0', 'LockFeature');\n\n    lockFeatureDoc.setAttribute('service', 'WFS');\n    lockFeatureDoc.setAttribute('version', '2.0.0');\n    // Expiry in seconds.\n    lockFeatureDoc.setAttribute('expiry', '300');\n    lockFeatureDoc.setAttribute('lockAction', 'SOME');\n\n    const queryElement = document.createElementNS('https://www.opengis.net/wfs/2.0', 'Query');\n    queryElement.setAttribute('typeNames', typeName);\n\n    const filterElement = document.createElementNS('https://www.opengis.net/fes/2.0', 'Filter');\n    const isEqualToElement = document.createElementNS('https://www.opengis.net/fes/2.0', 'PropertyIsEqualTo');\n\n    const valueReferenceElement = document.createElementNS('https://www.opengis.net/fes/2.0', 'ValueReference');\n    const valueReferenceValue = document.createTextNode(idProperty);\n    valueReferenceElement.appendChild(valueReferenceValue);\n\n    const literalElement = document.createElementNS('https://www.opengis.net/fes/2.0', 'Literal');\n    const literalValue = document.createTextNode(id.toString());\n    literalElement.appendChild(literalValue);\n\n    isEqualToElement.appendChild(valueReferenceElement);\n    isEqualToElement.appendChild(literalElement);\n\n    filterElement.appendChild(isEqualToElement);\n\n    queryElement.appendChild(filterElement);\n\n    lockFeatureDoc.appendChild(queryElement);\n\n    return lockFeatureDoc;\n  };\n\n  const executeWfsLockFeature = useCallback(async (opts: ExecuteWfsLockOpts) => {\n    let url;\n\n    const source = opts.layer.getSource();\n    if (source instanceof OlSourceImageWMS) {\n      url = source.getUrl();\n    }\n    if (source instanceof OlSourceTileWMS) {\n      const urls = source.getUrls();\n      url = urls ? urls[0] : undefined;\n    }\n\n    if (!url) {\n      return;\n    }\n\n    if (url.endsWith('?')) {\n      url = url.slice(0, -1);\n    }\n\n    const lockFeatureDoc = writeWfsLockFeature({\n      layer: opts.layer,\n      feature: opts.feature\n    });\n\n    if (!lockFeatureDoc) {\n      return;\n    }\n\n    const defaultHeaders = {\n      'Content-Type': 'application/xml'\n    };\n\n    const response = await fetch(url, {\n      method: 'POST',\n      headers: opts.layer?.get('useBearerToken') ? {\n        ...defaultHeaders,\n        ...getBearerTokenHeader(client?.getKeycloak())\n      } : defaultHeaders,\n      body: new XMLSerializer().serializeToString(lockFeatureDoc)\n    });\n\n    if (!response.ok) {\n      throw new Error('No successful response while executing a WFS-LockFeature');\n    }\n\n    const responseText = await response.text();\n\n    const parser = new DOMParser();\n    const xmlDoc = parser.parseFromString(responseText, 'text/xml');\n\n    // TODO Make detection more robust\n    const transactionLockFailed = xmlDoc.getElementsByTagName('wfs:FeaturesNotLocked');\n\n    if (transactionLockFailed.length > 0) {\n      throw new Error(`Error while locking a feature: ${responseText}`);\n    }\n\n    return responseText;\n  }, [client]);\n\n  return executeWfsLockFeature;\n};\n\nexport default useExecuteWfsLockFeature;\n","import {\n  useCallback,\n  useEffect\n} from 'react';\n\nimport {\n  FeatureCollection\n} from 'geojson';\n\nimport MapBrowserEvent from 'ol/MapBrowserEvent';\n\nimport Logger from '@terrestris/base-util/dist/Logger';\n\nimport {\n  WmsLayer\n} from '@terrestris/ol-util/dist/typeUtils/typeUtils';\n\nimport {\n  useMap\n} from '@terrestris/react-util/dist/Hooks/useMap/useMap';\n\nimport {\n  getBearerTokenHeader\n} from '@terrestris/shogun-util/dist/security/getBearerTokenHeader';\n\nimport useSHOGunAPIClient from './useSHOGunAPIClient';\n\nexport const useGetFeatureInfo = (layer?: WmsLayer, onSuccess?: (featureCollection: FeatureCollection) => void, onFailure?: () => void) => {\n  const map = useMap();\n  const client = useSHOGunAPIClient();\n\n  const onSingleClick = useCallback(async (evt: MapBrowserEvent<PointerEvent | KeyboardEvent | WheelEvent>) => {\n    if (!map || !layer) {\n      return;\n    }\n\n    const coords = evt.coordinate;\n\n    const viewResolution = map.getView().getResolution();\n\n    if (!viewResolution) {\n      return;\n    }\n\n    const source = layer.getSource();\n    const url = source?.getFeatureInfoUrl(\n      coords,\n      viewResolution,\n      map.getView().getProjection(),\n      {\n        INFO_FORMAT: 'application/json',\n        BUFFER: 10\n      }\n    );\n\n    const defaultHeaders = {\n      'Content-Type': 'application/json'\n    };\n\n    if (!url) {\n      return;\n    }\n\n    try {\n      map.getTargetElement().style.cursor = 'wait';\n\n      const response = await fetch(url, {\n        method: 'GET',\n        headers: layer.get('useBearerToken') ? {\n          ...defaultHeaders,\n          ...getBearerTokenHeader(client?.getKeycloak())\n        } : defaultHeaders\n      });\n\n      if (!response.ok) {\n        throw new Error('No successful response');\n      }\n\n      const featureCollection: FeatureCollection = await response.json();\n\n      if (onSuccess) {\n        onSuccess(featureCollection);\n      }\n    } catch (error) {\n      Logger.error('Error: ', error);\n\n      if (onFailure) {\n        onFailure();\n      }\n    } finally {\n      map.getTargetElement().style.cursor = '';\n    }\n  }, [client, layer, map, onSuccess, onFailure]);\n\n  const onPointerMove = useCallback((evt: MapBrowserEvent<PointerEvent | KeyboardEvent | WheelEvent>) => {\n    if (!map || !layer) {\n      return;\n    }\n\n    if (evt.dragging) {\n      return;\n    }\n\n    const data = layer.getData(evt.pixel);\n\n    if (!(data instanceof Uint8ClampedArray)) {\n      return;\n    }\n\n    const hit = data && data[3] > 0;\n\n    map.getTargetElement().style.cursor = hit ? 'pointer' : '';\n  }, [layer, map]);\n\n  useEffect(() => {\n    if (!map) {\n      return;\n    }\n\n    map.on('pointermove', onPointerMove);\n    map.on('singleclick', onSingleClick);\n\n    return () => {\n      map.un('pointermove', onPointerMove);\n      map.un('singleclick', onSingleClick);\n    };\n  }, [map, onPointerMove, onSingleClick]);\n};\n\nexport default useGetFeatureInfo;\n","import React, {\n  useEffect,\n  useState\n} from 'react';\n\nimport {\n  Alert, Modal\n} from 'antd';\n\nimport ClientConfiguration from 'clientConfig';\n\nimport OlFeature from 'ol/Feature';\n\nimport {\n  useTranslation\n} from 'react-i18next';\n\nimport Logger from '@terrestris/base-util/dist/Logger';\n\nimport { MapUtil } from '@terrestris/ol-util/dist/MapUtil/MapUtil';\n\nimport {\n  WmsLayer,\n  isWmsLayer\n} from '@terrestris/ol-util/dist/typeUtils/typeUtils';\n\nimport {\n  useMap\n} from '@terrestris/react-util/dist/Hooks/useMap/useMap';\n\nimport useAppDispatch from '../../hooks/useAppDispatch';\nimport useAppSelector from '../../hooks/useAppSelector';\nimport useExecuteWfsTransaction from '../../hooks/useExecuteWfsTransaction';\nimport useWriteWfsTransaction from '../../hooks/useWriteWfsTransaction';\n\nimport {\n  reset,\n  setFormDirty\n} from '../../store/editFeature';\nimport {\n  hide as hideEditFeatureDrawer\n} from '../../store/editFeatureDrawerOpen';\n\nimport MapDrawer, {\n  MapDrawerProps\n} from '../MapDrawer';\n\nimport EditFeatureFullForm from './EditFeatureFullForm';\nimport EditFeatureSwitch from './EditFeatureSwitch';\n\nimport './index.less';\n\nexport type EditFeatureDrawerProps = MapDrawerProps;\n\nexport const EditFeatureDrawer: React.FC<EditFeatureDrawerProps> = ({\n  ...passThroughProps\n}) => {\n  const {\n    t\n  } = useTranslation();\n\n  const [layer, setLayer] = useState<WmsLayer>();\n  const [isFeatureLocked, setIsFeatureLocked] = useState<boolean>(false);\n  const [drawerTitle, setDrawerTitle] = useState<string>(t('EditFeatureDrawer.featureEditor'));\n\n  const isDrawerOpen = useAppSelector(state => state.editFeatureDrawerOpen);\n  const layerId = useAppSelector(state => state.editFeature.layerId);\n  const feature = useAppSelector(state => state.editFeature.feature);\n  const formDirty = useAppSelector(state => state.editFeature.formDirty);\n\n  const map = useMap();\n  const dispatch = useAppDispatch();\n  const writeWfsTransaction = useWriteWfsTransaction();\n  const executeWfsTransaction = useExecuteWfsTransaction();\n\n  useEffect(() => {\n    if (!map || !layerId) {\n      return;\n    }\n\n    const olLayer = MapUtil.getLayerByOlUid(map, layerId);\n\n    if (!olLayer || !isWmsLayer(olLayer)) {\n      Logger.warn(`Could not find layer with id ${layerId}`);\n      return;\n    }\n\n    setDrawerTitle(`${t('EditFeatureDrawer.featureEditor')} - ${olLayer.get('name')}`);\n    setLayer(olLayer);\n  }, [map, layerId, t]);\n\n  const releaseLock = async () => {\n    if (!layer || !feature || !feature.id || !ClientConfiguration.wfsLockFeatureEnabled) {\n      return;\n    }\n\n    try {\n      const feat = new OlFeature();\n      feat.setId(feature.id);\n\n      const transaction = await writeWfsTransaction({\n        layer: layer,\n        deleteFeatures: [],\n        upsertFeatures: [feat]\n      });\n\n      if (!transaction) {\n        return;\n      }\n\n      await executeWfsTransaction({\n        layer: layer,\n        transaction: transaction\n      });\n    } catch (error) {\n      Logger.error('Error while releasing the lock on the feature: ', error);\n    }\n  };\n\n  const closeDrawer = async () => {\n    await releaseLock();\n\n    dispatch(hideEditFeatureDrawer());\n    dispatch(setFormDirty(false));\n    dispatch(reset());\n    setIsFeatureLocked(false);\n  };\n\n  const onDrawerClose = () => {\n    if (layer && feature && formDirty) {\n      Modal.confirm({\n        maskClosable: false,\n        title: t('EditFeatureDrawer.closeDrawerWarnTitle'),\n        content: t('EditFeatureDrawer.closeDrawerWarnContent'),\n        okType: 'danger',\n        onOk: closeDrawer\n      });\n    } else {\n      closeDrawer();\n    }\n  };\n\n  const onLockSuccess = () => {\n    setIsFeatureLocked(false);\n  };\n\n  const onLockError = () => {\n    setIsFeatureLocked(true);\n  };\n\n  const onCreate = () => {\n    setIsFeatureLocked(false);\n  };\n\n  return (\n    <MapDrawer\n      className=\"map-drawer edit-feature-drawer\"\n      onClose={onDrawerClose}\n      open={isDrawerOpen}\n      title={drawerTitle}\n      {...passThroughProps}\n    >\n      {\n        !layer && (\n          <Alert\n            message={t('EditFeatureDrawer.noLayerFoundError')}\n            type=\"error\"\n            showIcon\n          />\n        )\n      }\n      {\n        isFeatureLocked && (\n          <Alert\n            message={t('EditFeatureDrawer.isFeatureLockedErrorMsg')}\n            type=\"error\"\n            showIcon\n          />\n        )\n      }\n      {\n        layer && layerId && !feature &&\n        <EditFeatureSwitch\n          layer={layer}\n          onLockSuccess={onLockSuccess}\n          onLockError={onLockError}\n          onCreate={onCreate}\n        />\n      }\n      {\n        layer && feature &&\n        <EditFeatureFullForm\n          feature={feature}\n          layer={layer}\n        />\n      }\n    </MapDrawer>\n  );\n};\n\nexport default EditFeatureDrawer;\n","import React, {\n  useState\n} from 'react';\n\nimport {\n  Modal,\n  Statistic\n} from 'antd';\n\nimport {\n  ModalProps\n} from 'antd/lib/modal';\n\nimport {\n  useTranslation\n} from 'react-i18next';\n\nimport useAppSelector from '../../hooks/useAppSelector';\n\nimport {\n  useClientVersion\n} from '../../hooks/useVersion';\n\nimport './index.less';\n\ninterface ApplicationInfoProps extends ModalProps {\n  opener?: JSX.Element;\n}\n\nexport const ApplicationInfo: React.FC<ApplicationInfoProps> = ({\n  opener,\n  ...restProps\n}) => {\n  const {\n    t\n  } = useTranslation();\n\n  const appInfo = useAppSelector(state => state.appInfo);\n  const logoPath = useAppSelector(state => state.logoPath);\n  const appDescription = useAppSelector(state => state.description);\n\n  const [isVisible, setIsVisible] = useState<boolean>(false);\n\n  const toggleVisibility = () => {\n    setIsVisible(!isVisible);\n  };\n\n  let Opener;\n  if (opener) {\n    Opener = React.cloneElement(\n      opener,\n      {\n        onClick: toggleVisibility\n      }\n    );\n  } else {\n    Opener = <button onClick={toggleVisibility}>Open</button>;\n  }\n\n  return (\n    <>\n      {\n        Opener\n      }\n      <Modal\n        className='application-info'\n        title={t('ApplicationInfo.title')}\n        centered={true}\n        open={isVisible}\n        onOk={toggleVisibility}\n        onCancel={toggleVisibility}\n        footer={null}\n        {...restProps}\n      >\n        <img\n          className=\"logo\"\n          src={logoPath}\n          alt=\"Logo\"\n        />\n        <div\n          className=\"description\"\n        >\n          {appDescription}\n        </div>\n        <Statistic\n          title={t('ApplicationInfo.clientVersionTitle')}\n          value={useClientVersion()}\n        />\n        {\n          (appInfo.version && appInfo.buildTime) &&\n          <Statistic\n            title={t('ApplicationInfo.backendVersionTitle')}\n            value={`${appInfo.version} (${appInfo.buildTime})`}\n          />\n        }\n      </Modal>\n    </>\n  );\n};\n\nexport default ApplicationInfo;\n","export const useClientVersion = () => {\n  return PROJECT_VERSION;\n};\n","import React, {\n  useEffect\n} from 'react';\n\nimport {\n  Button,\n  Divider,\n  Tooltip\n} from 'antd';\n\nimport OlControlMousePosition from 'ol/control/MousePosition';\nimport OlControlScaleLine from 'ol/control/ScaleLine';\nimport { createStringXY } from 'ol/coordinate';\n\nimport { useTranslation } from 'react-i18next';\n\nimport ScaleCombo from '@terrestris/react-geo/dist/Field/ScaleCombo/ScaleCombo';\nimport { useMap } from '@terrestris/react-util/dist/Hooks/useMap/useMap';\n\nimport useAppSelector from '../../hooks/useAppSelector';\nimport { usePlugins } from '../../hooks/usePlugins';\n\nimport {\n  FooterPlacementOrientation,\n  isFooterIntegration\n} from '../../plugin';\n\nimport { Legal } from '../../store/legal';\n\nimport { ApplicationInfo } from '../ApplicationInfo';\n\nimport './index.less';\n\nexport type FooterProps = React.ComponentProps<'div'>;\n\nexport const Footer: React.FC<FooterProps> = ({\n  ...restProps\n}): JSX.Element => {\n  const plugins = usePlugins();\n  const { t } = useTranslation();\n\n  const legalInformation: Legal = useAppSelector(state => state.legal);\n  const map = useMap();\n\n  const insertPlugins = (itemPosition: FooterPlacementOrientation, items: JSX.Element[]) => {\n    plugins.forEach(plugin => {\n      if (isFooterIntegration(plugin.integration) && plugin.integration?.placementOrientation === itemPosition) {\n        const {\n          key,\n          wrappedComponent: WrappedPluginComponent\n        } = plugin;\n\n        items.splice(plugin.integration?.insertionIndex ?? 0, 0,\n          <WrappedPluginComponent\n            key={key}\n          />\n        );\n      }\n    });\n  };\n\n  useEffect(() => {\n    if (!map) {\n      return;\n    }\n\n    const existingControl = map\n      .getControls()\n      .getArray()\n      .find(control => control instanceof OlControlScaleLine);\n\n    if (existingControl) {\n      return;\n    }\n\n    map.addControl(\n      new OlControlScaleLine({\n        target: 'scale-line-container'\n      })\n    );\n  }, [map]);\n\n  useEffect(() => {\n    if (!map) {\n      return;\n    }\n\n    const existingControl = map\n      .getControls()\n      .getArray()\n      .find(control => control instanceof OlControlMousePosition);\n\n    if (existingControl) {\n      return;\n    }\n\n    map.addControl(\n      new OlControlMousePosition({\n        coordinateFormat: createStringXY(2),\n        projection: map.getView().getProjection(),\n        target: 'mouse-position'\n      })\n    );\n  }, [map]);\n\n  if (!map) {\n    return <></>;\n  }\n\n  const getLeftItems = () => {\n    const items = [\n      <div\n        key=\"scale-line-container\"\n        id=\"scale-line-container\"\n        aria-label=\"scale-line\"\n      />,\n      <Divider\n        key=\"scale-line-divider\"\n        type=\"vertical\"\n      />,\n      <div\n        key=\"scale-combo-container\"\n        className=\"scale-combo\"\n        aria-label='scale-combo'\n      >\n        {t('Footer.scale')}:&nbsp;\n        <ScaleCombo\n          aria-label='scalecombo-dropdown'\n        />\n        <Divider\n          type=\"vertical\"\n        />\n      </div>,\n      <div\n        key=\"reference-system-container\"\n        className=\"reference-system\"\n        aria-label=\"reference-system\"\n      >\n        {t('Footer.refSystem')}: {map.getView().getProjection().getCode()}\n        <Divider\n          type=\"vertical\"\n        />\n      </div>,\n      <div\n        key=\"mouse-position-container\"\n        className=\"mouse-position-wrapper\"\n      >\n        {t('Footer.mousePosition')}:&nbsp;\n        <div\n          id=\"mouse-position\"\n          className=\"mouse-position\"\n          aria-label=\"mouse-position\"\n        />\n      </div>\n    ];\n\n    insertPlugins('left', items);\n\n    return items;\n  };\n\n  const getRightItems = () => {\n    const items = [\n      <Button\n        key=\"open-contact\"\n        onClick={openContactModal}\n        type=\"link\"\n      >\n        {t('Footer.contact')}\n      </Button>,\n      <Button\n        key=\"open-imprint\"\n        onClick={openImprintModal}\n        type=\"link\"\n      >\n        {t('Footer.imprint')}\n      </Button>,\n      <Button\n        key=\"open-privacy\"\n        onClick={openPrivacyModal}\n        type=\"link\"\n      >\n        {t('Footer.privacypolicy')}\n      </Button>,\n      <ApplicationInfo\n        key=\"application-info\"\n        opener={\n          <Tooltip\n            title={t('Footer.aboutTooltip')}\n          >\n            <Button\n              type=\"link\"\n              aria-label=\"info-opener\"\n            >\n              {t('Footer.about')}\n            </Button>\n          </Tooltip>\n        }\n      />\n    ];\n\n    if (plugins.length > 0) {\n      insertPlugins('right', items);\n    }\n\n    return items;\n  };\n\n  const openContactModal = (): void => {\n    window.open(legalInformation.contact, '_blank');\n  };\n\n  const openImprintModal = (): void => {\n    window.open(legalInformation.imprint, '_blank');\n  };\n\n  const openPrivacyModal = (): void => {\n    window.open(legalInformation.privacy, '_blank');\n  };\n\n  return (\n    <div\n      className=\"footer\"\n      {...restProps}\n    >\n      <div\n        className=\"item-container left-items\"\n      >\n        {\n          getLeftItems()\n        }\n      </div>\n      <div\n        className=\"item-container right-items\"\n      >\n        {\n          getRightItems()\n        }\n      </div>\n    </div>\n  );\n};\n\nexport default Footer;\n","import React from 'react';\n\nimport {\n  faCircleQuestion\n} from '@fortawesome/free-solid-svg-icons';\nimport {\n  FontAwesomeIcon\n} from '@fortawesome/react-fontawesome';\n\nimport {\n  Button,\n  Tooltip\n} from 'antd';\nimport { ButtonProps } from 'antd/lib';\n\nimport { useTranslation } from 'react-i18next';\n\nexport type DocumentationButtonProps = ButtonProps;\n\nconst defaultClassName = 'documentationbutton';\nexport const DocumentationButton: React.FC<DocumentationButtonProps> = ({\n  className\n}) => {\n\n  const { t } = useTranslation();\n\n  const finalClassName = className\n    ? `${defaultClassName} ${className}`\n    : defaultClassName;\n\n  return (\n    <Tooltip\n      title={t('DocumentationButton.tooltip')}\n    >\n      <Button\n        type=\"link\"\n        aria-label=\"documentation-button\"\n        onClick={() => window.open('/gis-docs', '_blank')}\n        className={finalClassName}\n        icon={\n          <FontAwesomeIcon\n            icon={faCircleQuestion}\n          />\n        }\n      />\n    </Tooltip>\n  );\n};\n\nexport default DocumentationButton;\n","import React, {\n  useCallback,\n  useEffect,\n  useMemo,\n  useRef,\n  useState\n} from 'react';\n\nimport {\n  LoadingOutlined,\n  SearchOutlined,\n  SettingOutlined\n} from '@ant-design/icons';\nimport {\n  Checkbox,\n  Dropdown,\n  Empty,\n  Input,\n  InputProps,\n  Button,\n  Space,\n  Tooltip\n} from 'antd';\n\nimport ClientConfiguration from 'clientConfig';\n\nimport {\n  getUid\n} from 'ol';\nimport {\n  Extent as OlExtent\n} from 'ol/extent';\nimport OlFeature from 'ol/Feature';\nimport GeoJSON from 'ol/format/GeoJSON';\nimport {\n  transformExtent\n} from 'ol/proj';\nimport OlStyleCircle from 'ol/style/Circle';\nimport OlStyleFill from 'ol/style/Fill';\nimport OlStyleStroke from 'ol/style/Stroke';\nimport OlStyle from 'ol/style/Style';\n\nimport {\n  useTranslation\n} from 'react-i18next';\n\nimport Logger from '@terrestris/base-util/dist/Logger';\n\nimport { PermalinkUtil } from '@terrestris/ol-util';\n\nimport SearchResultsPanel, {\n  Category as ResultCategory\n} from '@terrestris/react-geo/dist/Panel/SearchResultsPanel/SearchResultsPanel';\n\nimport {\n  useMap\n} from '@terrestris/react-util/dist/Hooks/useMap/useMap';\n\nimport './index.less';\nimport useAppDispatch from '../../hooks/useAppDispatch';\nimport useGetFitPadding from '../../hooks/useGetFitPadding';\nimport { setSearchResultState } from '../../store/searchResult';\n\nexport type SearchEngineFunction = (value: string, viewBox?: OlExtent) => Promise<ResultCategory[] | undefined>;\n\nexport type Item = {\n  feature: OlFeature;\n};\n\nexport type MultiSearchProps = InputProps & {\n  /**\n   * The geocoder search engine to use.\n   */\n  geocoderSearchEngine?: SearchEngineFunction;\n\n  /**\n   * The data search engine to use.\n   */\n  dataSearchEngine?: SearchEngineFunction;\n};\n\nexport const MultiSearch: React.FC<MultiSearchProps> = ({\n  geocoderSearchEngine,\n  dataSearchEngine\n}): JSX.Element => {\n\n  const map = useMap();\n  const {\n    t\n  } = useTranslation();\n\n  const dispatch = useAppDispatch();\n  const clickAwayRef = useRef<HTMLDivElement>(null);\n\n  const geoJSONFormat = useMemo(() => new GeoJSON(), []);\n\n  const [isGeocoderEnabled, setIsGeocoderEnabled] = useState<boolean>(!!geocoderSearchEngine);\n  const [isDataSearchEnabled, setIsDataSearchEnabled] = useState<boolean>(!!dataSearchEngine);\n  const [useViewBox, setUseViewBox] = useState<boolean>(ClientConfiguration.search?.defaultUseViewBox ?? true);\n  const [searchValue, setSearchValue] = useState<string>('');\n  const [loading, setLoading] = useState<boolean>(false);\n  const [resultsVisible, setResultsVisible] = useState<boolean>(false);\n  const [settingsVisible, setSettingsVisible] = useState<boolean>(false);\n  const [searchResults, setSearchResults] = useState<ResultCategory[]>([]);\n  const getFitPadding = useGetFitPadding();\n\n  useEffect(() => {\n    window.addEventListener('mousedown', handleClickAway);\n\n    return () => {\n      window.removeEventListener('mousedown', handleClickAway);\n    };\n  }, []);\n\n  const handleClickAway = (e: Event) => {\n    let target = e.target;\n    while (target) {\n      target = (target as Node).parentNode;\n    }\n\n    if ((clickAwayRef.current && ((clickAwayRef.current as Element).contains(e.target as Node)))) {\n      return;\n    }\n\n    setResultsVisible(false);\n  };\n\n  const settingsMenu = useMemo(() => {\n    const menu = {\n      items: [{\n        label: (\n          <Checkbox\n            checked={useViewBox}\n            onChange={e => setUseViewBox(e.target.checked)}\n          >\n            {t('MultiSearch.searchInViewBox')}\n          </Checkbox>\n        ),\n        key: 'viewbox'\n      }]\n    };\n\n    if (geocoderSearchEngine) {\n      menu.items.push({\n        label: (\n          <Checkbox\n            checked={isGeocoderEnabled}\n            onChange={e => setIsGeocoderEnabled(e.target.checked)}\n          >\n            {t('MultiSearch.searchGeocoder')}\n          </Checkbox>\n        ),\n        key: 'geocoder'\n      });\n    }\n\n    if (dataSearchEngine) {\n      menu.items.push({\n        label: (\n          <Checkbox\n            checked={isDataSearchEnabled}\n            onChange={e => setIsDataSearchEnabled(e.target.checked)}\n          >\n            {t('MultiSearch.searchData')}\n          </Checkbox>\n        ),\n        key: 'data'\n      });\n    }\n\n    return menu;\n  }, [useViewBox, t, geocoderSearchEngine, dataSearchEngine, isGeocoderEnabled, isDataSearchEnabled]);\n\n  const performSearch = useCallback(async () => {\n    if (!map) {\n      return;\n    }\n\n    if (!isGeocoderEnabled && !isDataSearchEnabled) {\n      return;\n    }\n\n    const minChars = ClientConfiguration.search?.minChars ?? 3;\n    if (searchValue.length < minChars) {\n      resetSearch();\n      return;\n    }\n\n    setLoading(true);\n\n    let viewBox: OlExtent | undefined;\n\n    if (useViewBox) {\n      const mapViewProjection = map?.getView().getProjection();\n      const extent = map?.getView()?.calculateExtent();\n      if (extent) {\n        viewBox = transformExtent(extent, mapViewProjection, 'EPSG:4326');\n      }\n    }\n\n    const updatedResults: ResultCategory[] = [];\n\n    if (isDataSearchEnabled && dataSearchEngine) {\n      try {\n        const results = await dataSearchEngine(searchValue, viewBox);\n\n        if (!results) {\n          throw new Error('No response from data search engine.');\n        }\n\n        updatedResults.push(...results);\n      } catch (error) {\n        Logger.error('Error while data search: \\n', error);\n      } finally {\n        if (!isGeocoderEnabled) {\n          setLoading(false);\n        }\n      }\n    }\n\n    if (isGeocoderEnabled && geocoderSearchEngine) {\n      try {\n        const results = await geocoderSearchEngine(searchValue, viewBox);\n\n        if (!results) {\n          throw new Error('No response from geocoder search engine.');\n        }\n\n        updatedResults.push(...results);\n      } catch (error) {\n        Logger.error('Error while geocoder search: \\n', error);\n      } finally {\n        setLoading(false);\n      }\n    }\n\n    const allEmpty = updatedResults.every(result => result.features.length === 0);\n\n    setSearchResults(allEmpty ? [] : updatedResults);\n    setResultsVisible(true);\n  }, [map, isGeocoderEnabled, isDataSearchEnabled, searchValue, useViewBox, dataSearchEngine, geocoderSearchEngine]);\n\n  useEffect(() => {\n    const delay = ClientConfiguration.search?.delay ?? 1000;\n    const timeout = setTimeout(() => {\n      performSearch();\n    }, delay);\n\n    return () => clearTimeout(timeout);\n  }, [performSearch]);\n\n  const resetSearch = () => {\n    setSearchResults([]);\n  };\n\n  const actionsCreator = (item: any) => {\n    const feat = item.feature;\n    const layer = feat.get('layer');\n\n    if (!layer?.get('editable')) {\n      return;\n    }\n\n    // button is temporarily disabled\n    return [<></>];\n  };\n\n  const layerStyle = useMemo(() => (\n    new OlStyle({\n      stroke: new OlStyleStroke({\n        color: 'rgb(255,0,0)',\n        width: 2\n      }),\n      fill: new OlStyleFill({\n        color: 'rgba(255,255,255, 0.5)'\n      }),\n      image: new OlStyleCircle({\n        radius: 10,\n        fill: new OlStyleFill({\n          color: 'rgba(255,255,255, 0.5)'\n        }),\n        stroke: new OlStyleStroke({\n          color: 'rgb(255,0,0)',\n          width: 3\n        })\n      })\n    })\n  ), []);\n\n  const resultRenderer = () => {\n    if (searchValue.length < 2 || !resultsVisible || loading || !searchResults) {\n      return null;\n    }\n\n    const numTotal = searchResults.length;\n\n    if (numTotal === 0) {\n      return (\n        <div\n          className='no-search-result-div'\n        >\n          <Empty\n            image={Empty.PRESENTED_IMAGE_SIMPLE}\n          />\n        </div>\n      );\n    }\n\n    const onSearchResultClick = (item: Item) => {\n      setResultsVisible(false);\n      zoomOffsetOnClick(item);\n      if (ClientConfiguration.search?.activateLayerOnClick) {\n        activateLayer(item);\n      }\n\n      if (ClientConfiguration.search?.showSearchResultDrawer) {\n        const featureObject = geoJSONFormat.writeFeatureObject(item.feature);\n\n        const layerUndefined = featureObject.properties?.layer === undefined;\n\n        // Remove layer from properties, as it is not serializable\n        delete featureObject.properties?.layer;\n\n        dispatch(setSearchResultState({\n          geoJSONFeature: featureObject,\n          layerId: layerUndefined ? null : getUid(item.feature.get('layer')),\n          drawerVisibility: true\n        }));\n\n        setSearchValue('');\n      }\n    };\n\n    const activateLayer = (item: Item) => {\n      const layer = item?.feature?.get('layer');\n      if (layer && map && !layer.getVisible()) {\n        layer.setVisible(true);\n        // also make all parent folders / groups visible so\n        // that the layer becomes visible in map\n        PermalinkUtil.setParentsVisible(\n          map,\n          map.getLayerGroup().getLayers(),\n          getUid(layer)\n        );\n      }\n    };\n\n    const zoomOffsetOnClick = (item: Item) => {\n      const extent = item.feature.getGeometry()?.getExtent();\n\n      if (extent) {\n        map?.getView().fit(extent, {\n          size: map.getSize(),\n          padding: getFitPadding(ClientConfiguration.search?.showSearchResultDrawer)\n        });\n      }\n    };\n\n    return (\n      <SearchResultsPanel\n        searchResults={searchResults}\n        numTotal={numTotal}\n        accordion\n        searchTerms={searchValue.split(' ')}\n        actionsCreator={actionsCreator}\n        layerStyle={layerStyle}\n        onClick={onSearchResultClick}\n      />\n    );\n  };\n\n  const getPlaceholder = () => {\n    if (isGeocoderEnabled && isDataSearchEnabled) {\n      return t('MultiSearch.searchPlaceholder');\n    }\n\n    if (!isGeocoderEnabled && isDataSearchEnabled) {\n      return t('MultiSearch.searchPlaceholderDataOnly');\n    }\n\n    if (isGeocoderEnabled && !isDataSearchEnabled) {\n      return t('MultiSearch.searchPlaceholderGeocoderOnly');\n    }\n  };\n\n  return (\n    <div\n      className=\"multi-search\"\n      ref={clickAwayRef}\n    >\n      <Space.Compact>\n        <Input\n          value={searchValue}\n          disabled={!isGeocoderEnabled && !isDataSearchEnabled}\n          onChange={event => {\n            setLoading(event.target.value !== '');\n            setSearchValue(event.target.value);\n          }}\n          allowClear\n          onFocus={() => setResultsVisible(true)}\n          placeholder={getPlaceholder()}\n          prefix={<SearchOutlined />}\n          suffix={loading ? <LoadingOutlined /> : null}\n        />\n        <Dropdown\n          menu={settingsMenu}\n          trigger={['click']}\n          onOpenChange={setSettingsVisible}\n          open={settingsVisible}\n        >\n          <Tooltip\n            title={t('MultiSearch.settingsTooltip')}\n            placement=\"right\"\n          >\n            <Button\n              icon={<SettingOutlined />}\n            />\n          </Tooltip>\n        </Dropdown>\n      </Space.Compact>\n      {resultRenderer()}\n    </div>\n  );\n};\n\nexport default MultiSearch;\n","import React from 'react';\n\nimport {\n  InputProps\n} from 'antd/lib/input';\n\nimport Logger from '@terrestris/base-util/dist/Logger';\n\nimport useNominatimSearchEngine from '../../hooks/searchEngines/useNominatimSearchEngine';\nimport useSolrSearchEngine from '../../hooks/searchEngines/useSolrSearchEngine';\nimport useWfsSearchEngine from '../../hooks/searchEngines/useWfsSearchEngine';\nimport useAppSelector from '../../hooks/useAppSelector';\n\nimport MultiSearch from '../MultiSearch';\n\nexport type SearchFieldProps = InputProps;\n\nexport const SearchField: React.FC<SearchFieldProps> = ({\n  ...passThroughProps\n}): JSX.Element => {\n\n  const useNominatim = useAppSelector((state) => state.searchEngines.includes('nominatim'));\n  const useSolr = useAppSelector((state) => state.searchEngines.includes('solr'));\n  const useWfs = useAppSelector((state) => state.searchEngines.includes('wfs'));\n\n  const wfsSearchEngine = useWfsSearchEngine();\n  const solrSearchEngine = useSolrSearchEngine();\n  const nominatimSearchEngine = useNominatimSearchEngine();\n\n  const getGeocoderSearchEngine = () => {\n    if (useNominatim) {\n      return nominatimSearchEngine;\n    }\n  };\n\n  const getDataSearchEngine = () => {\n    // Only allow solr or wfs simultaneously.\n    if (useSolr && useWfs) {\n      Logger.warn('Both solr and wfs search are configured. Only one of them ' +\n        'can be used at the same time.');\n      return;\n    }\n\n    if (useSolr) {\n      return solrSearchEngine;\n    }\n\n    if (useWfs) {\n      return wfsSearchEngine;\n    }\n  };\n\n  // At least a single search engine should be configured.\n  if (!useNominatim && !useSolr && !useWfs ) {\n    Logger.warn('Neither nominatim, solr nor wfs search is configured.');\n    return <></>;\n  }\n\n  return (\n    <div\n      className=\"search\"\n      aria-label=\"search-field\"\n    >\n      <MultiSearch\n        aria-label=\"search\"\n        geocoderSearchEngine={getGeocoderSearchEngine()}\n        dataSearchEngine={getDataSearchEngine()}\n        {...passThroughProps}\n      />\n    </div>\n  );\n};\n\nexport default SearchField;\n","import {\n  useCallback\n} from 'react';\n\nimport ClientConfiguration from 'clientConfig';\n\nimport {\n  Extent as OlExtent\n} from 'ol/extent';\nimport OlFeature from 'ol/Feature';\nimport {\n  equalTo,\n  like,\n  or\n} from 'ol/format/filter';\nimport OlFormatGeoJSON from 'ol/format/GeoJSON';\nimport {\n  transformExtent\n} from 'ol/proj';\n\nimport Logger from '@terrestris/base-util/dist/Logger';\n\nimport {\n  isWmsLayer,\n  WmsLayer\n} from '@terrestris/ol-util/dist/typeUtils/typeUtils';\n\nimport type {\n  Category as ResultCategory\n} from '@terrestris/react-geo/dist/Panel/SearchResultsPanel/SearchResultsPanel';\n\nimport {\n  useMap\n} from '@terrestris/react-util/dist/Hooks/useMap/useMap';\n\nimport {\n  SearchConfig\n} from '@terrestris/shogun-util/dist/model/Layer';\n\nimport useExecuteGetFeature from '../useExecuteGetFeature';\nimport useExecuteWfsDescribeFeatureType from '../useExecuteWfsDescribeFeatureType';\n\nexport const isFulfilled = <T, >(p: PromiseSettledResult<T>): p is PromiseFulfilledResult<T> => p.status === 'fulfilled';\nexport const isRejected = <T, >(p: PromiseSettledResult<T>): p is PromiseRejectedResult => p.status === 'rejected';\n\nexport const useWfsSearchEngine = () => {\n  const map = useMap();\n  const executeGetFeature = useExecuteGetFeature();\n  const executeWfsDescribeFeatureType = useExecuteWfsDescribeFeatureType();\n\n  const replaceTemplates = useCallback((template: string, feature: OlFeature): string => {\n    // regex for template string with values in brackets, e.g. {name}\n    const pattern = /{\\s*(\\w+?)\\s*}/g;\n    return template.replace(pattern, (_, token) => feature.getProperties()[token] || '');\n  }, []);\n\n  const getFeatureTitle = useCallback((searchValue: string, feature: OlFeature, layer: WmsLayer) => {\n    const searchConfig = layer?.get('searchConfig') as SearchConfig;\n\n    if (searchConfig?.displayTemplate) {\n      return replaceTemplates(searchConfig.displayTemplate, feature);\n    }\n\n    for (const [key, value] of Object.entries(feature.getProperties())) {\n      const propValue = value?.toString();\n\n      if (propValue.toLowerCase().indexOf(searchValue?.toLowerCase()) > -1) {\n        // Show matched value followed by the attribute name in square brackets (e.g. '53111 Bonn [city]').\n        return `${propValue} [${key}]`;\n      }\n    }\n\n    // Fallback.\n    return feature.getId();\n  }, [replaceTemplates]);\n\n  const performWfsSearch = useCallback(async (value: string, viewBox?: OlExtent) => {\n    if (!map) {\n      return;\n    }\n\n    const searchableLayers = map.getAllLayers().filter(l => l.get('searchable'));\n\n    if (searchableLayers.length === 0) {\n      Logger.warn('No queryable layer found.');\n      return;\n    }\n\n    type GetFeatureResponse = ReturnType<typeof executeGetFeature>;\n\n    const promises: GetFeatureResponse[] = [];\n    const layers: WmsLayer[] = [];\n\n    for (const searchableLayer of searchableLayers) {\n      if (!isWmsLayer(searchableLayer)) {\n        Logger.warn('Layer type not supported in search: ', searchableLayer);\n        continue;\n      }\n\n      const searchConfig = searchableLayer?.get('searchConfig') as SearchConfig | null;\n\n      if (!(searchConfig && searchConfig.attributes)) {\n        Logger.warn('No search configuration given for layer: ', searchableLayer);\n        continue;\n      }\n\n      const describeFeatureType = await executeWfsDescribeFeatureType(searchableLayer);\n\n      if (!describeFeatureType) {\n        Logger.warn('No successful DescribeFeatureType for layer: ', searchableLayer);\n        continue;\n      }\n\n      const layerName: string | null = searchableLayer.getSource()?.getParams()?.LAYERS;\n\n      if (!layerName) {\n        Logger.warn('No layer name available for layer: ', searchableLayer);\n        continue;\n      }\n\n      const featureType = describeFeatureType.featureTypes.find(ft => ft.typeName === layerName || ft.typeName === layerName.split(':')?.[1]);\n\n      if (!featureType) {\n        Logger.warn('No corresponding feature type for layer: ', searchableLayer);\n        continue;\n      }\n\n      const filter = searchConfig.attributes\n        .map(attribute => {\n          const attr = featureType.properties.find(property => property.name === attribute);\n\n          if (!attr) {\n            Logger.warn(`Attribute \"${attribute}\" not found in feature type `+\n              `\"${featureType.typeName}\" for layer \"${searchableLayer.get('name')}\".`);\n            return null;\n          }\n\n          if (attr.localType === 'string') {\n            return like(attribute, `*${value}*`, '*', '.', '!', false);\n          } else if (attr.localType === 'number' || attr.localType === 'int') {\n            const numValue = Number(value);\n\n            if (isNaN(numValue)) {\n              return null;\n            }\n\n            return equalTo(attribute, numValue);\n          } else {\n            Logger.warn(`Attribute \"${attribute}\" with type \"${attr.localType}\" ` +\n              `not supported for search in layer \"${searchableLayer.get('name')}\".`);\n            return null;\n          }\n        })\n        .filter(f => f !== null);\n\n      if (filter.length === 0) {\n        Logger.warn('No valid filter available for layer: ', searchableLayer);\n        continue;\n      }\n\n      // Get all properties that\n      //   1. are defined in the display template\n      //   2. are defined in the result drawer config (if needed)\n      // Note: if no result drawer config is provided, all the attributes should be requested -> propertyNames is set to undefined\n      const propertyNames: string[] = [];\n\n      if (searchConfig.displayTemplate) {\n        const pattern = /{\\s*(\\w+?)\\s*}/g;\n        propertyNames.push(...Array.from(searchConfig.displayTemplate.matchAll(pattern), m => m[1]));\n      }\n\n      if (ClientConfiguration.search?.showSearchResultDrawer && searchConfig.resultDrawerConfig) {\n        propertyNames.push(...searchConfig.resultDrawerConfig?.children?.map(child => child.propertyName) || []);\n      }\n\n      promises.push(\n        executeGetFeature({\n          layer: searchableLayer,\n          filter: filter.length === 1 ? filter[0] : or(...filter),\n          // BBOX must be in map projection.\n          bbox: viewBox ? transformExtent(viewBox, 'EPSG:4326', map.getView().getProjection()) : undefined,\n          maxFeatures: 10,\n          propertyNames: searchConfig.resultDrawerConfig ? Array.from(new Set(propertyNames)) : undefined\n        })\n      );\n      layers.push(searchableLayer);\n    }\n\n    const results = (await Promise.allSettled(promises))\n      .map((settled, i) => ({\n        value: isFulfilled(settled) ? settled.value : undefined,\n        reason: isRejected(settled) ? settled.reason : undefined,\n        status: settled.status,\n        layer: layers[i]\n      }));\n\n    const fulfilledResponses = results.filter(res => res.status === 'fulfilled');\n    const rejectedResponses = results.filter(res => res.status === 'rejected');\n\n    rejectedResponses.forEach(res => {\n      Logger.error(`Error while fetching the layer search results for layer \"${res.layer.get('name')}\": `, res.reason);\n    });\n\n    const OlFormatGeoJson = new OlFormatGeoJSON();\n\n    const wfsResults: ResultCategory[] = [];\n\n    for (const fulfilledResponse of fulfilledResponses) {\n      const features = OlFormatGeoJson.readFeatures(fulfilledResponse.value, {\n        featureProjection: map.getView().getProjection()\n      });\n\n      features.forEach(feature => {\n        feature.set('title', getFeatureTitle(value, feature, fulfilledResponse.layer));\n        feature.set('layer', fulfilledResponse.layer);\n      });\n\n      wfsResults.push({\n        title: fulfilledResponse.layer.get('name'),\n        features: features\n      });\n    }\n\n    return wfsResults;\n  }, [executeGetFeature, executeWfsDescribeFeatureType, getFeatureTitle, map]);\n\n  return performWfsSearch;\n};\n\nexport default useWfsSearchEngine;\n","import {\n  useCallback\n} from 'react';\n\nimport ClientConfiguration from 'clientConfig';\n\nimport _groupBy from 'lodash/groupBy';\n\nimport {\n  Extent as OlExtent\n} from 'ol/extent';\nimport OlFeature from 'ol/Feature';\nimport OlFormatWKT from 'ol/format/WKT';\nimport OlGeometry from 'ol/geom/Geometry';\n\nimport Logger from '@terrestris/base-util/dist/Logger';\nimport {\n  MapUtil\n} from '@terrestris/ol-util/dist/MapUtil/MapUtil';\n\nimport {\n  isWmsLayer,\n  WmsLayer\n} from '@terrestris/ol-util/dist/typeUtils/typeUtils';\n\nimport type {\n  Category as ResultCategory\n} from '@terrestris/react-geo/dist/Panel/SearchResultsPanel/SearchResultsPanel';\n\nimport {\n  useMap\n} from '@terrestris/react-util/dist/Hooks/useMap/useMap';\n\nimport {\n  SearchConfig\n} from '@terrestris/shogun-util/dist/model/Layer';\n\nimport generateSolrQuery from '../../utils/generateSolrQuery';\n\nimport useExecuteSolrQuery from '../useExecuteSolrQuery';\n\nexport type DataSearchResult = Record<string, string | string[] | number[]>;\n\nexport type HighlightingResult = Record<string, string>;\n\nexport type HighlightingResults = Record<string, HighlightingResult>;\n\nexport const isFulfilled = <T, >(p: PromiseSettledResult<T>): p is PromiseFulfilledResult<T> => p.status === 'fulfilled';\nexport const isRejected = <T, >(p: PromiseSettledResult<T>): p is PromiseRejectedResult => p.status === 'rejected';\n\nexport const useSolrSearchEngine = () => {\n  const map = useMap();\n  const executeSolrQuery = useExecuteSolrQuery();\n\n  const replaceTemplates = useCallback((template: string, data: DataSearchResult): string => {\n    const pattern = /{\\s*(\\w+?)\\s*}/g; // regex for template string with values in brackets, e.g. {name}\n    return template.replace(pattern, (_, token) => data[token]?.toString() || '');\n  }, []);\n\n  const getFeatureTitle = useCallback((value: string, dsResult: DataSearchResult, highlightResult?: HighlightingResult): string => {\n    if (!map) {\n      return '';\n    }\n\n    const layer = MapUtil.getLayerByNameParam(map, dsResult.featureType[0] as string);\n    const searchConfig = layer?.get('searchConfig') as SearchConfig;\n\n    const blacklistedAttributes = [\n      'geometry'\n    ];\n\n    let title = '';\n\n    if (searchConfig?.displayTemplate) {\n      return replaceTemplates(searchConfig.displayTemplate, dsResult);\n    }\n\n    if (highlightResult) {\n      const filteredHighlightKeys = Object.keys(highlightResult).filter(key => !blacklistedAttributes.includes(key));\n      if (filteredHighlightKeys.length > 0) {\n        const highlightValue = highlightResult[filteredHighlightKeys[0]];\n        return `${highlightValue} [${filteredHighlightKeys[0]}]`;\n      }\n    }\n\n    Object.keys(dsResult)\n      .filter(key => !blacklistedAttributes.includes(key))\n      .forEach(propKey => {\n        const propValue = dsResult[propKey]?.toString();\n        if (!title && propValue.toLowerCase().indexOf(value.toLowerCase()) > -1) {\n          // show matched value followed by the attribute name in square brackets (e.g. '53111 Bonn [city]')\n          title = `${propValue} [${propKey}]`;\n        }\n      });\n\n    if (!title) {\n      // fallback -> should never happen after adding of the valid layer search config\n      title = dsResult.id as string;\n    }\n\n    return title;\n  }, [map, replaceTemplates]);\n\n  const applyAttributesToFeature = useCallback((\n    olFeature: OlFeature,\n    dsResult: DataSearchResult\n  ): void => {\n    const blacklistedAttributes = [\n      'category',\n      'id',\n      'featureType',\n      'geometry',\n      'search',\n      '_version_'\n    ];\n\n    Object.keys(dsResult)\n      .filter(key => !blacklistedAttributes.includes(key))\n      .forEach(key => {\n        const value = dsResult[key];\n        if (value !== undefined) {\n          olFeature.set(key, value);\n        }\n      });\n  }, []);\n\n  const performSolrSearch = useCallback(async (value: string, viewBox?: OlExtent) => {\n    if (!map) {\n      return;\n    }\n\n    const solrBasePath = ClientConfiguration.search?.solrBasePath ?? '/search/query';\n    const queriesPerLayer = generateSolrQuery({\n      searchValue: value,\n      map\n    });\n\n    type SolrQueryResponse = ReturnType<typeof executeSolrQuery>;\n\n    const promises: SolrQueryResponse[] = [];\n\n    for (const queryPerLayer of queriesPerLayer) {\n      promises.push(executeSolrQuery({\n        searchUrl: solrBasePath,\n        query: queryPerLayer.query,\n        fieldList: queryPerLayer.fieldList,\n        rowsPerQuery: ClientConfiguration.search?.solrQueryConfig?.rowsPerQuery,\n        queryParser: ClientConfiguration.search?.solrQueryConfig?.queryParser,\n        coreName: ClientConfiguration.search?.coreName,\n        useSolrHighlighting: ClientConfiguration.search?.useSolrHighlighting,\n        tagPre: ClientConfiguration.search?.solrQueryConfig?.tagPre,\n        tagPost: ClientConfiguration.search?.solrQueryConfig?.tagPost,\n        requireFieldMatch: ClientConfiguration.search?.solrQueryConfig?.requireFieldMatch,\n        viewBox: viewBox\n      }));\n    }\n\n    const results = (await Promise.allSettled(promises))\n      .map((settled) => ({\n        value: isFulfilled(settled) ? settled.value : undefined,\n        reason: isRejected(settled) ? settled.reason : undefined,\n        status: settled.status\n      }));\n\n    const fulfilledResponses = results.filter(res => res.status === 'fulfilled');\n    const rejectedResponses = results.filter(res => res.status === 'rejected');\n\n    rejectedResponses.forEach(res => {\n      Logger.error('Error while fetching the solr results for layer ', res.reason);\n    });\n\n    const dataResults = fulfilledResponses.flatMap(sR => sR.value?.response?.docs).filter(r => r);\n    const hlResults = Object.assign({}, ...fulfilledResponses.map(sr => sr.value?.highlighting));\n\n    const wktFormat = new OlFormatWKT();\n\n    const solrResults: ResultCategory[] = [];\n\n    // 1. group by category or layer title\n    let categories;\n    if (ClientConfiguration.search?.groupByCategory) {\n      categories = _groupBy(dataResults, res => res?.category?.[0]);\n    } else {\n      const sarchableLayers = map.getAllLayers().filter(l => l.get('searchable'));\n      const resultsWithLayerName = dataResults.map(result => {\n        const layerTitle = sarchableLayers.filter(l => isWmsLayer(l))\n          .find((l) => (l as WmsLayer).getSource()?.getParams()?.LAYERS === result?.featureType?.[0])\n          ?.get('name');\n\n        return {\n          layerTitle,\n          ...result\n        } as DataSearchResult;\n      });\n      categories = _groupBy(resultsWithLayerName, res => res?.layerTitle);\n    }\n\n    // 2. build features\n    Object.keys(categories).forEach(category => {\n      const features = categories[category].map(dsResult => {\n        if (!dsResult?.geometry?.[0]) {\n          return;\n        }\n        const id = dsResult.id as string;\n\n        const geometry = wktFormat.readGeometry(dsResult.geometry[0], {\n          dataProjection: 'EPSG:4326',\n          featureProjection: map.getView().getProjection()\n        });\n        const olFeat = new OlFeature({\n          geometry\n        });\n\n        applyAttributesToFeature(olFeat, dsResult);\n\n        olFeat.set('title', getFeatureTitle(value, dsResult, hlResults?.[id]));\n        let ftName;\n        if (dsResult.featureType?.[0]) {\n          const layer = MapUtil.getLayerByNameParam(map, dsResult.featureType?.[0] as string);\n          if (layer) {\n            olFeat.set('layer', layer);\n            ftName = layer.get('name');\n          }\n        } else {\n          ftName = id.substring(0, id.lastIndexOf('_'));\n        }\n        olFeat.set('ftName', ftName);\n        return olFeat;\n      }).filter(f => f) as OlFeature<OlGeometry>[];\n      const resultCategory: ResultCategory = {\n        title: category,\n        features\n      };\n      solrResults.push(resultCategory);\n    });\n\n    return solrResults;\n  }, [applyAttributesToFeature, executeSolrQuery, getFeatureTitle, map]);\n\n  return performSolrSearch;\n};\n\nexport default useSolrSearchEngine;\n","import {\n  useCallback\n} from 'react';\n\nimport {\n  Extent as OlExtent\n} from 'ol/extent';\n\nimport {\n  getBearerTokenHeader\n} from '@terrestris/shogun-util/dist/security/getBearerTokenHeader';\n\nimport useSHOGunAPIClient from './useSHOGunAPIClient';\n\nexport type SolrQueryDocument = {\n  /**\n   * The id of the document.\n   */\n  id: string;\n  /**\n   * The category of the feature.\n   */\n  category?: string[];\n  /**\n   * The name of the feature type.\n   */\n  featureType?: string[];\n  /**\n   * The WKT geometry.\n   */\n  geometry?: string[];\n};\n\nexport type SolrQueryResponse = {\n  highlighting: Record<string, unknown>;\n  response: {\n    docs: SolrQueryDocument[];\n    numFound: number;\n    numFoundExact: boolean;\n    start: number;\n  };\n  responseHeader: {\n    QTime: number;\n    params: {\n      json: string;\n    };\n    status: number;\n  };\n};\n\nexport type SolrQueryConfig = {\n  q: string;\n  fq?: string;\n  defType?: 'lucene' | 'dismax' | 'edismax';\n  qf?: string;\n  rows?: number;\n  hl?: boolean;\n  'hl.fl'?: string;\n  'hl.tag.pre'?: string;\n  'hl.tag.post'?: string;\n  'hl.requireFieldMatch'?: boolean;\n};\n\nexport type SolrQueryOpts = {\n  searchUrl: string;\n  query: string;\n  fieldList?: string;\n  useSolrHighlighting?: boolean;\n  tagPre?: string;\n  tagPost?: string;\n  requireFieldMatch?: boolean;\n  viewBox?: OlExtent;\n  rowsPerQuery?: number;\n  queryParser?: 'lucene' | 'dismax' | 'edismax';\n  coreName?: string;\n};\n\nexport const useExecuteSolrQuery = () => {\n  const client = useSHOGunAPIClient();\n\n  const executeSolrQuery = useCallback(async (opts: SolrQueryOpts) => {\n    const solrQueryConfig: SolrQueryConfig = {\n      q: opts.query,\n      rows: opts.rowsPerQuery ?? 100,\n      defType: opts.queryParser ?? 'edismax'\n    };\n\n    if (opts.fieldList) {\n      solrQueryConfig.qf = opts.fieldList;\n    } else {\n      solrQueryConfig.qf = opts.coreName ?? 'search';\n    }\n\n    if (opts.viewBox) {\n      const bboxFilter = `geometry:[${opts.viewBox[1]},${opts.viewBox[0]} TO ${opts.viewBox[3]},${opts.viewBox[2]}]`;\n      solrQueryConfig.fq = bboxFilter;\n    }\n\n    if (opts.useSolrHighlighting) {\n      solrQueryConfig.hl = true;\n      solrQueryConfig['hl.fl'] = '*';\n      solrQueryConfig['hl.tag.pre'] = opts.tagPre ?? '<b>';\n      solrQueryConfig['hl.tag.post'] = opts.tagPost ?? '</b>';\n      solrQueryConfig['hl.requireFieldMatch'] = opts.requireFieldMatch ?? true;\n    }\n\n    const defaultHeaders = {\n      'Content-Type': 'application/json'\n    };\n\n    const response = await fetch(opts.searchUrl, {\n      method: 'POST',\n      headers: {\n        ...defaultHeaders,\n        ...getBearerTokenHeader(client?.getKeycloak())\n      },\n      body: JSON.stringify(solrQueryConfig)\n    });\n\n    if (!response.ok) {\n      throw new Error('Failed to execute Solr query');\n    }\n\n    return await response.json() as SolrQueryResponse;\n  }, [client]);\n\n  return executeSolrQuery;\n};\n\nexport default useExecuteSolrQuery;\n","import {\n  useCallback\n} from 'react';\n\nimport ClientConfiguration from 'clientConfig';\n\nimport _isNil from 'lodash/isNil';\n\nimport {\n  Extent as OlExtent\n} from 'ol/extent';\nimport OlFormatGeoJSON from 'ol/format/GeoJSON';\n\nimport {\n  useTranslation\n} from 'react-i18next';\n\nimport type {\n  Category as ResultCategory\n} from '@terrestris/react-geo/dist/Panel/SearchResultsPanel/SearchResultsPanel';\n\nimport {\n  createNominatimSearchFunction\n} from '@terrestris/react-util/dist/Hooks/search/createNominatimSearchFunction';\nimport {\n  useMap\n} from '@terrestris/react-util/dist/Hooks/useMap/useMap';\n\nexport const useNominatimSearchEngine = () => {\n  const map = useMap();\n\n  const {\n    t\n  } = useTranslation();\n\n  const performNominatimSearch = useCallback(async (value: string, viewBox?: OlExtent) => {\n    if (!map) {\n      return;\n    }\n\n    const executeNominatimSearch = createNominatimSearchFunction({\n      bounded: viewBox ? 1 : undefined,\n      viewBox: viewBox ? viewBox?.toString() : undefined,\n      countryCodes: '',\n      nominatimBaseUrl: ClientConfiguration.search?.nominatimUrl ?? 'https://nominatim.openstreetmap.org/search?'\n    });\n\n    const response = await executeNominatimSearch(value);\n\n    const geoJsonFormat = new OlFormatGeoJSON();\n    const nFeats = response?.features\n      .filter(f => !_isNil(f?.properties.geojson))\n      .map(f => {\n        const olFeat = geoJsonFormat.readFeature(f.geometry, {\n          dataProjection: 'EPSG:4326',\n          featureProjection: map.getView().getProjection()\n        });\n\n        if (Array.isArray(olFeat)) {\n          return;\n        }\n\n        olFeat.setProperties(f.properties);\n\n        olFeat.set('title', f.properties.display_name);\n\n        return olFeat;\n      })\n      .filter(f => f !== undefined);\n\n    const nResults: ResultCategory[] = [{\n      title: t('useNominatimSearchEngine.title'),\n      features: nFeats ?? []\n    }];\n\n    return nResults;\n  }, [map, t]);\n\n  return performNominatimSearch;\n};\n\nexport default useNominatimSearchEngine;\n","import _groupBy from 'lodash/groupBy';\nimport Map from 'ol/Map';\n\nimport {\n  WmsLayer,\n  isWmsLayer\n} from '@terrestris/ol-util/dist/typeUtils/typeUtils';\n\nimport {\n  SearchConfig\n} from '@terrestris/shogun-util/dist/model/Layer';\n\nexport interface SolrQueryProps {\n  searchValue: string;\n  map: Map;\n}\n\ntype SolrQuery = {\n  query: string;\n  fieldList?: string;\n};\n\n/**\n * Generates a solr search query based on the `searchConfiguration` and `searchable` properties of each layer. This\n * currently considers all layers which are part of the layer tree / map.\n */\nexport const generateSolrQuery = ({\n  searchValue,\n  map\n}: SolrQueryProps): SolrQuery[] => {\n  // parse searchValue into an array of search terms,\n  // removing special characters and white spaces\n  const parts = searchValue.trim()\n    .replaceAll(/[()\\\\\\-_.//]/g, ' ')\n    .split(' ')\n    .map(s => s.trim())\n    .filter(s => s !== '');\n\n  const searchQueries: SolrQuery[] = [];\n  const layers = map.getAllLayers().filter(l => l.get('searchable'));\n  const groupedLayers = _groupBy(layers, (l) => (l.get('searchConfig') as SearchConfig)?.attributes);\n\n  Object.entries(groupedLayers).forEach(([key, layerList]) => {\n    const layerNames = layerList\n      .filter(l => isWmsLayer(l))\n      .map(l => (l as WmsLayer).getSource()?.getParams()?.LAYERS);\n\n    const featureTypeParts = layerNames.map(layerName => `featureType:\"${layerName}\"`);\n    const featureTypeQuery = featureTypeParts.join(' OR ');\n\n    const query = `(${featureTypeQuery}) AND (${generateSearchQuery(parts)})`;\n    searchQueries.push({\n      query: query,\n      fieldList: key !== 'undefined' ? key.split(',').join(' ') : undefined\n    });\n  });\n\n  return searchQueries;\n};\n\n/**\n * Applies operators for wildcard and fuzzy search to a solr (sub)query for multiple search terms.\n * Also includes exact matches to allow searching for numeric values.\n * @param searchParts The search input which may consist of multiple search terms, e.g. [\"foo\", \"bar\"]\n */\nconst generateSearchQuery = (\n  searchParts: string[]\n): string => {\n  const subQueries = searchParts.map(part => {\n    return `(${part.trim()}^4 OR *${part.trim()}*^2 OR ${part.trim()}~1)`;\n  });\n  return subQueries.join(' AND ');\n};\n\nexport default generateSolrQuery;\n","import * as React from 'react';\n\nimport {\n  Avatar,\n  Dropdown,\n  MenuProps\n} from 'antd';\nimport { AvatarProps } from 'antd/lib/avatar';\n\nimport './index.less';\n\nimport _isString from 'lodash/isString';\n\n// non default props\nexport interface BaseProps {\n  className?: string;\n  imageSrc?: string;\n  userMenu?: MenuProps;\n  userName?: React.ReactNode;\n  style?: any;\n}\n\nexport type UserChipProps = BaseProps & AvatarProps;\n\nconst UserChip: React.FC<UserChipProps> = ({\n  className,\n  imageSrc,\n  userMenu,\n  userName,\n  style,\n  ...passThroughProps\n}) => {\n  // eslint-disable-next-line  no-underscore-dangle, @typescript-eslint/naming-convention\n  const _className = 'userchip';\n\n  const getInitials = (): string => {\n    if (!_isString(userName)) {\n      return '??';\n    }\n\n    return userName\n      .split(' ')\n      .map(part => part[0] ?? '')\n      .join('')\n      .toUpperCase();\n  };\n\n  const getUserMenu = () => {\n    const finalClassName = className\n      ? `${className} ${_className}`\n      : _className;\n\n    return (\n      <div\n        className={finalClassName}\n        style={style}\n      >\n        <Avatar\n          src={imageSrc}\n          size=\"large\"\n          className=\"userimage\"\n          {...passThroughProps}\n        >\n          {imageSrc ? '' : getInitials()}\n        </Avatar>\n        <span className=\"username\">{userName}</span>\n      </div>\n    );\n  };\n\n  if (userMenu?.items) {\n    return (\n      <Dropdown\n        menu={userMenu}\n        trigger={['click']}\n        getPopupContainer={() =>\n          document.getElementsByClassName(_className)[0] as HTMLElement\n        }\n      >\n        {getUserMenu()}\n      </Dropdown>\n    );\n  } else {\n    return getUserMenu();\n  }\n};\n\nexport default UserChip;\n","import React, {\n  useEffect,\n  useState\n} from 'react';\n\nimport {\n  faUserCog,\n  faSignOut,\n  faSignIn,\n  faAngleDown\n} from '@fortawesome/free-solid-svg-icons';\nimport {\n  FontAwesomeIcon\n} from '@fortawesome/react-fontawesome';\n\nimport {\n  Button,\n  Tooltip\n} from 'antd';\nimport {\n  ItemType\n} from 'antd/lib/menu/interface';\n\nimport _isEmpty from 'lodash/isEmpty';\n\nimport {\n  MenuInfo\n} from 'rc-menu/lib/interface';\n\nimport {\n  useTranslation\n} from 'react-i18next';\n\nimport useAppSelector from '../../hooks/useAppSelector';\nimport useSHOGunAPIClient from '../../hooks/useSHOGunAPIClient';\nimport {\n  getGravatarUrl\n} from '../../utils/getGravatarUrl';\n\nimport UserChip from '../UserChip';\n\nimport './index.less';\n\nexport const UserMenu: React.FC = (): JSX.Element => {\n  const {\n    t\n  } = useTranslation();\n\n  const [loginUrl, setLoginUrl] = useState<string>();\n\n  const client = useSHOGunAPIClient();\n  const keycloak = client?.getKeycloak();\n\n  const user = useAppSelector((state) => state.user);\n\n  useEffect(() => {\n    const getLoginUrl = async () => {\n      const url = await keycloak?.createLoginUrl();\n      setLoginUrl(url);\n    };\n\n    getLoginUrl();\n  }, [keycloak]);\n\n  const onMenuClick = (evt: MenuInfo) => {\n    switch (evt.key) {\n      case 'settings':\n        if (keycloak) {\n          keycloak.accountManagement();\n        }\n        break;\n      case 'logout':\n        if (keycloak) {\n          keycloak.logout({\n            redirectUri: loginUrl\n          });\n        }\n        break;\n      default:\n        break;\n    }\n  };\n\n  const getMenu = () => {\n    const username: ItemType = {\n      key: 'username',\n      label: (\n        <div\n          className=\"username-menu-item\"\n          aria-label=\"user-name\"\n        >\n          <span\n            className=\"item-username\"\n          >\n            {\n              user.providerDetails?.username ?? user.authProviderId\n            }\n          </span>\n          <br />\n          <span\n            className=\"item-fullname\"\n          >\n            {\n              `${user.providerDetails?.firstName ?? ''} ${user.providerDetails?.lastName ?? ''}`\n            }\n          </span>\n        </div>\n      )\n    };\n\n    const divider: ItemType = {\n      type: 'divider'\n    };\n\n    const settings: ItemType = {\n      key: 'settings',\n      icon: (\n        <FontAwesomeIcon\n          icon={faUserCog}\n        />\n      ),\n      label: t('UserMenu.settingsMenuTitle')\n    };\n\n    const logout: ItemType = {\n      key: 'logout',\n      icon: (\n        <FontAwesomeIcon\n          icon={faSignOut}\n        />\n      ),\n      label: (\n        <div\n          aria-label=\"logout\"\n        >\n          {t('UserMenu.logoutMenuTitle')}\n        </div>\n      )\n    };\n\n    const accountRoles = keycloak?.tokenParsed?.resource_access?.account?.roles;\n    const hasUserManagementAccess = Array.isArray(accountRoles) && accountRoles.indexOf('manage-account') > -1;\n\n    const items: ItemType[] = hasUserManagementAccess ? [\n      username,\n      divider,\n      settings,\n      divider,\n      logout\n    ] : [\n      username,\n      divider,\n      logout\n    ];\n\n    return {\n      items,\n      onClick: onMenuClick\n    };\n  };\n\n  const onLoginClick = () => {\n    if (keycloak) {\n      keycloak.login();\n    }\n  };\n\n  return (\n    <div\n      className=\"user-menu\"\n    >\n      {_isEmpty(user) ? (\n        <Tooltip\n          title={t('UserMenu.loginTooltip')}\n        >\n          <Button\n            type=\"link\"\n            onClick={onLoginClick}\n            icon={\n              <FontAwesomeIcon\n                icon={faSignIn}\n              />\n            }\n          >\n            {t('UserMenu.loginMenuTitle')}\n          </Button>\n        </Tooltip>\n      ) : (\n        <UserChip\n          size=\"small\"\n          imageSrc={getGravatarUrl({\n            email: user.providerDetails?.email ?? '',\n            size: 28\n          })}\n          userName={\n            <FontAwesomeIcon\n              icon={faAngleDown}\n            />\n          }\n          userMenu={getMenu()}\n        />\n      )}\n    </div>\n  );\n};\n\nexport default UserMenu;\n","import { md5 } from 'js-md5';\n\nexport interface GravatarProps {\n  email: string;\n  size?: number;\n  rating?: 'g' | 'pg' | 'r' | 'x';\n  defaultImage?: '404' | 'mp' | 'identicon' | 'monsterid' | 'wavatar' | 'retro' | 'robohash' | 'blank';\n  force?: boolean;\n}\n\nconst GRAVATAR_BASE_URL = 'https://www.gravatar.com/avatar/';\n\n/**\n * https://de.gravatar.com/site/implement/images/\n */\nexport const getGravatarUrl = ({\n  email = '',\n  size = 80,\n  rating = 'g',\n  defaultImage = 'identicon',\n  force = false\n}: GravatarProps): string => {\n  const lowerCaseEmail = email.toLowerCase();\n  const hash = md5(lowerCaseEmail);\n\n  let url = `${GRAVATAR_BASE_URL}${hash}?s=${size}&r=${rating}&d=${defaultImage}`;\n\n  if (force) {\n    url = `${url}&f=y`;\n  }\n\n  return url;\n};\n\nexport default getGravatarUrl;\n","import React from 'react';\n\nimport {\n  Tooltip,\n  Typography\n} from 'antd';\n\nimport ClientConfiguration from 'clientConfig';\n\nimport { useTranslation } from 'react-i18next';\n\nimport DocumentationButton from '../../components/DocumentationButton';\nimport {\n  useAppSelector\n} from '../../hooks/useAppSelector';\nimport {\n  usePlugins\n} from '../../hooks/usePlugins';\n\nimport {\n  HeaderPlacementOrientation,\n  isHeaderIntegration\n} from '../../plugin';\nimport SearchField from '../SearchField';\n\nimport UserMenu from '../UserMenu';\n\nimport './index.less';\n\nexport type HeaderProps = React.ComponentProps<'div'>;\n\nexport const Header: React.FC<HeaderProps> = ({\n  ...restProps\n}): JSX.Element => {\n  const title = useAppSelector(state => state.title);\n  const logoPath = useAppSelector(state => state.logoPath);\n  const userMenuVisible = useAppSelector(state => state.userMenu.visible);\n\n  const { t } = useTranslation();\n  const plugins = usePlugins();\n\n  const { Link } = Typography;\n\n  const insertPlugins = (itemPosition: HeaderPlacementOrientation, items: JSX.Element[]) => {\n    plugins.forEach(plugin => {\n      if (isHeaderIntegration(plugin.integration) && plugin.integration?.placementOrientation === itemPosition) {\n        const {\n          key,\n          wrappedComponent: WrappedPluginComponent\n        } = plugin;\n\n        items.splice(plugin.integration?.insertionIndex ?? 0, 0,\n          <WrappedPluginComponent\n            key={key}\n          />\n        );\n      }\n    });\n  };\n\n  const getLeftItems = () => {\n    const items = [\n      <Tooltip\n        key=\"logo\"\n        title={t('Header.backToHome')}\n        placement=\"bottomLeft\"\n      >\n        <Link\n          href={\n            ClientConfiguration.logoLinkUrl ||\n            ClientConfiguration.shogunBase ||\n            '/'\n          }\n          aria-label={t('Header.backToHome')}\n          className=\"logo-link\"\n        >\n          <img\n            className=\"logo\"\n            data-testid=\"logo\"\n            src={logoPath}\n            alt=\"\"\n            aria-hidden=\"true\"\n          />\n        </Link>\n      </Tooltip>,\n      <div\n        key=\"title\"\n        className=\"title\"\n        aria-label=\"title\"\n      >\n        {title}\n      </div>\n    ];\n\n    insertPlugins('left', items);\n\n    return items;\n  };\n\n  const getCenterItems = () => {\n    const items = [\n      <SearchField\n        key=\"search\"\n        aria-label='search-input'\n        name='search-input'\n        className='search-input'\n      />\n    ];\n\n    insertPlugins('center', items);\n\n    return items;\n  };\n\n  const getDocsButton = () => {\n    if (!ClientConfiguration.documentationButtonVisible) {\n      return;\n    }\n\n    return (\n      <DocumentationButton\n        key=\"docs-button\"\n      />\n    );\n  };\n\n  const getUserMenu = () => {\n    if (!userMenuVisible || !ClientConfiguration.keycloak?.enabled) {\n      return;\n    }\n\n    return (\n      <div\n        key=\"user-menu\"\n        aria-label=\"user-menu\"\n      >\n        <UserMenu\n          key=\"user-menu\"\n        />\n      </div>\n    );\n  };\n\n  const getRightItems = () => {\n    const items = [\n      getDocsButton(),\n      getUserMenu()\n    ].filter((item) => {\n      return item !== undefined;\n    });\n\n    insertPlugins('right', items);\n    return items;\n  };\n\n  return (\n    <div\n      className=\"header\"\n      {...restProps}\n    >\n      <div\n        className=\"item-container left-items\"\n      >\n        {\n          getLeftItems()\n        }\n      </div>\n      <div\n        className=\"item-container center-items\"\n      >\n        {\n          getCenterItems()\n        }\n      </div>\n      <div\n        className=\"item-container right-items\"\n      >\n        {\n          getRightItems()\n        }\n      </div>\n    </div>\n  );\n};\n\nexport default Header;\n","import React, {\n  useState,\n  useEffect,\n  useCallback\n} from 'react';\n\nimport {\n  Alert,\n  Spin\n} from 'antd';\n\nimport OlLayer from 'ol/layer/Layer';\n\nimport {\n  useTranslation\n} from 'react-i18next';\n\nimport Logger from '@terrestris/base-util/dist/Logger';\n\nimport Layer from '@terrestris/shogun-util/dist/model/Layer';\n\nimport useSHOGunAPIClient from '../../../hooks/useSHOGunAPIClient';\n\nimport './index.less';\n\nexport type LayerConfigurationProps = React.ComponentProps<'pre'> & {\n  layer?: OlLayer;\n};\n\nexport const LayerConfiguration: React.FC<LayerConfigurationProps> = ({\n  layer,\n  ...restProps\n}): JSX.Element => {\n  const [loading, setLoading] = useState<boolean>(false);\n  const [errorMessage, setErrorMessage] = useState<string>();\n  const [layerConfiguration, setLayerConfiguration] = useState<Layer>();\n\n  const client = useSHOGunAPIClient();\n\n  const {\n    t\n  } = useTranslation();\n\n  const getLayerConfiguration = useCallback(async () => {\n    try {\n      setLoading(true);\n      setErrorMessage('');\n\n      if (!layer || !layer.get('shogunId')) {\n        throw new Error('No layer provided or the layer has no shogunId set');\n      }\n\n      const conf = await client?.layer().findOne(layer.get('shogunId'));\n\n      setLayerConfiguration(conf);\n    } catch (error) {\n      Logger.error(error);\n      setErrorMessage(t('LayerConfiguration.errorMessage'));\n    } finally {\n      setLoading(false);\n    }\n  }, [t, client, layer]);\n\n  useEffect(() => {\n    getLayerConfiguration();\n  }, [getLayerConfiguration]);\n\n  if (errorMessage) {\n    return (\n      <Alert\n        type=\"error\"\n        closable={true}\n        message={errorMessage}\n      />\n    );\n  }\n\n  return (\n    <Spin\n      spinning={loading}\n    >\n      <pre\n        className=\"layer-configuration\"\n        {...restProps}\n      >\n        <code>\n          {\n            JSON.stringify(layerConfiguration, null, '  ')\n          }\n        </code>\n      </pre>\n    </Spin>\n  );\n};\n\nexport default LayerConfiguration;\n","import React, {\n  useState,\n  useEffect,\n  useCallback\n} from 'react';\n\nimport {\n  Alert,\n  Form,\n  FormProps,\n  Spin\n} from 'antd';\n\nimport OlLayerImage from 'ol/layer/Image';\nimport OlLayer from 'ol/layer/Layer';\nimport OlLayerTile from 'ol/layer/Tile';\nimport OlSourceImageWMS from 'ol/source/ImageWMS';\nimport OlSourceTileWMS from 'ol/source/TileWMS';\n\nimport {\n  useTranslation\n} from 'react-i18next';\n\nimport Logger from '@terrestris/base-util/dist/Logger';\nimport { UrlUtil } from '@terrestris/base-util/dist/UrlUtil/UrlUtil';\n\nimport CapabilitiesUtil from '@terrestris/ol-util/dist/CapabilitiesUtil/CapabilitiesUtil';\n\nimport {\n  isWmsLayer\n} from '@terrestris/ol-util/dist/typeUtils/typeUtils';\n\nimport {\n  getBearerTokenHeader\n} from '@terrestris/shogun-util/dist/security/getBearerTokenHeader';\n\nimport useSHOGunAPIClient from '../../../hooks/useSHOGunAPIClient';\n\nimport './index.less';\n\nexport type LayerDetailsProps = Partial<FormProps> & {\n  layer?: OlLayer;\n};\n\nexport const LayerDetails: React.FC<LayerDetailsProps> = ({\n  layer,\n  ...restProps\n}): JSX.Element => {\n  const [loading, setLoading] = useState<boolean>(false);\n  const [capabilities, setCapabilities] = useState<any>();\n  const [errorMessage, setErrorMessage] = useState<string>();\n\n  const client = useSHOGunAPIClient();\n\n  const {\n    t\n  } = useTranslation();\n\n  const getCapabilities = useCallback(async () => {\n    if (!layer || !isWmsLayer(layer)) {\n      return;\n    }\n\n    try {\n      setLoading(true);\n      setErrorMessage('');\n      setCapabilities(undefined);\n\n      const capa = await CapabilitiesUtil.getWmsCapabilitiesByLayer(\n        (layer as OlLayerImage<OlSourceImageWMS> | OlLayerTile<OlSourceTileWMS>), {\n          headers: {\n            ...layer.get('useBearerToken') ? {\n              ...getBearerTokenHeader(client?.getKeycloak())\n            } : undefined\n          }\n        });\n\n      setCapabilities(capa);\n    } catch (error) {\n      Logger.error(error);\n      setErrorMessage(t('LayerDetails.errorMessage'));\n    } finally {\n      setLoading(false);\n    }\n  }, [t, client, layer]);\n\n  useEffect(() => {\n    getCapabilities();\n  }, [getCapabilities]);\n\n  const getLayerName = () => {\n    if (!layer || !isWmsLayer(layer)) {\n      return;\n    }\n\n    return layer.getSource()?.getParams().LAYERS;\n  };\n\n  const getCapabilitiesUrl = () => {\n    if (!layer || !isWmsLayer(layer)) {\n      return;\n    }\n\n    let layerUrl;\n    if (layer.getSource() instanceof OlSourceImageWMS) {\n      layerUrl = (layer.getSource() as OlSourceImageWMS).getUrl();\n    }\n    if (layer.getSource() instanceof OlSourceTileWMS) {\n      const urls = (layer.getSource() as OlSourceTileWMS).getUrls();\n      layerUrl = urls ? urls[0] : undefined;\n    }\n\n    if (layerUrl) {\n      return UrlUtil.createValidGetCapabilitiesRequest(layerUrl, 'WMS', '1.3.0');\n    }\n  };\n\n  const getCapabilitiesLayer = () => {\n    const layers: any[] = capabilities?.Capability?.Layer?.Layer;\n    const layerName = getLayerName();\n    let lay;\n    if (Array.isArray(layers)) {\n      lay = layers?.find(l => l?.Name === layerName);\n    } else {\n      return layers;\n    }\n    return lay;\n  };\n\n  const getBBox = () => {\n    const lay = getCapabilitiesLayer();\n\n    if (!lay || !lay.EX_GeographicBoundingBox) {\n      return;\n    }\n\n    return [\n      lay.EX_GeographicBoundingBox.westBoundLongitude,\n      lay.EX_GeographicBoundingBox.southBoundLatitude,\n      lay.EX_GeographicBoundingBox.eastBoundLongitude,\n      lay.EX_GeographicBoundingBox.northBoundLatitude\n    ].join(', ');\n  };\n\n  const getMinScale = () => {\n    const lay = getCapabilitiesLayer();\n\n    if (!lay) {\n      return;\n    }\n\n    return lay.MinScaleDenominator;\n  };\n\n  const getMaxScale = () => {\n    const lay = getCapabilitiesLayer();\n\n    if (!lay) {\n      return;\n    }\n\n    return lay.MaxScaleDenominator;\n  };\n\n  const getAbstract = () => {\n    const lay = getCapabilitiesLayer();\n\n    if (!lay) {\n      return;\n    }\n\n    return lay.Abstract;\n  };\n\n  const getServiceAbstract = () => {\n    return capabilities?.Service?.Abstract;\n  };\n\n  const getContact = () => {\n    return capabilities?.Service?.ContactInformation?.ContactElectronicMailAddress;\n  };\n\n  const getLayerTitle = () => {\n    const lay = getCapabilitiesLayer();\n\n    if (!lay) {\n      return;\n    }\n\n    return lay.Title;\n  };\n\n  const getAccessConstraints = () => {\n    return capabilities?.Service?.AccessConstraints;\n  };\n\n  if (errorMessage) {\n    return (\n      <Alert\n        type=\"error\"\n        closable={true}\n        message={errorMessage}\n      />\n    );\n  }\n\n  return (\n    <Spin\n      spinning={loading}\n    >\n      <Form\n        className=\"layer-details\"\n        layout=\"horizontal\"\n        size=\"small\"\n        labelAlign=\"left\"\n        labelWrap={true}\n        labelCol={{\n          flex: '150px'\n        }}\n        {...restProps}\n      >\n        <Form.Item\n          name=\"layerName\"\n          label={t('LayerDetails.layerNameLabel')}\n        >\n          <span>{getLayerName() ? getLayerName() : t('LayerDetails.noDataPlaceholder')}</span>\n        </Form.Item>\n        <Form.Item\n          name=\"layerTitle\"\n          label={t('LayerDetails.layerTitleLabel')}\n        >\n          <span>{getLayerTitle() ? getLayerTitle() : t('LayerDetails.noDataPlaceholder')}</span>\n        </Form.Item>\n        <Form.Item\n          name=\"service-abstract\"\n          label={t('LayerDetails.serviceAbstractLabel')}\n        >\n          <span>{getServiceAbstract() ? getServiceAbstract() : t('LayerDetails.noDataPlaceholder')}</span>\n        </Form.Item>\n        <Form.Item\n          name=\"abstract\"\n          label={t('LayerDetails.abstractLabel')}\n        >\n          <span>{getAbstract() ? getAbstract() : t('LayerDetails.noDataPlaceholder')}</span>\n        </Form.Item>\n        <Form.Item\n          name=\"accessConstraints\"\n          label={t('LayerDetails.accessConstraintsLabel')}\n        >\n          <span>{getAccessConstraints() ? getAccessConstraints() : t('LayerDetails.noDataPlaceholder')}</span>\n        </Form.Item>\n        <Form.Item\n          name=\"CapabilitiesUrl\"\n          label={t('LayerDetails.capabilitiesUrlLabel')}\n        >\n          <a href={getCapabilitiesUrl()}>{getCapabilitiesUrl()}</a>\n        </Form.Item>\n        <Form.Item\n          name=\"contact\"\n          label={t('LayerDetails.contactLabel')}\n        >\n          {getContact() ? <a href={`mailto:${getContact()}`}>{getContact()}</a> : <span>{t('LayerDetails.noDataPlaceholder')}</span>}\n        </Form.Item>\n        <Form.Item\n          name=\"minScale\"\n          label={t('LayerDetails.minScaleLabel')}\n        >\n          <span>{getMinScale() ? getMinScale() : t('LayerDetails.noDataPlaceholder')}</span>\n        </Form.Item>\n        <Form.Item\n          name=\"maxScale\"\n          label={t('LayerDetails.maxScaleLabel')}\n        >\n          <span>{getMaxScale() ? getMaxScale() : t('LayerDetails.noDataPlaceholder')}</span>\n        </Form.Item>\n        <Form.Item\n          name=\"bbox\"\n          label={t('LayerDetails.bboxLabel')}\n        >\n          <span>{getBBox() ? getBBox() : t('LayerDetails.noDataPlaceholder')}</span>\n        </Form.Item>\n      </Form>\n    </Spin>\n  );\n};\n\nexport default LayerDetails;\n","import React, {\n  useState,\n  useEffect\n} from 'react';\n\nimport {\n  FileTextOutlined\n} from '@ant-design/icons';\n\nimport {\n  Button,\n  Modal,\n  ModalProps,\n  Tooltip\n} from 'antd';\n\nimport OlLayer from 'ol/layer/Layer';\n\nimport {\n  useTranslation\n} from 'react-i18next';\n\nimport { MapUtil } from '@terrestris/ol-util/dist/MapUtil/MapUtil';\n\nimport {\n  useMap\n} from '@terrestris/react-util/dist/Hooks/useMap/useMap';\n\nimport useAppDispatch from '../../hooks/useAppDispatch';\nimport useAppSelector from '../../hooks/useAppSelector';\n\nimport {\n  hide as hideLayerDetailsModal,\n  setLayer as setDetailsLayer\n} from '../../store/layerDetailsModal';\n\nimport LayerConfiguration from './LayerConfiguration';\nimport LayerDetails from './LayerDetails';\n\nimport './index.less';\n\nexport type LayerDetailsModalProps = Partial<ModalProps>;\n\nexport const LayerDetailsModal: React.FC<LayerDetailsModalProps> = ({\n  ...restProps\n}): JSX.Element => {\n  const [layer, setLayer] = useState<OlLayer>();\n  const [configurationVisible, setConfigurationVisible] = useState<boolean>(false);\n\n  const isModalVisible = useAppSelector(state => state.layerDetailsModal.visible);\n  const layerId = useAppSelector(state => state.layerDetailsModal.layerId);\n\n  const dispatch = useAppDispatch();\n\n  const map = useMap();\n\n  const {\n    t\n  } = useTranslation();\n\n  useEffect(() => {\n    if (!map) {\n      return;\n    }\n\n    if (!layerId) {\n      setLayer(undefined);\n      return;\n    }\n\n    const l = MapUtil.getLayerByOlUid(map, layerId);\n\n    if (!(l instanceof OlLayer)) {\n      return;\n    }\n\n    setLayer(l);\n  }, [map, layerId]);\n\n  const closeModal = () => {\n    dispatch(hideLayerDetailsModal());\n    dispatch(setDetailsLayer(undefined));\n  };\n\n  const onShowConfigurationClick = () => {\n    setConfigurationVisible(!configurationVisible);\n  };\n\n  return (\n    <Modal\n      className=\"layer-details-modal\"\n      title={(\n        <div\n          className=\"title-group\"\n        >\n          <span>{t('LayerDetailsModal.title', {\n            layerName: layer?.get('name')\n          })}\n          </span>\n          {\n            layer?.get('shogunId') && (\n              <Tooltip\n                title={configurationVisible ?\n                  t('LayerDetailsModal.internalConfigurationButtonTooltipPressed') :\n                  t('LayerDetailsModal.internalConfigurationButtonTooltip')\n                }\n              >\n                <Button\n                  type=\"link\"\n                  className={configurationVisible ? 'pressed' : ''}\n                  icon={<FileTextOutlined />}\n                  onClick={onShowConfigurationClick}\n                />\n              </Tooltip>\n            )\n          }\n        </div>\n      )}\n      open={isModalVisible}\n      onCancel={closeModal}\n      width={800}\n      footer={false}\n      {...restProps}\n    >\n      <LayerDetails\n        layer={layer}\n        hidden={configurationVisible}\n      />\n      {\n        layer?.get('shogunId') && (\n          <LayerConfiguration\n            layer={layer}\n            hidden={!configurationVisible}\n          />\n        )\n      }\n    </Modal>\n  );\n};\n\nexport default LayerDetailsModal;\n","import React, { useState } from 'react';\n\nimport {\n  faPlus,\n  faMinus,\n  faLocation,\n  faLocationPin\n} from '@fortawesome/free-solid-svg-icons';\n\nimport {\n  FontAwesomeIcon\n} from '@fortawesome/react-fontawesome';\nimport {\n  TooltipPlacement\n} from 'antd/es/tooltip';\n\nimport {\n  useTranslation\n} from 'react-i18next';\n\nimport {\n  GeoLocationButton\n} from '@terrestris/react-geo/dist/Button/GeoLocationButton/GeoLocationButton';\nimport ZoomButton from '@terrestris/react-geo/dist/Button/ZoomButton/ZoomButton';\n\nimport {\n  useMap\n} from '@terrestris/react-util/dist/Hooks/useMap/useMap';\n\nimport useAppSelector from '../../hooks/useAppSelector';\nimport Toolbar, { ToolbarProps } from '../Toolbar';\n\nimport './index.less';\n\nexport type MapToolbarProps = React.HTMLAttributes<HTMLDivElement> & ToolbarProps;\n\nexport const MapToolbar: React.FC = (): JSX.Element => {\n  const {\n    t\n  } = useTranslation();\n  const map = useMap();\n\n  const [geolocationButtonPressed, setGeolocationButtonPressed] = useState(false);\n\n  const mapToolbarVisible = useAppSelector(state => state.mapToolbarVisible.visible);\n\n  const stylingDrawerVisibility = useAppSelector(state => state.stylingDrawerVisibility);\n  const editFeatureDrawerOpen = useAppSelector(state => state.editFeatureDrawerOpen);\n  const searchResultDrawerOpen = useAppSelector(state => state.searchResult.drawerVisibility);\n  const drawerOpen = stylingDrawerVisibility || editFeatureDrawerOpen || searchResultDrawerOpen;\n  const className = drawerOpen ? 'drawer-open' : '';\n\n  const btnTooltipProps = {\n    tooltipPlacement: 'left' as TooltipPlacement,\n    tooltipProps: {\n      mouseEnterDelay: 0.5\n    }\n  };\n\n  return (\n    <>\n      {mapToolbarVisible &&\n        <Toolbar\n          id='map-toolbar'\n          className={className}\n          alignment=\"vertical\"\n          role=\"toolbar\"\n        >\n          {map &&\n            <ZoomButton\n              aria-label='zoom-in'\n              tooltip={t('MapToolbar.zoomInTooltip')}\n              icon={\n                <FontAwesomeIcon\n                  icon={faPlus}\n                />\n              }\n              {...btnTooltipProps}\n            />}\n          {map &&\n            <ZoomButton\n              aria-label='zoom-out'\n              tooltip={t('MapToolbar.zoomOutTooltip')}\n              delta={-1}\n              icon={\n                <FontAwesomeIcon\n                  icon={faMinus}\n                />\n              }\n              {...btnTooltipProps}\n            />}\n          {map &&\n            <GeoLocationButton\n              aria-label='geolocation'\n              showMarker={true}\n              follow={true}\n              pressed={geolocationButtonPressed}\n              onChange={() => setGeolocationButtonPressed(!geolocationButtonPressed)}\n              tooltip={t('MapToolbar.geoLocation')}\n              icon={\n                <FontAwesomeIcon\n                  icon={faLocation}\n                />\n              }\n              pressedIcon={\n                <FontAwesomeIcon\n                  icon={faLocationPin}\n                />\n              }\n              {...btnTooltipProps}\n            />}\n        </Toolbar>\n      }\n    </>\n  );\n};\n\nexport default MapToolbar;\n","import React from 'react';\n\nexport interface AttributeValueCellProps {\n  value: any;\n  attributeName: string;\n  resultDrawerConfig?: {\n    children?: {\n      displayName?: string;\n      fieldProps?: {\n        urlDisplayValue?: string;\n      };\n    }[];\n  } | null;\n}\n\nexport const AttributeValueCell: React.FC<AttributeValueCellProps> = ({\n  value,\n  attributeName,\n  resultDrawerConfig\n}) => {\n  let normalized = value;\n\n  const isUrl = (val: string) => {\n    return /^(?:\\w+:)?\\/\\/([^\\s.]+\\.\\S{2}|localhost[:?\\d]*)\\S*$/.test(val);\n  };\n\n  if (\n    Array.isArray(value) &&\n    value.length === 1 &&\n    typeof value[0] === 'string'\n  ) {\n    normalized = value[0];\n  }\n\n  if (\n    typeof normalized === 'string' &&\n    isUrl(normalized) &&\n    resultDrawerConfig\n  ) {\n    const fieldConfig = resultDrawerConfig.children?.find(\n      c => c.displayName === attributeName\n    );\n    const displayText = fieldConfig?.fieldProps?.urlDisplayValue || normalized;\n\n    return (\n      <a\n        href={normalized}\n        target=\"_blank\"\n        rel=\"noopener noreferrer\"\n      >\n        {displayText}\n      </a>\n    );\n  }\n\n  return (\n    <div\n      style={{\n        wordBreak: 'break-word',\n        whiteSpace: 'pre-line'\n      }}\n    >\n      {normalized == null || typeof normalized === 'object'\n        ? ''\n        : normalized}\n    </div>\n  );\n};\n","import React, {\n  useCallback,\n  useEffect,\n  useMemo\n} from 'react';\n\nimport {\n  DrawerProps\n} from 'antd';\nimport { ColumnType } from 'antd/es/table';\n\nimport OlFeature from 'ol/Feature';\nimport GeoJSONParser from 'ol/format/GeoJSON';\nimport OlLayerVector from 'ol/layer/Vector';\nimport OlSourceVector from 'ol/source/Vector';\nimport OlStyleCircle from 'ol/style/Circle';\nimport OlStyleFill from 'ol/style/Fill';\nimport OlStyleStroke from 'ol/style/Stroke';\nimport OlStyle from 'ol/style/Style';\n\nimport {\n  useTranslation\n} from 'react-i18next';\n\nimport { MapUtil } from '@terrestris/ol-util/dist/MapUtil/MapUtil';\n\nimport PropertyGrid from '@terrestris/react-geo/dist/Grid/PropertyGrid/PropertyGrid';\nimport { useMap } from '@terrestris/react-util/dist/Hooks/useMap/useMap';\nimport { useOlLayer } from '@terrestris/react-util/dist/Hooks/useOlLayer/useOlLayer';\n\nimport {\n  PropertyFormItemReadConfig,\n  PropertyFormTabConfig\n} from '@terrestris/shogun-util/dist/model/Layer';\n\nimport useAppDispatch from '../../hooks/useAppDispatch';\nimport useAppSelector from '../../hooks/useAppSelector';\nimport {\n  setSearchResultState\n} from '../../store/searchResult';\nimport MapDrawer from '../MapDrawer';\n\nimport { FeatureInfoForm } from '../ToolMenu/FeatureInfo/FeatureInfoForm';\n\nimport { AttributeValueCell } from './AttributeValueCell';\n\nexport type SearchResultDrawerProps = DrawerProps;\n\ntype AttributeRecord = {\n  key: string;\n  attributeName: string;\n  attributeValue: string | number | string[] | number[];\n};\n\nexport const SearchResultDrawer: React.FC<SearchResultDrawerProps> = ({\n  ...passThroughProps\n}): JSX.Element => {\n\n  const dispatch = useAppDispatch();\n  const map = useMap();\n  const isSearchResultDrawerVisible = useAppSelector(state => state.searchResult.drawerVisibility);\n  const geoJSONFeature = useAppSelector(state => state.searchResult.geoJSONFeature);\n  const targetLayerId = useAppSelector(state => state.searchResult.layerId);\n  const olFeature: OlFeature | null = useMemo(() => {\n    if (!geoJSONFeature) {\n      return null;\n    }\n    return new GeoJSONParser().readFeature(geoJSONFeature) as OlFeature;\n  }, [geoJSONFeature]);\n  const targetLayer = useMemo(() => {\n    if (!targetLayerId || !map) {\n      return null;\n    }\n    return MapUtil.getLayerByOlUid(map, targetLayerId);\n  }, [targetLayerId, map]);\n\n  const highlightLayer = useOlLayer(() => {\n    return new OlLayerVector({\n      source: new OlSourceVector(),\n      style: new OlStyle({\n        stroke: new OlStyleStroke({\n          color: 'rgb(255,0,0)',\n          width: 2\n        }),\n        fill: new OlStyleFill({\n          color: 'rgba(255,255,255, 0.5)'\n        }),\n        image: new OlStyleCircle({\n          radius: 10,\n          fill: new OlStyleFill({\n            color: 'rgba(255,255,255, 0.5)'\n          }),\n          stroke: new OlStyleStroke({\n            color: 'rgb(255,0,0)',\n            width: 3\n          })\n        })\n      })\n    });\n  }, []);\n\n  const highlightFeature = useCallback((feature?: OlFeature) => {\n    if (!highlightLayer || !highlightLayer.getSource() || !feature) {\n      return;\n    }\n    highlightLayer.getSource()!.clear();\n    highlightLayer.getSource()!.addFeature(feature);\n  }, [highlightLayer]);\n\n  useEffect(() => {\n    if (olFeature && map) {\n      highlightFeature(olFeature);\n    }\n  }, [olFeature, map, highlightFeature]);\n\n  const {\n    t\n  } = useTranslation();\n\n  const onClose = () => {\n    dispatch(setSearchResultState({\n      drawerVisibility: false,\n      layerId: null,\n      geoJSONFeature: null\n    }));\n    highlightLayer?.getSource()!.clear();\n  };\n\n  const normalizeFeatureProperties = (feature: OlFeature, keys: string[]) => {\n    keys.forEach(key => {\n      const val = feature.get(key);\n\n      if (\n        Array.isArray(val) &&\n        val.length === 1 &&\n        typeof val[0] === 'string'\n      ) {\n        feature.set(key, val[0]);\n      }\n    });\n  };\n\n  const resolveTitle = (\n    feature: OlFeature | null,\n    configTitle?: string\n  ): string => {\n    if (!feature) {\n      return '';\n    }\n\n    if (!configTitle) {\n      return feature.get('title') ?? '';\n    }\n\n    const match = configTitle.match(/^{(.+)}$/);\n    if (match) {\n      const key = match[1];\n      return feature.get(key) ?? '';\n    }\n\n    return configTitle;\n  };\n\n  const resultDrawerConfig: PropertyFormTabConfig<PropertyFormItemReadConfig> | null =\n    targetLayer?.get('searchConfig')?.resultDrawerConfig ?? null;\n\n  useEffect(() => {\n    if (olFeature && resultDrawerConfig?.children) {\n      const keysToNormalize = resultDrawerConfig.children.map(\n        c => c.propertyName\n      );\n      normalizeFeatureProperties(olFeature, keysToNormalize);\n    }\n  }, [olFeature, resultDrawerConfig?.children]);\n\n  const attributeFilter = useMemo(() => {\n    return resultDrawerConfig?.children\n      ? resultDrawerConfig.children.map(c => c.propertyName)\n      : undefined;\n  }, [resultDrawerConfig]);\n\n  const attributeNames = useMemo(() => {\n    return resultDrawerConfig?.children\n      ? Object.fromEntries(\n        resultDrawerConfig.children.map(c => [\n          c.propertyName,\n          c.displayName ?? ''\n        ])\n      )\n      : undefined;\n  }, [resultDrawerConfig]);\n\n  const columns: ColumnType<AttributeRecord>[] = [{\n    title: t('FeaturePropertyGrid.key'),\n    dataIndex: 'attributeName',\n    key: 'attributeName',\n    width: '50%',\n    ellipsis: true,\n    defaultSortOrder: 'ascend',\n    sorter: (a, b) => a.key.localeCompare(b.key)\n  }, {\n    title: t('FeaturePropertyGrid.value'),\n    dataIndex: 'attributeValue',\n    key: 'attributeValue',\n    width: '50%',\n    ellipsis: true,\n    render: (value, record) => (\n      <AttributeValueCell\n        value={value}\n        attributeName={record.attributeName}\n        resultDrawerConfig={resultDrawerConfig}\n      />\n    )\n  }];\n\n  return (\n    <MapDrawer\n      title={t('SearchResultDrawer.title')}\n      placement=\"right\"\n      onClose={onClose}\n      open={isSearchResultDrawerVisible}\n      maskClosable={false}\n      mask={false}\n      {...passThroughProps}\n    >\n      <div>\n        {olFeature && (\n          <h3>{resolveTitle(olFeature, resultDrawerConfig?.title)}</h3>\n        )}\n        {\n          olFeature && Object.keys(olFeature.getProperties()).length > 1 && (\n            resultDrawerConfig ? (\n              <FeatureInfoForm\n                name={resultDrawerConfig?.title}\n                feature={olFeature}\n                formConfig={resultDrawerConfig?.children}\n              />\n            ) : (\n              <PropertyGrid\n                className=\"property-grid\"\n                feature={olFeature}\n                attributeFilter={attributeFilter}\n                size=\"small\"\n                sticky={false}\n                attributeNames={attributeNames}\n                columns={columns}\n                scroll={{\n                  scrollToFirstRowOnChange: true\n                }}\n              />\n            )\n          )\n        }\n      </div>\n    </MapDrawer>\n  );\n};\n\nexport default SearchResultDrawer;\n","import React, {\n  useEffect,\n  useState,\n  FC,\n  JSX, useMemo\n} from 'react';\n\nimport {\n  locale as GsLocale\n} from 'geostyler';\nimport {\n  CardStyle,\n  CardStyleProps\n} from 'geostyler/dist/Component/CardStyle/CardStyle';\n\nimport {\n  GeoStylerContext\n} from 'geostyler/dist/context/GeoStylerContext/GeoStylerContext';\n\nimport { OlStyleParser } from 'geostyler-openlayers-parser';\n\nimport {\n  Style as GsStyle\n} from 'geostyler-style';\n\nimport _get from 'lodash/get';\nimport OlFeature from 'ol/Feature';\nimport OlLayerVector from 'ol/layer/Vector';\nimport OlSourceVector from 'ol/source/Vector';\n\nimport {\n  StyleFunction,\n  StyleLike as OlStyleLike\n} from 'ol/style/Style';\n\nimport { useTranslation } from 'react-i18next';\n\nimport logger from '@terrestris/base-util/dist/Logger';\nimport { MapUtil } from '@terrestris/ol-util/dist/MapUtil/MapUtil';\n\nimport {\n  useMap\n} from '@terrestris/react-util/dist/Hooks/useMap/useMap';\n\nimport i18n from '../../../../../i18n';\n\nexport type StylingComponentProps = CardStyleProps;\n\nexport const StylingComponent: FC<StylingComponentProps> = ({\n  ...passThroughProps\n}): JSX.Element => {\n\n  const { t } = useTranslation();\n\n  const gsLocale = useMemo(() => {\n    let currentLocale = i18n.language || i18n.options?.lng || 'en_US';\n    switch (currentLocale) {\n      case 'en':\n      case 'en_GB':\n      case 'en_US':\n        currentLocale = 'en_US'; break;\n      case 'de':\n        currentLocale = 'de_DE'; break;\n      case 'pl':\n        currentLocale = 'pl_Pl'; break;\n      case 'cz':\n        currentLocale = 'cs_CZ'; break;\n      default:\n        currentLocale = '';\n    }\n    return _get(GsLocale, currentLocale) || GsLocale.en_US;\n  }, []);\n\n  const defaultStyle: GsStyle = {\n    name: t('StylingComponent.defaultStyleName'),\n    rules: [{\n      name: t('StylingComponent.defaultAreaStyleName'),\n      symbolizers: [{\n        kind: 'Fill',\n        color: '#00b72b',\n        outlineOpacity: 0.8,\n        opacity: 0.5,\n        fillOpacity: 0.8,\n        outlineWidth: 2,\n        outlineColor: '#00b72b'\n      }]\n    }, {\n      name: t('StylingComponent.defaultLineStyleName'),\n      symbolizers: [{\n        kind: 'Line',\n        color: '#00b72b',\n        width: 2,\n        opacity: 0.8\n      }]\n    }, {\n      name: t('StylingComponent.defaultPointStyleName'),\n      symbolizers: [{\n        kind: 'Mark',\n        wellKnownName: 'circle',\n        color: '#00b72b',\n        strokeColor: '#00b72b',\n        strokeOpacity: 0.8,\n        opacity: 0.5,\n        radius: 7\n      }],\n      filter: [\n        '==',\n        'label',\n        'undefined'\n      ]\n    }, {\n      name: t('StylingComponent.defaultTextStyleName'),\n      symbolizers: [{\n        kind: 'Text',\n        label: '{{label}}',\n        size: 12,\n        font: [\n          'sans-serif'\n        ],\n        opacity: 0.8,\n        color: '#00b72b',\n        offset: [\n          5,\n          5\n        ],\n        haloColor: '#00b72b',\n        haloWidth: 1\n      }],\n      filter: [\n        '!=',\n        'label',\n        'undefined'\n      ]\n    }]\n  };\n\n  const [style, setStyle] = useState<GsStyle>(defaultStyle);\n\n  const map = useMap();\n\n  useEffect(() => {\n    if (!style || !map) {\n      return;\n    }\n\n    const olParser = new OlStyleParser();\n\n    const drawVectorLayer = MapUtil.getLayerByName(map, 'react-geo_digitize') as OlLayerVector<OlSourceVector>;\n\n    const parseStyles = async () => {\n      let olStylePolygon: OlStyleLike;\n      let olStyleLineString: OlStyleLike;\n      let olStylePoint: OlStyleLike;\n      let olStyleText: OlStyleLike;\n\n      for (const rule of style.rules) {\n        const newStyle: GsStyle = {\n          name: '',\n          rules: [rule]\n        };\n\n        const olStyle = await olParser.writeStyle(newStyle);\n\n        if (!olStyle.output || rule.symbolizers.length < 1) {\n          return;\n        }\n\n        if (rule.symbolizers[0].kind === 'Fill') {\n          olStylePolygon = olStyle.output;\n        }\n\n        if (rule.symbolizers[0].kind === 'Text') {\n          olStyleText = olStyle.output;\n        }\n\n        if (rule.symbolizers[0].kind === 'Line') {\n          olStyleLineString = olStyle.output;\n        }\n\n        if (rule.symbolizers[0].kind === 'Mark') {\n          olStylePoint = olStyle.output;\n        }\n      }\n\n      const drawLayerStyleFunction = (feature: OlFeature, resolution: number) => {\n        const geometryType = feature.getGeometry()?.getType();\n\n        if (!geometryType) {\n          return;\n        }\n\n        if (['MultiPolygon', 'Polygon', 'Circle'].includes(geometryType)) {\n          return typeof olStylePolygon === 'function' ? olStylePolygon(feature, resolution) : olStylePolygon;\n        }\n\n        if (['MultiLineString', 'LineString'].includes(geometryType)) {\n          return typeof olStyleLineString === 'function' ? olStyleLineString(feature, resolution) : olStyleLineString;\n        }\n\n        if (['MultiPoint', 'Point'].includes(geometryType)) {\n          if (feature.get('label')) {\n            return typeof olStyleText === 'function' ? olStyleText(feature, resolution) : olStyleText;\n          }\n\n          return typeof olStylePoint === 'function' ? olStylePoint(feature, resolution) : olStylePoint;\n        }\n      };\n\n      drawVectorLayer.setStyle(drawLayerStyleFunction as StyleFunction);\n    };\n\n    parseStyles().then(() => logger.info('Styles parsed and applied to draw layer.'));\n  }, [style, map]);\n\n  return (\n    <GeoStylerContext.Provider value={{\n      locale: gsLocale\n    }}\n    >\n      <CardStyle\n        style={style}\n        onStyleChange={setStyle}\n        {...passThroughProps}\n      />\n    </GeoStylerContext.Provider>\n  );\n};\n\nexport default StylingComponent;\n","import React, {\n  FC, JSX\n} from 'react';\n\nimport {\n  DrawerProps\n} from 'antd';\n\nimport {\n  useTranslation\n} from 'react-i18next';\n\nimport useAppDispatch from '../../hooks/useAppDispatch';\nimport useAppSelector from '../../hooks/useAppSelector';\nimport { setStylingDrawerVisibility } from '../../store/stylingDrawerVisibility';\nimport MapDrawer from '../MapDrawer';\nimport StylingComponent from '../ToolMenu/Draw/StylingDrawerButton/StylingComponent';\n\nexport type StylingDrawerProps = DrawerProps;\n\nexport const StylingDrawer: FC<StylingDrawerProps> = ({\n  ...passThroughProps\n}): JSX.Element => {\n\n  const dispatch = useAppDispatch();\n  const isStylingDrawerVisible = useAppSelector(state => state.stylingDrawerVisibility);\n\n  const {\n    t\n  } = useTranslation();\n\n  const onClose = () => {\n    dispatch(setStylingDrawerVisibility(false));\n  };\n\n  return (\n    <MapDrawer\n      title={t('StylingDrawer.title')}\n      placement=\"right\"\n      onClose={onClose}\n      open={isStylingDrawerVisible}\n      maskClosable={false}\n      mask={false}\n      {...passThroughProps}\n    >\n      <StylingComponent />\n    </MapDrawer>\n  );\n};\n\nexport default StylingDrawer;\n","import React from 'react';\n\nimport './index.less';\n\nimport {\n  Select\n} from 'antd';\n\nconst {\n  Option\n} = Select;\n\nimport i18n from '../../i18n';\n\nexport const LanguageSelect = () => {\n  const supportedLanguages = Object.keys(i18n.services.resourceStore.data);\n\n  const onLanguageChange = (lang: string) => {\n    i18n.changeLanguage(lang);\n  };\n\n  return (\n    <div\n      className=\"language-select\"\n      aria-label='language-selector'\n    >\n      <Select\n        defaultValue={i18n.language || 'en'}\n        onChange={onLanguageChange}\n      >\n        {\n          supportedLanguages.map(supportedLanguage => {\n            return (\n              <Option\n                key={supportedLanguage}\n                value={supportedLanguage}\n              >\n                {supportedLanguage.toUpperCase()}\n              </Option>\n            );\n          })\n        }\n      </Select>\n    </div>\n  );\n};\n\nexport default LanguageSelect;\n","import React, {\n  useEffect, useState, useMemo\n} from 'react';\n\nimport {\n  CopyOutlined,\n  MailOutlined,\n  WhatsAppOutlined\n} from '@ant-design/icons';\nimport {\n  Input,\n  Tooltip,\n  message\n} from 'antd';\nimport copy from 'copy-to-clipboard';\nimport {\n  EventsKey\n} from 'ol/events';\nimport BaseLayer from 'ol/layer/Base';\nimport LayerGroup from 'ol/layer/Group';\nimport ImageLayer from 'ol/layer/Image';\nimport TileLayer from 'ol/layer/Tile';\nimport {\n  unByKey\n} from 'ol/Observable';\nimport {\n  useTranslation\n} from 'react-i18next';\n\nimport { PermalinkUtil } from '@terrestris/ol-util/dist/PermalinkUtil/PermalinkUtil';\n\nimport {\n  useMap\n} from '@terrestris/react-util/dist/Hooks/useMap/useMap';\n\nimport Layer from '@terrestris/shogun-util/dist/model/Layer';\n\nimport './index.less';\n\nexport const Permalink: React.FC = () => {\n  const map = useMap();\n  const layerAttributes = useMemo(() => [\n    'layerConfig',\n    'isExternalLayer',\n    'isUploadedLayer',\n    'groupName'\n  ], []);\n  const {\n    t\n  } = useTranslation();\n\n  const initialPermalink = map ? PermalinkUtil.getLink(\n    map,\n    ';',\n    l => l.get('name'),\n    l => (l instanceof TileLayer || l instanceof ImageLayer) && l.getVisible(),\n    layerAttributes\n  ) : '';\n\n  const [permalink, setPermalink] = useState(initialPermalink);\n\n  const mailSubject = 'SHOGun Web-GIS';\n  const mailBody = `Hey,\\r\\ncheck out the layer-composition I created:\\r\\n\\r\\n${permalink}`;\n\n  useEffect(() => {\n    if (!map) {\n      return;\n    }\n    const eventKeys: EventsKey[] = [];\n\n    const identifierFunction = (l: BaseLayer) => l.get('name');\n    const filterFunction = (l: BaseLayer) => (l instanceof TileLayer || l instanceof ImageLayer) && l.getVisible();\n    const updatePermalink = () => {\n      setPermalink(PermalinkUtil.getLink(\n        map,\n        ';',\n        identifierFunction,\n        filterFunction,\n        layerAttributes\n      ));\n    };\n\n    const updateLayerConfig = () => {\n      const externalLayers = map.getAllLayers().filter(l => l.get('isExternalLayer') || l.get('isUploadedLayer'));\n      externalLayers.forEach(externalLayer => {\n        const layerConfig = externalLayer.get('layerConfig') as Layer;\n        if (layerConfig) {\n          if (layerConfig.clientConfig) {\n            layerConfig.clientConfig.opacity = externalLayer.getOpacity();\n          } else {\n            layerConfig.clientConfig = {\n              opacity: externalLayer.getOpacity()\n            };\n          }\n          externalLayer.set('layerConfig', layerConfig);\n        }\n      });\n      updatePermalink();\n    };\n\n    const registerLayerCallback = (layerGroup: LayerGroup) => {\n      const layersInGroup = layerGroup.getLayers().getArray();\n      for (const layerInGroup of layersInGroup) {\n        if (layerInGroup instanceof LayerGroup) {\n          registerLayerCallback(layerInGroup);\n        } else {\n          const eventKeyVisibility = layerInGroup.on('change:visible', updatePermalink);\n          const eventKeyOpacity = layerInGroup.on('change:opacity', updateLayerConfig);\n          eventKeys.push(eventKeyVisibility, eventKeyOpacity);\n        }\n      }\n    };\n\n    const listenerKeyCenter = map.getView().on('change:center', updatePermalink);\n    const listenerKeyResolution = map.getView().on('change:resolution', updatePermalink);\n\n    const mapLayerGroup = map.getLayerGroup();\n    registerLayerCallback(mapLayerGroup);\n    updateLayerConfig();\n\n    return () => {\n      unByKey(listenerKeyCenter);\n      unByKey(listenerKeyResolution);\n      unByKey(eventKeys);\n    };\n  }, [layerAttributes, map, t]);\n\n  function onWhatsAppClick() {\n    const whatsAppUrl = new URL('https://wa.me');\n    whatsAppUrl.searchParams.set('text', mailBody);\n    window.open(whatsAppUrl);\n  }\n\n  function onMailClick() {\n    const mailToUrl = new URL('mailto:');\n    mailToUrl.searchParams.set('subject', mailSubject);\n    mailToUrl.searchParams.set('body', mailBody);\n    window.open(mailToUrl.toString().replace(/\\+/g, '%20'), '_self');\n  }\n\n  function onCopyClick() {\n    const success = copy(permalink);\n    if (success) {\n      message.info(t('Permalink.copiedToClipboard'));\n    } else {\n      message.info(t('Permalink.copyToClipboardFailed'));\n    }\n  }\n\n  return (\n    <div className=\"permalink-wrapper\">\n      <div className=\"icons\">\n        <Tooltip title={t('Permalink.whatsAppTooltip')}>\n          <WhatsAppOutlined onClick={onWhatsAppClick} />\n        </Tooltip>\n        <Tooltip title={t('Permalink.mailTooltip')}>\n          <MailOutlined onClick={onMailClick} />\n        </Tooltip>\n      </div>\n      <div\n        className=\"link\"\n        aria-label='permalink-url'\n      >\n        <Input value={permalink}\n          readOnly\n        />\n        <Tooltip title={t('Permalink.copyTooltip')}>\n          <CopyOutlined onClick={onCopyClick} />\n        </Tooltip>\n      </div>\n    </div>\n  );\n};\n\nexport default Permalink;\n","import OlLayer from 'ol/layer/Layer';\n\nimport { MapFishPrintV3WMSSerializer } from '@terrestris/mapfish-print-manager/dist/serializer/MapFishPrintV3WMSSerializer';\n\nexport class SHOGunMapFishPrintV3WMSSerializer extends MapFishPrintV3WMSSerializer {\n\n  serialize(layer: OlLayer, opts?: any) {\n    const serialized: any = super.serialize(layer, opts);\n\n    if (serialized.baseURL.startsWith('/geoserver/ows')) {\n      serialized.baseURL = `http://shogun-geoserver:8080${serialized.baseURL}`;\n    }\n\n    if (serialized.baseURL.startsWith('/geoserver/SHOGUN')) {\n      serialized.baseURL = `http://shogun-geoserver:8080${serialized.baseURL}`;\n    }\n\n    return serialized;\n  }\n}\n\nexport default SHOGunMapFishPrintV3WMSSerializer;\n","import OlLayer from 'ol/layer/Layer';\nimport OlSourceTileWMS from 'ol/source/TileWMS';\n\nimport { MapFishPrintV3TiledWMSSerializer } from '@terrestris/mapfish-print-manager/dist/serializer/MapFishPrintV3TiledWMSSerializer';\n\nimport SHOGunMapFishPrintV3WMSSerializer from './SHOGunMapFishPrintV3WMSSerializer';\n\nexport class SHOGunMapFishPrintV3TiledWMSSerializer extends SHOGunMapFishPrintV3WMSSerializer {\n\n  serialize(layer: OlLayer<OlSourceTileWMS>, opts: any) {\n    const optsToApply = {\n      tileSize: [512, 512],\n      ...opts\n    };\n\n    const source = layer.getSource();\n\n    if (!source || !this.validateSource(source)) {\n      return;\n    }\n\n    const serialized = {\n      ...super.serialize(layer, optsToApply),\n      ...{\n        type: MapFishPrintV3TiledWMSSerializer.TYPE_WMS\n      },\n      ...opts\n    };\n\n    return serialized;\n  }\n}\n\nexport default SHOGunMapFishPrintV3TiledWMSSerializer;\n","import React, {\n  useEffect\n} from 'react';\n\nimport { Input } from 'antd';\nimport { InputProps } from 'antd/lib/input';\n\nimport _isNil from 'lodash/isNil';\n\nimport useAppDispatch from '../../../hooks/useAppDispatch';\nimport { addCustomParam } from '../../../store/print';\n\nexport type CustomFieldInputProps = InputProps;\n\nexport const CustomFieldInput: React.FC<CustomFieldInputProps> = ({\n  value,\n  id,\n  placeholder,\n  maxLength,\n  ...restProps\n}): JSX.Element => {\n\n  const dispatch = useAppDispatch();\n\n  useEffect(() => {\n    if (!_isNil(id)) {\n      dispatch(addCustomParam({\n        [id]: value\n      }));\n    }\n  }, [value, id, dispatch]);\n\n  return (\n    <Input\n      id={id}\n      value={value}\n      placeholder={placeholder}\n      maxLength={maxLength}\n      showCount={!!(maxLength && maxLength > 1)}\n      {...restProps}\n    />\n  );\n};\n\nexport default CustomFieldInput;\n","import React, {\n  useEffect,\n  useRef,\n  useState\n} from 'react';\n\nimport {\n  Select\n} from 'antd';\nimport {\n  SelectProps\n} from 'antd/lib/select';\n\nimport {\n  MapFishPrintV3Manager\n} from '@terrestris/mapfish-print-manager';\n\nimport {\n  Layout\n} from '../';\n\nexport interface LayoutSelectProps extends SelectProps<string> {\n  printManager: MapFishPrintV3Manager;\n  onValueChange: () => void;\n}\n\nexport const LayoutSelect: React.FC<LayoutSelectProps> = ({\n  printManager,\n  onValueChange,\n  placeholder = 'Bitte whlen Sie eine Vorlage aus',\n  value,\n  ...restProps\n}): JSX.Element => {\n\n  const [layout, setLayout] = useState<any>(value);\n  const prevLayoutRef = useRef<string | null | undefined>(layout);\n\n  useEffect(() => {\n    prevLayoutRef.current = value;\n  }, [value]);\n\n  useEffect(() => {\n    if (printManager) {\n      printManager.setLayout(layout);\n      if (prevLayoutRef.current !== layout) {\n        onValueChange();\n      }\n    }\n  }, [printManager, layout, onValueChange, value]);\n\n  useEffect(() => {\n    setLayout(value);\n  }, [value]);\n\n  return (\n    <Select\n      placeholder={placeholder}\n      value={layout}\n      onChange={setLayout}\n      {...restProps}\n    >\n      {\n        printManager?.getLayouts().map((l: Layout) => (\n          <Select.Option\n            key={l.name}\n            value={l.name}\n          >\n            {l.name}\n          </Select.Option>\n        ))\n      }\n    </Select>\n  );\n};\n\nexport default LayoutSelect;\n","import React, {\n  useEffect,\n  useState\n} from 'react';\n\nimport {\n  Select\n} from 'antd';\nimport {\n  SelectProps\n} from 'antd/lib/select';\n\nimport {\n  MapFishPrintV3Manager\n} from '@terrestris/mapfish-print-manager';\n\nexport interface OutputFormatSelectProps extends SelectProps<string> {\n  printManager: MapFishPrintV3Manager;\n  outputFormats: string[];\n}\n\nexport const OutputFormatSelect: React.FC<OutputFormatSelectProps> = ({\n  printManager,\n  placeholder,\n  value,\n  outputFormats,\n  ...restProps\n}): JSX.Element => {\n\n  const [outputFormat, setOutputFormat] = useState<any>(value);\n\n  useEffect(() => {\n    if (printManager) {\n      printManager.setOutputFormat(outputFormat);\n    }\n  }, [printManager, outputFormat]);\n\n  useEffect(() => {\n    setOutputFormat(value);\n  }, [value]);\n\n  return (\n    <Select\n      placeholder={placeholder}\n      value={outputFormat}\n      onChange={setOutputFormat}\n      {...restProps}\n    >\n      {\n        outputFormats.map((f: string) => (\n          <Select.Option\n            key={f}\n            value={f}\n          >\n            {f.toLocaleUpperCase()}\n          </Select.Option>\n        ))\n      }\n    </Select>\n  );\n};\n\nexport default OutputFormatSelect;\n","import React, {\n  useEffect,\n  useState\n} from 'react';\n\nimport {\n  Select\n} from 'antd';\nimport {\n  SelectProps\n} from 'antd/lib/select';\n\nimport {\n  MapFishPrintV3Manager\n} from '@terrestris/mapfish-print-manager';\n\nexport interface ResolutionSelectProps extends SelectProps<number> {\n  printManager: MapFishPrintV3Manager;\n}\n\nexport const ResolutionSelect: React.FC<ResolutionSelectProps> = ({\n  printManager,\n  placeholder,\n  value,\n  ...restProps\n}): JSX.Element => {\n\n  const [resolution, setResolution] = useState<any>(value);\n\n  useEffect(() => {\n    if (printManager) {\n      printManager.setDpi(resolution);\n    }\n  }, [printManager, resolution]);\n\n  useEffect(() => {\n    setResolution(value);\n  }, [value]);\n\n  return (\n    <Select\n      placeholder={placeholder}\n      value={resolution}\n      onChange={setResolution}\n      {...restProps}\n    >\n      {\n        printManager?.getDpis().map((d: number) => (\n          <Select.Option\n            key={d}\n            value={d}\n          >\n            {`${d} DPI`}\n          </Select.Option>\n        ))\n      }\n    </Select>\n  );\n};\n\nexport default ResolutionSelect;\n","import React, {\n  useEffect,\n  useState\n} from 'react';\n\nimport {\n  Select\n} from 'antd';\nimport {\n  SelectProps\n} from 'antd/lib/select';\n\nimport {\n  MapFishPrintV3Manager\n} from '@terrestris/mapfish-print-manager';\n\nimport { useMap } from '@terrestris/react-util/dist/Hooks/useMap/useMap';\n\nexport interface ScaleSelectProps extends SelectProps<number> {\n  printManager: MapFishPrintV3Manager;\n}\n\nexport const ScaleSelect: React.FC<ScaleSelectProps> = ({\n  printManager,\n  placeholder,\n  value,\n  ...restProps\n}): JSX.Element => {\n\n  const map = useMap();\n\n  const [scale, setScale] = useState<number>(0);\n\n  useEffect(() => {\n    if (printManager && scale) {\n      printManager.setScale(scale);\n    }\n  }, [printManager, scale]);\n\n  useEffect(() => {\n    const updateScale = () => {\n      const pmScale = printManager.getScale();\n      if (pmScale) {\n        setScale(pmScale);\n      }\n    };\n    const transformInteraction = map?.getInteractions().getArray().find(i => {\n      return i.get('name') === MapFishPrintV3Manager.TRANSFORM_INTERACTION_NAME;\n    });\n\n    if (printManager && transformInteraction) {\n      // @ts-expect-error interaction events are not typed correctly\n      transformInteraction.on('scaling', updateScale);\n\n      return () => {\n        // @ts-expect-error interaction events are not typed correctly\n        transformInteraction.on('scaling', updateScale);\n      };\n    }\n  }, [printManager, map]);\n\n  useEffect(() => {\n    if (value) {\n      setScale(value);\n    }\n  }, [value]);\n\n  return (\n    <Select\n      placeholder={placeholder}\n      value={scale}\n      onChange={setScale}\n      {...restProps}\n    >\n      {\n        printManager?.getScales().map((s: number) => (\n          <Select.Option\n            key={s}\n            value={s}\n          >\n            {`1 : ${s.toLocaleString()}`}\n          </Select.Option>\n        ))\n      }\n    </Select>\n  );\n};\n\nexport default ScaleSelect;\n","import OlLayer from 'ol/layer/Layer';\nimport OlRendererLayer from 'ol/renderer/Layer';\nimport OlSourceImageWMS from 'ol/source/ImageWMS';\nimport OlSource from 'ol/source/Source';\nimport OlSourceTileWMS from 'ol/source/TileWMS';\n\nimport { Shared } from '@terrestris/mapfish-print-manager/dist/util/Shared';\n\nShared.getLegendGraphicUrl = (layer: OlLayer<OlSource, OlRendererLayer<any>>): string => {\n  if (layer.get('legendUrl')) {\n    return layer.get('legendUrl');\n  }\n\n  if (layer.getSource() instanceof OlSourceTileWMS ||\n    layer.getSource() instanceof OlSourceImageWMS) {\n\n    const customParams: any = layer.get('customPrintLegendParams');\n    const source: any = layer.getSource();\n\n    const {\n      LAYERS,\n      VERSION,\n      FORMAT\n    } = source.getParams();\n\n    let url: string = source instanceof OlSourceImageWMS ?\n      source.getUrl() :\n      source.getUrls()[0];\n\n    if (url.startsWith('/geoserver/ows')) {\n      url = `http://shogun-geoserver:8080${url}`;\n    }\n\n    const params: any = {\n      LAYER: LAYERS.split(',')[0],\n      VERSION: VERSION || '1.3.0',\n      SERVICE: 'WMS',\n      REQUEST: 'GetLegendGraphic',\n      FORMAT: FORMAT || 'image/png',\n      ...customParams\n    };\n\n    const queryParams = Object.keys(params).map(key => {\n      return `${encodeURIComponent(key)}=${encodeURIComponent(params[key])}`;\n    }).join('&');\n\n    if (url.startsWith('/geoserver/SHOGUN')) {\n      url = `http://shogun-geoserver:8080${url}/service?`;\n      return `${url}${queryParams}`;\n    }\n\n    if (url.endsWith('?')) {\n      return `${url}${queryParams}`;\n    } else {\n      return `${url}?${queryParams}`;\n    }\n  }\n\n  return '';\n};\n","import React, {\n  useCallback,\n  useEffect,\n  useState\n} from 'react';\n\nimport { faDownload } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\n\nimport {\n  Alert,\n  Button,\n  Form\n} from 'antd';\nimport { FormProps } from 'antd/lib/form/Form';\n\nimport ClientConfiguration from 'clientConfig';\n\nimport _isNil from 'lodash/isNil';\n\nimport OlLayerGroup from 'ol/layer/Group';\nimport OlLayer from 'ol/layer/Layer';\nimport OlLayerVector from 'ol/layer/Vector';\nimport OlLayerRenderer from 'ol/renderer/Layer';\nimport OlSource from 'ol/source/Source';\nimport OlSourceVector from 'ol/source/Vector';\n\nimport { useTranslation } from 'react-i18next';\n\nimport Logger from '@terrestris/base-util/dist/Logger';\n\nimport {\n  MapFishPrintV3Manager,\n  MapFishPrintV3ManagerOpts\n} from '@terrestris/mapfish-print-manager/dist/manager/MapFishPrintV3Manager';\nimport { MapFishPrintV3GeoJsonSerializer }\n  from '@terrestris/mapfish-print-manager/dist/serializer/MapFishPrintV3GeoJsonSerializer';\nimport { MapFishPrintV3OSMSerializer } from '@terrestris/mapfish-print-manager/dist/serializer/MapFishPrintV3OSMSerializer';\nimport { MapFishPrintV3StamenSerializer } from '@terrestris/mapfish-print-manager/dist/serializer/MapFishPrintV3StamenSerializer';\nimport { MapFishPrintV3WMTSSerializer }\n  from '@terrestris/mapfish-print-manager/dist/serializer/MapFishPrintV3WMTSSerializer';\nimport { MapFishPrintV3XYZSerializer } from '@terrestris/mapfish-print-manager/dist/serializer/MapFishPrintV3XYZSerializer';\n\nimport LayerUtil from '@terrestris/ol-util/dist/LayerUtil/LayerUtil';\nimport { MapUtil } from '@terrestris/ol-util/dist/MapUtil/MapUtil';\n\nimport { useAsyncEffect } from '@terrestris/react-util/dist/Hooks/useAsyncEffect/useAsyncEffect';\nimport { useMap } from '@terrestris/react-util/dist/Hooks/useMap/useMap';\n\nimport { getBearerTokenHeader } from '@terrestris/shogun-util/dist/security/getBearerTokenHeader';\n\nimport useAppDispatch from '../../hooks/useAppDispatch';\nimport useAppSelector from '../../hooks/useAppSelector';\nimport useSHOGunAPIClient from '../../hooks/useSHOGunAPIClient';\n\nimport { addCustomParam } from '../../store/print';\n\nimport SHOGunMapFishPrintV3TiledWMSSerializer from '../PrintForm/Serializer/SHOGunMapFishPrintV3TiledWMSSerializer';\nimport SHOGunMapFishPrintV3WMSSerializer from '../PrintForm/Serializer/SHOGunMapFishPrintV3WMSSerializer';\n\nimport CustomFieldInput from './CustomFieldInput';\nimport LayoutSelect from './LayoutSelect';\nimport OutputFormatSelect from './OutputFormatSelect';\nimport ResolutionSelect from './ResolutionSelect';\nimport ScaleSelect from './ScaleSelect';\n\nimport '../PrintForm/Shared/Shared';\n\nexport interface Layout {\n  name: string;\n  attributes: any[];\n}\n\nexport interface PrintFormProps extends Omit<FormProps, 'form'> {\n  active: boolean;\n  customPrintScales?: number[];\n  layerBlackList?: string[];\n  layouts?: Layout[];\n  outputFormats?: string[];\n}\n\nexport type LayerType = OlLayer<OlSource, OlLayerRenderer<OlLayerVector<OlSourceVector>>>;\n\nexport const PrintForm: React.FC<PrintFormProps> = ({\n  active,\n  customPrintScales = [],\n  layerBlackList = [],\n  outputFormats = ['pdf', 'png'],\n  ...restProps\n}): JSX.Element => {\n\n  const [form] = Form.useForm();\n  const {\n    t,\n    i18n\n  } = useTranslation();\n\n  const map = useMap();\n\n  const dispatch = useAppDispatch();\n\n  const currentLanguageCode = i18n.language;\n\n  const client = useSHOGunAPIClient();\n\n  const customMapParams = useAppSelector(state => state.print.customMapParams);\n  const customParams = useAppSelector(state => state.print.customParams);\n  const printApp = useAppSelector(state => state.print.printApp);\n\n  const [printManager, setPrintManager] = useState<MapFishPrintV3Manager | null>(null);\n  const [loading, setLoading] = useState<boolean>(false);\n  const [errorMsg, setErrorMsg] = useState<string | null>(null);\n\n  const layerFilter = useCallback((l: OlLayer<OlSource>) => {\n    if (!map) {\n      return;\n    }\n\n    const layerName = l.get('name');\n\n    return layerName && !layerBlackList.includes(layerName) &&\n      l.getVisible() && !(l instanceof OlLayerGroup) &&\n      MapUtil.layerInResolutionRange(l, map);\n  }, [map, layerBlackList]);\n\n  const legendFilter = useCallback((l: OlLayer<OlSource>) => {\n    if (_isNil(map)) {\n      return false;\n    }\n    const layerName = l.get('name');\n    const notBlacklisted = !layerBlackList.includes(layerName);\n    const notHidden = !l.get('hideLegendInPrint');\n    const visible = l.getVisible() && MapUtil.layerInResolutionRange(l, map);\n    const printableLayer = !(l instanceof OlLayerGroup);\n\n    if (notBlacklisted && notHidden && visible && printableLayer) {\n      const res = map?.getView().getResolution();\n      if (res) {\n        l.set('customPrintLegendParams', {\n          SCALE: MapUtil.getScaleForResolution(res, 'm')\n        });\n      }\n      return true;\n    }\n    return false;\n  }, [map, layerBlackList]);\n\n  const getPrintableLayers = useCallback((printLayer: LayerType) => {\n    if (!map) {\n      return [];\n    }\n\n    return MapUtil.getAllLayers(map).filter((layer) => {\n      const layerName = layer.get('name');\n      return layerName &&\n        !(layerName.includes('react-geo')) &&\n        layer.getVisible() &&\n        !(layer instanceof OlLayerGroup) &&\n        layer !== printLayer;\n    }) as LayerType[];\n  }, [map]);\n\n  const getAttributions = useCallback((manager: MapFishPrintV3Manager) => {\n    const extentLayer = manager.getExtentLayer();\n    if (!extentLayer) {\n      return '';\n    }\n\n    const layers = getPrintableLayers(extentLayer);\n    const allAttributions: string[] = [];\n\n    layers.filter((layer: LayerType) => {\n      return layer.getSource && layer.getSource()?.getAttributions && layer.getSource()?.getAttributions();\n    }).forEach((layer: LayerType) => {\n      const currentLayerAttribution = LayerUtil.getLayerAttributionsText(layer, ',', true);\n\n      if (!allAttributions.includes(currentLayerAttribution)) {\n        allAttributions.push(currentLayerAttribution);\n      }\n    });\n    return allAttributions.join(', ').trim();\n  }, [getPrintableLayers]);\n\n  const initializePrintManager = useCallback(async () => {\n    if (_isNil(map)) {\n      return;\n    }\n    let pManagerOpts: MapFishPrintV3ManagerOpts = {\n      url: ClientConfiguration.print?.url ?? '/print',\n      map,\n      customPrintScales: map\n        ?.getView()\n        ?.getResolutions()\n        ?.map((d: number | undefined) => {\n          const units = map?.getView()?.getProjection()?.getUnits();\n          if (typeof d !== 'undefined') {\n            const scale = MapUtil.getScaleForResolution(d, units);\n            if (typeof scale !== 'undefined') {\n              return MapUtil.roundScale(scale);\n            }\n          }\n          return undefined;\n        })\n        .filter((scale: number | undefined) => typeof scale !== 'undefined')\n        ?.reverse() as number[] | undefined,\n      timeout: 60000,\n      layerFilter,\n      headers: {\n        ...getBearerTokenHeader(client?.getKeycloak())\n      },\n      transformOpts: {\n        rotate: false\n      },\n      serializers: [\n        new MapFishPrintV3StamenSerializer(),\n        new MapFishPrintV3GeoJsonSerializer(),\n        new MapFishPrintV3OSMSerializer(),\n        new MapFishPrintV3WMTSSerializer(),\n        new MapFishPrintV3XYZSerializer(),\n        new SHOGunMapFishPrintV3WMSSerializer(),\n        new SHOGunMapFishPrintV3TiledWMSSerializer()\n      ],\n      legendFilter\n    };\n\n    if (customPrintScales.length > 0) {\n      pManagerOpts = {\n        ...pManagerOpts,\n        ...{\n          customPrintScales: customPrintScales.toReversed()\n        }\n      };\n    }\n\n    const pManager: MapFishPrintV3Manager = new MapFishPrintV3Manager(pManagerOpts);\n\n    try {\n      await pManager.init();\n\n      // Use locale print app if available.\n      // Implies that a print app with the language code exists.\n      const apps = pManager.getPrintApps();\n      if (!printApp) {\n        if (apps && currentLanguageCode && apps.includes(currentLanguageCode)) {\n          await pManager.setPrintApp(currentLanguageCode);\n        }\n      } else {\n        await pManager.setPrintApp(printApp);\n      }\n\n      pManager.setOutputFormat(pManager.getOutputFormats()[0]);\n      pManager.setDpi(pManager.getDpis()[0]);\n      pManager.setLayout(pManager.getLayouts()[0]?.name);\n\n      return pManager;\n    } catch (error) {\n      setErrorMsg(() => t('PrintForm.managerErrorMessage'));\n      Logger.error('Could not initialize print manager: ', error);\n    }\n  }, [map, layerFilter, client, legendFilter, customPrintScales, printApp, currentLanguageCode, t]);\n\n  useEffect(() => {\n    if (printManager) {\n      dispatch(addCustomParam({\n        attributions: getAttributions(printManager)\n      }));\n    }\n  }, [dispatch, getAttributions, printManager]);\n\n  useAsyncEffect(async () => {\n    if (active) {\n      if (!printManager) {\n        form.resetFields();\n        const manager = await initializePrintManager();\n        if (manager) {\n          setPrintManager(manager);\n        }\n      }\n    } else {\n      printManager?.shutdownManager();\n      setPrintManager(null);\n    }\n  }, [printManager, active, initializePrintManager, form]);\n\n  useEffect(() => {\n    if (printManager) {\n      if (customParams) {\n        printManager.setCustomParams(customParams);\n      }\n      if (customMapParams) {\n        printManager.setCustomMapParams(customMapParams);\n      }\n    }\n  }, [printManager, customParams, customMapParams]);\n\n  const onDownloadClick = async () => {\n    try {\n      setErrorMsg(null);\n      setLoading(true);\n\n      if (!printManager) {\n        return;\n      }\n\n      const downloadUrl = await printManager.print(false);\n\n      if (!downloadUrl) {\n        throw new Error('No download URL available, the job has failed.');\n      }\n\n      window.open(downloadUrl);\n    } catch (error: any) {\n      setErrorMsg(t('PrintForm.printJobErrorMsg') || null);\n      Logger.error(error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const onAlertClose = () => {\n    setErrorMsg(null);\n  };\n\n  const handleLayoutChange = () => {\n    form.setFieldValue('dpi', printManager?.getDpis()[0]);\n  };\n\n  return (\n    <div\n      className=\"print\"\n      aria-label=\"print-form\"\n    >\n      {\n        errorMsg && (\n          <Alert\n            className=\"print-alert\"\n            message={errorMsg}\n            type=\"error\"\n            closable\n            showIcon\n            onClose={onAlertClose}\n          />\n        )\n      }\n      <>\n        <Form\n          form={form}\n          className=\"print-form\"\n          labelAlign=\"left\"\n          labelCol={{\n            flex: '90px'\n          }}\n          {...restProps}\n        >\n          {\n            printManager?.isInitiated() && (\n              <>\n                <Form.Item\n                  aria-label='print-title'\n                  name=\"title\"\n                  label={t('PrintForm.title')}\n                  initialValue={t('PrintForm.initialTitle')}\n                >\n                  <CustomFieldInput\n                    aria-label='print-title-input'\n                    maxLength={50}\n                    placeholder={t('PrintForm.titlePlaceholder')}\n                  />\n                </Form.Item>\n                <Form.Item\n                  aria-label='print-comment'\n                  name=\"comment\"\n                  label={t('PrintForm.comment')}\n                >\n                  <CustomFieldInput\n                    aria-label='print-comment-input'\n                    maxLength={200}\n                    placeholder={t('PrintForm.commentPlaceholder')}\n                  />\n                </Form.Item>\n                <Form.Item\n                  aria-label='print-layout'\n                  name=\"layout\"\n                  label={t('PrintForm.layout')}\n                  initialValue={printManager?.getLayouts()[0]?.name}\n                >\n                  <LayoutSelect\n                    aria-label='print-layout-input'\n                    printManager={printManager}\n                    onValueChange={handleLayoutChange}\n                  />\n                </Form.Item>\n                <Form.Item\n                  aria-label='print-scale'\n                  name='scale'\n                  label={t('PrintForm.scale')}\n                  initialValue={printManager?.getClosestScaleToFitMap()}\n                >\n                  <ScaleSelect\n                    aria-label='print-scale-input'\n                    printManager={printManager}\n                  />\n                </Form.Item>\n                <Form.Item\n                  aria-label='print-dpi'\n                  name=\"dpi\"\n                  label={t('PrintForm.dpi')}\n                  initialValue={printManager.getDpis()[0]}\n                >\n                  <ResolutionSelect\n                    aria-label='print-dpi-input'\n                    printManager={printManager}\n                    placeholder={t('PrintForm.resolutionPlaceholder')}\n                  />\n                </Form.Item>\n                <Form.Item\n                  aria-label='print-format'\n                  name=\"format\"\n                  label={t('PrintForm.format')}\n                  initialValue=\"pdf\"\n                >\n                  <OutputFormatSelect\n                    aria-label='print-format-input'\n                    printManager={printManager}\n                    outputFormats={outputFormats}\n                    placeholder={t('PrintForm.outputFormatPlaceholder')}\n                  />\n                </Form.Item>\n              </>\n            )}\n        </Form>\n        <Button\n          aria-label='create-print'\n          className='print-button tool-menu-button'\n          disabled={!printManager?.isInitiated()}\n          icon={<FontAwesomeIcon icon={faDownload} />}\n          loading={loading}\n          onClick={onDownloadClick}\n        >\n          {t('PrintForm.downloadBtnText')}\n        </Button>\n      </>\n    </div>\n  );\n};\n\nexport default PrintForm;\n","import React from 'react';\n\nimport {\n  AutoComplete,\n  Form,\n  Input\n} from 'antd';\n\nimport {\n  useTranslation\n} from 'react-i18next';\n\nimport type {\n  FormData\n} from '..';\n\nexport type AttributionRowProps = {\n  keyName: string | number;\n  onChange?: (value: string) => void;\n  options?: string[];\n};\n\nconst AttributionRow: React.FC<AttributionRowProps> = ({\n  keyName,\n  onChange = () => {},\n  options\n}) => {\n\n  const {\n    t\n  } = useTranslation();\n\n  return (\n    <>\n      <Form.Item\n        name={[keyName, 'name']}\n        rules={[{\n          required: true,\n          message: t('AttributionRow.missingKey')\n        }, ({ getFieldsValue }) => ({\n          validator(_, value: string) {\n            const fields: FormData = getFieldsValue(true);\n\n            if (fields.fields) {\n              const filtered = Object.entries(fields.fields).filter(([, val]) => val?.name === value);\n\n              if (filtered.length > 1) {\n                return Promise.reject(new Error(t('AttributionRow.keyInUse')));\n              }\n            }\n\n            return Promise.resolve();\n          }\n        })]}\n      >\n        <AutoComplete\n          placeholder={t('AttributionRow.keyPlaceholder')}\n          onChange={(value) => {\n            onChange(value);\n          }}\n          options={options?.map(o => ({ value: o }))}\n        />\n      </Form.Item>\n      <Form.Item\n        name={[keyName, 'value']}\n        rules={[{\n          required: true,\n          message: t('AttributionRow.missingValue')\n        }]}\n      >\n        <Input\n          placeholder={t('AttributionRow.valuePlaceholder')}\n          onChange={evt => {\n            onChange(evt.target.value);\n          }}\n        />\n      </Form.Item>\n    </>\n  );\n};\n\nexport default AttributionRow;\n","import React, {\n  useCallback,\n  useEffect,\n  useState\n} from 'react';\n\nimport {\n  faMinusSquare\n} from '@fortawesome/free-regular-svg-icons';\nimport {\n  faPlus\n} from '@fortawesome/free-solid-svg-icons';\nimport {\n  FontAwesomeIcon\n} from '@fortawesome/react-fontawesome';\n\nimport {\n  Button,\n  Drawer,\n  DrawerProps,\n  Form,\n  FormListFieldData,\n  Popconfirm,\n  notification,\n  Row\n} from 'antd';\n\nimport OlFeature from 'ol/Feature';\nimport OlGeometry from 'ol/geom/Geometry';\n\nimport {\n  useTranslation\n} from 'react-i18next';\n\nimport Logger from '@terrestris/base-util/dist/Logger';\n\nimport {\n  useMap\n} from '@terrestris/react-util/dist/Hooks/useMap/useMap';\nimport {\n  DigitizeUtil\n} from '@terrestris/react-util/dist/Util/DigitizeUtil';\n\nimport AttributionRow from './AttributionRow';\n\nimport './index.less';\n\nexport type FormData = {\n  fields?: [{\n    name?: string;\n    value?: string;\n  }];\n};\n\nexport type AttributionDrawerProps = Omit<DrawerProps, 'open'> & {\n  selectedFeature: OlFeature | undefined;\n};\n\nconst AttributionDrawer: React.FC<AttributionDrawerProps> = ({\n  selectedFeature,\n  ...passThroughProps\n}) => {\n  const [isFormValid, setIsFormValid] = useState(true);\n  const [availableFeatureCollectionAttributes, setAvailableFeatureCollectionAttributes] = useState<string[]>([]);\n  const [availableFeatureAttributes, setAvailableFeatureAttributes] = useState<string[]>([]);\n  const [, contextHolder] = notification.useNotification();\n  const [form] = Form.useForm<FormData>();\n\n  const map = useMap();\n\n  const open = selectedFeature !== undefined;\n\n  const {\n    t\n  } = useTranslation();\n\n  const updateAvailableFeatureAttributes = useCallback((fields: FormData) => {\n    const currentKeys = fields.fields\n      ?.map(field => field?.name?.toLowerCase())\n      .filter(key => key !== undefined);\n\n    setAvailableFeatureAttributes(availableFeatureCollectionAttributes.filter(o => !(currentKeys?.includes(o.toLowerCase()))));\n  }, [availableFeatureCollectionAttributes]);\n\n  useEffect(() => {\n    if (!map) {\n      return;\n    }\n\n    const properties = selectedFeature?.getProperties();\n\n    form.setFieldValue('fields', []);\n\n    if (properties) {\n      const filteredPropertyEntries = Object.entries(properties)\n        .filter(([, value]) => !(value instanceof OlGeometry))\n        .map(([key, value]) => [key, value]);\n      const filteredProperties = Object.fromEntries(filteredPropertyEntries);\n\n      const formProperties = Object.entries(filteredProperties)\n        .map(([key, value]) => {\n          return {\n            name: key,\n            value: value\n          };\n        });\n\n      form.setFieldValue('fields', formProperties);\n    }\n\n    const digitizeLayer = DigitizeUtil.getDigitizeLayer(map);\n    const digitizedFeatures = digitizeLayer.getSource()?.getFeatures();\n\n    const featureCollectionAttributes = new Set<string>();\n    digitizedFeatures?.forEach(feat => {\n      Object.keys(feat.getProperties()).forEach(prop => {\n        if (!(feat.get(prop) instanceof OlGeometry)) {\n          featureCollectionAttributes.add(prop);\n        }\n      });\n    });\n    setAvailableFeatureCollectionAttributes(Array.from(featureCollectionAttributes));\n  }, [selectedFeature, form, map]);\n\n  const onFinish = (input: FormData) => {\n    if (!selectedFeature) {\n      return;\n    }\n    notification.destroy();\n    notification.success({\n      message: (t('notificationApplyText.title')),\n      placement: 'top',\n      duration: 3.5\n    });\n\n    for (const property in selectedFeature.getProperties()) {\n      if (!(selectedFeature.get(property) instanceof OlGeometry)) {\n        selectedFeature.unset(property);\n      }\n    }\n\n    if (input.fields) {\n      Object.values(input.fields).forEach(field => {\n        if (!field?.name) {\n          return;\n        }\n        selectedFeature.set(field.name, field.value);\n      });\n    }\n  };\n\n  const remove = (rmFn: any, name: number) => {\n    rmFn(name);\n  };\n\n  const onChange = async () => {\n    try {\n      await form.validateFields();\n      setIsFormValid(true);\n    } catch (error) {\n      setIsFormValid(false);\n      Logger.error(error);\n    }\n  };\n\n  const onValuesChange = (changedFields: FormData, fields: FormData) => {\n    updateAvailableFeatureAttributes(fields);\n  };\n\n  const getFormItems = (fields: FormListFieldData[], rmFn: any) => {\n    return fields.map((field) => {\n      const removeAndMessage = () => {\n        notification.destroy();\n        notification.info({\n          message: (t('notificationDeleteText.title')),\n          description: (t('notificationDeleteText.info')),\n          placement: 'top',\n          duration: 6\n        });\n        remove(rmFn, field.name);\n      };\n      return (\n        <div\n          key={field.key}\n          className='attribute-row'\n        >\n          <AttributionRow\n            keyName={field.name}\n            key={field.key}\n            onChange={onChange}\n            options={availableFeatureAttributes}\n          />\n          <Popconfirm\n            title={t('AttributionPopConfirm.title')}\n            okText={t('AttributionPopConfirm.okText')}\n            cancelText={t('AttributionPopConfirm.cancelText')}\n            placement='topRight'\n            onConfirm={removeAndMessage}\n          >\n            {contextHolder}\n            <Button\n              className=\"remove-attribute-button\"\n              type='primary'\n              danger={true}\n              icon={\n                <FontAwesomeIcon\n                  icon={faMinusSquare}\n                />\n              }\n            />\n          </Popconfirm>\n        </div>\n      );\n    });\n  };\n\n  return (\n    <Drawer\n      title={t('Attribution.title')}\n      className=\"attribution-drawer\"\n      placement=\"right\"\n      mask={false}\n      maskClosable={false}\n      closable={false}\n      open={open}\n      {...passThroughProps}\n    >\n      {!selectedFeature &&\n        <>\n          {t('Attribution.select')}\n        </>\n      }\n      <Row>\n        <Form\n          onFinish={onFinish}\n          autoComplete=\"off\"\n          form={form}\n          onValuesChange={onValuesChange}\n        >\n          <Form.List\n            name=\"fields\"\n          >\n            {(fields, {\n              add,\n              remove: rmFn\n            }) => (\n              <>\n                {\n                  getFormItems(fields, rmFn)\n                }\n                <Form.Item>\n                  {\n                    selectedFeature ?\n                      <Button\n                        type=\"dashed\"\n                        onClick={() => {\n                          add();\n                        }}\n                        className=\"add-attribute-button\"\n                        icon={\n                          <FontAwesomeIcon\n                            icon={faPlus}\n                          />\n                        }\n                      >\n                        {t('Attribution.add')}\n                      </Button> :\n                      <></>\n                  }\n                </Form.Item>\n              </>\n            )}\n          </Form.List>\n          <Form.Item>\n            <Button\n              className=\"submit-attributes-button\"\n              type=\"primary\"\n              htmlType=\"submit\"\n              disabled={!isFormValid}\n              hidden={!selectedFeature}\n            >\n              {t('Attribution.submit')}\n            </Button>\n          </Form.Item>\n        </Form>\n      </Row>\n    </Drawer>\n  );\n};\n\nexport default AttributionDrawer;\n","import * as React from 'react';\nimport {\n  useEffect,\n  useState\n} from 'react';\n\nimport { ExclamationCircleOutlined } from '@ant-design/icons';\nimport { Modal } from 'antd';\nimport OlVectorLayer from 'ol/layer/Vector';\nimport OlSourceVector from 'ol/source/Vector';\n\nimport {\n  useTranslation\n} from 'react-i18next';\n\nimport SimpleButton, { SimpleButtonProps } from '@terrestris/react-geo/dist/Button/SimpleButton/SimpleButton';\nimport {\n  useMap\n} from '@terrestris/react-util/dist/Hooks/useMap/useMap';\nimport { DigitizeUtil } from '@terrestris/react-util/dist/Util/DigitizeUtil';\n\nconst { confirm } = Modal;\n\ninterface OwnProps {\n  /**\n   * The vector layer which will be used for digitize features.\n   * The standard digitizeLayer can be retrieved via `DigitizeUtil.getDigitizeLayer(map)`.\n   */\n  digitizeLayer?: OlVectorLayer<OlSourceVector>;\n}\n\nexport type DeleteAllButtonProps = OwnProps & SimpleButtonProps;\n\n/**\n * The className added to this component.\n */\nconst defaultClassName = 'deleteallbutton';\n\nexport const DeleteAllButton: React.FC<DeleteAllButtonProps> = ({\n  className,\n  digitizeLayer,\n  ...passThroughProps\n}) => {\n  const [layers, setLayers] = useState<[OlVectorLayer<OlSourceVector>] | null>(null);\n\n  const map = useMap();\n\n  const {\n    t\n  } = useTranslation();\n\n  useEffect(() => {\n    if (!map) {\n      return;\n    }\n\n    if (digitizeLayer) {\n      setLayers([digitizeLayer]);\n    } else {\n      setLayers([DigitizeUtil.getDigitizeLayer(map)]);\n    }\n  }, [map, digitizeLayer]);\n\n  if (!layers) {\n    return null;\n  }\n\n  const onClick = () => {\n\n    confirm({\n      title: (t('DeleteAllButton.deleteAll')),\n      content: (t('DeleteAllButton.confirmMessage')),\n      icon: <ExclamationCircleOutlined />,\n      onOk(){\n        layers[0].getSource()?.clear();\n      }\n    });\n  };\n\n  const finalClassName = className\n    ? `${defaultClassName} ${className}`\n    : defaultClassName;\n\n  return (\n    <SimpleButton\n      onClick={onClick}\n      className={finalClassName}\n      {...passThroughProps}\n    />\n  );\n};\n\nexport default DeleteAllButton;\n","import React, {\n  useState\n} from 'react';\n\nimport {\n  faUpload\n} from '@fortawesome/free-solid-svg-icons';\nimport {\n  FontAwesomeIcon\n} from '@fortawesome/react-fontawesome';\n\nimport {\n  Alert,\n  message,\n  Modal,\n  ModalProps,\n  Spin,\n  Upload\n} from 'antd';\n\nimport {\n  RcFile,\n  UploadChangeParam,\n  UploadFile\n} from 'antd/lib/upload/interface';\n\nimport OlFeature from 'ol/Feature';\nimport OlFormatGeoJSON from 'ol/format/GeoJSON';\n\nconst { Dragger } = Upload;\n\nimport {\n  UploadRequestOption\n} from 'rc-upload/lib/interface';\n\nimport {\n  useTranslation\n} from 'react-i18next';\n\nimport Logger from '@terrestris/base-util/dist/Logger';\n\nimport {\n  useMap\n} from '@terrestris/react-util/dist/Hooks/useMap/useMap';\nimport {\n  DigitizeUtil\n} from '@terrestris/react-util/dist/Util/DigitizeUtil';\n\nimport './index.less';\n\nexport type ImportDataModalProps = Partial<ModalProps> & {\n  onSuccess?: (features: OlFeature[]) => void;\n  onFailure?: (error: Error) => void;\n};\n\nexport const ImportDataModal: React.FC<ImportDataModalProps> = ({\n  className = 'import-data-modal',\n  footer = false,\n  width = 600,\n  onCancel,\n  onSuccess,\n  onFailure,\n  ...passThroughProps\n}): JSX.Element => {\n  const [isLoading, setIsLoading] = useState<boolean>(false);\n  const [importError, setImportError] = useState('');\n\n  const map = useMap();\n\n  const {\n    t\n  } = useTranslation();\n\n  const supportedFileExtensions = [\n    'json',\n    'geojson'\n  ];\n\n  const supportedFormats = [\n    'application/json',\n    'application/geo+json',\n    'application/geojson'\n  ];\n\n  const onCancelInternal = (evt: React.MouseEvent<HTMLButtonElement>) => {\n    setImportError('');\n    setIsLoading(false);\n\n    onCancel?.(evt);\n  };\n\n  const onBeforeFileUpload = (file: RcFile) => {\n    const fileType = file.type;\n    const fileExtension = file.name.split('.').pop();\n\n    setImportError('');\n\n    if (!supportedFormats.includes(fileType) || (fileExtension && !supportedFileExtensions.includes(fileExtension))) {\n      setImportError(t('ImportDataModal.error.supportedFormats', {\n        supportedFormats: supportedFormats.join(', ')\n      }));\n\n      return false;\n    }\n\n    return true;\n  };\n\n  const readFeaturesFromFile = (options: UploadRequestOption<OlFeature[]>) => {\n    const {\n      file,\n      onSuccess: onSuccessUpload,\n      onError: onErrorUpload\n    } = options;\n\n    if (!(file instanceof File)) {\n      return;\n    }\n\n    if (!map) {\n      return;\n    }\n\n    const fileReader = new FileReader();\n\n    fileReader.onload = () => {\n      try {\n        const features = new OlFormatGeoJSON().readFeatures(fileReader.result, {\n          featureProjection: map.getView().getProjection()\n        });\n\n        onSuccessUpload?.(features);\n      } catch (err) {\n        onErrorUpload?.(err as Error);\n        Logger.error('Error while reading the file: ', err);\n      }\n    };\n\n    fileReader.readAsText(file);\n  };\n\n  const onFileUploadChange = (info: UploadChangeParam<UploadFile<OlFeature[]>>) => {\n    const status = info.file.status;\n    const features = info.file.response;\n\n    if (!map) {\n      return;\n    }\n\n    if (status === 'uploading') {\n      setIsLoading(true);\n    } else if (status === 'done') {\n      const digitizeLayer = DigitizeUtil.getDigitizeLayer(map);\n      const digitizeLayerSource = digitizeLayer.getSource();\n      digitizeLayerSource?.addFeatures(features || []);\n\n      setIsLoading(false);\n      message.success(t('ImportDataModal.success'));\n      onSuccess?.(features || []);\n    } else if (status === 'error') {\n      setIsLoading(false);\n      setImportError(t('ImportDataModal.error.parsing'));\n      onFailure?.(info.file.error);\n    }\n  };\n\n  return (\n    <Modal\n      title={t('ImportDataModal.title')}\n      onCancel={onCancelInternal}\n      className={className}\n      width={width}\n      footer={footer}\n      {...passThroughProps}\n    >\n      {\n        importError && (\n          <Alert\n            message={importError}\n            closable={true}\n            type=\"error\"\n          />\n        )\n      }\n      <Spin\n        spinning={isLoading}\n      >\n        <Dragger\n          customRequest={readFeaturesFromFile}\n          accept={[...supportedFileExtensions.map(ext => `.${ext}`), supportedFormats].join(',')}\n          maxCount={1}\n          showUploadList={false}\n          beforeUpload={onBeforeFileUpload}\n          onChange={onFileUploadChange}\n        >\n          <p className=\"ant-upload-drag-icon\">\n            <FontAwesomeIcon\n              icon={faUpload}\n            />\n          </p>\n          <p className=\"ant-upload-text\">\n            {t('ImportDataModal.description')}\n          </p>\n          <p className=\"ant-upload-hint\">\n            {t('ImportDataModal.hint')}\n          </p>\n        </Dragger>\n      </Spin>\n    </Modal>\n  );\n};\n\nexport default ImportDataModal;\n","import React from 'react';\n\nimport {\n  faPaintBrush\n} from '@fortawesome/free-solid-svg-icons';\n\nimport {\n  FontAwesomeIcon\n} from '@fortawesome/react-fontawesome';\n\nimport { Button } from 'antd';\n\nimport {\n  useTranslation\n} from 'react-i18next';\n\nimport useAppDispatch from '../../../../hooks/useAppDispatch';\nimport useAppSelector from '../../../../hooks/useAppSelector';\nimport { setStylingDrawerVisibility } from '../../../../store/stylingDrawerVisibility';\n\nexport const StylingButton: React.FC = (): JSX.Element => {\n\n  const dispatch = useAppDispatch();\n\n  const {\n    t\n  } = useTranslation();\n\n  const drawerVisibilty = useAppSelector(state => state.stylingDrawerVisibility);\n\n  const toggleDrawer = () => {\n    dispatch(setStylingDrawerVisibility(!drawerVisibilty));\n  };\n\n  return (\n    <Button\n      type=\"link\"\n      onClick={toggleDrawer}\n      icon={<FontAwesomeIcon icon={faPaintBrush} />}\n    >\n      {drawerVisibilty ? t('StylingDrawer.closeColorPalette') : t('StylingDrawer.openColorPalette')}\n    </Button>\n  );\n};\n\nexport default StylingButton;\n","import React, {\n  useCallback,\n  useState,\n  JSX\n} from 'react';\n\nimport {\n  faGripLines,\n  faCircle,\n  faSquare,\n  faFont,\n  faCircleNotch,\n  faShapes,\n  faPenToSquare,\n  faUpload,\n  faTrash,\n  faEraser,\n  faDownload\n} from '@fortawesome/free-solid-svg-icons';\n\nimport {\n  FontAwesomeIcon\n} from '@fortawesome/react-fontawesome';\n\nimport {\n  Button\n} from 'antd';\n\nimport {\n  Feature\n} from 'ol';\nimport OlFeature from 'ol/Feature';\nimport GeoJSON from 'ol/format/GeoJSON';\n\nimport {\n  useTranslation\n} from 'react-i18next';\n\nimport { DeleteButton } from '@terrestris/react-geo/dist/Button/DeleteButton/DeleteButton';\nimport DrawButton from '@terrestris/react-geo/dist/Button/DrawButton/DrawButton';\nimport {\n  ModifyButton, ModifyButtonProps\n} from '@terrestris/react-geo/dist/Button/ModifyButton/ModifyButton';\nimport SimpleButton from '@terrestris/react-geo/dist/Button/SimpleButton/SimpleButton';\nimport {\n  ToggleGroup, ToggleGroupProps\n} from '@terrestris/react-geo/dist/Button/ToggleGroup/ToggleGroup';\nimport {\n  useMap\n} from '@terrestris/react-util/dist/Hooks/useMap/useMap';\nimport {\n  DigitizeUtil\n} from '@terrestris/react-util/dist/Util/DigitizeUtil';\n\nimport AttributionDrawer from './Attributions';\nimport DeleteAllButton from './DeleteAllButton';\nimport ImportDataModal from './ImportDataModal';\nimport StylingButton from './StylingDrawerButton';\n\nimport './index.less';\n\ninterface DefaultDrawProps {\n  showDrawPoint?: boolean;\n  showDrawLine?: boolean;\n  showDrawPolygon?: boolean;\n  showDrawCircle?: boolean;\n  showDrawRectangle?: boolean;\n  showDrawAnnotation?: boolean;\n  showModifyFeatures?: boolean;\n  showUploadFeatures?: boolean;\n  showDownloadFeatures?: boolean;\n  showDeleteFeatures?: boolean;\n  showStyleFeatures?: boolean;\n}\n\nexport type DrawProps = Partial<DefaultDrawProps>;\n\nexport const Draw: React.FC<DrawProps> = ({\n  showDrawPoint,\n  showDrawLine,\n  showDrawPolygon,\n  showDrawCircle,\n  showDrawRectangle,\n  showDrawAnnotation,\n  showModifyFeatures,\n  showUploadFeatures,\n  showDeleteFeatures\n}): JSX.Element => {\n  const [selectedModifyFeature, setSelectedModifyFeature] = useState<OlFeature>();\n  const [selectedButton, setSelectedButton] = useState<string>();\n  const [isImportDataModalOpen, setIsImportDataModalOpen] = useState<boolean>(false);\n\n  const {\n    t\n  } = useTranslation();\n\n  const map = useMap();\n\n  const onToggleChange: Exclude<ToggleGroupProps['onChange'], undefined> = useCallback((evt, value) => {\n    setSelectedButton(value);\n    if (value !== 'draw-modify') {\n      setSelectedModifyFeature(undefined);\n    }\n  }, []);\n\n  const onModifyFeatureSelect: Exclude<ModifyButtonProps['onFeatureSelect'], undefined> = useCallback(event => {\n    if (event.selected.length > 0) {\n      setSelectedModifyFeature(event.selected[0]);\n    } else {\n      setSelectedModifyFeature(undefined);\n    }\n  }, []);\n\n  const onGeoJSONDownload = () => {\n    const clonedFeatures: Feature[] = [];\n    if (map) {\n      const mapProjection = map.getView().getProjection().getCode();\n      const digitizeLayer = DigitizeUtil.getDigitizeLayer(map);\n      const digitizedFeatures = digitizeLayer.getSource()?.getFeatures();\n      if (digitizedFeatures && digitizedFeatures.length > 0) {\n        digitizedFeatures.forEach(feat => {\n          const clonedFeature = feat.clone();\n          clonedFeature.getGeometry()?.transform(mapProjection, 'EPSG:4326');\n          clonedFeatures.push(clonedFeature);\n        });\n        const geoJSON = new GeoJSON().writeFeatures(clonedFeatures);\n\n        const fileToDownload = new Blob([geoJSON], {\n          type: 'application/geo+json'\n        });\n\n        // download the file\n        const url = window.URL.createObjectURL(fileToDownload);\n        const link = document.createElement('a');\n        link.href = url;\n        link.setAttribute('download', 'exportedFeatures.geojson');\n        document.body.appendChild(link);\n        link.click();\n        document.body.removeChild(link);\n      }\n    }\n  };\n\n  const onImportDataClick = () => {\n    setIsImportDataModalOpen(true);\n  };\n\n  const onCloseImportDataModal = () => {\n    setIsImportDataModalOpen(false);\n  };\n\n  if (!map) {\n    return <></>;\n  }\n\n  return (\n    <div\n      className=\"draw-tools\"\n    >\n      <ToggleGroup\n        selected={selectedButton}\n        onChange={onToggleChange}\n      >\n        {showDrawPoint ? (\n          <DrawButton\n            drawType=\"Point\"\n            key=\"draw-point\"\n            pressed={false}\n            type=\"link\"\n            value=\"draw-point\"\n          >\n            <FontAwesomeIcon\n              icon={faCircle}\n            />\n            <span\n              className=\"draw-point\"\n            >\n              {t('Draw.point')}\n            </span>\n          </DrawButton>\n        ) : <></>}\n\n        {showDrawLine ? (\n          <DrawButton\n            drawType=\"LineString\"\n            key=\"draw-line\"\n            type=\"link\"\n            value=\"draw-line\"\n          >\n            <FontAwesomeIcon\n              icon={faGripLines}\n            />\n            <span\n              className=\"draw-line\"\n            >\n              {t('Draw.line')}\n            </span>\n          </DrawButton>\n        ) : <></>}\n\n        {showDrawPolygon ? (\n          <DrawButton\n            value=\"draw-polygon\"\n            key=\"draw-polygon\"\n            drawType=\"Polygon\"\n            type=\"link\"\n          >\n            <FontAwesomeIcon\n              icon={faShapes}\n            />\n            <span\n              className=\"draw-polygon\"\n            >\n              {t('Draw.polygon')}\n            </span>\n          </DrawButton>\n        ) : <></>}\n\n        {showDrawCircle ? (\n          <DrawButton\n            value=\"draw-circle\"\n            key=\"draw-circle\"\n            drawType=\"Circle\"\n            type=\"link\"\n          >\n            <FontAwesomeIcon\n              icon={faCircleNotch}\n            />\n            <span\n              className=\"draw-circle\"\n            >\n              {t('Draw.circle')}\n            </span>\n          </DrawButton>\n        ) : <></>}\n\n        {showDrawRectangle ? (\n          <DrawButton\n            drawType=\"Rectangle\"\n            key=\"draw-rectangle\"\n            type=\"link\"\n            value=\"draw-rectangle\"\n          >\n            <FontAwesomeIcon\n              icon={faSquare}\n            />\n            <span\n              className=\"draw-rectangle\"\n            >\n              {t('Draw.rectangle')}\n            </span>\n          </DrawButton>\n        ) : <></>}\n\n        {showDrawAnnotation ? (\n          <DrawButton\n            drawType=\"Text\"\n            key=\"draw-text\"\n            modalPromptCancelButtonText={t('Draw.modalPromptCancelButtonText')}\n            modalPromptOkButtonText={t('Draw.modalPromptOkButtonText')}\n            modalPromptTitle={t('Draw.modalPromptTitle')}\n            type=\"link\"\n            value=\"draw-text\"\n          >\n            <FontAwesomeIcon\n              icon={faFont}\n            />\n            <span\n              className=\"draw-text\"\n            >\n              {t('Draw.text')}\n            </span>\n          </DrawButton>\n        ) : <></>}\n\n        <StylingButton\n          key=\"styling\"\n        />\n\n        {showModifyFeatures ? (\n          <ModifyButton\n            value=\"draw-modify\"\n            key=\"draw-modify\"\n            type=\"link\"\n            onFeatureSelect={onModifyFeatureSelect}\n          >\n            <FontAwesomeIcon\n              icon={faPenToSquare}\n            />\n            <span\n              className=\"draw-modify\"\n            >\n              {t('Draw.modify')}\n            </span>\n          </ModifyButton>\n        ) : <></>}\n\n        {showDeleteFeatures ? (\n          <DeleteButton\n            value=\"draw-delete\"\n            key=\"draw-delete\"\n            type=\"link\"\n          >\n            <FontAwesomeIcon\n              icon={faEraser}\n            />\n            <span\n              className=\"draw-delete\"\n            >\n              {t('Draw.delete')}\n            </span>\n          </DeleteButton>\n        ) : <></>}\n      </ToggleGroup>\n      {showDeleteFeatures ? (\n        <DeleteAllButton\n          value=\"draw-delete-all\"\n          type=\"link\"\n        >\n          <FontAwesomeIcon\n            icon={faTrash}\n          />\n          <span\n            className=\"draw-delete-all\"\n          >\n            {t('DeleteAllButton.deleteAll')}\n          </span>\n        </DeleteAllButton>\n      ):<></>}\n      {showUploadFeatures ? (\n        <>\n          <Button\n            onClick={onImportDataClick}\n            aria-label='draw-upload'\n            type=\"link\"\n            icon={\n              <FontAwesomeIcon\n                icon={faUpload}\n              />\n            }\n          >\n            <span\n              className=\"draw-upload\"\n            >\n              {t('Draw.upload')}\n            </span>\n          </Button>\n          <ImportDataModal\n            open={isImportDataModalOpen}\n            onCancel={onCloseImportDataModal}\n            onSuccess={onCloseImportDataModal}\n          />\n        </>\n      ) : <></>}\n      {showUploadFeatures ? (\n        <SimpleButton\n          value=\"draw-export\"\n          onClick={onGeoJSONDownload}\n          type=\"link\"\n        >\n          <FontAwesomeIcon\n            icon={faDownload}\n          />\n          <span\n            className=\"draw-export\"\n          >\n            {t('Draw.export')}\n          </span>\n        </SimpleButton>\n      ) : <></>}\n      <AttributionDrawer\n        selectedFeature={selectedModifyFeature}\n      />\n    </div>\n  );\n};\n\nexport default Draw;\n","import {\n  useCallback,\n  useEffect\n} from 'react';\n\nimport OlLayerVector from 'ol/layer/Vector';\nimport OlSourceVector from 'ol/source/Vector';\nimport OlStyleCircle from 'ol/style/Circle';\nimport OlStyleFill from 'ol/style/Fill';\nimport OlStyleStroke from 'ol/style/Stroke';\nimport OlStyle from 'ol/style/Style';\n\nimport { MapUtil } from '@terrestris/ol-util/dist/MapUtil/MapUtil';\n\nimport { useMap } from '@terrestris/react-util/dist/Hooks/useMap/useMap';\n\nexport type HighlightVectorLayerOpts = {\n  layerName: string;\n};\n\nexport const useHighlightVectorLayer = (opts: HighlightVectorLayerOpts) => {\n  const map = useMap();\n\n  const initVectorLayer = useCallback(async () => {\n    if (!map) {\n      return;\n    }\n\n    if (MapUtil.getLayerByName(map, opts.layerName)) {\n      return;\n    }\n\n    const source = new OlSourceVector();\n\n    const fill = new OlStyleFill({\n      color: 'rgba(255, 255, 255, 0.15)'\n    });\n    const stroke = new OlStyleStroke({\n      color: 'rgba(209, 70, 47, 1)',\n      width: 2\n    });\n    const featureStyle = new OlStyle({\n      fill,\n      stroke,\n      image: new OlStyleCircle({\n        radius: 5,\n        fill,\n        stroke\n      })\n    });\n\n    const layer = new OlLayerVector({\n      source: source,\n      style: featureStyle\n    });\n\n    layer.set('name', opts.layerName);\n\n    map.addLayer(layer);\n  }, [map, opts.layerName]);\n\n  const deinitVectorLayer = useCallback(() => {\n    if (!map) {\n      return;\n    }\n\n    const vectorLayer = MapUtil.getLayerByName(map, opts.layerName) as OlLayerVector<OlSourceVector>;\n\n    if (!vectorLayer) {\n      return;\n    }\n\n    map.removeLayer(vectorLayer);\n  }, [map, opts.layerName]);\n\n  useEffect(() => {\n    initVectorLayer();\n\n    return () => deinitVectorLayer();\n  }, [deinitVectorLayer, initVectorLayer]);\n};\n\nexport default useHighlightVectorLayer;\n","import React from 'react';\n\nimport {\n  faClipboardCheck,\n  faClipboardList,\n  faEdit\n} from '@fortawesome/free-solid-svg-icons';\nimport {\n  FontAwesomeIcon\n} from '@fortawesome/react-fontawesome';\n\nimport {\n  Button,\n  Pagination,\n  PaginationProps,\n  Tooltip\n} from 'antd';\n\nimport copy from 'copy-to-clipboard';\n\nimport {\n  Feature\n} from 'geojson';\nimport _clone from 'lodash/clone';\n\nimport {\n  getUid\n} from 'ol';\nimport { isEmpty as isEmptyOlExtent } from 'ol/extent';\nimport OlFeature from 'ol/Feature';\nimport OlFormatGeoJSON from 'ol/format/GeoJSON';\nimport OlGeometry from 'ol/geom/Geometry';\nimport OlLayer from 'ol/layer/Layer';\n\nimport {\n  useTranslation\n} from 'react-i18next';\n\nimport Logger from '@terrestris/base-util/dist/Logger';\n\nimport {\n  useMap\n} from '@terrestris/react-util/dist/Hooks/useMap/useMap';\nimport { DigitizeUtil } from '@terrestris/react-util/dist/Util/DigitizeUtil';\n\nimport useAppDispatch from '../../../../hooks/useAppDispatch';\nimport useAppSelector from '../../../../hooks/useAppSelector';\nimport useGetFitPadding from '../../../../hooks/useGetFitPadding';\nimport {\n  setLayerId,\n  setFeature\n} from '../../../../store/editFeature';\nimport {\n  show as showEditFeatureDrawer\n} from '../../../../store/editFeatureDrawerOpen';\nimport { CopyTools } from '../../../../store/featureInfo';\n\nimport './index.less';\n\nexport type PaginationToolbarProps = {\n  exportFilter?: (propertyName: string, propertyValue: string) => boolean;\n  features: OlFeature[];\n  layer?: OlLayer;\n  selectedFeature: OlFeature;\n} & PaginationProps;\n\nexport const PaginationToolbar: React.FC<PaginationToolbarProps> = ({\n  exportFilter,\n  features,\n  layer,\n  selectedFeature,\n  ...passThroughProps\n}): JSX.Element => {\n\n  const {\n    t\n  } = useTranslation();\n  const dispatch = useAppDispatch();\n  const map = useMap();\n  const getFitPadding = useGetFitPadding();\n\n  const activeCopyTools = useAppSelector(state => state.featureInfo.activeCopyTools);\n\n  const allowedEditMode = useAppSelector(\n    state => state.editFeature.userEditMode\n  );\n\n  const onCopyAsGeoJSONClick = () => {\n    if (!selectedFeature) {\n      return;\n    }\n\n    const selectedFeatureClone = selectedFeature.clone();\n\n    if (exportFilter) {\n      const propertyEntries = Object.entries(selectedFeatureClone.getProperties());\n      const filteredPropertyEntries = propertyEntries.filter(([key, value]) => exportFilter(key, value));\n\n      for (const [key, value] of propertyEntries) {\n        if (value instanceof OlGeometry) {\n          continue;\n        }\n\n        selectedFeatureClone.unset(key);\n      }\n\n      selectedFeatureClone.setProperties(Object.fromEntries(filteredPropertyEntries));\n    }\n\n    copy(new OlFormatGeoJSON().writeFeature(selectedFeatureClone));\n  };\n\n  const onCopyAsObjectClick = () => {\n    if (!selectedFeature) {\n      return;\n    }\n\n    let props = Object.entries(_clone(selectedFeature.getProperties()))\n      .filter(([, value]) => !(value instanceof OlGeometry));\n\n    if (exportFilter) {\n      props = props.filter(([key, value]) => exportFilter(key, value));\n    }\n\n    copy(JSON.stringify(Object.fromEntries(props)));\n  };\n\n  const onEditFeatureBtnClick = () => {\n    if (!layer || !map) {\n      return;\n    }\n\n    const geojsonFeatureString = new OlFormatGeoJSON().writeFeature(selectedFeature);\n\n    try {\n      const geojsonFeature = JSON.parse(geojsonFeatureString) as Feature;\n      const editLayer = DigitizeUtil.getDigitizeLayer(map);\n\n      if (!editLayer) {\n        return;\n      }\n\n      const source = editLayer.getSource();\n\n      if (!source) {\n        return;\n      }\n\n      source.clear();\n      source.addFeature(selectedFeature);\n\n      if (isEmptyOlExtent(source.getExtent())) {\n        return;\n      }\n\n      map.getView().fit(source.getExtent(), {\n        padding: getFitPadding()\n      });\n      dispatch(setLayerId(getUid(layer)));\n      dispatch(setFeature(geojsonFeature));\n      dispatch(showEditFeatureDrawer());\n    } catch (error) {\n      Logger.error('Could not parse GeoJSON: ', error);\n    }\n  };\n\n  const isEditButtonVisible = allowedEditMode.includes('CREATE') ||\n    allowedEditMode.includes('DELETE') ||\n    allowedEditMode.includes('UPDATE');\n  const isLayerEditable = layer?.get('editable');\n\n  return (\n    <div\n      className=\"pagination-toolbar\"\n    >\n      <Pagination\n        simple\n        total={features.length}\n        size=\"small\"\n        pageSize={1}\n        {...passThroughProps}\n      />\n      <div\n        className=\"copy-buttons\"\n      >\n        {\n          isEditButtonVisible && (\n            <Tooltip\n              key=\"edit\"\n              title={isLayerEditable ? t('PaginationToolbar.editFeature') : t('PaginationToolbar.editDisabled')}\n            >\n              <Button\n                type=\"text\"\n                size=\"small\"\n                onClick={onEditFeatureBtnClick}\n                icon={<FontAwesomeIcon icon={faEdit} />}\n                disabled={!isLayerEditable}\n              />\n            </Tooltip>\n          )\n        }\n        {\n          activeCopyTools?.includes(CopyTools.COPY_AS_GEOJSON) && (\n            <Tooltip\n              title={t('PaginationToolbar.copyAsGeoJson')}\n            >\n              <Button\n                type=\"text\"\n                size=\"small\"\n                onClick={onCopyAsGeoJSONClick}\n                icon={<FontAwesomeIcon icon={faClipboardCheck} />}\n              />\n            </Tooltip>\n          )\n        }\n        {\n          activeCopyTools?.includes(CopyTools.COPY_AS_OBJECT) && (\n            <Tooltip\n              title={t('PaginationToolbar.copyAsObject')}\n            >\n              <Button\n                type=\"text\"\n                size=\"small\"\n                onClick={onCopyAsObjectClick}\n                icon={<FontAwesomeIcon icon={faClipboardList} />}\n              />\n            </Tooltip>\n          )\n        }\n      </div>\n    </div>\n  );\n};\n\nexport default PaginationToolbar;\n","import React, {\n  useEffect,\n  useState\n} from 'react';\n\nimport {\n  Tabs,\n  TabsProps\n} from 'antd';\n\nimport _isNil from 'lodash/isNil';\nimport OlFeature from 'ol/Feature';\nimport OlLayer from 'ol/layer/Layer';\nimport OlLayerVector from 'ol/layer/Vector';\nimport OlSourceVector from 'ol/source/Vector';\n\nimport {\n  Tab\n} from 'rc-tabs/lib/interface';\n\nimport { MapUtil } from '@terrestris/ol-util/dist/MapUtil/MapUtil';\n\nimport { useMap } from '@terrestris/react-util/dist/Hooks/useMap/useMap';\n\nimport {\n  PropertyFormItemReadConfig,\n  PropertyFormTabConfig\n} from '@terrestris/shogun-util/dist/model/Layer';\n\nimport useHighlightVectorLayer from '../../../../hooks/useHighlightVectorLayer';\n\nimport FeatureInfoForm from '../FeatureInfoForm';\nimport PaginationToolbar from '../PaginationToolbar';\n\nexport type FeatureInfoTabsProps = TabsProps & {\n  features: OlFeature[];\n  layerName: string;\n  tabConfig?: PropertyFormTabConfig<PropertyFormItemReadConfig>[];\n  layer: OlLayer;\n};\n\nexport const FeatureInfoTabs: React.FC<FeatureInfoTabsProps> = ({\n  features,\n  layerName,\n  layer,\n  tabConfig,\n  ...passThroughProps\n}) => {\n  const [currentPage, setCurrentPage] = useState<number>(1);\n  const [selectedFeature, setSelectedFeature] = useState<OlFeature>();\n  const [activeKey, setActiveKey] = useState<string>('0');\n\n  const map = useMap();\n\n  const vectorLayerName = `selection-layer-${layerName}`;\n\n  useHighlightVectorLayer({\n    layerName: vectorLayerName\n  });\n\n  useEffect(() => {\n    if (!map) {\n      return;\n    }\n\n    const vectorLayer = MapUtil.getLayerByName(map, vectorLayerName) as OlLayerVector<OlSourceVector>;\n\n    if (!vectorLayer) {\n      return;\n    }\n\n    vectorLayer.getSource()?.clear();\n    setCurrentPage(1);\n\n    if (features.length > 0) {\n      setActiveKey('0');\n      setSelectedFeature(features[0]);\n    }\n  }, [features, map, vectorLayerName]);\n\n  useEffect(() => {\n    if (!selectedFeature || !map) {\n      return;\n    }\n\n    const vectorLayer = MapUtil.getLayerByName(map, vectorLayerName) as OlLayerVector<OlSourceVector>;\n\n    if (!vectorLayer) {\n      return;\n    }\n\n    vectorLayer.getSource()?.clear();\n    vectorLayer.getSource()?.addFeature(selectedFeature);\n  }, [selectedFeature, map, vectorLayerName]);\n\n  const onChange = (page: number) => {\n    if (page < 1) {\n      return;\n    }\n\n    setCurrentPage(page);\n    setSelectedFeature(features[page - 1]);\n  };\n\n  if (!tabConfig || !selectedFeature) {\n    return <></>;\n  }\n\n  const exportFilter = (propertyName: string) => {\n    let match = false;\n\n    for (const conf of tabConfig) {\n      if (!conf.children) {\n        continue;\n      }\n\n      for (const child of conf.children) {\n        if (child.propertyName === propertyName) {\n          match = true;\n          break;\n        }\n      }\n    }\n\n    return match;\n  };\n\n  const items = tabConfig\n    .filter(config => !_isNil(config))\n    .map((config, idx) => {\n      return {\n        label: config.title,\n        key: `${idx}`,\n        forceRender: true,\n        children: (\n          <FeatureInfoForm\n            name={config.title}\n            feature={selectedFeature}\n            formConfig={config.children}\n          />\n        )\n      } as Tab;\n    });\n\n  const changeKey = (key: string) => {\n    setActiveKey(key);\n  };\n\n  return (\n    <div\n      className=\"feature-info-tabs\"\n    >\n      <PaginationToolbar\n        current={currentPage}\n        exportFilter={exportFilter}\n        features={features}\n        layer={layer}\n        onChange={onChange}\n        selectedFeature={selectedFeature}\n      />\n      <Tabs\n        items={items}\n        activeKey={activeKey}\n        defaultActiveKey='0'\n        onTabClick={changeKey}\n        {...passThroughProps}\n      />\n    </div>\n  );\n};\n\nexport default FeatureInfoTabs;\n","import React, {\n  useEffect,\n  useState\n} from 'react';\n\nimport {\n  TableProps\n} from 'antd';\n\nimport OlFeature from 'ol/Feature';\nimport OlGeometry from 'ol/geom/Geometry';\nimport OlLayer from 'ol/layer/Layer';\nimport OlLayerVector from 'ol/layer/Vector';\nimport OlSourceVector from 'ol/source/Vector';\n\nimport {\n  useTranslation\n} from 'react-i18next';\n\nimport { MapUtil } from '@terrestris/ol-util/dist/MapUtil/MapUtil';\n\nimport PropertyGrid from '@terrestris/react-geo/dist/Grid/PropertyGrid/PropertyGrid';\nimport { useMap } from '@terrestris/react-util/dist/Hooks/useMap/useMap';\n\nimport useHighlightVectorLayer from '../../../../hooks/useHighlightVectorLayer';\n\nimport PaginationToolbar from '../PaginationToolbar';\n\nimport './index.less';\n\nexport type FeatureInfoPropertyGridProps = {\n  features: OlFeature[];\n  layerName: string;\n  layer?: OlLayer;\n} & TableProps<OlFeature>;\n\nexport const FeatureInfoPropertyGrid: React.FC<FeatureInfoPropertyGridProps> = ({\n  features,\n  layerName,\n  layer,\n  ...restProps\n}): JSX.Element => {\n  const [currentPage, setCurrentPage] = useState<number>();\n  const [selectedFeature, setSelectedFeature] = useState<OlFeature>();\n  const [blacklistedAttributes, setBlacklistedAttributes] = useState<string[]>([]);\n\n  const map = useMap();\n\n  const {\n    t\n  } = useTranslation();\n\n  const vectorLayerName = `selection-layer-${layerName}`;\n\n  useHighlightVectorLayer({\n    layerName: vectorLayerName\n  });\n\n  useEffect(() => {\n    if (!map) {\n      return;\n    }\n\n    const vectorLayer = MapUtil.getLayerByName(map, vectorLayerName) as OlLayerVector<OlSourceVector>;\n\n    if (!vectorLayer) {\n      return;\n    }\n\n    vectorLayer.getSource()?.clear();\n    setCurrentPage(1);\n\n    if (features.length > 0) {\n      setSelectedFeature(features[0]);\n    }\n  }, [features, map, vectorLayerName]);\n\n  useEffect(() => {\n    if (!selectedFeature || !map) {\n      return;\n    }\n\n    const vectorLayer = MapUtil.getLayerByName(map, vectorLayerName) as OlLayerVector<OlSourceVector>;\n\n    if (!vectorLayer) {\n      return;\n    }\n\n    const geomAttributes = Object.entries(selectedFeature.getProperties())\n      .filter(([, value]) => value instanceof OlGeometry)\n      .map(([key]) => key);\n\n    setBlacklistedAttributes(geomAttributes);\n\n    vectorLayer.getSource()?.clear();\n    vectorLayer.getSource()?.addFeature(selectedFeature);\n  }, [selectedFeature, map, vectorLayerName]);\n\n  const onChange = (page: number) => {\n    setCurrentPage(page);\n    setSelectedFeature(features[page - 1]);\n  };\n\n  if (!selectedFeature) {\n    return <></>;\n  }\n\n  const attributeFilter = selectedFeature.getKeys()\n    .filter((prop: string | number | boolean) => {\n      return !blacklistedAttributes.includes((prop as string).toLocaleLowerCase());\n    });\n\n  return (\n    <PropertyGrid\n      className=\"property-grid\"\n      feature={selectedFeature}\n      attributeFilter={attributeFilter}\n      size=\"small\"\n      sticky={true}\n      title={() => (\n        <PaginationToolbar\n          features={features}\n          selectedFeature={selectedFeature}\n          current={currentPage}\n          layer={layer}\n          onChange={onChange}\n        />\n      )}\n      columns={[{\n        title: t('FeaturePropertyGrid.key'),\n        dataIndex: 'attributeName',\n        key: 'attributeName',\n        width: '50%',\n        ellipsis: true,\n        defaultSortOrder: 'ascend',\n        sorter: (a, b) => a.key.localeCompare(b.key)\n      }, {\n        title: t('FeaturePropertyGrid.value'),\n        dataIndex: 'attributeValue',\n        key: 'attributeValue',\n        width: '50%',\n        ellipsis: true\n      }]}\n      scroll={{\n        scrollToFirstRowOnChange: true,\n        y: 'calc(100% - 90px)'\n      }}\n      {...restProps}\n    />\n  );\n};\n\nexport default FeatureInfoPropertyGrid;\n","import React, {\n  useState,\n  FC,\n  JSX\n} from 'react';\n\nimport {\n  FormProps,\n  Spin,\n  Tabs\n} from 'antd';\n\nimport {\n  groupBy, mapValues\n} from 'lodash';\n\nimport _isNil from 'lodash/isNil';\nimport OlFormatGeoJSON from 'ol/format/GeoJSON';\nimport OlLayerBase from 'ol/layer/Base';\nimport OlLayerImage from 'ol/layer/Image';\nimport OlLayerTile from 'ol/layer/Tile';\nimport OlSourceImageWMS from 'ol/source/ImageWMS';\nimport OlSourceTileWMS from 'ol/source/TileWMS';\n\nimport { Tab } from 'rc-tabs/lib/interface';\n\nimport { useTranslation } from 'react-i18next';\n\nimport {\n  isWmsLayer,\n  WmsLayer\n} from '@terrestris/ol-util/dist/typeUtils/typeUtils';\n\nimport {\n  CoordinateInfo,\n  CoordinateInfoProps\n} from '@terrestris/react-geo/dist/CoordinateInfo/CoordinateInfo';\n\nimport { CoordinateInfoResult } from '@terrestris/react-util/dist/Hooks/useCoordinateInfo/useCoordinateInfo';\nimport { useMap } from '@terrestris/react-util/dist/Hooks/useMap/useMap';\n\nimport { getBearerTokenHeader } from '@terrestris/shogun-util/dist/security/getBearerTokenHeader';\n\nimport useAppDispatch from '../../../hooks/useAppDispatch';\nimport useAppSelector from '../../../hooks/useAppSelector';\nimport usePlugins from '../../../hooks/usePlugins';\nimport useSHOGunAPIClient from '../../../hooks/useSHOGunAPIClient';\n\nimport { isFeatureInfoIntegration } from '../../../plugin';\n\nimport { CopyTools } from '../../../store/featureInfo';\nimport {\n  SelectedFeatures, setSelectedFeatures\n} from '../../../store/selectedFeatures';\n\nimport FeatureInfoTabs from './FeatureInfoTabs';\n\nimport FeatureInfoPropertyGrid from './FeaturePropertyGrid';\n\nimport './index.less';\n\nexport type FeatureInfoConfig = {\n  enabled?: boolean;\n  activeCopyTools?: CopyTools[];\n};\n\nexport type FeatureInfoProps = FormProps & Partial<CoordinateInfoProps>;\n\ntype LayerIndex = {\n  layerName: string;\n  index?: number;\n};\n\nexport const FeatureInfo: FC<FeatureInfoProps> = ({\n  ...restProps\n}): JSX.Element => {\n\n  const {\n    t\n  } = useTranslation();\n\n  const map = useMap();\n  const client = useSHOGunAPIClient();\n  const plugins = usePlugins();\n  const dispatch = useAppDispatch();\n\n  const [activeTabKey, setActiveTabKey] = useState<string | undefined>(undefined);\n  const featureInfoEnabled = useAppSelector(state => state.featureInfo.enabled);\n\n  const layerFilter = (layer: OlLayerBase) => {\n    if (!layer.getVisible()) {\n      return false;\n    }\n    if (!layer.get('hoverable')) {\n      return false;\n    }\n    if (layer instanceof OlLayerImage && layer.getSource() instanceof OlSourceImageWMS) {\n      return true;\n    }\n    return layer instanceof OlLayerTile && layer.getSource() instanceof OlSourceTileWMS;\n  };\n\n  const changeActiveKey = (key: string) => {\n    setActiveTabKey(key);\n  };\n\n  const findMapLayerIndex = (layerName: string) => {\n    if (_isNil(map)) {\n      return;\n    }\n    const allLayers = map.getAllLayers();\n\n    return allLayers.findIndex(l => {\n      if (isWmsLayer(l)) {\n        const source = l.getSource();\n        const unqualifiedMapLayerName = getUnqualifiedLayerName(source?.getParams().LAYERS);\n        const unqualifiedLayerName = getUnqualifiedLayerName(layerName);\n\n        return unqualifiedLayerName === unqualifiedMapLayerName;\n      }\n      return false;\n    });\n  };\n\n  const resultRenderer = (coordinateInfoState: CoordinateInfoResult) => {\n    if (_isNil(map)) {\n      return <></>;\n    }\n    const featureLayerResult = coordinateInfoState.features;\n    const loading = coordinateInfoState.loading;\n\n    if (featureLayerResult.length === 0) {\n      return (\n        <span className='usage-hint'>\n          {t('FeatureInfo.usageHint')}\n        </span>\n      );\n    }\n\n    const items: (Tab & { index: number })[] = [];\n\n    const groupedResultsByLayer = groupBy(featureLayerResult, 'featureType');\n\n    Object.entries(groupedResultsByLayer).forEach(([layerName, featureLayerResults]) => {\n      let pluginRendererAvailable = false;\n\n      const features = featureLayerResults.map(flr => flr.feature);\n      const allLayers = map.getAllLayers();\n      const mapLayerIndex = findMapLayerIndex(layerName);\n      if (_isNil(mapLayerIndex)) {\n        return;\n      }\n      const mapLayer = allLayers[mapLayerIndex];\n\n      plugins.forEach(plugin => {\n        if (isFeatureInfoIntegration(plugin.integration) &&\n          ((Array.isArray(plugin.integration.layers) && plugin.integration.layers.includes(layerName)) ||\n            !plugin.integration.layers)) {\n          const {\n            key,\n            wrappedComponent: WrappedPluginComponent\n          } = plugin;\n\n          items.push({\n            label: layerName,\n            index: mapLayerIndex,\n            key: layerName,\n            children: (\n              <WrappedPluginComponent\n                key={key}\n              />\n            )\n          });\n\n          pluginRendererAvailable = true;\n        }\n      });\n\n      if (!pluginRendererAvailable) {\n        items.push({\n          label: mapLayer?.get('name') || layerName,\n          index: mapLayerIndex,\n          key: layerName,\n          children: (\n            <div\n              key={layerName}\n            >\n              {\n                mapLayer?.get('featureInfoFormConfig') ?\n                  <FeatureInfoTabs\n                    tabConfig={mapLayer?.get('featureInfoFormConfig')}\n                    features={features}\n                    layerName={layerName}\n                    layer={mapLayer}\n                  /> :\n                  <FeatureInfoPropertyGrid\n                    features={features}\n                    layerName={layerName}\n                    layer={mapLayer}\n                  />\n              }\n            </div>\n          )\n        });\n      }\n    });\n\n    items.sort((a, b) => b.index - a.index);\n\n    return (\n      <Spin\n        spinning={loading}\n      >\n        <Tabs\n          destroyInactiveTabPane={true}\n          items={items}\n          activeKey={activeTabKey}\n          defaultActiveKey={items[0].key}\n          onTabClick={changeActiveKey}\n        />\n      </Spin>\n    );\n  };\n\n  const getUnqualifiedLayerName = (layerName: string) => {\n    return layerName.split(':').length > 1 ?\n      layerName.split(':')[1] :\n      layerName.split(':')[0];\n  };\n\n  const getFetchOpts = (layer: WmsLayer) => {\n    return {\n      headers: {\n        ...layer.get('useBearerToken') ? {\n          ...getBearerTokenHeader(client?.getKeycloak())\n        } : undefined\n      }\n    };\n  };\n\n  const onSuccess = (coordinateInfoState: CoordinateInfoResult) => {\n    const featureLayerResult = coordinateInfoState.features;\n\n    const grouped = groupBy(featureLayerResult, 'featureType');\n    const mapped = mapValues(grouped, g => g.map(flr => flr.feature));\n\n    const serializedFeatures: SelectedFeatures = {};\n    for (const [layerName, feats] of Object.entries(mapped)) {\n      serializedFeatures[layerName] = new OlFormatGeoJSON().writeFeatures(feats);\n    }\n\n    const layers: LayerIndex[] = featureLayerResult\n      .map(result => ({\n        layerName: result.featureType,\n        index: findMapLayerIndex(result.featureType)\n      }))\n      .sort((a, b) => {\n        if (_isNil(a.index) || _isNil(b.index)) {\n          return 0;\n        }\n        return b.index - a.index;\n      });\n\n    if (layers.length > 0) {\n      setActiveTabKey(layers[0].layerName);\n    }\n\n    dispatch(setSelectedFeatures(serializedFeatures));\n  };\n\n  if (!map) {\n    return <></>;\n  }\n\n  if (!featureInfoEnabled) {\n    return <></>;\n  }\n\n  return (\n    <div className='feature-info-panel'>\n      <CoordinateInfo\n        active={featureInfoEnabled}\n        drillDown={true}\n        featureCount={10}\n        fetchOpts={getFetchOpts}\n        layerFilter={layerFilter}\n        onSuccess={onSuccess}\n        resultRenderer={resultRenderer}\n        {...restProps}\n      />\n    </div>\n  );\n};\n\nexport default FeatureInfo;\n","import React, {\n  useEffect, useMemo,\n  useState\n} from 'react';\n\nimport {\n  faClock\n} from '@fortawesome/free-solid-svg-icons';\nimport {\n  FontAwesomeIcon\n} from '@fortawesome/react-fontawesome';\n\nimport {\n  Divider\n} from 'antd';\n\nimport dayjs, { Dayjs } from 'dayjs';\nimport _isNil from 'lodash/isNil';\nimport OlLayerImage from 'ol/layer/Image';\nimport OlLayerTile from 'ol/layer/Tile';\nimport OlSourceImageWMS from 'ol/source/ImageWMS';\nimport OlSourceTileWMS from 'ol/source/TileWMS';\n\nimport {\n  useTranslation\n} from 'react-i18next';\n\nimport TimeSlider, {\n  TimeSliderMark,\n  TimeSliderProps\n} from '@terrestris/react-geo/dist/Slider/TimeSlider/TimeSlider';\n\nimport './index.less';\n\ninterface WmsTimeSliderProps extends Omit<TimeSliderProps, 'min' | 'max' | 'marks' | 'useRange' |\n  'onChange' | 'defaultValue' | 'value' | 'formatString'> {\n  layer: OlLayerTile<OlSourceTileWMS> | OlLayerImage<OlSourceImageWMS>;\n}\n\nconst formatString = 'YYYY-MM-DD';\n\nexport const WmsTimeSlider: React.FC<WmsTimeSliderProps> = ({\n  layer,\n  ...passThroughProps\n}) => {\n  const [value, setValue] = useState<Dayjs | [Dayjs, Dayjs]>();\n  const [startDate, setStartDate] = useState<Dayjs>();\n  const [endDate, setEndDate] = useState<Dayjs>();\n\n  const marks: TimeSliderMark[] = useMemo(() => {\n    if (_isNil(startDate) || _isNil(endDate)) {\n      return [];\n    }\n    const mid = startDate!.clone().add(endDate!.diff(startDate) / 2);\n    return [{\n      timestamp: startDate,\n      markConfig: {\n        label: startDate.format(formatString)\n      }\n    }, {\n      timestamp: mid,\n      markConfig: {\n        label: mid.format(formatString)\n      }\n    }, {\n      timestamp: endDate,\n      markConfig: {\n        label: endDate.format(formatString),\n        style: {\n          left: 'unset',\n          right: 0,\n          transform: 'translate(50%)'\n        }\n      }\n    }] satisfies TimeSliderMark[];\n  }, [endDate, startDate]);\n\n  const {\n    t\n  } = useTranslation();\n\n  useEffect(() => {\n    const dimension = layer.get('dimension');\n\n    if (!dimension) {\n      return;\n    }\n\n    let timeValues;\n    if (dimension.values) {\n      timeValues = dimension.values.split(',');\n    }\n\n    if (!timeValues || timeValues.length === 0) {\n      return;\n    }\n\n    setStartDate(dayjs(timeValues[0]));\n    setEndDate(dayjs(timeValues[timeValues.length - 1]));\n    setValue(dayjs(timeValues[timeValues.length - 1]));\n\n    const m: Record<string | number, string> = {};\n    timeValues.forEach((val: string) => {\n      m[val] = dayjs(val).format('YYYY-MM-DD');\n    });\n\n    if (timeValues.default === 'current') {\n      let nearest: [number, string] = [NaN, ''];\n      Object.values(m).forEach(d => {\n        const diff = dayjs().diff(dayjs(d));\n\n        if (diff < nearest[0]) {\n          nearest = [diff, d];\n        }\n      });\n\n      setValue(dayjs(nearest[1]));\n    }\n  }, [layer]);\n\n  const onChange = (val: Dayjs | [Dayjs, Dayjs]) => {\n    setValue(val);\n\n    layer.getSource()?.updateParams({\n      TIME: Array.isArray(val) ? val[0].format(formatString) : val.format(formatString)\n    });\n  };\n\n  return (\n    <div\n      className=\"wms-time-slider\"\n    >\n      <Divider>\n        <FontAwesomeIcon\n          icon={faClock}\n        />\n        {t('WmsTimeSlider.title')}\n      </Divider>\n      {\n        marks && startDate && endDate ?\n          <TimeSlider\n            defaultValue={dayjs()}\n            formatString={formatString}\n            marks={marks}\n            max={endDate}\n            min={startDate}\n            onChange={onChange}\n            value={value}\n            {...passThroughProps}\n          /> :\n          <span>\n            {t('WmsTimeSlider.default')}\n          </span>\n      }\n    </div>\n  );\n};\n\nexport default WmsTimeSlider;\n","import React, {\n  useState\n} from 'react';\n\nimport {\n  faEllipsisV\n} from '@fortawesome/free-solid-svg-icons';\nimport {\n  FontAwesomeIcon\n} from '@fortawesome/react-fontawesome';\n\nimport {\n  Dropdown,\n  DropDownProps,\n  notification,\n  Spin\n} from 'antd';\nimport {\n  ItemType\n} from 'antd/lib/menu/interface';\n\nimport {\n  getUid\n} from 'ol';\nimport OlLayerBase from 'ol/layer/Base';\nimport OlLayerGroup from 'ol/layer/Group';\nimport OlLayerImage from 'ol/layer/Image';\nimport OlLayerTile from 'ol/layer/Tile';\nimport {\n  transformExtent\n} from 'ol/proj';\nimport OlSourceImageWMS from 'ol/source/ImageWMS';\nimport OlSourceTileWMS from 'ol/source/TileWMS';\n\nimport {\n  MenuInfo\n} from 'rc-menu/lib/interface';\n\nimport {\n  useTranslation\n} from 'react-i18next';\n\nimport Logger from '@terrestris/base-util/dist/Logger';\n\nimport LayerUtil from '@terrestris/ol-util/dist/LayerUtil/LayerUtil';\nimport { MapUtil } from '@terrestris/ol-util/dist/MapUtil/MapUtil';\n\nimport {\n  isWmsLayer\n} from '@terrestris/ol-util/dist/typeUtils/typeUtils';\n\nimport {\n  useMap\n} from '@terrestris/react-util/dist/Hooks/useMap/useMap';\n\nimport {\n  DownloadConfig\n} from '@terrestris/shogun-util/dist/model/Layer';\nimport {\n  getBearerTokenHeader\n} from '@terrestris/shogun-util/dist/security/getBearerTokenHeader';\n\nimport useAppDispatch from '../../../../hooks/useAppDispatch';\nimport useAppSelector from '../../../../hooks/useAppSelector';\nimport useGetFitPadding from '../../../../hooks/useGetFitPadding';\nimport useSHOGunAPIClient from '../../../../hooks/useSHOGunAPIClient';\n\nimport {\n  setLayerId,\n  setFeature\n} from '../../../../store/editFeature';\nimport {\n  show as showEditFeatureDrawer\n} from '../../../../store/editFeatureDrawerOpen';\n\nimport {\n  setLayer as setLayerDetailsLayer,\n  show as showLayerDetailsModal\n} from '../../../../store/layerDetailsModal';\n\nexport type LayerTreeContextMenuProps = {\n  layer: OlLayerTile<OlSourceTileWMS> | OlLayerImage<OlSourceImageWMS>;\n  visibleLegendsIds: string[];\n  setVisibleLegendsIds: (ids: string[]) => void;\n} & Partial<DropDownProps>;\n\nexport const LayerTreeContextMenu: React.FC<LayerTreeContextMenuProps> = ({\n  layer,\n  visibleLegendsIds,\n  setVisibleLegendsIds,\n  ...restProps\n}): JSX.Element => {\n\n  const [settingsVisible, setSettingsVisible] = useState<boolean>(false);\n  const [extentLoading, setExtentLoading] = useState<boolean>(false);\n\n  const dispatch = useAppDispatch();\n  const client = useSHOGunAPIClient();\n  const map = useMap();\n  const getFitPadding = useGetFitPadding();\n  const {\n    t\n  } = useTranslation();\n\n  const downloadConfig: DownloadConfig[] = layer.get('downloadConfig') ?? null;\n  const allowedEditMode = useAppSelector(\n    state => state.editFeature.userEditMode\n  );\n  const metadataVisible = useAppSelector(state => state.layerTree.metadataVisible);\n\n  const onContextMenuItemClick = (evt: MenuInfo): void => {\n    if (evt?.key.startsWith('downloadLayer')) {\n      const url = evt.key.split('|')[1];\n      downloadLayer(decodeURI(url));\n    }\n    switch (evt?.key) {\n      case 'zoomToExtent':\n        zoomToLayerExtent();\n        break;\n      case 'removeExternal':\n        removeExternalLayer();\n        break;\n      case 'toggleLegend': {\n        const legendId: string = getUid(layer);\n        const newLegendIds = [...visibleLegendsIds];\n        if (newLegendIds.includes(legendId)) {\n          newLegendIds.splice(newLegendIds.indexOf(legendId), 1);\n        } else {\n          newLegendIds.push(legendId);\n        }\n        setVisibleLegendsIds(newLegendIds);\n        break;\n      }\n      case 'editLayer':\n        dispatch(setFeature(null));\n        dispatch(setLayerId(getUid(layer)));\n        dispatch(showEditFeatureDrawer());\n        break;\n      case 'layerDetails':\n        dispatch(setLayerDetailsLayer(getUid(layer)));\n        dispatch(showLayerDetailsModal());\n        break;\n      default:\n        break;\n    }\n    setSettingsVisible(false);\n  };\n\n  const zoomToLayerExtent = async (): Promise<void> => {\n    if (!map) {\n      return;\n    }\n\n    setExtentLoading(true);\n\n    try {\n      let extent = await LayerUtil.getExtentForLayer(layer, {\n        headers: layer.get('useBearerToken') ? {\n          ...getBearerTokenHeader(client?.getKeycloak())\n        } : {}\n      });\n      extent = transformExtent(extent, 'EPSG:4326', map.getView().getProjection());\n      map.getView().fit(extent, {\n        padding: getFitPadding()\n      });\n    } catch (error) {\n      Logger.error(error);\n      notification.error({\n        message: t('LayerTreeContextMenu.extentError')\n      });\n    } finally {\n      setExtentLoading(false);\n    }\n  };\n\n  const getParentLayerGroups = (l: OlLayerBase): OlLayerGroup[] => {\n    if (!map) {\n      return [];\n    }\n\n    const layerGroups = getAllLayerGroups(map.getLayerGroup())\n      .filter(layerGroup => layerGroup.getLayers().getArray().includes(l));\n\n    return layerGroups;\n  };\n\n  const getAllLayerGroups = (layerGroup: OlLayerGroup): OlLayerGroup[] => {\n    const layerGroups = [layerGroup];\n\n    for (const l of layerGroup.getLayers().getArray()) {\n      if (l instanceof OlLayerGroup) {\n        layerGroups.push(...getAllLayerGroups(l));\n      }\n    }\n\n    return layerGroups;\n  };\n\n  const removeLayer = (l: OlLayerBase) => {\n    const parentGroups = getParentLayerGroups(l);\n\n    parentGroups.forEach(parentGroup => parentGroup.getLayers().remove(l));\n  };\n\n  const removeExternalLayer = () => {\n    if (!map) {\n      return;\n    }\n\n    removeLayer(layer);\n\n    const externalLayerGroup = MapUtil.getLayerByName(map, t('AddLayerModal.externalWmsFolder')) as OlLayerGroup;\n    const uploadedLayerGroup = MapUtil.getLayerByName(map, t('UploadDataModal.uploadedDataFolder')) as OlLayerGroup;\n\n    if (externalLayerGroup && externalLayerGroup.getLayers().getLength() === 0) {\n      removeLayer(externalLayerGroup);\n    }\n\n    if (uploadedLayerGroup && uploadedLayerGroup.getLayers().getLength() === 0) {\n      removeLayer(uploadedLayerGroup);\n    }\n  };\n\n  const downloadLayer = async (url: string) => {\n    if (!layer) {\n      return;\n    }\n    const reqOpts = {\n      method: 'GET',\n      headers: {\n        ...layer.get('useBearerToken') ? {\n          ...getBearerTokenHeader(client?.getKeycloak())\n        } : undefined\n      }\n    };\n\n    const res = await fetch(url, reqOpts);\n    const blob = await res.blob();\n    const a = document.createElement('a');\n    a.href = URL.createObjectURL(blob);\n    a.setAttribute('download', layer.get('name'));\n    a.click();\n  };\n\n  const dropdownMenuItems: ItemType[] = [];\n\n  if (isWmsLayer(layer)) {\n    dropdownMenuItems.push({\n      label: (\n        <Spin\n          spinning={extentLoading}\n        >\n          {t('LayerTreeContextMenu.layerZoomToExtent')}\n        </Spin>\n      ),\n      key: 'zoomToExtent'\n    });\n  }\n\n  if (isWmsLayer(layer) && layer.getVisible()) {\n    const legendVisible = visibleLegendsIds.includes(getUid(layer));\n\n    dropdownMenuItems.push({\n      label: legendVisible ? t('LayerTreeContextMenu.hideLegend') : t('LayerTreeContextMenu.showLegend'),\n      key: 'toggleLegend'\n    });\n  }\n\n  if (layer.get('isExternalLayer') || layer.get('isUploadedLayer')) {\n    dropdownMenuItems.push({\n      label: t('LayerTreeContextMenu.removeLayer'),\n      key: 'removeExternal'\n    });\n  }\n\n  if (downloadConfig) {\n    const downloadItems = downloadConfig.map((dlConfig: DownloadConfig) => {\n      return {\n        label: t('LayerTreeContextMenu.downloadLayer', {\n          formatName: dlConfig.formatName ?? 'XML'\n        }),\n        key: `downloadLayer|${encodeURI(dlConfig.downloadUrl)}`\n      };\n    });\n    dropdownMenuItems.push(...downloadItems);\n  }\n\n  if (\n    layer.get('editable') &&\n    (allowedEditMode.includes('CREATE') ||\n      allowedEditMode.includes('UPDATE') ||\n      allowedEditMode.includes('DELETE'))\n  ) {\n    dropdownMenuItems.push({\n      label: t('LayerTreeContextMenu.editLayer'),\n      key: 'editLayer'\n    });\n  }\n\n  if (metadataVisible) {\n    dropdownMenuItems.push({\n      label: t('LayerTreeContextMenu.layerDetails'),\n      key: 'layerDetails'\n    });\n  }\n\n  return (\n    <div\n      aria-label='layer-context'\n    >\n      <Dropdown\n        menu={{\n          items: dropdownMenuItems,\n          onClick: onContextMenuItemClick\n        }}\n        placement=\"bottomLeft\"\n        onOpenChange={setSettingsVisible}\n        open={settingsVisible}\n        trigger={['click']}\n        {...restProps}\n      >\n        <FontAwesomeIcon icon={faEllipsisV} />\n      </Dropdown>\n    </div>\n  );\n};\n\nexport default LayerTreeContextMenu;\n","import React from 'react';\n\nimport './index.less';\n\nexport const LoadingIndicator: React.FC = (): JSX.Element => {\n  return (\n    <div className=\"layer-node-title-loading-animation\">\n      <span className=\"dot-one\">.</span>\n      <span className=\"dot-two\">.</span>\n      <span className=\"dot-three\">.</span>\n    </div>\n  );\n};\n\nexport default LoadingIndicator;\n","import React, {\n  useState,\n  useEffect,\n  useCallback,\n  useMemo\n} from 'react';\n\nimport {\n  faMagnifyingGlass,\n  faCircleInfo,\n  faPen\n} from '@fortawesome/free-solid-svg-icons';\nimport {\n  FontAwesomeIcon\n} from '@fortawesome/react-fontawesome';\n\nimport {\n  Tooltip\n} from 'antd';\n\nimport _isNil from 'lodash/isNil';\n\nimport {\n  getUid,\n  MapEvent as OlMapEvent\n} from 'ol';\nimport BaseEvent from 'ol/events/Event';\nimport OlBaseLayer from 'ol/layer/Base';\nimport OlLayerGroup from 'ol/layer/Group';\nimport OlLayerImage from 'ol/layer/Image';\nimport OlLayer from 'ol/layer/Layer';\nimport OlLayerTile from 'ol/layer/Tile';\nimport OlVectorLayer from 'ol/layer/Vector';\nimport OlSourceImageWMS from 'ol/source/ImageWMS';\nimport OlSourceTileWMS from 'ol/source/TileWMS';\n\nimport {\n  useTranslation\n} from 'react-i18next';\n\nimport { MapUtil } from '@terrestris/ol-util/dist/MapUtil/MapUtil';\nimport { isWmsLayer } from '@terrestris/ol-util/dist/typeUtils/typeUtils';\n\nimport RgLayerTree, {\n  LayerTreeProps as RgLayerTreeProps\n} from '@terrestris/react-geo/dist/LayerTree/LayerTree';\nimport { Legend } from '@terrestris/react-geo/dist/Legend/Legend';\nimport LayerTransparencySlider from '@terrestris/react-geo/dist/Slider/LayerTransparencySlider/LayerTransparencySlider';\n\nimport {\n  useMap\n} from '@terrestris/react-util/dist/Hooks/useMap/useMap';\n\nimport type { LayerType } from '@terrestris/shogun-util/dist/model/enum/LayerType';\nimport {\n  getBearerTokenHeader\n} from '@terrestris/shogun-util/dist/security/getBearerTokenHeader';\n\nimport useAppSelector from '../../../hooks/useAppSelector';\nimport useSHOGunAPIClient from '../../../hooks/useSHOGunAPIClient';\n\nimport WmsTimeSlider from '../../WmsTimeSlider';\n\nimport LayerTreeContextMenu from './LayerTreeContextMenu';\nimport LoadingIndicator from './LoadingIndicator';\n\nimport './index.less';\n\nexport type LayerTreeProps = Partial<RgLayerTreeProps>;\n\nexport type LayerTileLoadCounter = Record<string, {\n  loading: number;\n  loaded: number;\n  percent: number;\n}>;\n\nexport const LayerTree: React.FC<LayerTreeProps> = ({\n  ...restProps\n}): JSX.Element => {\n  const map = useMap();\n  const client = useSHOGunAPIClient();\n  const {\n    t\n  } = useTranslation();\n\n  const initialLayersUid = map?.getAllLayers().map(l => getUid(l));\n\n  const showLegendsState: boolean = useAppSelector(state => state.layerTree.showLegends) ?? false;\n  const layerIconsVisible: boolean = useAppSelector(state => state.layerTree.layerIconsVisible) ?? false;\n\n  const [visibleLegendsIds, setVisibleLegendsIds] = useState<string[]>(showLegendsState ? initialLayersUid ?? [] : []);\n  const [layerTileLoadCounter, setLayerTileLoadCounter] = useState<LayerTileLoadCounter>({});\n  const [mapScale, setMapScale] = useState<number>();\n\n  const registerTileLoadHandler = useCallback(() => {\n    if (!map) {\n      return;\n    }\n\n    const allLayers = MapUtil.getAllLayers(map);\n    allLayers.forEach(layer => {\n      if (layer instanceof OlLayer) {\n        const source = layer.getSource();\n        if (source instanceof OlSourceTileWMS) {\n          if (!source.hasListener('tileloadstart')) {\n            source.on('tileloadstart', tileLoadStartListener);\n          }\n          if (!source.hasListener('tileloadend') && !source.hasListener('tileloaderror')) {\n            source.on(['tileloadend', 'tileloaderror'], tileLoadEndListener);\n          }\n        }\n        if (source instanceof OlSourceImageWMS) {\n          if (!source.hasListener('imageloadstart')) {\n            source.on('imageloadstart', tileLoadStartListener);\n          }\n          if (!source.hasListener('imageloadend') && !source.hasListener('imageloaderror')) {\n            source.on(['imageloadend', 'imageloaderror'], tileLoadEndListener);\n          }\n        }\n      }\n    });\n  }, [map]);\n\n  const checkListeners = useCallback(() => {\n    const activeLayers = map?.getAllLayers().map(l => getUid(l));\n\n    if (activeLayers?.length !== initialLayersUid?.length) {\n      registerTileLoadHandler();\n    }\n  }, [map, initialLayersUid, registerTileLoadHandler]);\n\n  const legendRequestExtraParams = useMemo(() => ({\n    SCALE: mapScale,\n    LEGEND_OPTIONS: 'fontAntiAliasing:true;forceLabels:on',\n    TRANSPARENT: true\n  }), [mapScale]);\n\n  const legendRequestHeaders = useMemo(() => ({\n    ...getBearerTokenHeader(client?.getKeycloak())\n  }), [client]);\n\n  const onMapMoveEnd = useCallback((evt: OlMapEvent) => {\n    const mapView = evt.map.getView();\n\n    const unit = mapView.getProjection().getUnits() || 'm';\n    const resolution = mapView.getResolution();\n    const scale = resolution ? MapUtil.getScaleForResolution(resolution, unit) : undefined;\n\n    setMapScale(scale);\n  }, []);\n\n  useEffect(() => {\n    if (!map) {\n      return;\n    }\n\n    // Trigger once on initial render to set the current map scale.\n    onMapMoveEnd(new OlMapEvent('moveend', map));\n\n    map.on('moveend', onMapMoveEnd);\n\n    return () => {\n      map.un('moveend', onMapMoveEnd);\n    };\n  }, [map, onMapMoveEnd]);\n\n  useEffect(() => {\n    if (!map) {\n      return;\n    }\n\n    registerTileLoadHandler();\n\n    map.getLayers().on('change', checkListeners);\n\n    return () => {\n      const allLayers = MapUtil.getAllLayers(map);\n      allLayers.forEach(layer => {\n        if (layer instanceof OlLayer) {\n          const source = layer.getSource();\n          if (source.hasListener('tileloadstart')) {\n            source.un('tileloadstart', tileLoadStartListener);\n          }\n          if (source.hasListener('tileloadend')) {\n            source.un('tileloadend', tileLoadEndListener);\n          }\n          if (source.hasListener('tileloaderror')) {\n            source.un('tileloaderror', tileLoadEndListener);\n          }\n        }\n      });\n      map.getLayers().un('change', checkListeners);\n    };\n  }, [map, registerTileLoadHandler, checkListeners]);\n\n  const tileLoadStartListener = (evt: BaseEvent) => {\n    setLayerTileLoadCounter((counter: LayerTileLoadCounter) => {\n      const uid = getUid(evt.target);\n      const update = structuredClone(counter);\n\n      // reset when load was finished\n      if (update[uid] && update[uid].loaded >= update[uid].loading) {\n        update[uid].loading = 1;\n        update[uid].loaded = 0;\n        update[uid].percent = 0;\n        return update;\n      }\n\n      if (!update[uid]) {\n        update[uid] = {\n          loading: 0,\n          loaded: 0,\n          percent: 0\n        };\n      }\n\n      update[uid].loading = Number.isInteger(update[uid].loading) ?\n        update[uid].loading + 1 : 1;\n\n      return update;\n    });\n  };\n\n  const tileLoadEndListener = (evt: BaseEvent | Event) => {\n    setLayerTileLoadCounter((counter: LayerTileLoadCounter) => {\n      const uid = getUid(evt.target);\n      const update = structuredClone(counter);\n\n      if (!update[uid]) {\n        update[uid] = {\n          loading: 0,\n          loaded: 0,\n          percent: 0\n        };\n      }\n\n      update[uid].loaded = Number.isInteger(update[uid].loaded) ?\n        update[uid].loaded + 1 : 1;\n\n      const percent = Math.round(update[uid].loaded / update[uid].loading * 100);\n\n      if (percent > update[uid].percent) {\n        update[uid].percent = percent;\n      }\n\n      return update;\n    });\n  };\n\n  const treeFilterFunction = (layer: OlBaseLayer | OlLayerGroup) => {\n    if (layer instanceof OlLayerGroup) {\n      return true;\n    }\n    if (layer instanceof OlVectorLayer) {\n      return false;\n    }\n    if (_isNil(layer.get('shogunId'))) {\n      return false;\n    }\n    if (layer.get('isBackgroundLayer')) {\n      return false;\n    }\n    return true;\n  };\n\n  const treeNodeTitleRenderer = (layer: OlBaseLayer) => {\n    if (!map) {\n      return;\n    }\n\n    const percent = layer instanceof OlLayer && getUid(layer.getSource()) ?\n      layerTileLoadCounter[getUid(layer.getSource())]?.percent : 100;\n\n    if (layer instanceof OlLayerGroup) {\n      return (\n        <div\n          aria-label='layer-group'\n        >\n          {layer.get('name')}\n        </div>\n      );\n    } else {\n      return (\n        <>\n          <div\n            className=\"tree-node-header\"\n            aria-label=\"tree-node-header\"\n          >\n            <span\n              aria-label='layer-name'\n              className='layer-name'\n            >\n              {layer.get('name')}\n              <span\n                className='loading-dots'\n              >\n                {percent < 100 && <LoadingIndicator />}\n              </span>\n              <span\n                className='layer-icons-group'\n              >\n                {layer.get('searchable') && layerIconsVisible && (\n                  <>\n                    <Tooltip title={t('ToolMenu.searchable')}>\n                      <FontAwesomeIcon\n                        icon={faMagnifyingGlass}\n                        className='layer-icon'\n                      />\n                    </Tooltip>\n                  </>\n                )}\n                {layer.get('hoverable') && layer.get('visible') && layerIconsVisible && (\n                  <>\n                    <Tooltip title={t('ToolMenu.queryable')}>\n                      <FontAwesomeIcon\n                        icon={faCircleInfo}\n                        className='layer-icon'\n                      />\n                    </Tooltip>\n                  </>\n                )}\n                {layer.get('editable') && layerIconsVisible && (\n                  <>\n                    <Tooltip title={t('ToolMenu.editable')}>\n                      <FontAwesomeIcon\n                        icon={faPen}\n                        className='layer-icon'\n                      />\n                    </Tooltip>\n                  </>\n                )}\n              </span>\n            </span>\n            {\n              (layer instanceof OlLayerTile || layer instanceof OlLayerImage) && (\n                <div\n                  aria-label='layer-context-menu'\n                >\n                  <LayerTreeContextMenu\n                    layer={layer}\n                    visibleLegendsIds={visibleLegendsIds}\n                    setVisibleLegendsIds={setVisibleLegendsIds}\n                  />\n                </div>\n              )\n            }\n\n          </div>\n          {\n            layer.get('visible') &&\n            <div\n              className=\"layer-transparency\"\n              role=\"button\"\n              aria-label='transparency-slider'\n              tabIndex={0}\n              onClick={e => e.stopPropagation()}\n              onKeyDown={e => {\n                if (e.key === 'Enter' || e.key === ' ') {\n                  e.preventDefault();\n                  e.stopPropagation();\n                }\n              }}\n              onDragStart={e => {e.stopPropagation(); e.preventDefault();}}\n              draggable={true}\n            >\n              <LayerTransparencySlider\n                tooltip={{\n                  formatter: val => `${t('LayerTree.transparency')}: ${val}%`\n                }}\n                layer={layer}\n              />\n            </div>\n          }\n          {\n            (layer.get('visible') && layer.get('type') as LayerType === 'WMSTIME') &&\n            <div className=\"layer-time-slider\">\n              <WmsTimeSlider\n                layer={layer as OlLayerTile<OlSourceTileWMS> | OlLayerImage<OlSourceImageWMS>}\n              />\n            </div>\n          }\n          {\n            (layer.get('visible') && isWmsLayer(layer) && visibleLegendsIds.includes(getUid(layer))) &&\n            <Legend\n              layer={layer}\n              errorMsg={t('LayerTree.noLegendAvailable')}\n              extraParams={legendRequestExtraParams}\n              headers={layer.get('useBearerToken') ? legendRequestHeaders : undefined}\n            />\n          }\n        </>\n      );\n    }\n  };\n\n  if (!map) {\n    return <></>;\n  }\n\n  return (\n    <RgLayerTree\n      aria-label=\"layertree\"\n      className=\"layertree\"\n      nodeTitleRenderer={treeNodeTitleRenderer}\n      filterFunction={treeFilterFunction}\n      draggable\n      {...restProps}\n    />\n  );\n};\n\nexport default LayerTree;\n","import React, {\n  useState,\n  useMemo,\n  FC,\n  JSX\n} from 'react';\n\nimport {\n  faDrawPolygon,\n  faPenRuler\n} from '@fortawesome/free-solid-svg-icons';\n\nimport {\n  FontAwesomeIcon\n} from '@fortawesome/react-fontawesome';\n\nimport _get from 'lodash/get';\nimport _isEmpty from 'lodash/isEmpty';\nimport _isNil from 'lodash/isNil';\nimport proj4 from 'proj4';\nimport {\n  useTranslation\n} from 'react-i18next';\n\nimport { MeasureButton } from '@terrestris/react-geo/dist/Button/MeasureButton/MeasureButton';\nimport { ToggleGroup } from '@terrestris/react-geo/dist/Button/ToggleGroup/ToggleGroup';\nimport {\n  useMap\n} from '@terrestris/react-util/dist/Hooks/useMap/useMap';\n\nimport './index.less';\n\ninterface DefaultMeasureProps {\n  showMeasureDistance?: boolean;\n  showMeasureArea?: boolean;\n}\n\nexport type MeasureProps = Partial<DefaultMeasureProps>;\n\nexport const Measure: FC<MeasureProps> = ({\n  showMeasureDistance,\n  showMeasureArea\n}): JSX.Element => {\n  const {\n    t\n  } = useTranslation();\n\n  const map = useMap();\n\n  const isGeodesicMeasurement = useMemo(() => {\n    if (_isNil(map)) {\n      return true;\n    }\n\n    const proj = proj4.Proj(map.getView().getProjection().getCode());\n    const projName = _get(proj, 'projName');\n    return _isEmpty(projName) || projName === 'longlat' || projName === 'geocent';\n  }, [map]);\n\n  const [selected, setSelected] = useState<string>();\n\n  if (!map) {\n    return <></>;\n  }\n\n  return (\n    <ToggleGroup\n      className=\"measure-tools\"\n      selected={selected}\n      onChange={(evt, value) => {\n        setSelected(value);\n      }}\n    >\n      {showMeasureDistance ? (\n        <MeasureButton\n          geodesic={isGeodesicMeasurement}\n          value=\"line\"\n          measureType=\"line\"\n          type=\"link\"\n          continueLineMsg={t('Measure.clicktodrawline')}\n        >\n          <FontAwesomeIcon icon={faPenRuler} />\n          <span className=\"measure-text\">{t('Measure.line')}</span>\n        </MeasureButton>\n      ) : (\n        <></>\n      )}\n\n      {showMeasureArea ? (\n        <MeasureButton\n          geodesic={isGeodesicMeasurement}\n          value=\"poly\"\n          measureType=\"polygon\"\n          type=\"link\"\n          continuePolygonMsg={t('Measure.clicktodrawarea')}\n        >\n          <FontAwesomeIcon icon={faDrawPolygon} />\n          <span className=\"measure-text\">{t('Measure.area')}</span>\n        </MeasureButton>\n      ) : (\n        <></>\n      )}\n    </ToggleGroup>\n  );\n};\n\nexport default Measure;\n","import React, {\n  useCallback,\n  useEffect,\n  useState,\n  JSX\n} from 'react';\n\nimport type {\n  IconDefinition\n} from '@fortawesome/fontawesome-common-types';\n\nimport {\n  faChevronLeft,\n  faChevronRight,\n  faPalette,\n  faFileDownload,\n  faLanguage,\n  faCircleInfo,\n  faPlus,\n  faRuler,\n  faShareNodes,\n  faStream,\n  faUpload\n} from '@fortawesome/free-solid-svg-icons';\n\nimport {\n  FontAwesomeIcon\n} from '@fortawesome/react-fontawesome';\n\nimport {\n  Button,\n  Collapse,\n  CollapsePanelProps,\n  Tooltip\n} from 'antd';\n\nimport ClientConfiguration from 'clientConfig';\n\nimport _toArray from 'lodash/toArray';\n\nimport {\n  ItemType\n} from 'rc-collapse/lib/interface';\n\nimport {\n  useTranslation\n} from 'react-i18next';\n\nimport {\n  useMap\n} from '@terrestris/react-util/dist/Hooks/useMap/useMap';\n\nimport useAppDispatch from '../../hooks/useAppDispatch';\nimport useAppSelector from '../../hooks/useAppSelector';\nimport usePlugins from '../../hooks/usePlugins';\nimport useSHOGunAPIClient from '../../hooks/useSHOGunAPIClient';\n\nimport {\n  isToolMenuIntegration\n} from '../../plugin';\n\nimport {\n  show as showAdd\n} from '../../store/addLayerModal';\nimport {\n  setFeatureInfoEnabled\n} from '../../store/featureInfo';\nimport {\n  UploadTools,\n  setLayerTreeEnabled\n} from '../../store/layerTree';\nimport {\n  setActiveKeys,\n  setToolMenuWidth\n} from '../../store/toolMenu';\nimport {\n  show as showUpload\n} from '../../store/uploadDataModal';\n\nimport LanguageSelect from '../LanguageSelector';\nimport Permalink from '../Permalink';\nimport PrintForm from '../PrintForm';\n\nimport Draw from './Draw';\nimport FeatureInfo from './FeatureInfo';\nimport LayerTree from './LayerTree';\n\nimport Measure from './Measure';\n\nimport './index.less';\n\nexport interface TitleEventEntity {\n  key: string;\n  domEvent: React.MouseEvent<HTMLElement> | React.KeyboardEvent<HTMLElement>;\n}\n\nexport type ToolPanelConfig = {\n  icon: IconDefinition;\n  title: string;\n  wrappedComponent: JSX.Element;\n};\n\nexport type ToolMenuProps = Partial<CollapsePanelProps> & {\n  collapseWidth?: number;\n  minWidth?: number;\n  maxWidth?: number;\n};\n\nexport const ToolMenu: React.FC<ToolMenuProps> = ({\n  collapseWidth = 40,\n  minWidth = 240,\n  maxWidth = 600,\n  ...restProps\n}): JSX.Element => {\n  const {\n    t\n  } = useTranslation();\n  const map = useMap();\n\n  const plugins = usePlugins();\n\n  const dispatch = useAppDispatch();\n  const availableTools = useAppSelector(state => state.toolMenu.availableTools);\n  const activeKeys = useAppSelector(state => state.toolMenu.activeKeys);\n  const maxHeight = useAppSelector(state => state.toolMenu.maxHeight);\n  const width = useAppSelector(state => state.toolMenu.width);\n\n  const client = useSHOGunAPIClient();\n  const keycloak = client?.getKeycloak();\n\n  const [collapsed, setCollapsed] = useState<boolean>(false);\n  const [menuTools, setMenuTools] = useState<string[]>([]);\n  const [isResizing, setIsResizing] = useState(false);\n  const [noCollapseWidth, setNoCollapseWidth] = useState(width);\n\n  useEffect(() => {\n    const mobileQuery = window.matchMedia('only screen and (max-width: 450px) and (orientation: portrait),' +\n      'only screen and (max-width: 750px) and (orientation: landscape), only screen and (max-width: 580px)');\n    const mobileNavigatorRegEx = new RegExp('/Mobile|iP(hone|od|ad)|Android|BlackBerry|IEMobile|Kindle' +\n      '|NetFront|Silk-Accelerated|(hpw|web)OS|Fennec|Minimo|Opera M(obi|ini)|Blazer|Dolfin|Dolphin|Skyfire|Zune/');\n    const isMobile = mobileQuery.matches || mobileNavigatorRegEx.test(window.navigator.userAgent);\n\n    if (isMobile) {\n      setCollapsed(true);\n      dispatch(setToolMenuWidth(collapseWidth));\n    }\n  }, [collapseWidth, dispatch]);\n\n  useEffect(() => {\n    if (menuTools.length < 1) {\n      if (availableTools.includes('default')) {\n        setMenuTools([\n          'measure_tools',\n          'draw_tools',\n          'feature_info',\n          'print',\n          'tree',\n          'permalink',\n          'language_selector'\n        ]);\n      } else {\n        setMenuTools(availableTools);\n      }\n    }\n  }, [menuTools, availableTools]);\n\n  useEffect(() => {\n    const exclusiveTools = [\n      'print',\n      'measure_tools',\n      'draw_tools',\n      'feature_info',\n      'tree'\n    ];\n\n    const activeExclusiveTools = exclusiveTools.filter(tool => activeKeys.includes(tool));\n\n    if (activeExclusiveTools.length > 1) {\n      const lastExclusiveTool = activeKeys\n        .slice(0, activeKeys.length - 1)\n        .reverse()\n        .find(tool => exclusiveTools.includes(tool));\n\n      if (lastExclusiveTool) {\n        dispatch(\n          setActiveKeys(activeKeys.filter(keys => keys !== lastExclusiveTool))\n        );\n      }\n    }\n\n    dispatch(setFeatureInfoEnabled(activeKeys.includes('feature_info')));\n    dispatch(setLayerTreeEnabled(activeKeys.includes('tree')));\n\n  }, [activeKeys, dispatch]);\n\n  const getToolPanels = (): ItemType[] => {\n    const panels: ItemType[] = [];\n\n    menuTools.forEach((tool: string) => {\n      const toolPanelConfig = getToolPanelConfig(tool);\n\n      if (!toolPanelConfig) {\n        return;\n      }\n\n      const {\n        icon,\n        title,\n        wrappedComponent\n      } = toolPanelConfig;\n\n      panels.push({\n        key: tool,\n        label: (\n          <>\n            {icon ? <FontAwesomeIcon icon={icon} /> : undefined}\n            <span>{title}</span>\n          </>\n        ),\n        children: wrappedComponent\n      });\n    });\n\n    if (plugins) {\n      plugins.forEach(plugin => {\n        if (isToolMenuIntegration(plugin.integration)) {\n          const {\n            key,\n            wrappedComponent: WrappedPluginComponent,\n            integration: {\n              label = 'Plugin',\n              insertionIndex,\n              icon,\n              ...passThroughProps\n            }\n          } = plugin;\n\n          const newItem: ItemType = {\n            key,\n            label: (\n              <>\n                {icon ? <FontAwesomeIcon icon={icon} /> : undefined}\n                <span>{t(label)}</span>\n              </>\n            ),\n            ...passThroughProps,\n            children: <WrappedPluginComponent />\n          };\n\n          panels.splice(insertionIndex ?? 0, 0, newItem);\n        }\n      });\n    }\n    return panels;\n  };\n\n  const activeUploadTools = useAppSelector(state => state.layerTree.activeUploadTools);\n\n  const getToolPanelConfig = (tool: string): ToolPanelConfig | undefined => {\n    switch (tool) {\n      case 'measure_tools':\n        return {\n          icon: faRuler,\n          title: t('ToolMenu.measure'),\n          wrappedComponent: (\n            <Measure\n              showMeasureDistance={\n                availableTools.includes('default') || availableTools.includes('measure_tools_distance')\n              }\n              showMeasureArea={availableTools.includes('default') || availableTools.includes('measure_tools_area')}\n            />\n          )\n        };\n      case 'draw_tools':\n        return {\n          icon: faPalette,\n          title: t('ToolMenu.draw'),\n          wrappedComponent: (\n            <Draw\n              showDrawPoint={availableTools.includes('default') || availableTools.includes('draw_tools_point')}\n              showDrawLine={availableTools.includes('default') || availableTools.includes('draw_tools_line')}\n              showDrawPolygon={availableTools.includes('default') || availableTools.includes('draw_tools_polygon')}\n              showDrawCircle={availableTools.includes('default') || availableTools.includes('draw_tools_circle')}\n              showDrawRectangle={availableTools.includes('default') || availableTools.includes('draw_tools_rectangle')}\n              showDrawAnnotation={\n                availableTools.includes('default') || availableTools.includes('draw_tools_annotation')\n              }\n              showModifyFeatures={availableTools.includes('default') || availableTools.includes('draw_tools_modify')}\n              showUploadFeatures={availableTools.includes('default') || availableTools.includes('draw_tools_upload')}\n              showDownloadFeatures={\n                availableTools.includes('default') || availableTools.includes('draw_tools_download')\n              }\n              showDeleteFeatures={availableTools.includes('default') || availableTools.includes('draw_tools_delete')}\n              showStyleFeatures={availableTools.includes('default') || availableTools.includes('draw_tools_style')}\n            />\n          )\n        };\n      case 'feature_info':\n        return {\n          icon: faCircleInfo,\n          title: t('ToolMenu.featureInfo'),\n          wrappedComponent: (\n            <FeatureInfo />\n          )\n        };\n      case 'print':\n        return {\n          icon: faFileDownload,\n          title: t('ToolMenu.print'),\n          wrappedComponent: map ? (\n            <PrintForm\n              active={activeKeys.includes('print')}\n              layerBlackList={[\n                'react-geo_measure',\n                'hoverVectorLayer'\n              ]}\n            />\n          ) : <></>\n        };\n      case 'tree':\n        return {\n          icon: faStream,\n          title: t('ToolMenu.layertree'),\n          wrappedComponent: (\n            <div className='tree-wrapper'>\n              <LayerTree />\n              {activeUploadTools?.includes(UploadTools.addWMS) && (\n                <Button\n                  className='add-wms-button tool-menu-button'\n                  icon={<FontAwesomeIcon icon={faPlus} />}\n                  onClick={() => dispatch(showAdd())}\n                >\n                  {t('ToolMenu.addWms')}\n                </Button>\n              )\n              }\n              {\n                keycloak && ClientConfiguration.geoserver?.upload?.authorizedRoles?.some(\n                  role => keycloak.hasResourceRole(role, keycloak.clientId)) &&\n                activeUploadTools?.includes(UploadTools.dataUpload) && (\n                  <Button\n                    className='upload-data-button tool-menu-button'\n                    icon={<FontAwesomeIcon icon={faUpload} />}\n                    onClick={() => dispatch(showUpload())}\n                  >\n                    {t('ToolMenu.uploadData')}\n                  </Button>\n                )\n              }\n            </div>\n          )\n        };\n      case 'permalink':\n        return {\n          icon: faShareNodes,\n          title: t('Permalink.title'),\n          wrappedComponent: <Permalink />\n        };\n      case 'language_selector':\n        return {\n          icon: faLanguage,\n          title: t('ToolMenu.languageSelect'),\n          wrappedComponent: <LanguageSelect />\n        };\n      default:\n        break;\n    }\n  };\n\n  const onMouseDown = useCallback(() => {\n    setIsResizing(true);\n  }, []);\n\n  const onMouseUp = useCallback(() => {\n    setIsResizing(false);\n  }, []);\n\n  const onMouseMove = useCallback((e: MouseEvent) => {\n    if (isResizing && !collapsed) {\n      const offsetLeft = (e.clientX - document.body.offsetLeft);\n      if (offsetLeft > minWidth && offsetLeft < maxWidth) {\n        dispatch(setToolMenuWidth(offsetLeft));\n        setNoCollapseWidth(offsetLeft);\n      }\n    }\n  }, [isResizing, collapsed, minWidth, maxWidth, dispatch]);\n\n  useEffect(() => {\n    document.addEventListener('mousemove', onMouseMove);\n    document.addEventListener('mouseup', onMouseUp);\n\n    return () => {\n      document.removeEventListener('mousemove', onMouseMove);\n      document.removeEventListener('mouseup', onMouseUp);\n    };\n  }, [onMouseMove, onMouseUp]);\n\n  return (\n    <div\n      aria-label=\"tool-menu\"\n      className={`tool-menu ${collapsed ? 'collapsed' : ''}`}\n      style={{\n        width,\n        maxHeight: maxHeight ?? '100%'\n      }}\n    >\n      <Collapse\n        expandIconPosition='end'\n        activeKey={activeKeys}\n        destroyOnHidden={true}\n        onChange={(keys: string[] | string) => {\n          setCollapsed(false);\n          dispatch(setActiveKeys(_toArray(keys)));\n          if (collapsed) {\n            dispatch(setToolMenuWidth(noCollapseWidth));\n          }\n        }}\n        items={getToolPanels()}\n        {...restProps}\n      />\n      <Tooltip\n        placement={'right'}\n        title={collapsed ? t('ToolMenu.expand') : t('ToolMenu.collapse')}\n      >\n        <Button\n          className=\"collapse-btn\"\n          aria-label=\"collapse-button\"\n          icon={\n            collapsed ?\n              <FontAwesomeIcon icon={faChevronRight} /> :\n              <FontAwesomeIcon icon={faChevronLeft} />\n          }\n          onClick={() => {\n            dispatch(setActiveKeys([]));\n            setCollapsed(!collapsed);\n            if (collapsed) {\n              dispatch(setToolMenuWidth(noCollapseWidth));\n            } else {\n              dispatch(setToolMenuWidth(collapseWidth));\n            }\n          }}\n        />\n      </Tooltip>\n      {!collapsed ? (\n        <div\n          className=\"dynamicWidth\"\n          role=\"button\"\n          tabIndex={0}\n          onMouseDown={onMouseDown}\n          onKeyDown={e => {\n            if (e.key === 'Enter' || e.key === ' ') {\n              e.preventDefault();\n              onMouseDown();\n            }\n          }}\n        />\n      ) : <></>}\n    </div>\n  );\n};\n\nexport default ToolMenu;\n","import React, {\n  useState\n} from 'react';\n\nimport {\n  faUpload\n} from '@fortawesome/free-solid-svg-icons';\nimport {\n  FontAwesomeIcon\n} from '@fortawesome/react-fontawesome';\n\nimport {\n  Alert,\n  Modal,\n  ModalProps,\n  Spin,\n  Upload\n} from 'antd';\n\nconst { Dragger } = Upload;\n\nimport {\n  RcFile,\n  UploadChangeParam,\n  UploadFile\n} from 'antd/lib/upload/interface';\n\nimport ClientConfiguration from 'clientConfig';\n\nimport OlLayerGroup from 'ol/layer/Group';\nimport TileLayer from 'ol/layer/Tile';\nimport TileWMS from 'ol/source/TileWMS';\n\nimport {\n  UploadRequestOption\n} from 'rc-upload/lib/interface';\n\nimport {\n  useTranslation\n} from 'react-i18next';\n\nimport {\n  Shapefile\n} from 'shapefile.js';\n\nimport Logger from '@terrestris/base-util/dist/Logger';\n\nimport { MapUtil } from '@terrestris/ol-util/dist/MapUtil/MapUtil';\n\nimport {\n  useMap\n} from '@terrestris/react-util/dist/Hooks/useMap/useMap';\n\nimport Layer from '@terrestris/shogun-util/dist/model/Layer';\nimport SHOGunApplicationUtil from '@terrestris/shogun-util/dist/parser/SHOGunApplicationUtil';\nimport {\n  getBearerTokenHeader\n} from '@terrestris/shogun-util/dist/security/getBearerTokenHeader';\n\nimport useAppDispatch from '../../hooks/useAppDispatch';\nimport useAppSelector from '../../hooks/useAppSelector';\nimport useSHOGunAPIClient from '../../hooks/useSHOGunAPIClient';\nimport {\n  hide\n} from '../../store/uploadDataModal';\n\nimport './index.less';\n\ntype FeatureTypeAttribute = {\n  name: string;\n  minOccurs: number;\n  maxOccurs: number;\n  nillable: boolean;\n  binding?: string | null;\n  length?: number;\n};\n\ntype FeatureTypeAttributes = {\n  attribute: FeatureTypeAttribute[];\n};\n\nexport type LayerUploadOptions = {\n  baseUrl: string;\n  workspace: string;\n  storeName: string;\n  layerName: string;\n  file: RcFile;\n};\n\nexport type LayerUploadResponse = {\n  layerName: string;\n  workspace: string;\n  baseUrl: string;\n};\n\nexport type UploadDataModalProps = Partial<ModalProps>;\n\nexport const UploadDataModal: React.FC<UploadDataModalProps> = ({\n  ...restProps\n}): JSX.Element => {\n  const [uploadError, setUploadError] = useState('');\n  const [uploadSuccess, setUploadSuccess] = useState('');\n  const [isUploading, setIsUploading] = useState(false);\n\n  const isModalVisible = useAppSelector(state => state.uploadDataModal.visible);\n  const user = useAppSelector((state) => state.user);\n\n  const dispatch = useAppDispatch();\n\n  const map = useMap();\n  const client = useSHOGunAPIClient();\n\n  const {\n    t\n  } = useTranslation();\n\n  const closeModal = () => {\n    setUploadError('');\n    setUploadSuccess('');\n    dispatch(hide());\n  };\n\n  const addLayer = (layer: TileLayer<TileWMS>) => {\n    if (!map) {\n      return;\n    }\n\n    const targetFolderName = t('UploadDataModal.uploadedDataFolder');\n    let targetGroup = MapUtil.getLayerByName(map, targetFolderName) as OlLayerGroup;\n\n    if (!targetGroup) {\n      targetGroup = new OlLayerGroup({\n        layers: [],\n        properties: {\n          name: targetFolderName\n        }\n      });\n      const existingGroups = map.getLayerGroup().getLayers();\n      existingGroups.insertAt(existingGroups?.getLength() || 0, targetGroup);\n    }\n\n    if (!targetGroup.getLayers().getArray().includes(layer)) {\n      targetGroup.getLayers().push(layer);\n    }\n  };\n\n  const onBeforeFileUpload = (file: RcFile) => {\n    const maxSize = ClientConfiguration.geoserver?.upload?.limit ?? 200000000;\n    const fileType = file.type;\n    const fileSize = file.size;\n\n    setUploadError('');\n    setUploadSuccess('');\n\n    if (fileSize > maxSize) {\n      setUploadError(t('UploadDataModal.error.maxSize', {\n        maxSize: maxSize / 1000000\n      }));\n\n      return false;\n    }\n\n    const supportedFormats = ['application/zip', 'image/tiff'];\n    if (!supportedFormats.includes(fileType)) {\n      setUploadError(t('UploadDataModal.error.supportedFormats', {\n        supportedFormats: supportedFormats.join(', ')\n      }));\n\n      return false;\n    }\n\n    return true;\n  };\n\n  const uploadGeoTiff = async (options: LayerUploadOptions): Promise<void> => {\n    const {\n      baseUrl,\n      workspace,\n      storeName,\n      layerName,\n      file\n    } = options;\n\n    const coverageStoreUrl = `${baseUrl}/rest/workspaces/${workspace}/coveragestores/` +\n      `${storeName}/file.geotiff?configure=none`;\n\n    const coverageStoreResponse = await fetch(coverageStoreUrl, {\n      method: 'PUT',\n      headers: {\n        ...getBearerTokenHeader(client?.getKeycloak()),\n        'Content-Type': 'image/tiff'\n      },\n      body: file\n    });\n\n    if (!coverageStoreResponse.ok) {\n      throw new Error(t('UploadDataModal.error.general', {\n        fileName: file.name\n      }));\n    }\n\n    const coverageUrl = `${baseUrl}/rest/workspaces/${workspace}/coveragestores/${storeName}/coverages`;\n\n    const coverageResponse = await fetch(coverageUrl, {\n      method: 'POST',\n      headers: {\n        ...getBearerTokenHeader(client?.getKeycloak()),\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        coverage: {\n          enabled: true,\n          name: layerName,\n          nativeName: layerName,\n          title: layerName,\n          keywords: {\n            // eslint-disable-next-line quote-props\n            'string': [\n              'User upload',\n              `Uploaded by ${user.providerDetails?.username}`\n            ]\n          }\n        }\n      })\n    });\n\n    if (!coverageResponse.ok) {\n      throw new Error(t('UploadDataModal.error.general', {\n        fileName: file.name\n      }));\n    }\n  };\n\n  const uploadShapeZip = async (options: LayerUploadOptions): Promise<void> => {\n    const {\n      baseUrl,\n      workspace,\n      storeName,\n      layerName,\n      file\n    } = options;\n\n    const shp = await Shapefile.load(file);\n\n    let featureTypeName = '';\n    const featureTypeAttributes: FeatureTypeAttributes = {\n      attribute: []\n    };\n\n    if (Object.entries(shp).length !== 1) {\n      throw new Error(t('UploadDataModal.error.zipContent'));\n    }\n\n    Object.entries(shp).forEach(([k, v]) => {\n      featureTypeName = k;\n\n      const dbfContent = v.parse('dbf', {\n        properties: false\n      });\n\n      featureTypeAttributes.attribute = dbfContent.fields.map(field => ({\n        name: field.name,\n        minOccurs: 0,\n        maxOccurs: 1,\n        nillable: true,\n        binding: getAttributeType(field.type),\n        length: field.length\n      }));\n\n      const shxContent = v.parse('shx');\n\n      featureTypeAttributes.attribute.push({\n        name: 'the_geom',\n        minOccurs: 0,\n        maxOccurs: 1,\n        nillable: true,\n        binding: getGeometryType(shxContent.header.type)\n      });\n    });\n\n    const url = `${baseUrl}/rest/workspaces/${workspace}/datastores/` +\n      `${storeName}/file.shp?configure=none`;\n\n    const response = await fetch(url, {\n      method: 'PUT',\n      headers: {\n        ...getBearerTokenHeader(client?.getKeycloak()),\n        'Content-Type': 'application/zip'\n      },\n      body: file\n    });\n\n    if (!response.ok) {\n      throw new Error(t('UploadDataModal.error.general', {\n        fileName: file.name\n      }));\n    }\n\n    const featureTypeUrl = `${baseUrl}/rest/workspaces/${workspace}/datastores/${storeName}/featuretypes`;\n\n    const featureTypeResponse = await fetch(featureTypeUrl, {\n      method: 'POST',\n      headers: {\n        ...getBearerTokenHeader(client?.getKeycloak()),\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        featureType: {\n          enabled: true,\n          name: layerName,\n          nativeName: featureTypeName,\n          title: layerName,\n          attributes: featureTypeAttributes,\n          keywords: {\n            // eslint-disable-next-line quote-props\n            'string': [\n              'User upload',\n              `Uploaded by ${user.providerDetails?.username}`\n            ]\n          }\n        }\n      })\n    });\n\n    if (!featureTypeResponse.ok) {\n      throw new Error(t('UploadDataModal.error.general', {\n        fileName: file.name\n      }));\n    }\n  };\n\n  const onFileUploadAction = async (options: UploadRequestOption<LayerUploadResponse>) => {\n    const {\n      onError,\n      onSuccess,\n      file\n    } = options;\n\n    const splittedFileName = (file as RcFile).name.split('.');\n    const fileType = (file as RcFile).type;\n    const geoServerBaseUrl = ClientConfiguration.geoserver?.base ?? '/geoserver';\n    const workspace = ClientConfiguration.geoserver?.upload?.workspace ?? 'SHOGUN';\n    const layerName = `${splittedFileName[0]}_${Date.now()}`.toUpperCase();\n\n    const uploadData = {\n      file: file as RcFile,\n      baseUrl: geoServerBaseUrl,\n      workspace: workspace,\n      storeName: layerName,\n      layerName: layerName\n    };\n\n    try {\n      if (fileType === 'image/tiff') {\n        await uploadGeoTiff(uploadData);\n      }\n\n      if (fileType === 'application/zip') {\n        await uploadShapeZip(uploadData);\n      }\n\n      if (onSuccess) {\n        onSuccess({\n          baseUrl: geoServerBaseUrl,\n          workspace: workspace,\n          layerName: layerName\n        });\n      }\n    } catch (error) {\n      if (onError) {\n        onError({\n          name: 'UploadError',\n          message: (error instanceof Error) ? error.message : t('UploadDataModal.error.general', {\n            fileName: (file as RcFile).name\n          })\n        });\n      }\n    }\n  };\n\n  const onFileUploadChange = async (info: UploadChangeParam<UploadFile<LayerUploadResponse>>) => {\n    const file = info.file;\n\n    if (file.status === 'uploading') {\n      setIsUploading(true);\n    }\n\n    if (file.status === 'done') {\n      if (!client || !file.response) {\n        return;\n      }\n\n      const layerConfig: Layer = {\n        name: file.response.layerName,\n        type: 'TILEWMS',\n        clientConfig: {\n          hoverable: true\n        },\n        sourceConfig: {\n          url: `${file.response.baseUrl}/ows?`,\n          layerNames: `${file.response.workspace}:${file.response.layerName}`,\n          useBearerToken: true\n        }\n      };\n\n      const parser = new SHOGunApplicationUtil({\n        client\n      });\n\n      const olLayer = parser.parseTileLayer(layerConfig);\n      olLayer.set('layerConfig', layerConfig);\n      olLayer.set('isUploadedLayer', true);\n      olLayer.set('groupName', t('UploadDataModal.uploadedDataFolder'));\n      addLayer(olLayer);\n\n      setUploadSuccess(t('UploadDataModal.success', {\n        fileName: file.name,\n        layerName: file.response.layerName\n      }));\n\n      setIsUploading(false);\n    } else if (file.status === 'error') {\n      setIsUploading(false);\n\n      Logger.error(file.error);\n\n      if (file.error && file.error.message) {\n        setUploadError(file.error.message);\n      } else {\n        setUploadError(t('UploadDataModal.error.general', {\n          fileName: file.name\n        }));\n      }\n    }\n  };\n\n  const getGeometryType = (type: number) => {\n    const types: Record<number, string | null> = {\n      0: null, // Null\n      1: 'org.locationtech.jts.geom.Point', // Point\n      3: 'org.locationtech.jts.geom.LineString', // Polyline\n      5: 'org.locationtech.jts.geom.Polygon', // Polygon\n      8: 'org.locationtech.jts.geom.MultiPoint', // MultiPoint\n      11: 'org.locationtech.jts.geom.Point', // PointZ\n      13: 'org.locationtech.jts.geom.LineString', // PolylineZ\n      15: 'org.locationtech.jts.geom.Polygon', // PolygonZ\n      18: 'org.locationtech.jts.geom.MultiPoint', // MultiPointZ\n      21: 'org.locationtech.jts.geom.Point', // PointM\n      23: 'org.locationtech.jts.geom.LineString', // PolylineM\n      25: 'org.locationtech.jts.geom.Polygon', // PolygonM\n      28: 'org.locationtech.jts.geom.MultiPoint', // MultiPointM\n      31: null // MultiPatch\n    };\n\n    return types[type];\n  };\n\n  const getAttributeType = (dbfFieldType: string) => {\n    switch (dbfFieldType) {\n      case 'C': // Character\n        return 'java.lang.String';\n      case 'D': // Date\n        return 'java.util.Date';\n      case 'N': // Numeric\n        return 'java.lang.Long';\n      case 'F': // Floating point\n        return 'java.lang.Double';\n      case 'L': // Logical\n        return 'java.lang.Boolean';\n      case 'M': // Memo\n        return null;\n      default:\n        return null;\n    }\n  };\n\n  return (\n    <Modal\n      className=\"upload-data-modal\"\n      title={t('UploadDataModal.title')}\n      open={isModalVisible}\n      onCancel={closeModal}\n      width={600}\n      footer={false}\n      {...restProps}\n    >\n      {\n        uploadSuccess && (\n          <Alert\n            message={uploadSuccess}\n            closable={true}\n            type=\"success\"\n          />\n        )\n      }\n\n      {\n        uploadError && (\n          <Alert\n            message={uploadError}\n            closable={true}\n            type=\"error\"\n          />\n        )\n      }\n\n      <Spin\n        spinning={isUploading}\n      >\n        <Dragger\n          customRequest={onFileUploadAction}\n          accept='image/tiff,application/zip'\n          maxCount={1}\n          showUploadList={false}\n          beforeUpload={onBeforeFileUpload}\n          onChange={onFileUploadChange}\n        >\n          <p className=\"ant-upload-drag-icon\">\n            <FontAwesomeIcon\n              icon={faUpload}\n            />\n          </p>\n          <p className=\"ant-upload-text\">\n            {t('UploadDataModal.description')}\n          </p>\n          <p className=\"ant-upload-hint\">\n            {t('UploadDataModal.hint')}\n          </p>\n        </Dragger>\n      </Spin>\n    </Modal>\n  );\n};\n\nexport default UploadDataModal;\n","import React, {\n  useEffect\n} from 'react';\n\nimport AddLayerModal from './components/AddLayerModal/index';\nimport BasicMapComponent from './components/BasicMapComponent';\nimport CookieBanner from './components/CookieBanner';\nimport EditFeatureDrawer from './components/EditFeatureDrawer';\nimport Footer from './components/Footer';\nimport Header from './components/Header';\nimport LayerDetailsModal from './components/LayerDetailsModal';\nimport MapToolbar from './components/MapToolbar';\nimport SearchResultDrawer from './components/SearchResultDrawer';\nimport StylingDrawer from './components/StylingDrawer';\nimport ToolMenu from './components/ToolMenu';\nimport UploadDataModal from './components/UploadDataModal';\n\nimport useRestoreTransientLayers from './hooks/useRestoreTransientLayers';\n\nimport './App.less';\n\nexport type AppProps = React.ComponentProps<'div'>;\n\nexport const App: React.FC<AppProps> = ({\n  ...restProps\n}): JSX.Element => {\n\n  useRestoreTransientLayers();\n\n  useEffect(() => {\n    const loadingMask = document.querySelectorAll('.loadmask')[0];\n\n    if (loadingMask) {\n      loadingMask.classList.add('loadmask-hidden');\n    }\n  }, []);\n\n  return (\n    <div\n      className=\"App\"\n      {...restProps}\n    >\n      <Header />\n      <BasicMapComponent />\n      <ToolMenu />\n      <MapToolbar />\n      <Footer />\n      <CookieBanner />\n      <AddLayerModal />\n      <UploadDataModal />\n      <EditFeatureDrawer />\n      <LayerDetailsModal />\n      <StylingDrawer />\n      <SearchResultDrawer />\n    </div>\n  );\n};\n\nexport default App;\n","import _isEmpty from 'lodash/isEmpty';\n\nimport BaseLayer from 'ol/layer/Base';\nimport OlLayerGroup from 'ol/layer/Group';\n\nimport OlLayerImage from 'ol/layer/Image';\nimport OlLayerTile from 'ol/layer/Tile';\n\nimport {\n  useTranslation\n} from 'react-i18next';\n\nimport Logger from '@terrestris/base-util/dist/Logger';\n\nimport { MapUtil } from '@terrestris/ol-util/dist/MapUtil/MapUtil';\nimport { PermalinkUtil } from '@terrestris/ol-util/dist/PermalinkUtil/PermalinkUtil';\n\nimport {\n  useMap\n} from '@terrestris/react-util/dist/Hooks/useMap/useMap';\n\nimport Layer from '@terrestris/shogun-util/dist/model/Layer';\nimport SHOGunApplicationUtil from '@terrestris/shogun-util/dist/parser/SHOGunApplicationUtil';\n\nimport useQueryParams from './useQueryParams';\nimport useSHOGunAPIClient from './useSHOGunAPIClient';\n\nexport const useRestoreTransientLayers = async () => {\n  // eslint-disable-next-line react-hooks/rules-of-hooks\n  const map = useMap();\n  // eslint-disable-next-line react-hooks/rules-of-hooks\n  const client = useSHOGunAPIClient();\n  // eslint-disable-next-line react-hooks/rules-of-hooks\n  const queryParams = useQueryParams();\n  const {\n    t\n  // eslint-disable-next-line react-hooks/rules-of-hooks\n  } = useTranslation();\n\n  const layers = queryParams.get('layers');\n\n  if (!map) {\n    return;\n  }\n\n  const identifier = (l: BaseLayer) => l.get('name');\n  const filter = (l: BaseLayer) => (l instanceof OlLayerTile || l instanceof OlLayerImage);\n  const configString = PermalinkUtil.applyLink(map, ';', identifier, filter);\n\n  if (!configString) {\n    return;\n  }\n\n  const addLayerGroup = (name: string) => {\n    const layerGroup = new OlLayerGroup({\n      layers: []\n    });\n    layerGroup.set('name', name);\n    const existingGroups = map.getLayerGroup().getLayers();\n    existingGroups.insertAt(existingGroups?.getLength() || 0, layerGroup);\n\n    return layerGroup;\n  };\n\n  try {\n    const config = JSON.parse(configString);\n\n    if (!client) {\n      throw new Error('Client is not available');\n    }\n\n    const parser = new SHOGunApplicationUtil({\n      client\n    });\n\n    for (const cfg of config) {\n      if (!_isEmpty(cfg?.layerConfig)) {\n        const layerConfig: Layer = cfg.layerConfig;\n        const olLayer = await parser.parseLayer(layerConfig);\n\n        if (!olLayer) {\n          continue;\n        }\n\n        if (cfg.isExternalLayer) {\n          olLayer.set('isExternalLayer', cfg.isExternalLayer);\n        }\n\n        if (cfg.isUploadedLayer) {\n          olLayer.set('isUploadedLayer', cfg.isUploadedLayer);\n        }\n\n        olLayer.set('groupName', cfg.groupName);\n        olLayer.set('layerConfig', cfg.layerConfig);\n\n        olLayer.setVisible(!!layers?.split(';').some(l => l === layerConfig.name));\n\n        if (!(olLayer.get('isExternalLayer') || olLayer.get('isUploadedLayer'))) {\n          continue;\n        }\n\n        let targetGroup: OlLayerGroup;\n\n        if (olLayer.get('groupName')) {\n          // handle custom layer group\n          targetGroup = MapUtil.getLayerByName(map, olLayer.get('groupName')) as OlLayerGroup;\n\n          if (!targetGroup) {\n            targetGroup = addLayerGroup(olLayer.get('groupName'));\n          }\n        } else {\n          // handle default layer group for external layers (external and uploaded layers)\n          targetGroup = MapUtil.getLayersByProperty(map, 'isExternalLayerGroup', true)?.[0] as OlLayerGroup;\n          if (!targetGroup) {\n            targetGroup = addLayerGroup(t('AddLayerModal.externalWmsFolder'));\n            targetGroup.set('isExternalLayerGroup', true);\n          }\n        }\n\n        if (!MapUtil.getLayerByName(map, olLayer.get('name'))) {\n          targetGroup.getLayers().push(olLayer);\n        }\n      }\n    }\n  } catch (error) {\n    Logger.error(error);\n  }\n};\n\nexport default useRestoreTransientLayers;\n","import React from 'react';\n\nexport default function useQueryParams() {\n  const {\n    search\n  } = window.location;\n  return React.useMemo(() => new URLSearchParams(search), [search]);\n}\n"],"names":["useDispatch","useAppSelector","useSelector","ref","restProps","_useState","loading","setLoading","_useState1","layers","setLayers","_useState2","selectedRowKeys","setSelectedRowKeys","_useState3","validationStatus","setValidationStatus","_useState4","url","setUrl","_useState5","sanitizedUrl","setSanitizedUrl","_useState6","version","setVersion","isModalVisible","state","dispatch","useAppDispatch","map","useMap","t","useTranslation","useEffect","UrlUtil","closeModal","hide","addLayers","layersToAdd","targetFolderName","targetGroup","MapUtil","targetGroupAvailableInMap","OlLayerGroup","layerToAdd","ImageLayer","layerUrl","_layerToAdd_getSource1","TileLayer","_layerToAdd_getSource","_layerToAdd_getSource2","urls","undefined","layerConfig","existingGroups","Modal","SimpleButton","layer","getUid","Input","evt","value","capabilities","error","CapabilitiesUtil","notification","Logger","Select","Typography","Table","text","record","usePlugins","useContext","PluginContext","plugins","_useTranslation","i18n","blcVisible","allowEmptyBackground","targetGroups","oldName","changeEvent","OlObjectEvent","pluginComponents","plugin","pluginIntegration","key","WrappedPluginComponent","MapComponent","BackgroundLayerChooser","l","getPlugin","cookiePlugin","CookieConsent","client","useSHOGunAPIClient","useCallback","opts","_opts_layer","source","defaultHeaders","response","responseText","OlSourceImageWMS","OlSourceTileWMS","fetch","getBearerTokenHeader","XMLSerializer","Error","xmlDoc","parser","DOMParser","errorTagNameCandidates","candidate","readOnly","fieldConfig","passThroughProps","Upload","getCsrfTokenHeader","file","_file_response","uuid","a","fileName","fileUrl","anchor","blob","objectUrl","_isNil","document","result","window","Button","Promise","onSuccess","onError","reader","FileReader","e","initialFileList","mediaPreviewVisible","setMediaPreviewVisible","previewImage","setPreviewImage","defaultFileListWithBlob","setDefaultFileListWithBlob","imageUrlToBase64","useConvertImageUrl","useAsyncEffect","fileList","val","_val_response","FontAwesomeIcon","faPlus","FeatureInfoForm","feature","formConfig","form","_useForm","Form","fieldCfg","_fieldCfg_displayName","_fieldCfg_displayName1","DisplayField","referenceConfig","isModalOpen","setIsModalOpen","selectedFeature","setSelectedFeature","resolvePlaceholder","regex","match","resolved","columns","onDetailsClick","faBoxOpen","OlFeature","getDataSource","parsedValue","JSON","Array","getModalTitle","placeholder","lowerCandidate","_uploadValue__response_fileType","dataType","valueMap","format","suffix","urlDisplayValue","displayValue","Checkbox","Number","Intl","dayjs","isDayjs","_isString","protocols","protocol","uploadValue","getUpload","v","isFileConfig","ImageUpload","FileUpload","isJson","ReferenceTable","parentForm","propertyName","tablePropertyName","onChange","_record_defaultPropertyName","b","valA","valB","_","faEdit","Popconfirm","onConfirmDelete","faTrash","parentFormValues","deleteCandidates","_cloneDeep","deleteIdx","deleteCandidate","valueCopy","Object","_v_key","cfg","_isFinite","parsedDate","isUpload","upload","_upload_response","el","formValues","existingReferences","targetIdx","existingReference","EditFeatureForm","_isObject","applyFormDirty","formDirty","_debounce","changedValues","setFormDirty","field","createFieldComponent","DatePicker","InputNumber","Switch","_fieldCfg_fieldProps","EditReferenceTable","referenceTableConfig","formItemProps","isGeometryType","propertyType","geometryTypes","cacheKey","_layer_getSource","typeName","describeFeatureTypeCache","cacheEntry","params","responseJson","sessionStorage","executeWfsDescribeFeatureType","useExecuteWfsDescribeFeatureType","allowedEditMode","cleanFormValues","stringify","_iteratorError","cleanedValue","isReadOnly","_cfg_children","child","_value__response_fileType","filePath","fileInfoList","_val_response1","_val_response2","_val_response3","_val_response4","_describeFeatureType_featureTypes__properties","_opts_upsertFeatures","_opts_layer_getSource","inserts","updates","deletes","describeFeatureType","geomProperty","overallUpdateMode","transactionOpts","transaction","_transaction_getRootNode","lockId","property","feat","geometry","_feature_getGeometry","isEmpty","geomPropName","updateMode","OlFormatWFS","ClientConfiguration","open","children","_document_querySelectorAll_","Drawer","getComputedStyle","featureRequest","OlFormatFilter","Element","getCssPropertyValue","fallback","drawerOpen","toolMenuElement","toolMenuWidth","headerHeight","footerHeight","drawerWidth","alignment","className","baseClassName","finalClassName","_editHistory_current_past","_editHistory_current_future","historyLength","editHistory","useRef","getFitPadding","useGetFitPadding","editLayer","setEditLayer","setRevision","selected","setSelected","gjFormat","useMemo","OlFormatGeoJson","DigitizeUtil","isModified","_editLayer_getSource","olFeat","r","isEmptyOlExtent","updateRevision","features","clone","btnTooltipProps","Toolbar","ToggleGroup","_evt","DrawButton","faPencil","existingFeature","e2","ModifyButton","faDrawPolygon","DeleteButton","faUndo","editSource","previousSource","_isEmpty","nextSource","tabConfig","initialValues","items","config","idx","Tabs","writeWfsTransaction","useWriteWfsTransaction","executeWfsTransaction","useExecuteWfsTransaction","olFeature","isWmsLayer","OlFormatGeoJSON","_editLayer_getSource1","faRotateLeft","loadComplete","saveCompleted","setSaveCompleted","error1","setTimeout","faFloppyDisk","FeedbackIcon","onSaveSuccess","onSaveError","onDeleteSuccess","onDeleteError","ResetButton","SaveButton","executeGetFeature","useExecuteGetFeature","setTabConfig","setInitialValues","errorMsg","setErrorMsg","reloadFeature","id","root","filter","resourceId","updatedFeatures","setFeature","update","editFormConfig","properties","structuredClone","tabConfigs","_tabConfigs__children","_tabConfigs__children1","_tabConfigs__children2","parsedJson","tabCfg","_tabCfg_children","formCfg","_fileList__response_fileType","isImageFile","thumbUrl","EditFeatureGeometryToolbar","Alert","EditFeatureToolbar","_featureId_item","idString","featId","collectedFieldErrors","errorFields","line","index","React","EditFeatureTabs","onFailure","onSingleClick","onPointerMove","onLockSuccess","onLockError","onCreate","executeWfsLockFeature","lockFeatureDoc","writeWfsLockFeature","featureId","featureProperties","parseInt","idProperty","queryElement","filterElement","isEqualToElement","valueReferenceElement","valueReferenceValue","literalElement","literalValue","transactionLockFailed","featureCollection","coords","viewResolution","data","Uint8ClampedArray","hit","geomType","setLayer","isFeatureLocked","setIsFeatureLocked","drawerTitle","setDrawerTitle","isDrawerOpen","layerId","olLayer","closeDrawer","hideEditFeatureDrawer","reset","MapDrawer","EditFeatureSwitch","EditFeatureFullForm","ApplicationInfo","Opener","opener","appInfo","logoPath","appDescription","isVisible","setIsVisible","toggleVisibility","Statistic","PROJECT_VERSION","legalInformation","insertPlugins","itemPosition","isFooterIntegration","_plugin_integration","_plugin_integration1","control","OlControlScaleLine","OlControlMousePosition","createStringXY","Divider","ScaleCombo","Tooltip","defaultClassName","faCircleQuestion","_ClientConfiguration_search","geocoderSearchEngine","dataSearchEngine","clickAwayRef","geoJSONFormat","GeoJSON","isGeocoderEnabled","setIsGeocoderEnabled","isDataSearchEnabled","setIsDataSearchEnabled","useViewBox","setUseViewBox","searchValue","setSearchValue","resultsVisible","setResultsVisible","settingsVisible","setSettingsVisible","_useState7","searchResults","setSearchResults","handleClickAway","target","settingsMenu","menu","performSearch","minChars","viewBox","_map_getView","mapViewProjection","extent","updatedResults","results","results1","resetSearch","transformExtent","allEmpty","timeout","delay","clearTimeout","actionsCreator","item","layerStyle","OlStyle","OlStyleStroke","OlStyleFill","OlStyleCircle","Space","event","SearchOutlined","LoadingOutlined","Dropdown","SettingOutlined","resultRenderer","numTotal","Empty","SearchResultsPanel","_item_feature_getGeometry","_item_feature","PermalinkUtil","_ClientConfiguration_search1","_featureObject_properties","_featureObject_properties1","featureObject","layerUndefined","setSearchResultState","replaceTemplates","getFeatureTitle","executeSolrQuery","applyAttributesToFeature","useNominatim","useSolr","useWfs","wfsSearchEngine","template","token","searchConfig","propValue","searchableLayers","promises","fulfilledResponses","wfsResults","_iteratorError1","searchableLayer","_searchableLayer_getSource_getParams","layerName","featureType","propertyNames","pattern","_searchConfig_resultDrawerConfig_children","ft","_layerName_split","attribute","attr","like","numValue","isNaN","equalTo","f","m","or","Set","settled","i","isFulfilled","p","isRejected","res","rejectedResponses","fulfilledResponse","solrSearchEngine","_opts_rowsPerQuery","_opts_queryParser","solrQueryConfig","_opts_coreName","_opts_tagPre","_opts_tagPost","_opts_requireFieldMatch","_data_token","dsResult","highlightResult","blacklistedAttributes","title","filteredHighlightKeys","highlightValue","propKey","_dsResult_propKey","solrBasePath","queriesPerLayer","queryPerLayer","_ClientConfiguration_search_solrQueryConfig","_ClientConfiguration_search_solrQueryConfig1","_ClientConfiguration_search4","_ClientConfiguration_search5","_ClientConfiguration_search_solrQueryConfig2","_ClientConfiguration_search_solrQueryConfig3","_ClientConfiguration_search_solrQueryConfig4","dataResults","hlResults","wktFormat","solrResults","categories","sarchableLayers","resultsWithLayerName","parts","searchQueries","s","_groupBy","_l_get","featureTypeQuery","featureTypeParts","layerNames","layerList","_l_getSource_getParams","query","subQueries","searchParts","part","sR","_sR_value_response","sr","_sr_value","OlFormatWKT","_res_category","_sarchableLayers_filter_find","layerTitle","_result_featureType","category","_dsResult_geometry","_dsResult_featureType","ftName","_dsResult_featureType1","nominatimSearchEngine","geoJsonFormat","nFeats","executeNominatimSearch","createNominatimSearchFunction","nResults","MultiSearch","getGeocoderSearchEngine","imageSrc","userMenu","userName","style","_className","getUserMenu","Avatar","_part_","lowerCaseEmail","hash","_user_providerDetails","_user_providerDetails1","_user_providerDetails2","_keycloak_tokenParsed_resource_access_account","username","divider","settings","logout","accountRoles","loginUrl","setLoginUrl","keycloak","user","faSignIn","UserChip","email","size","rating","defaultImage","force","md5","faAngleDown","faUserCog","faSignOut","hasUserManagementAccess","userMenuVisible","Link","isHeaderIntegration","SearchField","getDocsButton","DocumentationButton","_ClientConfiguration_keycloak","UserMenu","errorMessage","setErrorMessage","layerConfiguration","setLayerConfiguration","getLayerConfiguration","Spin","setCapabilities","getCapabilities","getLayerName","getCapabilitiesUrl","getCapabilitiesLayer","_capabilities_Capability_Layer","getBBox","lay","getMinScale","getMaxScale","getAbstract","getServiceAbstract","_capabilities_Service","getContact","_capabilities_Service_ContactInformation","getLayerTitle","getAccessConstraints","configurationVisible","setConfigurationVisible","OlLayer","FileTextOutlined","hideLayerDetailsModal","setDetailsLayer","LayerDetails","LayerConfiguration","geolocationButtonPressed","setGeolocationButtonPressed","mapToolbarVisible","stylingDrawerVisibility","editFeatureDrawerOpen","searchResultDrawerOpen","ZoomButton","faMinus","GeoLocationButton","faLocation","faLocationPin","AttributeValueCell","attributeName","resultDrawerConfig","normalized","_resultDrawerConfig_children","_fieldConfig_fieldProps","c","displayText","_targetLayer_get","isSearchResultDrawerVisible","geoJSONFeature","targetLayerId","GeoJSONParser","targetLayer","highlightLayer","useOlLayer","OlLayerVector","OlSourceVector","highlightFeature","keys","attributeFilter","attributeNames","_c_displayName","resolveTitle","configTitle","_feature_get","_feature_get1","PropertyGrid","gsLocale","_i18n_options","currentLocale","_get","GsLocale","defaultStyle","setStyle","olParser","OlStyleParser","drawVectorLayer","parseStyles","olStylePolygon","olStyleLineString","olStylePoint","olStyleText","rule","newStyle","olStyle","drawLayerStyleFunction","resolution","geometryType","logger","GeoStylerContext","CardStyle","isStylingDrawerVisible","setStylingDrawerVisibility","StylingComponent","Option","supportedLanguages","lang","supportedLanguage","layerAttributes","initialPermalink","permalink","setPermalink","mailBody","eventKeys","identifierFunction","filterFunction","updatePermalink","updateLayerConfig","externalLayers","externalLayer","registerLayerCallback","layerGroup","layersInGroup","layerInGroup","LayerGroup","eventKeyVisibility","eventKeyOpacity","listenerKeyCenter","listenerKeyResolution","unByKey","WhatsAppOutlined","whatsAppUrl","URL","MailOutlined","mailToUrl","CopyOutlined","copy","message","SHOGunMapFishPrintV3WMSSerializer","MapFishPrintV3WMSSerializer","serialized","optsToApply","MapFishPrintV3TiledWMSSerializer","maxLength","addCustomParam","printManager","onValueChange","layout","setLayout","prevLayoutRef","outputFormats","outputFormat","setOutputFormat","setResolution","d","scale","setScale","updateScale","pmScale","transformInteraction","MapFishPrintV3Manager","Shared","customParams","_source_getParams","LAYERS","VERSION","FORMAT","queryParams","encodeURIComponent","_printManager_getLayouts_","active","customPrintScales","layerBlackList","_Form_useForm","currentLanguageCode","customMapParams","printApp","setPrintManager","layerFilter","legendFilter","notBlacklisted","notHidden","visible","printableLayer","getPrintableLayers","printLayer","getAttributions","manager","extentLayer","allAttributions","_layer_getSource1","currentLayerAttribution","LayerUtil","initializePrintManager","_ClientConfiguration_print","_map_getView_getResolutions_map_filter","pManagerOpts","pManager","_pManager_getLayouts_","apps","_map_getView_getProjection","units","MapFishPrintV3StamenSerializer","MapFishPrintV3GeoJsonSerializer","MapFishPrintV3OSMSerializer","MapFishPrintV3WMTSSerializer","MapFishPrintV3XYZSerializer","SHOGunMapFishPrintV3TiledWMSSerializer","CustomFieldInput","LayoutSelect","ScaleSelect","ResolutionSelect","OutputFormatSelect","faDownload","downloadUrl","keyName","options","getFieldsValue","fields","filtered","AutoComplete","o","isFormValid","setIsFormValid","availableFeatureCollectionAttributes","setAvailableFeatureCollectionAttributes","availableFeatureAttributes","setAvailableFeatureAttributes","contextHolder","_notification_useNotification","updateAvailableFeatureAttributes","_fields_fields","currentKeys","_field_name","_digitizeLayer_getSource","formProperties","OlGeometry","digitizedFeatures","featureCollectionAttributes","prop","Row","input","changedFields","add","rmFn","AttributionRow","faMinusSquare","confirm","digitizeLayer","ExclamationCircleOutlined","_layers__getSource","Dragger","footer","width","onCancel","isLoading","setIsLoading","importError","setImportError","supportedFileExtensions","supportedFormats","onSuccessUpload","onErrorUpload","File","fileReader","err","ext","fileType","fileExtension","info","status","digitizeLayerSource","faUpload","drawerVisibilty","faPaintBrush","showDrawPoint","showDrawLine","showDrawPolygon","showDrawCircle","showDrawRectangle","showDrawAnnotation","showModifyFeatures","showUploadFeatures","showDeleteFeatures","selectedModifyFeature","setSelectedModifyFeature","selectedButton","setSelectedButton","isImportDataModalOpen","setIsImportDataModalOpen","onToggleChange","onModifyFeatureSelect","onCloseImportDataModal","faCircle","faGripLines","faShapes","faCircleNotch","faSquare","faFont","StylingButton","faPenToSquare","faEraser","DeleteAllButton","ImportDataModal","clonedFeatures","mapProjection","_clonedFeature_getGeometry","clonedFeature","fileToDownload","Blob","link","AttributionDrawer","initVectorLayer","fill","stroke","featureStyle","deinitVectorLayer","vectorLayer","exportFilter","activeCopyTools","isEditButtonVisible","isLayerEditable","Pagination","geojsonFeatureString","geojsonFeature","setLayerId","showEditFeatureDrawer","CopyTools","selectedFeatureClone","propertyEntries","filteredPropertyEntries","faClipboardCheck","props","_clone","faClipboardList","currentPage","setCurrentPage","activeKey","setActiveKey","vectorLayerName","useHighlightVectorLayer","_vectorLayer_getSource","_vectorLayer_getSource1","PaginationToolbar","conf","page","setBlacklistedAttributes","activeTabKey","setActiveTabKey","featureInfoEnabled","changeActiveKey","findMapLayerIndex","allLayers","unqualifiedMapLayerName","getUnqualifiedLayerName","unqualifiedLayerName","CoordinateInfo","OlLayerImage","OlLayerTile","coordinateInfoState","featureLayerResult","grouped","groupBy","mapped","mapValues","g","flr","serializedFeatures","feats","setSelectedFeatures","featureLayerResults","pluginRendererAvailable","mapLayerIndex","mapLayer","isFeatureInfoIntegration","FeatureInfoTabs","FeatureInfoPropertyGrid","formatString","setValue","startDate","setStartDate","endDate","setEndDate","marks","mid","timeValues","dimension","nearest","NaN","diff","faClock","TimeSlider","_layer_get","visibleLegendsIds","setVisibleLegendsIds","extentLoading","setExtentLoading","downloadConfig","metadataVisible","getAllLayerGroups","layerGroups","removeLayer","parentGroups","parentGroup","dropdownMenuItems","legendVisible","downloadItems","dlConfig","_dlConfig_formatName","encodeURI","decodeURI","externalLayerGroup","uploadedLayerGroup","legendId","newLegendIds","setLayerDetailsLayer","showLayerDetailsModal","faEllipsisV","_useAppSelector","_useAppSelector1","initialLayersUid","showLegendsState","layerIconsVisible","layerTileLoadCounter","setLayerTileLoadCounter","mapScale","setMapScale","registerTileLoadHandler","tileLoadStartListener","tileLoadEndListener","checkListeners","activeLayers","legendRequestExtraParams","legendRequestHeaders","onMapMoveEnd","mapView","unit","OlMapEvent","counter","uid","percent","Math","RgLayerTree","_layerTileLoadCounter_getUid","LoadingIndicator","faMagnifyingGlass","faCircleInfo","faPen","LayerTreeContextMenu","LayerTransparencySlider","WmsTimeSlider","Legend","OlVectorLayer","showMeasureDistance","showMeasureArea","isGeodesicMeasurement","proj","proj4","projName","MeasureButton","faPenRuler","panels","collapseWidth","minWidth","maxWidth","availableTools","activeKeys","maxHeight","collapsed","setCollapsed","menuTools","setMenuTools","isResizing","setIsResizing","noCollapseWidth","setNoCollapseWidth","mobileQuery","mobileNavigatorRegEx","RegExp","setToolMenuWidth","exclusiveTools","activeExclusiveTools","tool","lastExclusiveTool","setActiveKeys","setFeatureInfoEnabled","setLayerTreeEnabled","activeUploadTools","onMouseDown","onMouseUp","onMouseMove","offsetLeft","Collapse","_toArray","toolPanelConfig","getToolPanelConfig","faRuler","Measure","faPalette","Draw","FeatureInfo","faFileDownload","PrintForm","_ClientConfiguration_geoserver_upload_authorizedRoles","faStream","LayerTree","UploadTools","showAdd","role","showUpload","faShareNodes","Permalink","faLanguage","LanguageSelect","icon","wrappedComponent","label","insertionIndex","newItem","faChevronRight","faChevronLeft","uploadError","setUploadError","uploadSuccess","setUploadSuccess","isUploading","setIsUploading","_ClientConfiguration_geoserver","_ClientConfiguration_geoserver_upload","splittedFileName","geoServerBaseUrl","workspace","uploadData","Date","baseUrl","storeName","coverageStoreResponse","coverageResponse","shp","featureTypeName","featureTypeAttributes","Shapefile","k","dbfContent","getAttributeType","dbfFieldType","shxContent","types","featureTypeResponse","maxSize","fileSize","SHOGunApplicationUtil","App","identifier","configString","addLayerGroup","search","URLSearchParams","name","_MapUtil_getLayersByProperty","loadingMask","Header","BasicMapComponent","ToolMenu","MapToolbar","Footer","CookieBanner","AddLayerModal","UploadDataModal","EditFeatureDrawer","LayerDetailsModal","StylingDrawer","SearchResultDrawer"],"mappings":"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"}