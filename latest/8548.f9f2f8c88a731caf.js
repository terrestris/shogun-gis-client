"use strict";(self.webpackChunk_terrestris_shogun_gis_client=self.webpackChunk_terrestris_shogun_gis_client||[]).push([["8548"],{62953:function(e,t,i){i.r(t),i.d(t,{optionsFromCapabilities:function(){return c}});var n=i(65952),r=i(78487),o=i(21915),s=i(23241),l=i(89434),a=i(5374);class u extends n.Z{constructor(e){let t=void 0!==e.requestEncoding?e.requestEncoding:"KVP",i=e.tileGrid,n=e.urls;void 0===n&&void 0!==e.url&&(n=(0,r.Gk)(e.url)),super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileClass:e.tileClass,tileGrid:i,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,urls:n,wrapX:void 0!==e.wrapX&&e.wrapX,transition:e.transition,zDirection:e.zDirection}),this.version_=void 0!==e.version?e.version:"1.0.0",this.format_=void 0!==e.format?e.format:"image/jpeg",this.dimensions_=void 0!==e.dimensions?e.dimensions:{},this.layer_=e.layer,this.matrixSet_=e.matrixSet,this.style_=e.style,this.requestEncoding_=t,this.setKey(this.getKeyForDimensions_()),n&&n.length>0&&(this.tileUrlFunction=(0,l.Un)(n.map(this.createFromWMTSTemplate.bind(this))))}setUrls(e){this.urls=e;let t=e.join("\n");this.setTileUrlFunction((0,l.Un)(e.map(this.createFromWMTSTemplate.bind(this))),t)}getDimensions(){return this.dimensions_}getFormat(){return this.format_}getLayer(){return this.layer_}getMatrixSet(){return this.matrixSet_}getRequestEncoding(){return this.requestEncoding_}getStyle(){return this.style_}getVersion(){return this.version_}getKeyForDimensions_(){let e=this.urls?this.urls.slice(0):[];for(let t in this.dimensions_)e.push(t+"-"+this.dimensions_[t]);return e.join("/")}updateDimensions(e){Object.assign(this.dimensions_,e),this.setKey(this.getKeyForDimensions_())}createFromWMTSTemplate(e){let t=this.requestEncoding_,i={layer:this.layer_,style:this.style_,tilematrixset:this.matrixSet_};"KVP"==t&&Object.assign(i,{Service:"WMTS",Request:"GetTile",Version:this.version_,Format:this.format_}),e="KVP"==t?(0,r.B5)(e,i):e.replace(/\{(\w+?)\}/g,function(e,t){return t.toLowerCase()in i?i[t.toLowerCase()]:e});let n=this.tileGrid,o=this.dimensions_;return function(i,s,l){if(!i)return;let a={TileMatrix:n.getMatrixId(i[0]),TileCol:i[1],TileRow:i[2]};Object.assign(a,o);let u=e;return u="KVP"==t?(0,r.B5)(u,a):u.replace(/\{(\w+?)\}/g,function(e,t){return encodeURIComponent(a[t])})}}}function c(e,t){let i,n;let r=e.Contents.Layer,l=r?.find(function(e){return e.Identifier==t.layer});if(!l)return null;let u=e.Contents.TileMatrixSet;(i=l.TileMatrixSetLink.length>1?"projection"in t?l.TileMatrixSetLink.findIndex(function(e){let i=u.find(function(t){return t.Identifier==e.TileMatrixSet}).SupportedCRS,n=(0,a.get)(i),r=(0,a.get)(t.projection);return n&&r?(0,a.equivalent)(n,r):i==t.projection}):l.TileMatrixSetLink.findIndex(function(e){return e.TileMatrixSet==t.matrixSet}):0)<0&&(i=0);let c=l.TileMatrixSetLink[i].TileMatrixSet,d=l.TileMatrixSetLink[i].TileMatrixSetLimits,f=l.Format[0];"format"in t&&(f=t.format),(i=l.Style.findIndex(function(e){return"style"in t?e.Title==t.style:e.isDefault}))<0&&(i=0);let h=l.Style[i].Identifier,m={};"Dimension"in l&&l.Dimension.forEach(function(e,t,i){let n=e.Identifier,r=e.Default;void 0===r&&(r=e.Value[0]),m[n]=r});let g=e.Contents.TileMatrixSet.find(function(e){return e.Identifier==c}),p=g.SupportedCRS;if(p&&(n=(0,a.get)(p)),"projection"in t){let e=(0,a.get)(t.projection);e&&(!n||(0,a.equivalent)(e,n))&&(n=e)}let T=!1,x=n.getAxisOrientation().startsWith("ne"),S=g.TileMatrix[0],M={MinTileCol:0,MinTileRow:0,MaxTileCol:S.MatrixWidth-1,MaxTileRow:S.MatrixHeight-1};if(d){M=d[d.length-1];let e=g.TileMatrix.find(e=>e.Identifier===M.TileMatrix||g.Identifier+":"+e.Identifier===M.TileMatrix);e&&(S=e)}let _=28e-5*S.ScaleDenominator/n.getMetersPerUnit(),C=x?[S.TopLeftCorner[1],S.TopLeftCorner[0]]:S.TopLeftCorner,y=S.TileWidth*_,E=S.TileHeight*_,v=g.BoundingBox;v&&x&&(v=[v[1],v[0],v[3],v[2]]);let b=[C[0]+y*M.MinTileCol,C[1]-E*(1+M.MaxTileRow),C[0]+y*(1+M.MaxTileCol),C[1]-E*M.MinTileRow];if(void 0!==v&&!(0,o.containsExtent)(v,b)){let e=l.WGS84BoundingBox,t=(0,a.get)("EPSG:4326").getExtent();if(b=v,e)T=e[0]===t[0]&&e[2]===t[2];else{let e=(0,a.transformExtent)(v,g.SupportedCRS,"EPSG:4326");T=e[0]-1e-10<=t[0]&&e[2]+1e-10>=t[2]}}let w=(0,s.createFromCapabilitiesMatrixSet)(g,b,d),R=[],j=t.requestEncoding;if(j=void 0!==j?j:"","OperationsMetadata"in e&&"GetTile"in e.OperationsMetadata){let t=e.OperationsMetadata.GetTile.DCP.HTTP.Get;for(let e=0,i=t.length;e<i;++e)if(t[e].Constraint){let i=t[e].Constraint.find(function(e){return"GetEncoding"==e.name}).AllowedValues.Value;if(""===j&&(j=i[0]),"KVP"===j)i.includes("KVP")&&R.push(t[e].href);else break}else t[e].href&&(j="KVP",R.push(t[e].href))}return 0===R.length&&(j="REST",l.ResourceURL.forEach(function(e){"tile"===e.resourceType&&(f=e.format,R.push(e.template))})),{urls:R,layer:t.layer,matrixSet:c,format:f,projection:n,requestEncoding:j,tileGrid:w,style:h,dimensions:m,wrapX:T,crossOrigin:t.crossOrigin}}t.default=u},49179:function(e,t,i){function n(){throw Error("Unimplemented abstract method.")}i.r(t),i.d(t,{VERSION:function(){return s},abstract:function(){return n},getUid:function(){return o}});let r=0;function o(e){return e.ol_uid||(e.ol_uid=String(++r))}let s="10.3.1"}}]);
//# sourceMappingURL=8548.f9f2f8c88a731caf.js.map