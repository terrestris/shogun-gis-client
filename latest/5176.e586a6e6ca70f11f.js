"use strict";(self.webpackChunk_terrestris_shogun_gis_client=self.webpackChunk_terrestris_shogun_gis_client||[]).push([["5176"],{3783:function(t,e,i){i.d(e,{D4:function(){return d},RA:function(){return c},f6:function(){return u}});var s=i(80398),r=i(55506),n=i(78081),o=i(17353),l=i(29991),a=i(44954);class h extends n.A{constructor(t,e,i,r){super(),this.extent=t,this.pixelRatio_=i,this.resolution=e,this.state="function"==typeof r?s.default.IDLE:r,this.image_=null,this.loader="function"==typeof r?r:null}changed(){this.dispatchEvent(r.default.CHANGE)}getExtent(){return this.extent}getImage(){return this.image_}getPixelRatio(){return this.pixelRatio_}getResolution(){return this.resolution}getState(){return this.state}load(){if(this.state==s.default.IDLE&&this.loader){this.state=s.default.LOADING,this.changed();let t=this.getResolution(),e=Array.isArray(t)?t[0]:t;(0,l.toPromise)(()=>this.loader(this.getExtent(),e,this.getPixelRatio())).then(t=>{"image"in t&&(this.image_=t.image),"extent"in t&&(this.extent=t.extent),"resolution"in t&&(this.resolution=t.resolution),"pixelRatio"in t&&(this.pixelRatio_=t.pixelRatio),(t instanceof HTMLImageElement||a.CREATE_IMAGE_BITMAP&&t instanceof ImageBitmap||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement)&&(this.image_=t),this.state=s.default.LOADED}).catch(t=>{this.state=s.default.ERROR,console.error(t)}).finally(()=>this.changed())}}setImage(t){this.image_=t}setResolution(t){this.resolution=t}}function u(t,e,i){let s=!0,n=!1,l=!1,h=[(0,o.Jz)(t,r.default.LOAD,function(){l=!0,n||e()})];return t.src&&a.IMAGE_DECODE?(n=!0,t.decode().then(function(){s&&e()}).catch(function(t){s&&(l?e():i())})):h.push((0,o.Jz)(t,r.default.ERROR,i)),function(){s=!1,h.forEach(o.JH)}}function c(t,e){return e&&(t.src=e),t.src&&a.IMAGE_DECODE?new Promise((e,i)=>t.decode().then(()=>e(t)).catch(s=>t.complete&&t.width?e(t):i(s))):new Promise((e,i)=>{function s(){n(),e(t)}function r(){n(),i(Error("Image load error"))}function n(){t.removeEventListener("load",s),t.removeEventListener("error",r)}t.addEventListener("load",s),t.addEventListener("error",r)})}function d(t,e){return e&&(t.src=e),t.src&&a.IMAGE_DECODE&&a.CREATE_IMAGE_BITMAP?t.decode().then(()=>createImageBitmap(t)).catch(e=>{if(t.complete&&t.width)return t;throw e}):c(t)}e.Ay=h},80398:function(t,e,i){i.r(e),e.default={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4}},78907:function(t,e,i){var s=i(3783),r=i(31644),n=i(74255),o=i(84674),l=i(44954);class a extends r.A{constructor(t,e,i,s,r,n){super(t,e,n),this.crossOrigin_=s,this.src_=i,this.key=i,this.image_,l.WORKER_OFFSCREEN_CANVAS?this.image_=new OffscreenCanvas(1,1):(this.image_=new Image,null!==s&&(this.image_.crossOrigin=s)),this.unlisten_=null,this.tileLoadFunction_=r}getImage(){return this.image_}setImage(t){this.image_=t,this.state=n.default.LOADED,this.unlistenImage_(),this.changed()}getCrossOrigin(){return this.crossOrigin_}handleImageError_(){let t;this.state=n.default.ERROR,this.unlistenImage_(),this.image_=((t=(0,o.Y)(1,1)).fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas),this.changed()}handleImageLoad_(){if(l.WORKER_OFFSCREEN_CANVAS)this.state=n.default.LOADED;else{let t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=n.default.LOADED:this.state=n.default.EMPTY}this.unlistenImage_(),this.changed()}load(){this.state==n.default.ERROR&&(this.state=n.default.IDLE,this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==n.default.IDLE&&(this.state=n.default.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=(0,s.f6)(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}e.A=a},7689:function(t,e,i){var s=i(31644),r=i(74255),n=i(84674),o=i(55506),l=i(17353),a=i(85752),h=i(94966),u=i(22482),c=i(73445),d=i(20776);class g extends s.A{constructor(t,e,i,s,n,o,l,g,_,f,E,p){super(n,r.default.IDLE,p),this.renderEdges_=void 0!==E&&E,this.pixelRatio_=l,this.gutter_=g,this.canvas_=null,this.sourceTileGrid_=e,this.targetTileGrid_=s,this.wrappedTileCoord_=o||n,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=t.canWrapX()?t.getExtent():void 0;const m=s.getTileCoordExtent(this.wrappedTileCoord_),T=this.targetTileGrid_.getExtent();let R=this.sourceTileGrid_.getExtent();const I=T?(0,a.getIntersection)(m,T):m;if(0===(0,a.getArea)(I)){this.state=r.default.EMPTY;return}const A=t.getExtent();A&&(R=R?(0,a.getIntersection)(R,A):A);const L=s.getResolution(this.wrappedTileCoord_[0]),O=(0,u.aY)(t,i,I,L);if(!isFinite(O)||O<=0){this.state=r.default.EMPTY;return}const x=void 0!==f?f:d.l;if(this.triangulation_=new c.A(t,i,I,R,O*x,L),0===this.triangulation_.getTriangles().length){this.state=r.default.EMPTY;return}this.sourceZ_=e.getZForResolution(O);let D=this.triangulation_.calculateSourceExtent();if(R&&(t.canWrapX()?(D[1]=(0,h.qE)(D[1],R[1],R[3]),D[3]=(0,h.qE)(D[3],R[1],R[3])):D=(0,a.getIntersection)(D,R)),(0,a.getArea)(D)){let i=0,s=0;t.canWrapX()&&(i=(0,a.getWidth)(A),s=Math.floor((D[0]-A[0])/i)),(0,a.wrapAndSliceX)(D.slice(),t,!0).forEach(t=>{let r=e.getTileRangeForExtentAndZ(t,this.sourceZ_);for(let t=r.minX;t<=r.maxX;t++)for(let e=r.minY;e<=r.maxY;e++){let r=_(this.sourceZ_,t,e,l);if(r){let t=s*i;this.sourceTiles_.push({tile:r,offset:t})}}++s}),0===this.sourceTiles_.length&&(this.state=r.default.EMPTY)}else this.state=r.default.EMPTY}getImage(){return this.canvas_}reproject_(){let t=[];if(this.sourceTiles_.forEach(e=>{let i=e.tile;if(i&&i.getState()==r.default.LOADED){let s=this.sourceTileGrid_.getTileCoordExtent(i.tileCoord);s[0]+=e.offset,s[2]+=e.offset;let r=this.clipExtent_?.slice();r&&(r[0]+=e.offset,r[2]+=e.offset),t.push({extent:s,clipExtent:r,image:i.getImage()})}}),this.sourceTiles_.length=0,0===t.length)this.state=r.default.ERROR;else{let e=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(e),s="number"==typeof i?i:i[0],n="number"==typeof i?i:i[1],o=this.targetTileGrid_.getResolution(e),l=this.sourceTileGrid_.getResolution(this.sourceZ_),a=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=(0,u.XX)(s,n,this.pixelRatio_,l,this.sourceTileGrid_.getExtent(),o,a,this.triangulation_,t,this.gutter_,this.renderEdges_,this.interpolate),this.state=r.default.LOADED}this.changed()}load(){if(this.state==r.default.IDLE){this.state=r.default.LOADING,this.changed();let t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:e})=>{let i=e.getState();if(i==r.default.IDLE||i==r.default.LOADING){t++;let i=(0,l.KT)(e,o.default.CHANGE,s=>{let n=e.getState();(n==r.default.LOADED||n==r.default.ERROR||n==r.default.EMPTY)&&((0,l.JH)(i),0==--t&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(i)}}),0===t?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:t},e,i){t.getState()==r.default.IDLE&&t.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(l.JH),this.sourcesListenerKeys_=null}release(){this.canvas_&&((0,n.Yg)(this.canvas_.getContext("2d")),u.BV.push(this.canvas_),this.canvas_=null),super.release()}}e.A=g},81355:function(t,e,i){i.d(e,{U:function(){return _}});var s=i(78907),r=i(74255),n=i(55506),o=i(44954),l=i(21128),a=i(7689),h=i(93435),u=i(53800),c=i(94092),d=i(18473);class g extends d.A{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:_,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX,transition:t.transition,interpolate:void 0===t.interpolate||t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.crossOrigin=void 0!==t.crossOrigin?t.crossOrigin:null,this.tileClass=void 0!==t.tileClass?t.tileClass:s.A,this.tileGridForProjection={},this.reprojectionErrorThreshold_=t.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(t){return this.getProjection()&&t&&!(0,l.equivalent)(this.getProjection(),t)?0:this.getGutter()}getGutter(){return 0}getKey(){let t=super.getKey();return this.getInterpolate()||(t+=":disable-interpolation"),t}getTileGridForProjection(t){let e=this.getProjection();if(this.tileGrid&&(!e||(0,l.equivalent)(e,t)))return this.tileGrid;let i=(0,c.getUid)(t);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=(0,u.getForProjection)(t)),this.tileGridForProjection[i]}createTile_(t,e,i,s,o,l){let a=[t,e,i],h=this.getTileCoordForTileUrlFunction(a,o),u=h?this.tileUrlFunction(h,s,o):void 0,c=new this.tileClass(a,void 0!==u?r.default.IDLE:r.default.EMPTY,void 0!==u?u:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return c.key=l,c.addEventListener(n.default.CHANGE,this.handleTileChange.bind(this)),c}getTile(t,e,i,s,r,n){let o=this.getProjection();if(!o||!r||(0,l.equivalent)(o,r))return this.getTileInternal(t,e,i,s,o||r);let h=[t,e,i],u=this.getKey(),c=this.getTileGridForProjection(o),d=this.getTileGridForProjection(r),g=this.getTileCoordForTileUrlFunction(h,r),_=new a.A(o,c,r,d,h,g,this.getTilePixelRatio(s),this.getGutter(),(t,e,i,s)=>this.getTileInternal(t,e,i,s,o,n),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return _.key=u,_}getTileInternal(t,e,i,s,r,n){let o=this.getKey(),l=(0,h.et)(this,o,t,e,i);if(n&&n.containsKey(l))return n.get(l);let a=this.createTile_(t,e,i,s,r,o);return n?.set(l,a),a}setRenderReprojectionEdges(t){this.renderReprojectionEdges_!=t&&(this.renderReprojectionEdges_=t,this.changed())}setTileGridForProjection(t,e){let i=(0,l.get)(t);if(i){let t=(0,c.getUid)(i);t in this.tileGridForProjection||(this.tileGridForProjection[t]=e)}}}function _(t,e){if(o.WORKER_OFFSCREEN_CANVAS){let i=t.getCrossOrigin(),s="same-origin",r="same-origin";"anonymous"===i||""===i?(s="cors",r="omit"):"use-credentials"===i&&(s="cors",r="include"),fetch(e,{mode:s,credentials:r}).then(t=>{if(!t.ok)throw Error(`HTTP ${t.status}`);return t.blob()}).then(t=>createImageBitmap(t)).then(e=>{let i=t.getImage();i.width=e.width,i.height=e.height,i.getContext("2d").drawImage(e,0,0),e.close?.(),i.dispatchEvent(new Event("load"))}).catch(()=>{t.getImage().dispatchEvent(new Event("error"))});return}t.getImage().src=e}e.A=g}}]);
//# sourceMappingURL=5176.e586a6e6ca70f11f.js.map