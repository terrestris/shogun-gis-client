"use strict";(self.webpackChunk_terrestris_shogun_gis_client=self.webpackChunk_terrestris_shogun_gis_client||[]).push([["2031"],{23831:function(e,t,n){n.r(t),n.d(t,{BackgroundLayerChooser:function(){return R},default:function(){return T}});var r=n(76395),a=n.n(r),l=n(36693),o=n(56759),i=n(56418),s=n.n(i),c=n(99138),u=n.n(c),g=n(24910),m=n.n(g),d=n(49994),f=n.n(d),p=n(20554),y=n.n(p),w=n(76512),v=n.n(w),E=n(5988),b=n.n(E),k=n(698),V=n.n(k),h=n(50858),S=n(8544),C=n.n(S),N=n(15455),L=n(30126),$=n(28032),D=n(13102),B=n.n(D),M=n(86644),_=n(38225),F=({layer:e,activeLayer:t,width:n=128,height:l=128,onClick:o,zoom:i,center:s,backgroundLayerFilter:c,titleRenderer:g})=>{let[d,p]=(0,r.useState)(!1),y=(0,L.A)(),w=(0,r.useMemo)(()=>e instanceof f()?new(f())({source:e.getSource()}):e instanceof m()?new(m())({source:e.getSource()}):void 0,[e]),v=(0,r.useMemo)(()=>new(B())({view:new(C())({projection:y?.getView().getProjection(),resolutions:y?.getView().getResolutions(),center:s,zoom:i}),controls:[],interactions:[],layers:w&&[w]}),[s,y,w,i]);(0,r.useEffect)(()=>{let e=()=>p(!0),t=()=>p(!1);return v.on("loadstart",e),v.on("loadend",t),()=>{v.un("loadstart",e),v.un("loadend",t)}},[v]),(0,r.useEffect)(()=>{i&&v.getView().setZoom(i),s&&v.getView().setCenter(s)},[i,s,v]);let E=()=>{let e=t=>{if(!t)return[];let n=[];for(let r of t.getLayers().getArray())c(r)&&n.push(r),r instanceof u()&&n.push(...e(r));return n},t=y?.getLayerGroup();return t?e(t):[]},b=e=>{let t=e?.currentTarget,n=t?.dataset?.uid;if(!n||!y)return;let r=M.BY.getLayerByOlUid(y,n);r&&(E().forEach(e=>e.setVisible(!1)),r.setVisible(!0),("click"===e.type||"keydown"===e.type)&&o(r))},k=!1,V=(0,h.getUid)(e);t&&(k=V===(0,h.getUid)(t));let S=(0,r.useRef)(void 0);return a().createElement("div",{className:`layer-preview${k?" selected":""}`,key:V,"data-uid":V,role:"button",tabIndex:0,onMouseOver:b,onMouseLeave:()=>{E().forEach(e=>e.setVisible(!1)),t?.setVisible(!0)},onFocus:()=>{S.current=e},onBlur:()=>{S.current=void 0},onKeyDown:e=>{let t="Enter"===e.key||"Enter"===e.code,n=" "===e.key||"Spacebar"===e.key||"Space"===e.code;(t||n)&&(n&&e.preventDefault(),S.current&&b(e))},onClick:b},a().createElement($.A,{spinning:d},a().createElement(_.default,{mapDivId:`previewmap-${V}`,style:{height:l,width:n},map:v}),a().createElement("span",{className:"layer-title"},g?g(e):e.get("name"))))},A=n(71953);let R=({layers:e,allowEmptyBackground:t=!1,buttonTooltip:n="Change background layer",initiallySelectedLayer:i,noBackgroundTitle:c="No Background",backgroundLayerFilter:g=e=>!!e.get("isBackgroundLayer"),titleRenderer:d})=>{let p=(0,L.A)(),[w,E]=(0,r.useState)(p?.getView()?.getZoom()),[k,S]=(0,r.useState)(p?.getView()?.getCenter()),[$,D]=(0,r.useState)(!1),[B,M]=(0,r.useState)(),[_,R]=(0,r.useState)(!1),T=(0,r.useRef)(null);(0,r.useEffect)(()=>{if(p&&$){S(p.getView().getCenter()),E(p.getView().getZoom());let e=e=>{S(e.target.getCenter())},t=e=>{E(e.target.getZoom())};return p.getView().on("change:center",e),p.getView().on("change:resolution",t),()=>{p.getView().un("change:center",e),p.getView().un("change:resolution",t)}}},[p,$]),(0,r.useEffect)(()=>{i?M(i):M(e.find(e=>e.getVisible()))},[i,e]),(0,r.useEffect)(()=>{let e;if(!B||!p)return;let t=(e=>{if(e instanceof f()){let t;return(t=(e=>{if(e instanceof b())return new(b())({url:e.getUrls()?.[0],params:e.getParams(),tileLoadFunction:e.getTileLoadFunction()});if(e instanceof v())return new(v());if(e instanceof V()){let t=e.getTileGrid();return t?new(V())({url:e.getUrls()?.[0],layer:e.getLayer(),matrixSet:e.getMatrixSet(),format:e.getFormat(),tileGrid:t,style:e.getStyle(),requestEncoding:e.getRequestEncoding(),version:e.getVersion(),dimensions:e.getDimensions(),wrapX:e.getWrapX()}):null}return null})(e.getSource()))?new(f())({source:t}):null}if(e instanceof m()){let t;return(t=e.getSource())instanceof y()?new(m())({source:t}):null}if(e instanceof u()){if(e.get("isVectorTile")){let t=new(u());return(0,N.Bb)(t,e.get("url")),t}return new(u())({layers:e.getLayers()})}return null})(B);if(!t||!T.current)return;let n=(e=T.current,new(s())({collapsible:!1,target:e,className:"ol-overviewmap react-geo-bg-layer-chooser-overviewmap",layers:[t],view:new(C())({projection:p.getView().getProjection()})}));return p.addControl(n),()=>{p.removeControl(n)}},[B,p]);let U=(0,r.useRef)(!1),x=()=>{B?.setVisible(!1),M(void 0),D(!1),R(!0)};return a().createElement("div",{className:"bg-layer-chooser"},$&&a().createElement("div",{className:"layer-cards"},e.filter(g).map(e=>a().createElement(F,{key:(0,h.getUid)(e),activeLayer:B,onClick:e=>{D(!1),M(e),R(!1)},layer:e,backgroundLayerFilter:g,zoom:w,center:k,titleRenderer:d})),t&&a().createElement("div",{role:"button",tabIndex:0,className:`no-background${B?"":" selected"}`,onMouseOver:()=>{B?.setVisible(!1)},onMouseLeave:()=>{B?.setVisible(!0)},onFocus:()=>{U.current=!0},onBlur:()=>{U.current=!1},onKeyDown:e=>{let t="Enter"===e.key||"Enter"===e.code,n=" "===e.key||"Spacebar"===e.key||"Space"===e.code;(t||n)&&(n&&e.preventDefault(),U.current&&x())},onClick:x},a().createElement("div",{className:"no-background-preview"},a().createElement(o.gc,{icon:l.Dfk})),a().createElement("span",{className:"layer-title"},c))),a().createElement(A.default,{className:`change-bg-btn${$?" toggled":""}`,size:"small",tooltip:n,"aria-expanded":$,icon:$?a().createElement(o.gc,{icon:l.XkK}):a().createElement(o.gc,{icon:l.Wzs}),onClick:()=>D(!$)}),a().createElement("div",{className:"bg-preview"},_?a().createElement("div",{className:"no-background-preview"},a().createElement(o.gc,{icon:l.Dfk})):a().createElement("div",{id:"overview-map",ref:T}),B?a().createElement("span",{className:"layer-title"},d?d(B):B.get("name")):a().createElement("span",{className:"layer-title"},c)))};var T=R},71953:function(e,t,n){n.r(t);var r=n(76395),a=n(8110),l=n(71021),o=n(70198);let i=`${o.$}simplebutton`;t.default=({className:e,type:t="primary",tooltip:n,tooltipPlacement:o,tooltipProps:s={mouseEnterDelay:1.5},children:c,...u})=>{let g=e?`${e} ${i}`:`${i}`;return r.createElement(a.A,{title:n,placement:o,...s},r.createElement(l.Ay,{className:g,type:t,...u},c))}},38225:function(e,t,n){n.r(t),n.d(t,{MapComponent:function(){return l}});var r=n(76395),a=n.n(r);let l=({map:e,mapDivId:t="map",...n})=>{let l=(0,r.useCallback)(t=>{e&&(null===t?e.setTarget(void 0):e.setTarget(t))},[e]);return e?a().createElement("div",{id:t,ref:l,className:"map",role:"presentation",...n}):a().createElement(a().Fragment,null)};t.default=l},70198:function(e,t,n){n.d(t,{$:function(){return r}});let r="react-geo-"}}]);
//# sourceMappingURL=2031.cc11d414d683eb33.js.map