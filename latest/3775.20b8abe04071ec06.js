"use strict";(self.webpackChunk_terrestris_shogun_gis_client=self.webpackChunk_terrestris_shogun_gis_client||[]).push([["3775"],{25249:function(e,t,n){n.r(t),n.d(t,{default:function(){return N},GeoLocationButton:function(){return D}});var a=n(76395),r=n.n(a),i=n(69843),o=n.n(i),s=n(66046),c=n.n(s),u=n(62918),l=n.n(u),g=n(94934),d=n.n(g),f=n(25188),h=n.n(f),m=n(15516),p=n.n(m),M=n(17936),b=n(70038),w=n.n(b),k=n(36528),y=n.n(k),C=n(97562),$=n.n(C),P=class{static radToDeg=e=>360*e/(2*Math.PI);static degToRad=e=>e*Math.PI*2/360;static mod=e=>(e%(2*Math.PI)+2*Math.PI)%(2*Math.PI)},A=n(30126),E=n(38254),_=n.p+"6afbd13a3ce1b95d.png",v=n.p+"3380da3c8b677218.png",I=n(70198),T=n(53529);let D=({className:e,enableTracking:t=!1,follow:n=!1,onError:i=()=>void 0,onGeoLocationChange:s=()=>void 0,pressed:u,showMarker:g=!0,trackingOptions:f,...m})=>{(({active:e,enableTracking:t=!1,follow:n=!1,onError:r,onGeoLocationChange:i,showMarker:s=!1,trackingOptions:u={enableHighAccuracy:!0,maximumAge:1e4,timeout:6e5}})=>{let g=(0,A.A)(),[f,m]=(0,a.useState)(),b=(0,a.useMemo)(()=>new(d())([],"XYZM"),[]),k=(0,a.useMemo)(()=>new(c()),[]);(0,E.c)(()=>new(p())({properties:{name:"react-geo_geolocationlayer"},source:new(w())({features:[k]}),style:e=>{let t=e.get("heading"),n=Number.isFinite(t)&&0!==t?_:v,a=Number.isFinite(t)&&0!==t?t*Math.PI/180:0;return[new($())({image:new(y())({rotation:a,src:n})})]}}),[],s&&e);let C=(0,a.useCallback)(e=>{let t=e.target,n=t.getPosition()??[0,0],a=t.getAccuracy(),r=t.getHeading()||0,o=t.getSpeed()||0,s=n[0],c=n[1],u=b.getCoordinates(),l=u[u.length-1],g=l&&l[2];if(g){let e=r-P.mod(g);Math.abs(e)>Math.PI&&(e=-(e>=0?1:-1)*(2*Math.PI-Math.abs(e))),r=g+e}b.appendCoordinate([s,c,r,Date.now()]),b.setCoordinates(b.getCoordinates().slice(-20));let d={position:n,accuracy:a,heading:r,speed:o};m(d),i?.(d)},[b,i]),I=(0,a.useMemo)(()=>{if(!e||!g)return;let n=new(l())({projection:g.getView().getProjection(),trackingOptions:u});return t&&n.setTracking(!0),n},[e,g,u,t]),T=(0,a.useCallback)((e,t,n)=>{let a=(g?.getSize()??[0,0])[1];return[e[0]-Math.sin(t)*a*n/4,e[1]+Math.cos(t)*a*n/4]},[g]);return(0,a.useEffect)(()=>{if(!r||!I)return;let e=I.on("error",()=>{r()});return()=>{(0,M.unByKey)(e)}},[I,r]),(0,a.useEffect)(()=>{if(!I)return;let e=I.on("change",C);return()=>{(0,M.unByKey)(e)}},[I,C]),(0,a.useEffect)(()=>{if(I)return I.setTracking(t),()=>{I.setTracking(!1)}},[t,I]),(0,a.useEffect)(()=>{I&&I.setTrackingOptions(u)},[I,u]),(0,a.useEffect)(()=>{let e=Date.now()-750;e=Math.max(e,0);let t=b.getCoordinateAtM(e,!0);if(!o()(t)&&(n&&(g?.getView().setCenter(T([t[0],t[1]],-t[2],g?.getView().getResolution()??0)),g?.getView().setRotation(-t[2])),s)){let e=new(h())([t[0],t[1]]);k.setGeometry(e)}},[f,s,n,g,b,T,k])})({active:!!u,enableTracking:u&&t,follow:n,onError:i,onGeoLocationChange:s,showMarker:g,trackingOptions:f});let b=e?`${e} ${I.$}geolocationbutton`:`${I.$}geolocationbutton`;return r().createElement(T.A,{pressed:u,className:b,...m})};var N=D},53529:function(e,t,n){var a=n(76395),r=n.n(a),i=n(54440),o=n(74097),s=n(70198);t.A=({type:e="primary",pressed:t=!1,tooltipProps:n={mouseEnterDelay:1.5},className:a,tooltip:c,tooltipPlacement:u,pressedIcon:l,icon:g,children:d,value:f,onClick:h,onChange:m=()=>void 0,...p})=>{let M=`${s.$}togglebutton`,b=a?`${a} ${M}`:M,w="";return t&&(w=" btn-pressed"),r().createElement(i.A,{title:c,placement:u,...n},r().createElement(o.Ay,{type:e,onClick:e=>{h&&(h(e),e.defaultPrevented)||m(e,f)},onChange:m,className:`${b}${w}`,"aria-pressed":t,icon:t?l:g,...p},d))}},70198:function(e,t,n){n.d(t,{$:function(){return a}});let a="react-geo-"}}]);
//# sourceMappingURL=3775.20b8abe04071ec06.js.map