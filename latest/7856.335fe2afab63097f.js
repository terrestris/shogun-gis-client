"use strict";(self.webpackChunk_terrestris_shogun_gis_client=self.webpackChunk_terrestris_shogun_gis_client||[]).push([["7856"],{2022:function(t,e,i){i.d(e,{Jx:function(){return d},Kp:function(){return u},Q9:function(){return c}});var s=i(66575),r=i(73381),n=i(11256),o=i(91358),l=i(13002),a=i(64011);class h extends s.Z{constructor(t,e,i,s){super(),this.extent=t,this.pixelRatio_=i,this.resolution=e,this.state="function"==typeof s?n.default.IDLE:s,this.image_=null,this.loader="function"==typeof s?s:null}changed(){this.dispatchEvent(r.default.CHANGE)}getExtent(){return this.extent}getImage(){return this.image_}getPixelRatio(){return this.pixelRatio_}getResolution(){return this.resolution}getState(){return this.state}load(){if(this.state==n.default.IDLE&&this.loader){this.state=n.default.LOADING,this.changed();let t=this.getResolution(),e=Array.isArray(t)?t[0]:t;(0,a.toPromise)(()=>this.loader(this.getExtent(),e,this.getPixelRatio())).then(t=>{"image"in t&&(this.image_=t.image),"extent"in t&&(this.extent=t.extent),"resolution"in t&&(this.resolution=t.resolution),"pixelRatio"in t&&(this.pixelRatio_=t.pixelRatio),(t instanceof HTMLImageElement||t instanceof ImageBitmap||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement)&&(this.image_=t),this.state=n.default.LOADED}).catch(t=>{this.state=n.default.ERROR,console.error(t)}).finally(()=>this.changed())}}setImage(t){this.image_=t}setResolution(t){this.resolution=t}}function u(t,e,i){let s=!0,n=!1,a=!1,h=[(0,l.Vx)(t,r.default.LOAD,function(){a=!0,!n&&e()})];return t.src&&o.IMAGE_DECODE?(n=!0,t.decode().then(function(){s&&e()}).catch(function(t){s&&(a?e():i())})):h.push((0,l.Vx)(t,r.default.ERROR,i)),function(){s=!1,h.forEach(l.bN)}}function c(t,e){var i,s;return e&&(t.src=e),t.src&&o.IMAGE_DECODE?new Promise((e,i)=>t.decode().then(()=>e(t)).catch(s=>t.complete&&t.width?e(t):i(s))):(i=t,new Promise((t,e)=>{function s(){n(),t(i)}function r(){n(),e(Error("Image load error"))}function n(){i.removeEventListener("load",s),i.removeEventListener("error",r)}i.addEventListener("load",s),i.addEventListener("error",r)}))}function d(t,e){return e&&(t.src=e),t.src&&o.IMAGE_DECODE&&o.CREATE_IMAGE_BITMAP?t.decode().then(()=>createImageBitmap(t)).catch(e=>{if(t.complete&&t.width)return t;throw e}):c(t)}e.ZP=h},11256:function(t,e,i){i.r(e),e.default={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4}},15107:function(t,e,i){var s=i(24969),r=i(59900),n=i(85386),o=i(2022);class l extends s.Z{constructor(t,e,i,s,r,n){super(t,e,n),this.crossOrigin_=s,this.src_=i,this.key=i,this.image_=new Image,null!==s&&(this.image_.crossOrigin=s),this.unlisten_=null,this.tileLoadFunction_=r}getImage(){return this.image_}setImage(t){this.image_=t,this.state=r.default.LOADED,this.unlistenImage_(),this.changed()}handleImageError_(){this.state=r.default.ERROR,this.unlistenImage_(),this.image_=function(){let t=(0,n.E4)(1,1);return t.fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas}(),this.changed()}handleImageLoad_(){let t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=r.default.LOADED:this.state=r.default.EMPTY,this.unlistenImage_(),this.changed()}load(){this.state==r.default.ERROR&&(this.state=r.default.IDLE,this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==r.default.IDLE&&(this.state=r.default.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=(0,o.Kp)(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}e.Z=l},7245:function(t,e,i){var s=i(35211),r=i(73381),n=i(24969),o=i(59900),l=i(56245),a=i(52209),h=i(21882),u=i(21915),c=i(13002),d=i(85386);class g extends n.Z{constructor(t,e,i,r,n,c,d,g,_,f,E,p){super(n,o.default.IDLE,p),this.renderEdges_=void 0!==E&&E,this.pixelRatio_=d,this.gutter_=g,this.canvas_=null,this.sourceTileGrid_=e,this.targetTileGrid_=r,this.wrappedTileCoord_=c||n,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=t.canWrapX()?t.getExtent():void 0;let T=r.getTileCoordExtent(this.wrappedTileCoord_),m=this.targetTileGrid_.getExtent(),I=this.sourceTileGrid_.getExtent(),R=m?(0,u.getIntersection)(T,m):T;if(0===(0,u.getArea)(R)){this.state=o.default.EMPTY;return}let L=t.getExtent();L&&(I=I?(0,u.getIntersection)(I,L):L);let x=r.getResolution(this.wrappedTileCoord_[0]),G=(0,a.Co)(t,i,R,x);if(!isFinite(G)||G<=0){this.state=o.default.EMPTY;return}let D=void 0!==f?f:s.m;if(this.triangulation_=new l.Z(t,i,R,I,G*D,x),0===this.triangulation_.getTriangles().length){this.state=o.default.EMPTY;return}this.sourceZ_=e.getZForResolution(G);let P=this.triangulation_.calculateSourceExtent();if(I&&(t.canWrapX()?(P[1]=(0,h.uZ)(P[1],I[1],I[3]),P[3]=(0,h.uZ)(P[3],I[1],I[3])):P=(0,u.getIntersection)(P,I)),(0,u.getArea)(P)){let i=0,s=0;t.canWrapX()&&(i=(0,u.getWidth)(L),s=Math.floor((P[0]-L[0])/i)),(0,u.wrapAndSliceX)(P.slice(),t,!0).forEach(t=>{let r=e.getTileRangeForExtentAndZ(t,this.sourceZ_);for(let t=r.minX;t<=r.maxX;t++)for(let e=r.minY;e<=r.maxY;e++){let r=_(this.sourceZ_,t,e,d);if(r){let t=s*i;this.sourceTiles_.push({tile:r,offset:t})}}++s}),0===this.sourceTiles_.length&&(this.state=o.default.EMPTY)}else this.state=o.default.EMPTY}getImage(){return this.canvas_}reproject_(){let t=[];if(this.sourceTiles_.forEach(e=>{let i=e.tile;if(i&&i.getState()==o.default.LOADED){let s=this.sourceTileGrid_.getTileCoordExtent(i.tileCoord);s[0]+=e.offset,s[2]+=e.offset;let r=this.clipExtent_?.slice();r&&(r[0]+=e.offset,r[2]+=e.offset),t.push({extent:s,clipExtent:r,image:i.getImage()})}}),this.sourceTiles_.length=0,0===t.length)this.state=o.default.ERROR;else{let e=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(e),s="number"==typeof i?i:i[0],r="number"==typeof i?i:i[1],n=this.targetTileGrid_.getResolution(e),l=this.sourceTileGrid_.getResolution(this.sourceZ_),h=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=(0,a.sY)(s,r,this.pixelRatio_,l,this.sourceTileGrid_.getExtent(),n,h,this.triangulation_,t,this.gutter_,this.renderEdges_,this.interpolate),this.state=o.default.LOADED}this.changed()}load(){if(this.state==o.default.IDLE){this.state=o.default.LOADING,this.changed();let t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:e})=>{let i=e.getState();if(i==o.default.IDLE||i==o.default.LOADING){t++;let i=(0,c.oL)(e,r.default.CHANGE,s=>{let r=e.getState();(r==o.default.LOADED||r==o.default.ERROR||r==o.default.EMPTY)&&((0,c.bN)(i),0==--t&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(i)}}),0===t?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:t},e,i){t.getState()==o.default.IDLE&&t.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(c.bN),this.sourcesListenerKeys_=null}release(){this.canvas_&&((0,d.jy)(this.canvas_.getContext("2d")),a.rX.push(this.canvas_),this.canvas_=null),super.release()}}e.Z=g},65952:function(t,e,i){var s=i(73381),r=i(15107),n=i(7245),o=i(59900),l=i(76137),a=i(5374),h=i(86018),u=i(49179);class c extends l.Z{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:d,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX,transition:t.transition,interpolate:void 0===t.interpolate||t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.crossOrigin=void 0!==t.crossOrigin?t.crossOrigin:null,this.tileClass=void 0!==t.tileClass?t.tileClass:r.Z,this.tileGridForProjection={},this.reprojectionErrorThreshold_=t.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(t){return this.getProjection()&&t&&!(0,a.equivalent)(this.getProjection(),t)?0:this.getGutter()}getGutter(){return 0}getKey(){let t=super.getKey();return!this.getInterpolate()&&(t+=":disable-interpolation"),t}getTileGridForProjection(t){let e=this.getProjection();if(this.tileGrid&&(!e||(0,a.equivalent)(e,t)))return this.tileGrid;let i=(0,u.getUid)(t);return!(i in this.tileGridForProjection)&&(this.tileGridForProjection[i]=(0,h.getForProjection)(t)),this.tileGridForProjection[i]}createTile_(t,e,i,r,n,l){let a=[t,e,i],h=this.getTileCoordForTileUrlFunction(a,n),u=h?this.tileUrlFunction(h,r,n):void 0,c=new this.tileClass(a,void 0!==u?o.default.IDLE:o.default.EMPTY,void 0!==u?u:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return c.key=l,c.addEventListener(s.default.CHANGE,this.handleTileChange.bind(this)),c}getTile(t,e,i,s,r){let o=this.getProjection();if(!o||!r||(0,a.equivalent)(o,r))return this.getTileInternal(t,e,i,s,o||r);let l=[t,e,i],h=this.getKey(),u=this.getTileGridForProjection(o),c=this.getTileGridForProjection(r),d=this.getTileCoordForTileUrlFunction(l,r),g=new n.Z(o,u,r,c,l,d,this.getTilePixelRatio(s),this.getGutter(),(t,e,i,s)=>this.getTileInternal(t,e,i,s,o),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return g.key=h,g}getTileInternal(t,e,i,s,r){let n=this.getKey();return this.createTile_(t,e,i,s,r,n)}setRenderReprojectionEdges(t){if(this.renderReprojectionEdges_!=t)this.renderReprojectionEdges_=t,this.changed()}setTileGridForProjection(t,e){let i=(0,a.get)(t);if(i){let t=(0,u.getUid)(i);!(t in this.tileGridForProjection)&&(this.tileGridForProjection[t]=e)}}}function d(t,e){t.getImage().src=e}e.Z=c}}]);
//# sourceMappingURL=7856.335fe2afab63097f.js.map