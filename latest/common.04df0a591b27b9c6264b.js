(self.webpackChunk_terrestris_shogun_gis_client=self.webpackChunk_terrestris_shogun_gis_client||[]).push([[592],{46582:function(e,t,n){"use strict";n.r(t),n.d(t,{App:function(){return Ha},default:function(){return Ya}});var a=n(96985),r=n.n(a),o=n(38648),l=n(50146),i=n(71577),s=n(4107),c=n(34041),u=n(44338),d=n(74187),m=n(9479),p=n.n(m),g=n(33300),f=n.n(g),y=n(49862),h=n.n(y),w=n(60110),E=n(92212),b=n.n(E),v=n(49413),k=n.n(v),L=n(54388),S=n.n(L),T=n(10007),M=n.n(T),C=n(47139);var P=()=>(0,C.useDispatch)();const Z=C.useSelector;var A=Z,F=n(20908),O=n(93379),N=n.n(O),I=n(7795),x=n.n(I),D=n(90569),j=n.n(D),U=n(3565),R=n.n(U),z=n(19216),_=n.n(z),$=n(44589),B=n.n($),V=n(40171),K={};K.styleTagTransform=B(),K.setAttributes=R(),K.insert=j().bind(null,"head"),K.domAPI=x(),K.insertStyleElement=_();N()(V.Z,K),V.Z&&V.Z.locals&&V.Z.locals;function W(){return W=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},W.apply(this,arguments)}var G=({...e})=>{const[t,n]=(0,a.useState)(!1),[m,g]=(0,a.useState)([]),[y,E]=(0,a.useState)([]),[v,L]=(0,a.useState)("https://sgx.geodatenzentrum.de/wms_topplus_open"),[M,C]=(0,a.useState)(),[Z,O]=(0,a.useState)("1.3.0"),N=A((e=>e.addLayerModal.visible)),I=P(),x=(0,T.useMap)(),{t:D}=(0,w.useTranslation)();(0,a.useEffect)((()=>{N&&C(b().createValidGetCapabilitiesRequest(v,"WMS",Z))}),[Z,N,v]);const j=()=>{E([]),g([]),I((0,F.Cp)())},U=e=>{if(!x)return;const t=D("AddLayerModal.externalWmsFolder");let n=S().getLayerByName(x,t);if(!n){n=new(p())({layers:[]}),n.set("name",t);const e=x.getLayerGroup().getLayers();e.insertAt(e?.getLength()||0,n)}e.forEach((e=>{if(!n.getLayers().getArray().includes(e)){let t;if(e.set("isExternalLayer",!0),e instanceof f()&&(t=e.getSource()?.getUrl()),e instanceof h()){const n=e.getSource()?.getUrls();t=1===n?.length?n[0]:void 0}const a={name:e.get("name"),type:e instanceof h()?"TILEWMS":"WMS",opacity:e.getOpacity(),sourceConfig:{layerNames:e.getSource()?.getParams().LAYERS,url:t,useBearerToken:!1}};e.set("layerConfig",a),n.getLayers().push(e)}})),j()};return r().createElement(l.Z,W({className:"add-layer-modal",title:D("AddLayerModal.title"),open:N,onCancel:j,width:600,footer:[r().createElement(i.Z,{key:"add-all",disabled:m?.length<1,onClick:()=>{U(m)}},D("AddLayerModal.addAllLayers")),r().createElement(i.Z,{key:"add-selected",disabled:y?.length<1,onClick:()=>{const e=m.filter((e=>y.includes((0,d.getUid)(e))));U(e)}},D("AddLayerModal.addSelectedLayers"))]},e),r().createElement(s.Z.Search,{placeholder:D("AddLayerModal.inputPlaceholder"),value:v,onChange:e=>{L(e.target.value)},onSearch:async()=>{if(M)try{n(!0);const e=await k().getWmsCapabilities(M),t=k().getLayersFromWmsCapabilities(e,"Title");g(t)}catch(e){o.Z.error({message:D("AddLayerModal.errorMessage"),description:D("AddLayerModal.errorDescription")})}finally{n(!1)}},enterButton:!0,addonBefore:r().createElement(c.default,{defaultValue:"1.3.0",onChange:O,options:[{value:"1.3.0",label:`${D("AddLayerModal.version")} 1.3.0`},{value:"1.1.1",label:`${D("AddLayerModal.version")} 1.1.1`}]})}),r().createElement(u.Z,{loading:t,columns:[{title:D("AddLayerModal.columnTitle"),render:(e,t)=>t.get("title")}],rowKey:e=>(0,d.getUid)(e),rowSelection:{selectedRowKeys:y,onChange:E},pagination:!1,dataSource:m}))},H=n(41609),Y=n.n(H),q=n(12038),J=n.n(q),Q=n(35674),X=n.n(Q),ee=n(41154),te=n.n(ee),ne=n(73161),ae=n.n(ne),re=n(76688);const oe=()=>(0,a.useContext)(re.ZP);var le=oe;var ie=n(77257);var se=()=>(0,a.useContext)(ie.ZP);function ce(){return ce=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},ce.apply(this,arguments)}var ue=({...e})=>{const t=M()(),n=se(),o=function(){const{search:e}=window.location;return r().useMemo((()=>new URLSearchParams(e)),[e])}(),l=le(),i=o.get("center"),s=o.get("zoom"),c=o.get("layers"),u=o.get("customLayerAttributes"),{t:d}=(0,w.useTranslation)(),m=(0,a.useCallback)((async(e,a)=>{if(!t)return;const r=e=>{const n=new(p())({layers:[]});n.set("name",e);const a=t.getLayerGroup().getLayers();return a.insertAt(a?.getLength()||0,n),n};try{const o=JSON.parse(e);if(!n)throw new Error("Client is not available");const l=new(ae())({client:n});for(let e=0;e<o.length;e++){const n=o[e];if(!Y()(n?.layerConfig)){const e=n.layerConfig,o=await l.parseLayer(e);if(n.isExternalLayer&&o.set("isExternalLayer",n.isExternalLayer),n.isUploadedLayer&&o.set("isUploadedLayer",n.isUploadedLayer),o.set("groupName",n.groupName),o.set("layerConfig",n.layerConfig),o.setVisible(!!a?.split(";").some((t=>t===e.name))),!o.get("isExternalLayer")&&!o.get("isUploadedLayer"))continue;let i;o.get("groupName")?(i=S().getLayerByName(t,o.get("groupName")),i||(i=r(o.get("groupName")))):(i=S().getLayerByName(t,d("AddLayerModal.externalWmsFolder")),i||(i=r(d("AddLayerModal.externalWmsFolder")))),i.getLayers().push(o)}}}catch(e){J().error(e)}}),[n,t,d]);(0,a.useEffect)((()=>{if(t){const e=e=>e.get("name"),n=e=>e instanceof h()||e instanceof f(),a=X().applyLink(t,";",e,n);if(!a)return;m(a,c)}}),[t,m,i,s,c,u]);const g=[];return l&&l.forEach((e=>{if((t=e.integration)&&"map"===t.placement){const{key:t,wrappedComponent:n}=e;g.push(r().createElement(n,{key:t}))}var t})),t?r().createElement(te(),ce({map:t},e),g):r().createElement(r().Fragment,null)},de=n(27049),me=n(19906),pe=n.n(me),ge=n(41642),fe=n.n(ge),ye=n(99254),he=n(19805),we=n.n(he),Ee=n(78415),be={};be.styleTagTransform=B(),be.setAttributes=R(),be.insert=j().bind(null,"head"),be.domAPI=x(),be.insertStyleElement=_();N()(Ee.Z,be),Ee.Z&&Ee.Z.locals&&Ee.Z.locals;function ve(){return ve=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},ve.apply(this,arguments)}var ke=({...e})=>{const{t:t}=(0,w.useTranslation)(),n=A((e=>e.legal)),o=M()();(0,a.useEffect)((()=>{if(!o)return;o.getControls().getArray().find((e=>e instanceof fe()))||o.addControl(new(fe())({target:"scale-line-container"}))}),[o]),(0,a.useEffect)((()=>{if(!o)return;o.getControls().getArray().find((e=>e instanceof pe()))||o.addControl(new(pe())({coordinateFormat:(0,ye.createStringXY)(2),projection:o.getView().getProjection(),target:"mouse-position"}))}),[o]);return o?r().createElement("div",ve({className:"footer"},e),r().createElement("div",{className:"item-container left-items"},r().createElement("div",{id:"scale-line-container"}),r().createElement(de.Z,{type:"vertical"}),r().createElement("div",{className:"scale-combo"},t("Footer.scale"),": ",r().createElement(we(),{map:o}),r().createElement(de.Z,{type:"vertical"})),r().createElement("div",{className:"reference-system"},t("Footer.refSystem"),": ",o.getView().getProjection().getCode(),r().createElement(de.Z,{type:"vertical"})),r().createElement("div",{className:"mouse-position-wrapper"},t("Footer.mousePosition"),": ",r().createElement("div",{id:"mouse-position",className:"mouse-position"}))),r().createElement("div",{className:"item-container right-items"},r().createElement(i.Z,{onClick:()=>{window.open(n.contact,"_blank")},type:"link"},t("Footer.contact")),r().createElement(i.Z,{onClick:()=>{window.open(n.imprint,"_blank")},type:"link"},t("Footer.imprint")),r().createElement(i.Z,{onClick:()=>{window.open(n.privacy,"_blank")},type:"link"},t("Footer.privacypolicy")))):r().createElement(r().Fragment,null)},Le=n(90426),Se=n(32456),Te=n.n(Se);function Me(){return Me=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Me.apply(this,arguments)}var Ce=({...e})=>{const t=M()(),{t:n}=(0,w.useTranslation)(),[o,l]=(0,a.useState)();return(0,a.useEffect)((()=>{const e=t?.getView().getProjection(),n=t?.getView()?.get("extent");if(n){const t=(0,Le.transformExtent)(n,e,"EPSG:4326");l(t.toString())}}),[t]),t?r().createElement(Te(),Me({map:t,countryCodes:"",allowClear:!0,nominatimBaseUrl:"https://nominatim.terrestris.de/search.php?",placeholder:n("Nominatim.placeholder"),viewBox:o||""},e)):r().createElement(r().Fragment,null)},Pe=n(59417),Ze=n(70982),Ae=n(81350),Fe=n.n(Ae),Oe=n(88495),Ne=n.n(Oe);const Ie=({email:e="",size:t=80,rating:n="g",defaultImage:a="identicon",force:r=!1})=>{const o=e.toLowerCase();let l=`https://www.gravatar.com/avatar/${Ne()(o)}?s=${t}&r=${n}&d=${a}`;return r&&(l=`${l}&f=y`),l};var xe=n(7277);var De=n(88885),je={};je.styleTagTransform=B(),je.setAttributes=R(),je.insert=j().bind(null,"head"),je.domAPI=x(),je.insertStyleElement=_();N()(De.Z,je),De.Z&&De.Z.locals&&De.Z.locals;function Ue(){return Ue=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Ue.apply(this,arguments)}var Re=({opener:e,...t})=>{const{t:n}=(0,w.useTranslation)(),o=A((e=>e.appInfo)),i=A((e=>e.logoPath)),s=A((e=>e.description)),[c,u]=(0,a.useState)(!1),d=()=>{u(!c)};let m;return m=e?r().cloneElement(e,{onClick:d}):r().createElement("button",{onClick:d},"Open"),r().createElement(r().Fragment,null,m,r().createElement(l.Z,Ue({className:"application-info",title:n("ApplicationInfo.title"),centered:!0,open:c,onOk:d,onCancel:d,footer:null},t),r().createElement("img",{className:"logo",src:i}),r().createElement("div",{className:"description"},s),r().createElement(xe.Z,{title:n("ApplicationInfo.clientVersionTitle"),value:"5.2.0"}),o.version&&o.buildTime&&r().createElement(xe.Z,{title:n("ApplicationInfo.backendVersionTitle"),value:`${o.version} (${o.buildTime})`})))},ze=n(72285),_e={};_e.styleTagTransform=B(),_e.setAttributes=R(),_e.insert=j().bind(null,"head"),_e.domAPI=x(),_e.insertStyleElement=_();N()(ze.Z,_e),ze.Z&&ze.Z.locals&&ze.Z.locals;var $e=()=>{const{t:e}=(0,w.useTranslation)(),t=se(),n=t?.getKeycloak(),a=A((e=>e.user)),o=e=>{switch(e.key){case"settings":n&&n.accountManagement();break;case"info":default:break;case"login":n&&n.login();break;case"logout":n&&n.logout()}};return r().createElement(Fe(),{size:"small",imageSrc:Ie({email:a.providerDetails?.email||"",size:28}),userName:r().createElement(Ze.FontAwesomeIcon,{icon:Pe.gc2}),userMenu:(()=>{const t={key:"login",icon:r().createElement(Ze.FontAwesomeIcon,{icon:Pe.Yem}),label:e("UserMenu.loginMenuTitle")},n={key:"username",label:r().createElement("div",{className:"user-name"},r().createElement("span",null,a.providerDetails?.email))},l={type:"divider"},i={key:"settings",icon:r().createElement(Ze.FontAwesomeIcon,{icon:Pe.gNZ}),label:e("UserMenu.settingsMenuTitle")},s={key:"info",icon:r().createElement(Ze.FontAwesomeIcon,{icon:Pe.YHc}),label:r().createElement(Re,{opener:r().createElement("span",{className:"info-opener"},e("UserMenu.infoMenuTitle"))})},c={key:"logout",icon:r().createElement(Ze.FontAwesomeIcon,{icon:Pe.HEx}),label:e("UserMenu.logoutMenuTitle")};return{items:Y()(a)?[t,s]:[n,l,i,s,l,c],onClick:o}})()})},Be=n(62923),Ve={};Ve.styleTagTransform=B(),Ve.setAttributes=R(),Ve.insert=j().bind(null,"head"),Ve.domAPI=x(),Ve.insertStyleElement=_();N()(Be.Z,Ve),Be.Z&&Be.Z.locals&&Be.Z.locals;function Ke(){return Ke=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Ke.apply(this,arguments)}var We=({...e})=>{const t=Z((e=>e.title)),n=Z((e=>e.logoPath)),a=oe(),o=(e,t)=>{a.forEach((n=>{if((a=n.integration)&&"header"===a.placement&&n.integration?.placementOrientation===e){const{key:e,wrappedComponent:a}=n;t.splice(n.integration?.insertionIndex||0,0,r().createElement(a,{key:e}))}var a}))};return r().createElement("div",Ke({className:"header"},e),r().createElement("div",{className:"item-container left-items"},(()=>{const e=[r().createElement("img",{key:"logo",className:"logo",src:n}),r().createElement("div",{key:"title",className:"title"},t)];return o("left",e),e})()),r().createElement("div",{className:"item-container center-items"},(()=>{const e=[r().createElement(Ce,{key:"search"})];return o("center",e),e})()),r().createElement("div",{className:"item-container right-items"},(()=>{const e=[r().createElement($e,{key:"user-menu"})];return o("right",e),e})()))},Ge=n(27279),He=n(45777),Ye=n(87617),qe=n.n(Ye),Je=n(1581),Qe=n.n(Je),Xe=n(76712),et=n(63221),tt=n(85677),nt={};nt.styleTagTransform=B(),nt.setAttributes=R(),nt.insert=j().bind(null,"head"),nt.domAPI=x(),nt.insertStyleElement=_();N()(tt.Z,nt),tt.Z&&tt.Z.locals&&tt.Z.locals;var at=n(35895);const{Option:rt}=c.default;var ot=()=>{const e=Object.keys(at.Z.services.resourceStore.data);return r().createElement("div",{className:"language-select"},r().createElement(c.default,{defaultValue:at.Z.language||"en",onChange:e=>{at.Z.changeLanguage(e)}},e.map((e=>r().createElement(rt,{key:e,value:e},e.toUpperCase())))))},lt=n(75013),it=n(73254),st=n(64302),ct=n(99165),ut=n(48086),dt=n(20640),mt=n.n(dt),pt=n(99746),gt=n(10767),ft={};ft.styleTagTransform=B(),ft.setAttributes=R(),ft.insert=j().bind(null,"head"),ft.domAPI=x(),ft.insertStyleElement=_();N()(gt.Z,ft),gt.Z&&gt.Z.locals&&gt.Z.locals;var yt=()=>{const e=(0,T.useMap)(),t=(0,a.useMemo)((()=>["layerConfig","isExternalLayer","isUploadedLayer","groupName"]),[]),{t:n}=(0,w.useTranslation)(),o=e?X().getLink(e,";",(e=>e.get("name")),(e=>(e instanceof h()||e instanceof f())&&e.getVisible()),t):"",[l,i]=(0,a.useState)(o),c="SHOGun Web-GIS",u=`Hey,\r\ncheck out the layer-composition I created:\r\n\r\n${l}`;return(0,a.useEffect)((()=>{if(!e)return;let n=[];const a=e=>e.get("name"),r=e=>(e instanceof h()||e instanceof f())&&e.getVisible(),o=()=>{i(X().getLink(e,";",a,r,t))},l=()=>{e.getAllLayers().filter((e=>e.get("isExternalLayer")||e.get("isUploadedLayer"))).forEach((e=>{const t=e.get("layerConfig");t&&(t.clientConfig?t.clientConfig.opacity=e.getOpacity():t.clientConfig={opacity:e.getOpacity()},e.set("layerConfig",t))})),o()},s=e=>{const t=e.getLayers().getArray();for(let e=0;e<t.length;e++){const a=t[e];if(a instanceof p())s(a);else{let e=a.on("change:visible",o),t=a.on("change:opacity",l);n.push(e,t)}}},c=e.getView().on("change:center",o),u=e.getView().on("change:resolution",o);let d=e.getLayerGroup();return s(d),l(),()=>{(0,pt.unByKey)(c),(0,pt.unByKey)(u),(0,pt.unByKey)(n)}}),[t,e,n]),r().createElement("div",{className:"permalink-wrapper"},r().createElement("div",{className:"icons"},r().createElement(He.Z,{title:n("Permalink.twitterTooltip")},r().createElement(lt.Z,{onClick:function(){const e=new URL("https://twitter.com/intent/tweet");e.searchParams.set("url",u),window.open(e)}})),r().createElement(He.Z,{title:n("Permalink.whatsAppTooltip")},r().createElement(it.Z,{onClick:function(){const e=new URL("https://wa.me");e.searchParams.set("text",u),window.open(e)}})),r().createElement(He.Z,{title:n("Permalink.mailTooltip")},r().createElement(st.Z,{onClick:function(){const e=new URL("mailto:");e.searchParams.set("subject",c),e.searchParams.set("body",u),window.open(e.toString().replace(/\+/g,"%20"),"_self")}}))),r().createElement("div",{className:"link"},r().createElement(s.Z,{value:l,readOnly:!0}),r().createElement(He.Z,{title:n("Permalink.copyTooltip")},r().createElement(ct.Z,{onClick:function(){mt()(l)?ut.ZP.info(n("Permalink.copiedToClipboard")):ut.ZP.info(n("Permalink.copyToClipboardFailed"))}}))))},ht=n(22245),wt=n(76772),Et=n(73345),bt=n(57795),vt=n.n(bt),kt=n(55002),Lt=n.n(kt),St=n(19867),Tt=n.n(St),Mt=n(78459),Ct=n(97955),Pt=n.n(Ct),Zt=n(11032),At=n.n(Zt);class Ft extends(At()){serialize(e,t){const n=super.serialize(e,t);return n.baseURL.startsWith("/geoserver/ows")&&(n.baseURL=`http://shogun-geoserver:8080${n.baseURL}`),n.baseURL.startsWith("/geoserver/SHOGUN")&&(n.baseURL=`http://shogun-geoserver:8080${n.baseURL}`),n}}var Ot=Ft;var Nt=class extends Ot{serialize(e,t){const n={tileSize:[512,512],...t},a=e.getSource();if(!a||!this.validateSource(a))return;return{...super.serialize(e,n),type:Pt().TYPE_WMS,...t}}};function It(){return It=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},It.apply(this,arguments)}var xt=({printManager:e,value:t,id:n,placeholder:o,maxLength:l,...i})=>{const[c,u]=(0,a.useState)(t);return(0,a.useEffect)((()=>{e&&n&&e.setCustomParam(n,c)}),[e,c,n]),(0,a.useEffect)((()=>{u(t)}),[t]),r().createElement(s.Z,It({id:n,value:c,onChange:e=>u(e.target.value),placeholder:o,maxLength:l,showCount:!!(l&&l>1)},i))};function Dt(){return Dt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Dt.apply(this,arguments)}var jt=({printManager:e,placeholder:t="Bitte wählen Sie eine Vorlage aus",value:n,...o})=>{const[l,i]=(0,a.useState)(n);return(0,a.useEffect)((()=>{e&&e.setLayout(l)}),[e,l]),(0,a.useEffect)((()=>{i(n)}),[n]),r().createElement(c.default,Dt({placeholder:t,value:l,onChange:i},o),e?.getLayouts().map((e=>r().createElement(c.default.Option,{key:e.name,value:e.name},e.name))))};function Ut(){return Ut=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Ut.apply(this,arguments)}var Rt=({printManager:e,placeholder:t,value:n,outputFormats:o,...l})=>{const[i,s]=(0,a.useState)(n);return(0,a.useEffect)((()=>{e&&e.setOutputFormat(i)}),[e,i]),(0,a.useEffect)((()=>{s(n)}),[n]),r().createElement(c.default,Ut({placeholder:t,value:i,onChange:s},l),o.map((e=>r().createElement(c.default.Option,{key:e,value:e},e.toLocaleUpperCase()))))};function zt(){return zt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},zt.apply(this,arguments)}var _t=({printManager:e,placeholder:t,value:n,...o})=>{const[l,i]=(0,a.useState)(n);return(0,a.useEffect)((()=>{e&&e.setDpi(l)}),[e,l]),(0,a.useEffect)((()=>{i(n)}),[n]),r().createElement(c.default,zt({placeholder:t,value:l,onChange:i},o),e?.getDpis().map((e=>r().createElement(c.default.Option,{key:e,value:e},`${e} DPI`))))};function $t(){return $t=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},$t.apply(this,arguments)}var Bt=({printManager:e,placeholder:t,value:n,...o})=>{const l=M()(),[i,s]=(0,a.useState)(0);return(0,a.useEffect)((()=>{e&&i&&e.setScale(i)}),[e,i]),(0,a.useEffect)((()=>{const t=()=>{const t=e.getScale();t&&s(t)},n=l?.getInteractions().getArray().find((e=>e.get("name")===Et.MapFishPrintV3Manager.TRANSFORM_INTERACTION_NAME));if(e&&n&&n)return n.on("scaling",t),()=>{n.un("scaling",t)}}),[e,l]),(0,a.useEffect)((()=>{n&&s(n)}),[n]),r().createElement(c.default,$t({placeholder:t,value:i,onChange:s},o),e?.getScales().map((e=>r().createElement(c.default.Option,{key:e,value:e},`1 : ${e.toLocaleString()}`))))},Vt=n(91982),Kt=n.n(Vt),Wt=n(28523),Gt=n.n(Wt),Ht=n(26398);function Yt(){return Yt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Yt.apply(this,arguments)}n.n(Ht)().getLegendGraphicUrl=e=>{if(e.get("legendUrl"))return e.get("legendUrl");if(e.getSource()instanceof Gt()||e.getSource()instanceof Kt()){const t=e.get("customPrintLegendParams"),n=e.getSource(),{LAYERS:a,VERSION:r,FORMAT:o}=n.getParams();let l=n instanceof Kt()?n.getUrl():n.getUrls()[0];l.startsWith("/geoserver/ows")&&(l=`http://shogun-geoserver:8080${l}`);const i={LAYER:a.split(",")[0],VERSION:r||"1.3.0",SERVICE:"WMS",REQUEST:"GetLegendGraphic",FORMAT:o||"image/png",...t},s=Object.keys(i).map((e=>`${encodeURIComponent(e)}=${encodeURIComponent(i[e])}`)).join("&");return l.startsWith("/geoserver/SHOGUN")?(l=`http://shogun-geoserver:8080${l}/service?`,`${l}${s}`):l.endsWith("?")?`${l}${s}`:`${l}?${s}`}return""};var qt=({layerBlackList:e=[],map:t,active:n,customPrintScales:o=[],outputFormats:l=["pdf","png"],...s})=>{const[c]=ht.Z.useForm(),{t:u}=(0,w.useTranslation)(),d=se(),[m,g]=(0,a.useState)(null),[f,y]=(0,a.useState)(!1),[h,E]=(0,a.useState)(null),b=(0,a.useCallback)((n=>{if(!t)return;const a=n.get("name");return a&&!e.includes(a)&&n.getVisible()&&!(n instanceof p())&&S().layerInResolutionRange(n,t)}),[t,e]),v=(0,a.useCallback)((n=>{const a=n.get("name"),r=!e.includes(a),o=!n.get("hideLegendInPrint"),l=n.getVisible()&&S().layerInResolutionRange(n,t),i=!(n instanceof p());if(r&&o&&l&&i){const e=t.getView().getResolution();return e&&n.set("customPrintLegendParams",{SCALE:S().getScaleForResolution(e,"m")}),!0}return!1}),[t,e]),k=(0,a.useCallback)((async()=>{let e={url:qe().print?.url||"/print",map:t,timeout:6e4,layerFilter:b,headers:{...(0,Mt.getBearerTokenHeader)(d?.getKeycloak())},transformOpts:{rotate:!1},serializers:[new(vt()),new(Lt()),new(Tt()),new Ot,new Nt],legendFilter:v,customParams:{printLegend:!1}};o.length>0&&(e={...e,customPrintScales:o.reverse()});const n=new Et.MapFishPrintV3Manager(e);try{await n.init(),n.setOutputFormat(n.getOutputFormats()[0]),n.setDpi(n.getDpis()[0]),n.setLayout(n.getLayouts()[0]?.name),g(n)}catch(e){E((()=>u("PrintForm.managerErrorMessage"))),J().error("Could not initialize print manager: ",e)}}),[d,b,v,t,u,o]);(0,a.useEffect)((()=>{n?m||k():(m?.shutdownManager(),g(null))}),[m,n,k]);return r().createElement("div",{className:"print"},h&&r().createElement(wt.Z,{className:"print-alert",message:h,type:"error",closable:!0,showIcon:!0,onClose:()=>{E(null)}}),m?.isInitiated()&&r().createElement(r().Fragment,null,r().createElement(ht.Z,Yt({form:c,className:"print-form",labelAlign:"left",labelCol:{flex:"90px"}},s),r().createElement(ht.Z.Item,{name:"title",label:u("PrintForm.title"),initialValue:u("PrintForm.initialTitle")},r().createElement(xt,{maxLength:50,printManager:m,placeholder:u("PrintForm.titlePlaceholder")})),r().createElement(ht.Z.Item,{name:"comment",label:u("PrintForm.comment")},r().createElement(xt,{maxLength:200,printManager:m,placeholder:u("PrintForm.commentPlaceholder")})),r().createElement(ht.Z.Item,{name:"layout",label:u("PrintForm.layout"),initialValue:m?.getLayouts()[0]?.name},r().createElement(jt,{printManager:m})),r().createElement(ht.Z.Item,{name:"scale",label:u("PrintForm.scale"),initialValue:m?.getClosestScaleToFitMap()},r().createElement(Bt,{printManager:m})),r().createElement(ht.Z.Item,{name:"dpi",label:u("PrintForm.dpi"),initialValue:m.getDpis()[0]},r().createElement(_t,{printManager:m,placeholder:u("PrintForm.resolutionPlaceholder")})),r().createElement(ht.Z.Item,{name:"format",label:u("PrintForm.format"),initialValue:"pdf"},r().createElement(Rt,{printManager:m,outputFormats:l,placeholder:u("PrintForm.outputFormatPlaceholder")}))),r().createElement(i.Z,{className:"print-button tool-menu-button",disabled:!m?.isInitiated(),icon:r().createElement(Ze.FontAwesomeIcon,{icon:Pe.q7m}),loading:f,onClick:async()=>{try{if(E(null),y(!0),!m)return;const e=await m.print(!1);if(!e)throw new Error("No download URL available, the job has failed.");window.open(e)}catch(e){E(u("PrintForm.printJobErrorMsg")||null),J().error(e)}finally{y(!1)}}},u("PrintForm.downloadBtnText"))))},Jt=n(20963),Qt=n.n(Jt),Xt=n(57680),en=n.n(Xt),tn=n(1249),nn=n.n(tn),an=n(84986),rn=n.n(an),on=n(75321),ln=n.n(on),sn=n(44990),cn=n.n(sn),un=n(64748),dn=n.n(un),mn=n(30590),pn=n(7871),gn={};gn.styleTagTransform=B(),gn.setAttributes=R(),gn.insert=j().bind(null,"head"),gn.domAPI=x(),gn.insertStyleElement=_();N()(pn.Z,gn),pn.Z&&pn.Z.locals&&pn.Z.locals;var fn=n(273),yn=n(21015),hn={};hn.styleTagTransform=B(),hn.setAttributes=R(),hn.insert=j().bind(null,"head"),hn.domAPI=x(),hn.insertStyleElement=_();N()(yn.Z,hn),yn.Z&&yn.Z.locals&&yn.Z.locals;var wn=n(16144),En=n.n(wn),bn=n(53772),vn=n.n(bn);function kn(){return kn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},kn.apply(this,arguments)}var Ln=({...e})=>{const[t,n]=(0,a.useState)({name:"Default Style",rules:[{name:"Area",symbolizers:[{kind:"Fill",color:"#00b72b",outlineOpacity:.8,opacity:.5,fillOpacity:.8,outlineWidth:2,outlineColor:"#00b72b"}]},{name:"Line",symbolizers:[{kind:"Line",color:"#00b72b",width:2,opacity:.8}]},{name:"Point",symbolizers:[{kind:"Mark",wellKnownName:"circle",color:"#00b72b",strokeColor:"#00b72b",strokeOpacity:.8,opacity:.5,radius:7}],filter:["==","label","undefined"]},{name:"Text",symbolizers:[{kind:"Text",label:"{{label}}",size:12,font:["sans-serif"],opacity:.8,color:"#00b72b",offset:[5,5],haloColor:"#00b72b",haloWidth:1}],filter:["!=","label","undefined"]}]}),r=(0,T.useMap)();return(0,a.useEffect)((()=>{if(!t||!r)return;const e=new(vn());let n=S().getLayerByName(r,"react-geo_digitize");(async()=>{let a,r,o,l;for(const n of t.rules){const t={name:"",rules:[n]},i=await e.writeStyle(t);if(!i.output)return;"Fill"===n.symbolizers[0].kind&&(a=i.output),"Text"===n.symbolizers[0].kind&&(l=i.output),"Line"===n.symbolizers[0].kind&&(r=i.output),"Mark"===n.symbolizers[0].kind&&(o=i.output)}n.setStyle(((e,t)=>{const n=e.getGeometry()?.getType();if(n)return["MultiPolygon","Polygon","Circle"].includes(n)?"function"==typeof a?a(e,t):a:["MultiLineString","LineString"].includes(n)?"function"==typeof r?r(e,t):r:["MultiPoint","Point"].includes(n)?e.get("label")?"function"==typeof l?l(e,t):l:"function"==typeof o?o(e,t):o:void 0}))})()}),[t,r]),a.createElement(En(),kn({style:t,onStyleChange:n},e))};function Sn(){return Sn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Sn.apply(this,arguments)}var Tn=({...e})=>{const[t,n]=(0,a.useState)(!1),{t:o}=(0,w.useTranslation)();return r().createElement(r().Fragment,null,r().createElement(i.Z,{type:"link",onClick:()=>{n(!0)},icon:r().createElement(Ze.FontAwesomeIcon,{icon:Pe.XsY})},o("StylingDrawer.pickColor")),r().createElement(fn.Z,Sn({title:o("StylingDrawer.title"),placement:"right",onClose:()=>{n(!1)},open:t,mask:!1,width:"45vw",className:"color-pick-drawer"},e),r().createElement(Ln,null)))};var Mn=({showDrawPoint:e,showDrawLine:t,showDrawPolygon:n,showDrawCircle:a,showDrawRectangle:o,showDrawAnnotation:l,showModifyFeatures:i,showUploadFeatures:s,showDownloadFeatures:c,showDeleteFeatures:u})=>{const{t:d}=(0,w.useTranslation)(),m=(0,T.useMap)(),p=e=>{const t=new FileReader;t.onload=()=>{const e=(new(Qt())).readFeatures(t.result);if(m){const t=m.getView().getProjection().getCode();e.forEach((e=>{e.getGeometry()?.transform("EPSG:4326",t)}));const n=mn.DigitizeUtil.getDigitizeLayer(m).getSource();n?.addFeatures(e)}},t.readAsText(e)};return m?r().createElement(cn(),null,e?r().createElement(nn(),{name:"draw-point",drawType:"Point",type:"link",pressed:!1},r().createElement(Ze.FontAwesomeIcon,{icon:Pe.diR}),r().createElement("span",{className:"draw-point"},d("Draw.point"))):r().createElement(r().Fragment,null),t?r().createElement(nn(),{name:"draw-line",drawType:"LineString",type:"link"},r().createElement(Ze.FontAwesomeIcon,{icon:Pe.hx$}),r().createElement("span",{className:"draw-line"},d("Draw.line"))):r().createElement(r().Fragment,null),n?r().createElement(nn(),{name:"draw-polygon",drawType:"Polygon",type:"link"},r().createElement(Ze.FontAwesomeIcon,{icon:Pe.ubJ}),r().createElement("span",{className:"draw-polygon"},d("Draw.polygon"))):r().createElement(r().Fragment,null),a?r().createElement(nn(),{name:"draw-circle",drawType:"Circle",type:"link"},r().createElement(Ze.FontAwesomeIcon,{icon:Pe.diR}),r().createElement("span",{className:"draw-circle"},d("Draw.circle"))):r().createElement(r().Fragment,null),o?r().createElement(nn(),{name:"draw-rectangle",drawType:"Rectangle",type:"link"},r().createElement(Ze.FontAwesomeIcon,{icon:Pe.pL1}),r().createElement("span",{className:"draw-rectangle"},d("Draw.rectangle"))):r().createElement(r().Fragment,null),l?r().createElement(nn(),{name:"draw-text",drawType:"Text",type:"link"},r().createElement(Ze.FontAwesomeIcon,{icon:Pe.yGG}),r().createElement("span",{className:"draw-text"},d("Draw.text"))):r().createElement(r().Fragment,null),i?r().createElement(rn(),{name:"draw-modify",type:"link"},r().createElement(Ze.FontAwesomeIcon,{icon:Pe.Yai}),r().createElement("span",{className:"draw-modify"},d("Draw.modify"))):r().createElement(r().Fragment,null),s?r().createElement(dn(),{name:"draw-upload",onChange:e=>{const t=e.target.files;!t||1!==t.length||"application/geo+json"!==t[0].type&&"application/geojson"!==t[0].type||p(t[0])},type:"link"},r().createElement(ln(),{type:"link"},r().createElement(Ze.FontAwesomeIcon,{icon:Pe.cf$}),r().createElement("span",{className:"draw-upload"},d("Draw.upload")))):r().createElement(r().Fragment,null),c?r().createElement(ln(),{name:"draw-export",onClick:()=>{const e=[];if(m){const t=m.getView().getProjection().getCode(),n=mn.DigitizeUtil.getDigitizeLayer(m),a=n.getSource()?.getFeatures();if(a&&a.length>0){a.forEach((n=>{const a=n.clone();a.getGeometry()?.transform(t,"EPSG:4326"),e.push(a)}));const n=(new(Qt())).writeFeatures(e),r=new Blob([n],{type:"application/geo+json"}),o=window.URL.createObjectURL(r),l=document.createElement("a");l.href=o,l.setAttribute("download","exportedFeatures.geojson"),document.body.appendChild(l),l.click(),document.body.removeChild(l)}}},type:"link"},r().createElement(Ze.FontAwesomeIcon,{icon:Pe.q7m}),r().createElement("span",{className:"draw-export"},d("Draw.export"))):r().createElement(r().Fragment,null),u?r().createElement(en(),{name:"draw-delete",type:"link"},r().createElement(Ze.FontAwesomeIcon,{icon:Pe.$aW}),r().createElement("span",{className:"draw-delete"},d("Draw.delete"))):r().createElement(r().Fragment,null),r().createElement(Tn,null)):r().createElement(r().Fragment,null)},Cn=n(86629),Pn=n(41284),Zn=n.n(Pn),An=n(50433),Fn=n(21800),On=n(55151),Nn=n(20373),In=n.n(Nn),xn=n(34350),Dn=n.n(xn),jn=n(44457),Un=n.n(jn),Rn=n(98189),zn=n.n(Rn),_n=n(28253),$n=n.n(_n),Bn=n(35577),Vn=n.n(Bn),Kn=n(61316),Wn=n.n(Kn),Gn=n(86092),Hn={};Hn.styleTagTransform=B(),Hn.setAttributes=R(),Hn.insert=j().bind(null,"head"),Hn.domAPI=x(),Hn.insertStyleElement=_();N()(Gn.Z,Hn),Gn.Z&&Gn.Z.locals&&Gn.Z.locals;function Yn(){return Yn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Yn.apply(this,arguments)}var qn=({features:e,layerName:t,...n})=>{const[o,l]=(0,a.useState)(),[s,c]=(0,a.useState)(),u=M()(),d=`selection-layer-${t}`,m=t=>{l(t),c(e[t-1])};return(0,a.useEffect)((()=>{if(!u)return;return(()=>{if(S().getLayerByName(u,d))return;const t=new(Dn())({features:e}),n=new(zn())({color:"rgba(255, 255, 255, 0.15)"}),a=new($n())({color:"rgba(209, 70, 47, 1)",width:2}),r=new(Vn())({fill:n,stroke:a,image:new(Un())({radius:5,fill:n,stroke:a})}),o=new(In())({source:t,style:r});o.set("name",d),u.addLayer(o)})(),()=>(()=>{const e=S().getLayerByName(u,d);e&&u.removeLayer(e)})()}),[e,u,d]),(0,a.useEffect)((()=>{if(!u)return;const t=S().getLayerByName(u,d);t&&(t.getSource()?.clear(),l(1),e.length>0&&c(e[0]))}),[e,u,d]),(0,a.useEffect)((()=>{if(!s||!u)return;const e=S().getLayerByName(u,d);e&&(e.getSource()?.clear(),e.getSource()?.addFeature(s))}),[s,u,d]),s?r().createElement(Wn(),Yn({className:"property-grid",feature:s,size:"small",sticky:!0,title:()=>r().createElement(r().Fragment,null,r().createElement(On.Z,{simple:!0,total:e.length,size:"small",pageSize:1,current:o,onChange:m}),r().createElement(He.Z,{title:"Copy to clipboard"},r().createElement(i.Z,{type:"primary",onClick:()=>{mt()((new(Qt())).writeFeature(s))},icon:r().createElement(Ze.FontAwesomeIcon,{icon:Pe.kZ_})}))),columns:[{title:"Key",dataIndex:"attributeName",key:"attributeName",width:"50%",ellipsis:!0,defaultSortOrder:"ascend",sorter:(e,t)=>e.key.localeCompare(t.key)},{title:"Value",dataIndex:"attributeValue",key:"attributeValue",width:"50%",ellipsis:!0}],scroll:{scrollToFirstRowOnChange:!0,y:"calc(100% - 90px)"}},n)):r().createElement(r().Fragment,null)},Jn=n(16813),Qn={};Qn.styleTagTransform=B(),Qn.setAttributes=R(),Qn.insert=j().bind(null,"head"),Qn.domAPI=x(),Qn.insertStyleElement=_();N()(Jn.Z,Qn),Jn.Z&&Jn.Z.locals&&Jn.Z.locals;function Xn(){return Xn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Xn.apply(this,arguments)}var ea=({enabled:e,...t})=>{const{t:n}=(0,w.useTranslation)(),o=(0,T.useMap)(),l=se(),i=le(),s=P(),[c,u]=(0,a.useState)([]),m=e=>!!e.get("hoverable")&&(e instanceof f()&&e.getSource()instanceof Kt()||e instanceof h()&&e.getSource()instanceof Gt()),p=(0,a.useCallback)((()=>{if(!o)return;const e=S().getAllLayers(o,m);u(e.filter((e=>e.getVisible())))}),[o]);if((0,a.useEffect)((()=>{if(!o)return;p();const e=S().getAllLayers(o,m);return e.forEach((e=>e.on("change:visible",p))),()=>{e.forEach((e=>e.un("change:visible",p)))}}),[o,p]),!o)return r().createElement(r().Fragment,null);const g=e=>e.split(":").length>1?e.split(":")[1]:e.split(":")[0];if(!e)return r().createElement(r().Fragment,null);return r().createElement("div",{className:"feature-info-panel"},r().createElement(Zn(),Xn({featureCount:10,map:o,queryLayers:c,resultRenderer:e=>{const t=e.features,a=e.loading;if(0===Object.keys(t).length)return r().createElement("span",{className:"usage-hint"},n("FeatureInfo.usageHint"));const l=[];return Object.keys(t).forEach((e=>{let n=!1;const s=o.getAllLayers().find((t=>{if((0,An.isWmsLayer)(t)){const n=t.getSource(),a=g(n?.getParams().LAYERS);return g(e)===a}return!1}));i.forEach((t=>{if((a=t.integration)&&"feature-info"===a.placement&&(Array.isArray(t.integration.layers)&&t.integration.layers.includes(e)||!t.integration.layers)){const{key:a,wrappedComponent:o}=t;l.push({label:e,key:e,children:r().createElement(o,{key:a})}),n=!0}var a})),n||l.push({label:s?.get("name")||e,key:e,children:r().createElement("div",{key:e},r().createElement(qn,{features:t[e],layerName:e,loading:a}))})})),r().createElement(Cn.Z,{items:l})},fetchOpts:(()=>{const e={};return c.forEach((t=>{const n=(0,d.getUid)(t);e[n]={headers:{...t.get("useBearerToken")?{...(0,Mt.getBearerTokenHeader)(l?.getKeycloak())}:void 0}}})),e})(),onSuccess:e=>{const t=e.features,n={};Object.entries(t).forEach((e=>{const t=e[0],a=e[1];n[t]=(new(Qt())).writeFeatures(a)})),s((0,Fn.wl)(n))}},t)))},ta=n(54458),na=n(60925),aa=n.n(na),ra=n(87726),oa=n.n(ra),la=n(59001),ia=n.n(la),sa=n(26707),ca=n.n(sa),ua=n(30381),da=n.n(ua),ma=n(45514),pa=n.n(ma),ga=n(65947),fa={};fa.styleTagTransform=B(),fa.setAttributes=R(),fa.insert=j().bind(null,"head"),fa.domAPI=x(),fa.insertStyleElement=_();N()(ga.Z,fa),ga.Z&&ga.Z.locals&&ga.Z.locals;function ya(){return ya=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},ya.apply(this,arguments)}var ha=({layer:e,...t})=>{const[n,o]=(0,a.useState)(e.getSource()?.getParams().TIME),[l,i]=(0,a.useState)(),[s,c]=(0,a.useState)(),[u,d]=(0,a.useState)(),{t:m}=(0,w.useTranslation)();(0,a.useEffect)((()=>{const t=e.get("dimension")?.values?.split(",");if(!t||0===t.length)return;i(t[0]),c(t[t.length-1]),o(t[t.length-1]);const n={};if(t.forEach(((e,t)=>{n[e]=da()(e).format("YYYY-MM-DD")})),d(n),"current"===t.default){let e=[NaN,""];Object.values(n).forEach((t=>{let n=da()().diff(da()(t));n<e[0]&&(e=[n,t])})),o(e[1])}}),[e]);return r().createElement("div",{className:"wms-time-slider"},r().createElement(de.Z,null,r().createElement(Ze.FontAwesomeIcon,{icon:Pe.SZw}),m("WmsTimeSlider.title")),u?r().createElement(pa(),ya({min:l,max:s,marks:u,value:n,onChange:t=>{o(t),e.getSource()?.updateParams({TIME:t})},step:null},t)):r().createElement("span",null,m("WmsTimeSlider.warning")))},wa=n(11382),Ea=n(13013),ba=n(86954),va=n.n(ba);function ka(){return ka=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},ka.apply(this,arguments)}var La=({layer:e,visibleLegendsIds:t,setVisibleLegendsIds:n,...l})=>{const[i,s]=(0,a.useState)(!1),[c,u]=(0,a.useState)(!1),m=se(),g=(0,T.useMap)(),{t:f}=(0,w.useTranslation)(),y=e.get("downloadConfig")??null,h=async()=>{if(g){u(!0);try{let t=await va().getExtentForLayer(e,{headers:e.get("useBearerToken")?{...(0,Mt.getBearerTokenHeader)(m?.getKeycloak())}:{}});t=(0,Le.transformExtent)(t,"EPSG:4326",g.getView().getProjection()),g.getView().fit(t)}catch(e){J().error(e),o.Z.error({message:f("LayerTreeContextMenu.extentError")})}finally{u(!1)}}},E=e=>{const t=[e];for(const n of e.getLayers().getArray())n instanceof p()&&t.push(...E(n));return t},b=e=>{const t=(e=>g?E(g.getLayerGroup()).filter((t=>t.getLayers().getArray().includes(e))):[])(e);t.forEach((t=>t.getLayers().remove(e)))},v=()=>{if(!g)return;b(e);const t=S().getLayerByName(g,f("AddLayerModal.externalWmsFolder")),n=S().getLayerByName(g,f("UploadDataModal.uploadedDataFolder"));t&&0===t.getLayers().getLength()&&b(t),n&&0===n.getLayers().getLength()&&b(n)},k=async t=>{if(!e)return;const n={method:"GET",headers:{...e.get("useBearerToken")?{...(0,Mt.getBearerTokenHeader)(m?.getKeycloak())}:void 0}},a=await fetch(t,n),r=await a.blob(),o=document.createElement("a");o.href=URL.createObjectURL(r),o.setAttribute("download",e.get("name")),o.click()};let L=[];(0,An.isWmsLayer)(e)&&L.push({label:r().createElement(wa.Z,{spinning:c},f("LayerTreeContextMenu.layerZoomToExtent")),key:"zoomToExtent"});const M=t.includes((0,d.getUid)(e));if((0,An.isWmsLayer)(e)&&e.getVisible()&&L.push({label:f(M?"LayerTreeContextMenu.hideLegend":"LayerTreeContextMenu.showLegend"),key:"toggleLegend"}),(e.get("isExternalLayer")||e.get("isUploadedLayer"))&&L.push({label:f("LayerTreeContextMenu.removeLayer"),key:"removeExternal"}),y){const e=y.map((e=>({label:f("LayerTreeContextMenu.downloadLayer",{formatName:e.formatName??"XML"}),key:`downloadLayer|${encodeURI(e.downloadUrl)}`})));L.push(...e)}return r().createElement(Ea.Z,ka({menu:{items:L,onClick:a=>{if(a?.key.startsWith("downloadLayer")){const e=a.key.split("|")[1];k(decodeURI(e))}switch(a?.key){case"zoomToExtent":h();break;case"removeExternal":v();break;case"toggleLegend":const a=(0,d.getUid)(e),r=[...t];r.includes(a)?r.splice(r.indexOf(a),1):r.push(a),n(r)}s(!1)}},placement:"bottomLeft",onOpenChange:s,open:i,trigger:["click"]},l),r().createElement(Ze.FontAwesomeIcon,{icon:Pe.iV1}))},Sa=n(79770),Ta={};Ta.styleTagTransform=B(),Ta.setAttributes=R(),Ta.insert=j().bind(null,"head"),Ta.domAPI=x(),Ta.insertStyleElement=_();N()(Sa.Z,Ta),Sa.Z&&Sa.Z.locals&&Sa.Z.locals;function Ma(){return Ma=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Ma.apply(this,arguments)}var Ca=({...e})=>{const t=(0,T.useMap)(),n=se(),{t:o}=(0,w.useTranslation)(),[l,i]=(0,a.useState)([]),[s,c]=(0,a.useState)({});(0,a.useEffect)((()=>{if(!t)return;const e=S().getAllLayers(t);return e.forEach((e=>{if(e instanceof aa()){const t=e.getSource();t.hasListener("tileloadstart")||t.on("tileloadstart",u),t.hasListener("tileloadend")||t.hasListener("tileloaderror")||t.on(["tileloadend","tileloaderror"],m)}})),()=>{e.forEach((e=>{if(e instanceof aa()){const t=e.getSource();t.hasListener("tileloadstart")&&t.un("tileloadstart",u),t.hasListener("tileloadend")&&t.un("tileloadend",m),t.hasListener("tileloaderror")&&t.un("tileloaderror",m)}}))}}),[t]);const u=e=>{c((t=>{const n=parseInt((0,d.getUid)(e.target),10),a={...t};return a[n]&&a[n].loaded>=a[n].loading?(a[n].loading=1,a[n].loaded=0,a[n].percent=0,a):(a[n]||(a[n]={loading:0,loaded:0,percent:0}),a[n].loading=Number.isInteger(a[n].loading)?a[n].loading+1:1,a)}))},m=e=>{c((t=>{const n=parseInt((0,d.getUid)(e.target),10),a={...t};a[n]||(a[n]={loading:0,loaded:0,percent:0}),a[n].loaded=Number.isInteger(a[n].loaded)?a[n].loaded+1:1;const r=Math.round(a[n].loaded/a[n].loading*100);return r>a[n].percent&&(a[n].percent=r),a}))};return t?r().createElement(oa(),Ma({className:"layertree",map:t,nodeTitleRenderer:e=>{if(!t)return;const a=t.getView(),c=a.getProjection().getUnits()||"m",u=a.getResolution(),m=u?S().getScaleForResolution(u,c):void 0,g=e instanceof aa()&&(0,d.getUid)(e.getSource())?s[(0,d.getUid)(e.getSource())]?.percent:100;return e instanceof p()?r().createElement("div",null,e.get("name")):r().createElement(r().Fragment,null,r().createElement("div",{className:"tree-node-header"},r().createElement(ta.Z,{className:"loading-indicator",type:"circle",percent:g,format:()=>"",width:16,strokeWidth:20}),r().createElement("span",null,e.get("name")),(e instanceof h()||e instanceof f())&&r().createElement(La,{layer:e,visibleLegendsIds:l,setVisibleLegendsIds:i})),e.get("visible")&&r().createElement("div",{className:"layer-transparency"},r().createElement(ca(),{tooltip:{formatter:e=>`${o("LayerTree.transparency")}: ${e}%`},layer:e})),e.get("visible")&&"WMSTime"===e.get("type")&&r().createElement("div",{className:"layer-time-slider"},r().createElement(ha,{layer:e})),e.get("visible")&&l.includes((0,d.getUid)(e))&&r().createElement(ia(),{layer:e,errorMsg:o("LayerTree.noLegendAvailable"),extraParams:{scale:m,LEGEND_OPTIONS:"fontAntiAliasing:true;forceLabels:on",TRANSPARENT:!0},headers:e.get("useBearerToken")?{...(0,Mt.getBearerTokenHeader)(n?.getKeycloak())}:{}}))},filterFunction:e=>e.getLayers?!e.get("hideInLayerTree"):!e.getSource||!e.getSource()?.forEachFeature,draggable:!0},e)):r().createElement(r().Fragment,null)},Pa=n(75357),Za=n.n(Pa),Aa=n(85415),Fa={};Fa.styleTagTransform=B(),Fa.setAttributes=R(),Fa.insert=j().bind(null,"head"),Fa.domAPI=x(),Fa.insertStyleElement=_();N()(Aa.Z,Fa),Aa.Z&&Aa.Z.locals&&Aa.Z.locals;var Oa=({showMeasureDistance:e,showMeasureArea:t})=>{const{t:n}=(0,w.useTranslation)(),a=(0,T.useMap)();return a?r().createElement(cn(),null,e?r().createElement(Za(),{geodesic:!0,name:"line",map:a,measureType:"line",type:"link",continueLineMsg:n("Measure.clicktodrawline")},r().createElement(Ze.FontAwesomeIcon,{icon:Pe.SoD}),r().createElement("span",{className:"measure-text"},n("Measure.line"))):r().createElement(r().Fragment,null),t?r().createElement(Za(),{geodesic:!0,name:"poly",map:a,measureType:"polygon",type:"link",continuePolygonMsg:n("Measure.clicktodrawarea")},r().createElement(Ze.FontAwesomeIcon,{icon:Pe.ubJ}),r().createElement("span",{className:"measure-text"},n("Measure.area"))):r().createElement(r().Fragment,null)):r().createElement(r().Fragment,null)},Na=n(35818),Ia={};Ia.styleTagTransform=B(),Ia.setAttributes=R(),Ia.insert=j().bind(null,"head"),Ia.domAPI=x(),Ia.insertStyleElement=_();N()(Na.Z,Ia),Na.Z&&Na.Z.locals&&Na.Z.locals;function xa(){return xa=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},xa.apply(this,arguments)}const{Panel:Da}=Ge.default;var ja=({...e})=>{const{t:t}=(0,w.useTranslation)(),n=(0,T.useMap)(),o=le(),l=P(),s=A((e=>e.toolMenu.availableTools)),c=A((e=>e.toolMenu.activeKeys)),u=se(),d=u?.getKeycloak(),[m,p]=(0,a.useState)(!1),[g,f]=(0,a.useState)([]);(0,a.useEffect)((()=>{const e=window.matchMedia("only screen and (max-width: 450px) and (orientation: portrait),only screen and (max-width: 750px) and (orientation: landscape), only screen and (max-width: 580px)"),t=new RegExp("/Mobile|iP(hone|od|ad)|Android|BlackBerry|IEMobile|Kindle|NetFront|Silk-Accelerated|(hpw|web)OS|Fennec|Minimo|Opera M(obi|ini)|Blazer|Dolfin|Dolphin|Skyfire|Zune/");(e.matches||t.test(window.navigator.userAgent))&&p(!0)}),[]),(0,a.useEffect)((()=>{g.length<1&&(s.includes("default")?f(["measure_tools","draw_tools","feature_info","print","tree","permalink","language_selector"]):f(s))}),[g,s]),(0,a.useEffect)((()=>{c.includes("print")&&c.includes("measure_tools")&&(c.indexOf("print")<c.indexOf("measure_tools")?l((0,Xe.wG)(c.filter((e=>"print"!==e)))):l((0,Xe.wG)(c.filter((e=>"measure_tools"!==e)))))}),[c,l]);const y=e=>{switch(e){case"measure_tools":return{icon:Pe.KxN,title:t("ToolMenu.measure"),wrappedComponent:r().createElement(Oa,{showMeasureDistance:s.includes("default")||s.includes("measure_tools_distance"),showMeasureArea:s.includes("default")||s.includes("measure_tools_area")})};case"draw_tools":return{icon:Pe.ubJ,title:t("ToolMenu.draw"),wrappedComponent:r().createElement(Mn,{showDrawPoint:s.includes("default")||s.includes("draw_tools_point"),showDrawLine:s.includes("default")||s.includes("draw_tools_line"),showDrawPolygon:s.includes("default")||s.includes("draw_tools_polygon"),showDrawCircle:s.includes("default")||s.includes("draw_tools_circle"),showDrawRectangle:s.includes("default")||s.includes("draw_tools_rectangle"),showDrawAnnotation:s.includes("default")||s.includes("draw_tools_annotation"),showModifyFeatures:s.includes("default")||s.includes("draw_tools_modify"),showUploadFeatures:s.includes("default")||s.includes("draw_tools_upload"),showDownloadFeatures:s.includes("default")||s.includes("draw_tools_download"),showDeleteFeatures:s.includes("default")||s.includes("draw_tools_delete")})};case"feature_info":return{icon:Pe.kwz,title:t("ToolMenu.featureInfo"),wrappedComponent:r().createElement(ea,{enabled:c.includes("feature_info")})};case"print":return{icon:Pe.kwI,title:t("ToolMenu.print"),wrappedComponent:n?r().createElement(qt,{active:c.includes("print"),map:n,layerBlackList:["react-geo_measure","hoverVectorLayer"]}):r().createElement(r().Fragment,null)};case"tree":return{icon:Pe.aC2,title:t("ToolMenu.layertree"),wrappedComponent:r().createElement("div",{className:"tree-wrapper"},r().createElement(Ca,null),r().createElement(i.Z,{className:"add-wms-button tool-menu-button",icon:r().createElement(Ze.FontAwesomeIcon,{icon:Pe.r8p}),onClick:()=>l((0,F.$Z)())},t("ToolMenu.addWms")),d&&qe().geoserver?.upload?.authorizedRoles?.some((e=>d.hasResourceRole(e,d.clientId)))&&r().createElement(i.Z,{className:"upload-data-button tool-menu-button",icon:r().createElement(Ze.FontAwesomeIcon,{icon:Pe.cf$}),onClick:()=>l((0,et.$Z)())},t("ToolMenu.uploadData")))};case"permalink":return{icon:Pe.M6U,title:t("Permalink.title"),wrappedComponent:r().createElement(yt,null)};case"language_selector":return{icon:Pe.BCn,title:t("ToolMenu.languageSelect"),wrappedComponent:r().createElement(ot,null)}}};return r().createElement("div",{className:"tool-menu "+(m?"collapsed":"")},r().createElement(Ge.default,xa({expandIconPosition:"end",activeKey:c,destroyInactivePanel:!0,onChange:e=>{p(!1),l((0,Xe.wG)(Qe()(e)))}},e),(()=>{const e=[];return g.forEach((t=>{const n=y(t);if(!n)return;const{icon:a,title:o,wrappedComponent:l}=n,i=r().createElement(Da,{className:t,header:r().createElement(r().Fragment,null,a?r().createElement(Ze.FontAwesomeIcon,{icon:a}):void 0,r().createElement("span",null,o)),key:t},l);e.push(i)})),o&&o.forEach((n=>{if((a=n.integration)&&"tool-menu"===a.placement){const{key:a,wrappedComponent:o,integration:{placement:l,label:i="Plugin",insertionIndex:s,icon:c,...u}}=n;e.splice(s||0,0,r().createElement(Da,xa({header:r().createElement(r().Fragment,null,c?r().createElement(Ze.FontAwesomeIcon,{icon:c}):void 0,r().createElement("span",null,t(i))),key:a},u),r().createElement(o,null)))}var a})),e})()),r().createElement(He.Z,{placement:"right",title:t(m?"ToolMenu.expand":"ToolMenu.collapse")},r().createElement(i.Z,{className:"collapse-btn",icon:m?r().createElement(Ze.FontAwesomeIcon,{icon:Pe._tD}):r().createElement(Ze.FontAwesomeIcon,{icon:Pe.A35}),onClick:()=>{l((0,Xe.wG)([])),p(!m)}})))},Ua=n(93009),Ra=n(28837),za=n(65352),_a={};_a.styleTagTransform=B(),_a.setAttributes=R(),_a.insert=j().bind(null,"head"),_a.domAPI=x(),_a.insertStyleElement=_();N()(za.Z,_a),za.Z&&za.Z.locals&&za.Z.locals;function $a(){return $a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},$a.apply(this,arguments)}const{Dragger:Ba}=Ua.default;var Va=({...e})=>{const[t,n]=(0,a.useState)(""),[o,i]=(0,a.useState)(""),[s,c]=(0,a.useState)(!1),u=A((e=>e.uploadDataModal.visible)),d=A((e=>e.user)),m=P(),g=(0,T.useMap)(),f=se(),{t:y}=(0,w.useTranslation)(),h=e=>({0:null,1:"org.locationtech.jts.geom.Point",3:"org.locationtech.jts.geom.LineString",5:"org.locationtech.jts.geom.Polygon",8:"org.locationtech.jts.geom.MultiPoint",11:"org.locationtech.jts.geom.Point",13:"org.locationtech.jts.geom.LineString",15:"org.locationtech.jts.geom.Polygon",18:"org.locationtech.jts.geom.MultiPoint",21:"org.locationtech.jts.geom.Point",23:"org.locationtech.jts.geom.LineString",25:"org.locationtech.jts.geom.Polygon",28:"org.locationtech.jts.geom.MultiPoint",31:null}[e]),E=e=>{switch(e){case"C":return"java.lang.String";case"D":return"java.util.Date";case"N":return"java.lang.Long";case"F":return"java.lang.Double";case"L":return"java.lang.Boolean";default:return null}};return r().createElement(l.Z,$a({className:"upload-data-modal",title:y("UploadDataModal.title"),open:u,onCancel:()=>{n(""),i(""),m((0,et.Cp)())},width:600,footer:!1},e),o&&r().createElement(wt.Z,{message:o,closable:!0,type:"success"}),t&&r().createElement(wt.Z,{message:t,closable:!0,type:"error"}),r().createElement(wa.Z,{spinning:s},r().createElement(Ba,{customRequest:async e=>{const{onError:t,onSuccess:n,file:a}=e,r=a.name.split("."),o=a.type,l=qe().geoserver?.base||"/geoserver",i=qe().geoserver?.upload?.workspace||"SHOGUN",s=`${r[0]}_${Date.now()}`.toUpperCase(),c={file:a,baseUrl:l,workspace:i,storeName:s,layerName:s};try{"image/tiff"===o&&await(async e=>{const{baseUrl:t,workspace:n,storeName:a,layerName:r,file:o}=e,l=`${t}/rest/workspaces/${n}/coveragestores/${a}/file.geotiff?configure=none`;if(!(await fetch(l,{method:"PUT",headers:{...(0,Mt.getBearerTokenHeader)(f?.getKeycloak()),"Content-Type":"image/tiff"},body:o})).ok)throw new Error(y("UploadDataModal.error.general",{fileName:o.name}));const i=`${t}/rest/workspaces/${n}/coveragestores/${a}/coverages`;if(!(await fetch(i,{method:"POST",headers:{...(0,Mt.getBearerTokenHeader)(f?.getKeycloak()),"Content-Type":"application/json"},body:JSON.stringify({coverage:{enabled:!0,name:r,nativeName:r,title:r,keywords:{string:["User upload",`Uploaded by ${d.providerDetails?.username}`]}}})})).ok)throw new Error(y("UploadDataModal.error.general",{fileName:o.name}))})(c),"application/zip"===o&&await(async e=>{const{baseUrl:t,workspace:n,storeName:a,layerName:r,file:o}=e,l=await Ra.Uv.load(o);let i="",s={attribute:[]};if(1!==Object.entries(l).length)throw new Error(y("UploadDataModal.error.zipContent"));Object.entries(l).forEach((([e,t])=>{i=e;const n=t.parse("dbf",{properties:!1});s.attribute=n.fields.map((e=>({name:e.name,minOccurs:0,maxOccurs:1,nillable:!0,binding:E(e.type),length:e.length})));const a=t.parse("shx");s.attribute.push({name:"the_geom",minOccurs:0,maxOccurs:1,nillable:!0,binding:h(a.header.type)})}));const c=`${t}/rest/workspaces/${n}/datastores/${a}/file.shp?configure=none`;if(!(await fetch(c,{method:"PUT",headers:{...(0,Mt.getBearerTokenHeader)(f?.getKeycloak()),"Content-Type":"application/zip"},body:o})).ok)throw new Error(y("UploadDataModal.error.general",{fileName:o.name}));const u=`${t}/rest/workspaces/${n}/datastores/${a}/featuretypes`;if(!(await fetch(u,{method:"POST",headers:{...(0,Mt.getBearerTokenHeader)(f?.getKeycloak()),"Content-Type":"application/json"},body:JSON.stringify({featureType:{enabled:!0,name:r,nativeName:i,title:r,attributes:s,keywords:{string:["User upload",`Uploaded by ${d.providerDetails?.username}`]}}})})).ok)throw new Error(y("UploadDataModal.error.general",{fileName:o.name}))})(c),n&&n({baseUrl:l,workspace:i,layerName:s})}catch(e){t&&t({name:"UploadError",message:e instanceof Error?e.message:y("UploadDataModal.error.general",{fileName:a.name})})}},accept:"image/tiff,application/zip",maxCount:1,showUploadList:!1,beforeUpload:e=>{const t=qe().geoserver?.upload?.limit||2e8,a=e.type,r=e.size;if(n(""),i(""),r>t)return n(y("UploadDataModal.error.maxSize",{maxSize:t/1e6})),!1;const o=["application/zip","image/tiff"];return!!o.includes(a)||(n(y("UploadDataModal.error.supportedFormats",{supportedFormats:o.join(", ")})),!1)},onChange:async e=>{const t=e.file;if("uploading"===t.status&&c(!0),"done"===t.status){if(!f||!t.response)return;const e={name:t.response.layerName,type:"TILEWMS",clientConfig:{hoverable:!0},sourceConfig:{url:`${t.response.baseUrl}/ows?`,layerNames:`${t.response.workspace}:${t.response.layerName}`,useBearerToken:!0}},n=new(ae())({client:f}).parseTileLayer(e);n.set("layerConfig",e),n.set("isUploadedLayer",!0),n.set("groupName",y("UploadDataModal.uploadedDataFolder")),(e=>{if(!g)return;const t=y("UploadDataModal.uploadedDataFolder");let n=S().getLayerByName(g,t);if(!n){n=new(p())({layers:[],properties:{name:t}});const e=g.getLayerGroup().getLayers();e.insertAt(e?.getLength()||0,n)}n.getLayers().getArray().includes(e)||n.getLayers().push(e)})(n),i(y("UploadDataModal.success",{fileName:t.name,layerName:t.response.layerName})),c(!1)}else"error"===t.status&&(c(!1),J().error(t.error),t.error&&t.error.message?n(t.error.message):n(y("UploadDataModal.error.general",{fileName:t.name})))}},r().createElement("p",{className:"ant-upload-drag-icon"},r().createElement(Ze.FontAwesomeIcon,{icon:Pe.cf$})),r().createElement("p",{className:"ant-upload-text"},y("UploadDataModal.description")),r().createElement("p",{className:"ant-upload-hint"},y("UploadDataModal.hint")))))},Ka=n(65705),Wa={};Wa.styleTagTransform=B(),Wa.setAttributes=R(),Wa.insert=j().bind(null,"head"),Wa.domAPI=x(),Wa.insertStyleElement=_();N()(Ka.Z,Wa),Ka.Z&&Ka.Z.locals&&Ka.Z.locals;function Ga(){return Ga=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Ga.apply(this,arguments)}const Ha=({...e})=>((0,a.useEffect)((()=>{const e=document.querySelectorAll(".loadmask")[0];e&&e.classList.add("loadmask-hidden")}),[]),r().createElement("div",Ga({className:"App"},e),r().createElement(We,null),r().createElement(ue,null),r().createElement(ja,null),r().createElement(ke,null),r().createElement(G,null),r().createElement(Va,null)));var Ya=Ha},17649:function(e,t,n){"use strict";n.r(t);var a=n(96985),r=n.n(a),o=n(38648),l=n(88182),i=n(76772),s=n(17699),c=n(67502),u=n(87617),d=n.n(u),m=n(6767),p=n.n(m),g=n(94671),f=n(8266),y=n(9479),h=n.n(y),w=n(49862),E=n.n(w),b=n(22901),v=n.n(b),k=n(90426),L=n(14447),S=n.n(L),T=n(28523),M=n.n(T),C=n(83539),P=n.n(C),Z=n(20563),A=n(47139),F=n(12038),O=n.n(F),N=n(92212),I=n.n(N),x=n(29577),D=n.n(x),j=n(73161),U=n.n(j),R=n(12665),z=n.n(R),_=n(76688),$=n(77257),B=n(35895),V=n(97168);const K=(0,V.oM)({name:"appInfo",initialState:{authorities:[],buildTime:"",commitHash:"",userId:-1,version:""},reducers:{setAppInfo(e,t){return t.payload}}}),{setAppInfo:W}=K.actions;var G=K.reducer;const H=(0,V.oM)({name:"description",initialState:"",reducers:{setDescription:(e,t)=>t.payload}}),{setDescription:Y}=H.actions;var q=H.reducer;const J={contact:"https://www.terrestris.de/de/kontakt/",imprint:"https://www.terrestris.de/de/impressum/",privacy:"https://www.terrestris.de/de/datenschutzerklaerung/"},Q=(0,V.oM)({name:"legal",initialState:J,reducers:{setLegal:(e,t)=>({contact:t.payload.contact||J.contact,imprint:t.payload.imprint||J.imprint,privacy:t.payload.privacy||J.privacy})}}),{setLegal:X}=Q.actions;var ee=Q.reducer;const te=(0,V.oM)({name:"logoPath",initialState:"./shogun_logo.png",reducers:{setLogoPath:(e,t)=>t.payload}}),{setLogoPath:ne}=te.actions;var ae=te.reducer,re=n(14890),oe=n(20908),le=n(21800);const ie=(0,V.oM)({name:"title",initialState:"SHOGun Client",reducers:{setTitle:(e,t)=>t.payload}}),{setTitle:se}=ie.actions;var ce=ie.reducer,ue=n(76712),de=n(63221);const me=(0,V.oM)({name:"user",initialState:{},reducers:{setUser(e,t){return t.payload}}}),{setUser:pe}=me.actions;var ge=me.reducer;const fe=e=>(0,re.UY)({appInfo:G,title:ce,description:q,legal:ee,logoPath:ae,toolMenu:ue.ZP,addLayerModal:oe.ZP,user:ge,selectedFeatures:le.ZP,uploadDataModal:de.ZP,...e}),ye=(0,V.xC)({reducer:fe()});var he=n(93379),we=n.n(he),Ee=n(7795),be=n.n(Ee),ve=n(90569),ke=n.n(ve),Le=n(3565),Se=n.n(Le),Te=n(19216),Me=n.n(Te),Ce=n(44589),Pe=n.n(Ce),Ze=n(90978),Ae={};Ae.styleTagTransform=Pe(),Ae.setAttributes=Se(),Ae.insert=ke().bind(null,"head"),Ae.domAPI=be(),Ae.insertStyleElement=Me();we()(Ze.Z,Ae),Ze.Z&&Ze.Z.locals&&Ze.Z.locals;const Fe=r().lazy((()=>Promise.all([n.e(987),n.e(592),n.e(317)]).then(n.bind(n,46582)))),Oe=new(z())({url:d().shogunBase||"/"}),Ne=new(U())({client:Oe}),Ie=e=>{switch(e){case"en":default:return c.Z;case"de":return s.Z}},xe=async e=>{const t=await Ne.parseMapView(e,{constrainOnlyCenter:!0});let n;const a=e.clientConfig?.mapView.projection,r=e.clientConfig?.mapView;if(a&&r?.extent&&4===r.extent.length){const e=(0,k.fromLonLat)([r.extent[0],r.extent[1]],a),t=(0,k.fromLonLat)([r.extent[2],r.extent[3]],a);n=[e[0],e[1],t[0],t[1]]}n&&t.set("extent",n),t.setConstrainResolution(!0);const o=await Ne.parseLayerTree(e,a);return new(v())({view:t,layers:o,controls:(0,f.defaults)({zoom:!1})})},De=()=>{const e=new(E())({source:new(S())});e.set("name","OpenStreetMap");const t=new(E())({opacity:.5,visible:!0,source:new(M())({url:"https://gibs.earthdata.nasa.gov/wms/epsg3857/best/wms.cgi",projection:"EPSG:3857",params:{LAYERS:"MERRA2_2m_Air_Temperature_Assimilated_Monthly"}})});t.setProperties({name:"2-meter Air Temperature, Assimilated (Monthly, MERRA2)",hoverable:!0});const n=new(h())({layers:[t]});n.set("name","NASA Earth Observations");const a=new(h())({layers:[e]});a.set("name","Background");const r=(0,k.fromLonLat)([0,40],"EPSG:3857");return new(v())({view:new(P())({center:r,zoom:0}),layers:[a,n],controls:(0,f.defaults)({zoom:!1})})},je=async(e,t,a)=>{await n.I("default"),await new Promise(((e,n)=>{const a=document.createElement("script");a.src=t,a.type="text/javascript",a.async=!0,a.onload=()=>{a.parentElement?.removeChild(a),e()},a.onerror=e=>{a.parentElement?.removeChild(a),n(e)},document.head.appendChild(a)}));const r=window[e];await r.init(n.S.default);const o=[];for(const e of a){const t=(await r.get(e))();o.push(t)}return o};(async()=>{try{const e=await(async()=>{const e=d().keycloak?.enabled,t=d().keycloak?.onLoadAction,n=d().keycloak?.host,a=d().keycloak?.realm,r=d().keycloak?.clientId;if(!e)return;if(!n)throw new Error("Neither config key keycloak.host nor environment KEYCLOAK_HOST is set");if(!a)throw new Error("Neither config key keycloak.realm nor environment KEYCLOAK_REALM is set");if(!r)throw new Error("Neither config key keycloak.clientId nor environment KEYCLOAK_CLIENT_ID is set");const o=new g.Z({url:`${n}`,realm:a,clientId:r});return o.onTokenExpired=async()=>{try{await o.updateToken(0)}catch(e){O().error("Error while refreshing the access token: ",e)}},await o.init({onLoad:t}),o})();e&&Oe.setKeycloak(e);const t=await(async()=>{const e=I().getQueryParam(window.location.href,"applicationId");if(e)try{O().info(`Loading application with ID ${e}`);const t=await Oe.application().findOne(e);return O().info(`Successfully loaded application with ID ${e}`),t}catch(t){O().error(`Error while loading application with ID ${e}: ${t}`),o.Z.error({message:B.Z.t("Index.applicationLoadErrorMessage"),description:B.Z.t("Index.applicationLoadErrorDescription",{applicationId:e}),duration:0})}else O().info("No application ID given, can't load any configuration.")})(),n=t?.clientConfig?.defaultLanguage;!localStorage.getItem("i18nextLng")&&n&&B.Z.changeLanguage(n);const a=(e=>{const t={"--primaryColor":"#59666C","--secondaryColor":"#70B3BE","--complementaryColor":"#FFFFFF"};return e?(e.primaryColor&&(t["--primaryColor"]=e.primaryColor),e.secondaryColor&&(t["--secondaryColor"]=e.secondaryColor),e.secondaryColor&&(t["--complementaryColor"]=e.complementaryColor),t):t})(t?.clientConfig?.theme);l.ZP.config({theme:{primaryColor:p()(a["--primaryColor"]).isLight()?p()(a["--primaryColor"]).darken(.5).hexa():a["--primaryColor"]}}),Object.keys(a).forEach((e=>{document.body.style.setProperty(e,a[e])})),ye.subscribe((()=>{document.title=ye.getState().title})),(async e=>{if(e){if(e.name&&ye.dispatch(se(e.name)),e.clientConfig?.description&&ye.dispatch(Y(e.clientConfig?.description)),e.clientConfig?.legal&&ye.dispatch(X(e.clientConfig.legal)),e?.clientConfig?.theme?.logoPath&&ye.dispatch(ne(e.clientConfig.theme.logoPath)),e.toolConfig&&e.toolConfig.length>0){const t=[];e.toolConfig.map((e=>{e.config.visible&&t.push(e.name)})),ye.dispatch((0,ue.nn)(t))}}else O().info("No application configuration provided, the default store will be loaded")})(t);const i=await(async()=>{try{O().info("Loading application info");const e=await Oe.info().getAppInfo();return O().info("Successfully loaded application info"),e}catch(e){O().error("Error while loading application info: ",e)}})();(async e=>{e&&ye.dispatch(W(e))})(i);(async e=>{e&&ye.dispatch(pe(e))})(await(async e=>{if(e)try{O().info(`Loading user with ID ${e}`);const t=await Oe.user().findOne(e);return O().info(`Successfully loaded user with ID ${e}`),t}catch(t){O().error(`Error while loading user with ID ${e}: `,t)}else O().info("No user ID given, can't load it's details.")})(i?.userId));const s=await(async e=>e?await xe(e):(O().info("No application configuration provided, the default map will be loaded"),De()))(t),c=await(async e=>{if(!d().plugins||0===d().plugins.length)return O().info("No plugins found"),[];O().info("Loading plugins");const t=[];for(const n of d().plugins){const a=n.name,o=n.resourcePath,l=n.exposedPaths;if(!a)return O().error("Required plugin configuration 'name' is not set"),t;if(!o)return O().error("Required plugin configuration 'resourcePath' is not set"),t;if(!l)return O().error("Required plugin configuration 'exposedPaths' is not set"),t;let i;O().info(`Loading plugin ${a} (with exposed paths ${l.join(" and ")}) from ${o}`);try{i=await je(a,o,l),O().info(`Successfully loaded plugin ${a}`)}catch(e){return O().error(`Could not load plugin ${a}:`,e),t}i.forEach((n=>{const a=n.default,o=a.component;if(a.wrappedComponent=()=>r().createElement(o,{map:e,client:Oe}),a.i18n&&Object.entries(a.i18n).forEach((e=>{const t=e[0],n=e[1].translation;B.Z.addResourceBundle(t,"translation",n,!0,!0)})),a.reducers){const e=fe(a.reducers);ye.replaceReducer(e)}t.push(a)}))}return t})(s);(0,Z.render)(r().createElement(r().StrictMode,null,r().createElement(r().Suspense,{fallback:r().createElement("span",null)},r().createElement($.rA,{client:Oe},r().createElement(_.ol,{plugins:c},r().createElement(l.ZP,{locale:Ie(B.Z.language)},r().createElement(A.Provider,{store:ye},r().createElement(D().Provider,{value:s},r().createElement(Fe,null)))))))),document.getElementById("app"))}catch(e){const t=document.querySelectorAll(".loadmask")[0];t&&t.classList.add("loadmask-hidden"),O().error(e),(0,Z.render)(r().createElement(r().StrictMode,null,r().createElement(i.Z,{className:"error-boundary",message:B.Z.t("Index.errorMessage"),description:B.Z.t("Index.errorDescription"),type:"error",showIcon:!0})),document.getElementById("app"))}})()},76688:function(e,t,n){"use strict";n.d(t,{ol:function(){return l}});var a=n(96985),r=n.n(a);const o=r().createContext([]),l=({plugins:e,children:t})=>r().createElement(o.Provider,{value:e},t);t.ZP=o},77257:function(e,t,n){"use strict";n.d(t,{rA:function(){return l}});var a=n(96985),r=n.n(a);const o=r().createContext(null),l=({client:e,children:t})=>r().createElement(o.Provider,{value:e},t);t.ZP=o},35895:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var a=n(36609),r=n(15059),o=n(60110);a.ZP.use(r.Z).use(o.initReactI18next).init({resources:{de:{translation:{ApplicationInfo:{title:"Über",clientVersionTitle:"Client Version",backendVersionTitle:"Backend Version"},AddLayerModal:{addSelectedLayers:"Auswahl hinzufügen",addAllLayers:"Alle hinzufügen",inputPlaceholder:"WMS GetCapabilities URL angeben…",externalWmsFolder:"Externe Themen",title:"WMS hinzufügen",columnTitle:"Name",errorMessage:"Fehler",errorDescription:"Das Capabilities Dokument konnte nicht geladen werden, bitte prüfen Sie die URL",version:"Version"},BasicMapComponent:{processedLayersFolder:"Prozessierte Layer"},Permalink:{title:"Teilen",twitterTooltip:"Link via Twitter teilen",whatsAppTooltip:"Link via WhatsApp teilen",mailTooltip:"Link via Mail teilen",copyTooltip:"Link in die Zwischenablage kopieren",copiedToClipboard:"Link wurde in Zwischenablage kopiert",copyToClipboardFailed:"Link konnte nicht kopiert werden"},Measure:{title:"Messen",line:"Entfernung",area:"Fläche",clicktodrawline:"Zum Zeichnen einer Linie klicken",clicktodrawarea:"Zum Zeichnen einer Fläche klicken"},Draw:{point:"Punkt",line:"Linie",polygon:"Polygon",circle:"Kreis",rectangle:"Rechteck",text:"Anmerkung",modify:"Bearbeitung",upload:"Hochladen",delete:"Löschen",export:"Exportieren"},StylingDrawer:{pickColor:"Farbschema bearbeiten",title:"Farbschema bearbeiten"},FeatureInfo:{usageHint:"Klicken Sie in die Karte, um Detailinformationen zu erhalten."},LayerTree:{transparency:"Transparenz",noLegendAvailable:"Keine Legende verfügbar"},LayerTreeContextMenu:{layerZoomToExtent:"Auf Layerausdehnung zoomen",extentError:"Konnte nicht auf die Layerausdehnung zoomen",removeLayer:"Layer entfernen",showLegend:"Legende anzeigen",hideLegend:"Legende ausblenden",downloadLayer:"Layer exportieren ({{formatName}})"},ToolMenu:{expand:"Menu ausklappen",collapse:"Menu einklappen",measure:"Messen",draw:"Zeichnen",featureInfo:"Karteninhalte abfragen",addWms:"WMS hinzufügen",uploadData:"Daten hochladen",print:"Export",layertree:"Karten",languageSelect:"Sprachauswahl"},PrintForm:{title:"Kartentitel",initialTitle:"Druckausgabe",titlePlaceholder:"Bitte geben Sie einen Titel ein",comment:"Bemerkung",commentPlaceholder:"Bitte geben Sie einen Kommentar ein",layout:"Vorlage",dpi:"Auflösung",format:"Format",scale:"Maßstab",downloadBtnText:"Ausdruck erzeugen",printJobErrorMsg:"Der Kartenausdruck konnte nicht erzeugt werden",initErrorMsg:"Der Kartendruck Generator konnte nicht initialisiert werden.",outputFormatPlaceholder:"Bitte wählen Sie ein Ausgabeformat aus",resolutionPlaceholder:"Bitte wählen Sie eine Ausgabequalität aus",managerErrorMessage:"Fehler bei der Initialisierung der Export-Engine"},Footer:{refSystem:"Bezugssystem",scale:"Maßstab",mousePosition:"Mausposition",imprint:"Impressum",contact:"Kontakt",privacypolicy:"Datenschutz"},Index:{applicationLoadErrorMessage:"Fehler beim Laden der Applikation",applicationLoadErrorDescription:"Die Applikation mit der ID {{applicationId}} konnte nicht geladen werden. Die Standardkonfiguration wird stattdessen geladen.",errorMessage:"Fehler beim Laden der Applikation",errorDescription:"Aufgrund eines unerwarteten Fehlers konnte die Applikation nicht geladen werden. Bitte laden Sie die Seite erneut."},Nominatim:{placeholder:"Ortsname, Straßenname, Stadtteilname, POI usw."},UserMenu:{settingsMenuTitle:"Profil bearbeiten",infoMenuTitle:"Über",logoutMenuTitle:"Ausloggen",loginMenuTitle:"Anmelden"},WmsTimeSlider:{title:"Zeitlicher Bezug",default:"Keine Daten gefunden"},UploadDataModal:{title:"Daten hochladen",uploadedDataFolder:"Hochgeladene Daten",description:"Klicken Sie oder ziehen Sie die Datei zum Hochladen in diesen Bereich",hint:"Unterstützte Dateiformate sind Shapefile (gebündelt als *.zip) und GeoTIFF",success:"Datei {{fileName}} wurde erfolgreich geladen und der Layer {{layerName}} erstellt",error:{general:"Fehler beim Hochladen der Datei {{fileName}}",maxSize:"Der Upload überschreitet das Limit von {{maxSize}} MB",supportedFormats:"Der Dateityp ist nicht unterstützt ({{supportedFormats}})",zipContent:"Mehrere Geodatensätze innerhalb eines Archivs sind nicht unterstützt"}}}},en:{translation:{ApplicationInfo:{title:"About",clientVersionTitle:"Client version",backendVersionTitle:"Backend version"},AddLayerModal:{addSelectedLayers:"Add selected",addAllLayers:"Add all",inputPlaceholder:"Enter a WMS GetCapabilities URL…",externalWmsFolder:"External layers",title:"Add WMS",columnTitle:"Name",errorMessage:"Error",errorDescription:"Could not load the provided Capabilities document, please check the validity of the URL",version:"Version"},BasicMapComponent:{processedLayersFolder:"Processed layers"},Permalink:{title:"Share",twitterTooltip:"Share link via Twitter",whatsAppTooltip:"Share link via WhatsApp",mailTooltip:"Share link via Mail",copyTooltip:"Copy link to Clipboard",copiedToClipboard:"Copied to clipboard",copyToClipboardFailed:"Could not copy link to clipboard"},Measure:{title:"Measure",line:"Distance",area:"Area",clicktodrawline:"Click to draw line",clicktodrawarea:"Click to draw area"},Draw:{point:"Point",line:"Line",polygon:"Polygon",circle:"Circle",rectangle:"Rectangle",text:"Annotation",modify:"Edit",upload:"Upload",delete:"Delete",export:"Export"},StylingDrawer:{pickColor:"Modify color scheme",title:"Modify color scheme"},FeatureInfo:{usageHint:"Click on the map to get details about the clicked coordinate."},LayerTree:{transparency:"Transparency",noLegendAvailable:"No legend available"},LayerTreeContextMenu:{layerZoomToExtent:"Zoom to layer extent",extentError:"Could not zoom to layer extent",removeLayer:"Remove layer",showLegend:"Show legend",hideLegend:"Hide legend",downloadLayer:"Export layer as {{formatName}}"},ToolMenu:{expand:"Expand",collapse:"Collapse",measure:"Measure",draw:"Draw",featureInfo:"Query map features",addWms:"Add WMS",uploadData:"Upload data",print:"Export",layertree:"Maps",languageSelect:"Language selector"},PrintForm:{title:"Title",initialTitle:"Title",titlePlaceholder:"Please input a title…",comment:"Comment",commentPlaceholder:"Please enter a comment…",layout:"Layout",dpi:"Resolution",format:"Format",scale:"Scale",downloadBtnText:"Create print",printJobErrorMsg:"Could not generate PDF output",initErrorMsg:"PDF Generator could not be initialized",outputFormatPlaceholder:"Please select an output format",resolutionPlaceholder:"Please select an output quality",managerErrorMessage:"Error while initializing the export engine"},Footer:{refSystem:"Reference system",scale:"Scale",mousePosition:"Mouse position",imprint:"Imprint",contact:"Contact",privacypolicy:"Privacy"},Index:{applicationLoadErrorMessage:"Error while loading the application",applicationLoadErrorDescription:"The application with ID {{applicationId}} could not be loaded correctly. You're seeing the default application configuration.",errorMessage:"Error while loading the application",errorDescription:"An unexpected error occured while loading the application. Please try to reload the page."},Nominatim:{placeholder:"Place name, street name, district name, POI, etc."},UserMenu:{settingsMenuTitle:"Edit profile",infoMenuTitle:"About",logoutMenuTitle:"Logout",loginMenuTitle:"Login"},WmsTimeSlider:{title:"Time reference",default:"No data found"},UploadDataModal:{title:"Upload data",uploadedDataFolder:"Uploaded data",description:"Click or drag file to this area to upload",hint:"Supported file formats are Shapefile (bundled as *.zip) and GeoTIFF",success:"Successfully uploaded file {{fileName}} and created layer {{layerName}}",error:{general:"Error while uploading file {{fileName}}",maxSize:"The file exceeds the upload limit of {{maxSize}} MB",supportedFormats:"The given file type does not match the supported ones ({{supportedFormats}})",zipContent:"Multiple geodatasets within one archive are not supported"}}}}},fallbackLng:"en",debug:!1,interpolation:{escapeValue:!1},supportedLngs:["de","en"],returnNull:!1});var l=a.ZP},21302:function(e,t,n){Promise.all([n.e(987),n.e(592),n.e(776)]).then(n.bind(n,17649))},20908:function(e,t,n){"use strict";n.d(t,{$Z:function(){return r},Cp:function(){return o}});const a=(0,n(97168).oM)({name:"addLayerModal",initialState:{visible:!1},reducers:{show(e){e.visible=!0},hide(e){e.visible=!1},toggle(e){e.visible=!e.visible}}}),{show:r,hide:o,toggle:l}=a.actions;t.ZP=a.reducer},21800:function(e,t,n){"use strict";n.d(t,{wl:function(){return r}});const a=(0,n(97168).oM)({name:"selectedFeatures",initialState:{},reducers:{setSelectedFeatures(e,t){return t.payload}}}),{setSelectedFeatures:r}=a.actions;t.ZP=a.reducer},76712:function(e,t,n){"use strict";n.d(t,{nn:function(){return o},wG:function(){return r}});const a=(0,n(97168).oM)({name:"toolMenu",initialState:{activeKeys:[],availableTools:["default"]},reducers:{setActiveKeys(e,t){e.activeKeys=[...t.payload]},setAvailableTools(e,t){e.availableTools=[...t.payload]}}}),{setActiveKeys:r,setAvailableTools:o}=a.actions;t.ZP=a.reducer},63221:function(e,t,n){"use strict";n.d(t,{$Z:function(){return r},Cp:function(){return o}});const a=(0,n(97168).oM)({name:"uploadDataModal",initialState:{visible:!1},reducers:{show(e){e.visible=!0},hide(e){e.visible=!1},toggle(e){e.visible=!e.visible}}}),{show:r,hide:o,toggle:l}=a.actions;t.ZP=a.reducer},65705:function(e,t,n){"use strict";var a=n(87537),r=n.n(a),o=n(23645),l=n.n(o)()(r());l.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]),t.Z=l},40171:function(e,t,n){"use strict";var a=n(87537),r=n.n(a),o=n(23645),l=n.n(o)()(r());l.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]),t.Z=l},88885:function(e,t,n){"use strict";var a=n(87537),r=n.n(a),o=n(23645),l=n.n(o)()(r());l.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]),t.Z=l},78415:function(e,t,n){"use strict";var a=n(87537),r=n.n(a),o=n(23645),l=n.n(o)()(r());l.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]),t.Z=l},62923:function(e,t,n){"use strict";var a=n(87537),r=n.n(a),o=n(23645),l=n.n(o)()(r());l.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]),t.Z=l},85677:function(e,t,n){"use strict";var a=n(87537),r=n.n(a),o=n(23645),l=n.n(o)()(r());l.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]),t.Z=l},10767:function(e,t,n){"use strict";var a=n(87537),r=n.n(a),o=n(23645),l=n.n(o)()(r());l.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]),t.Z=l},21015:function(e,t,n){"use strict";var a=n(87537),r=n.n(a),o=n(23645),l=n.n(o)()(r());l.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]),t.Z=l},7871:function(e,t,n){"use strict";var a=n(87537),r=n.n(a),o=n(23645),l=n.n(o)()(r());l.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]),t.Z=l},86092:function(e,t,n){"use strict";var a=n(87537),r=n.n(a),o=n(23645),l=n.n(o)()(r());l.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]),t.Z=l},16813:function(e,t,n){"use strict";var a=n(87537),r=n.n(a),o=n(23645),l=n.n(o)()(r());l.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]),t.Z=l},79770:function(e,t,n){"use strict";var a=n(87537),r=n.n(a),o=n(23645),l=n.n(o)()(r());l.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]),t.Z=l},85415:function(e,t,n){"use strict";var a=n(87537),r=n.n(a),o=n(23645),l=n.n(o)()(r());l.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]),t.Z=l},35818:function(e,t,n){"use strict";var a=n(87537),r=n.n(a),o=n(23645),l=n.n(o)()(r());l.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]),t.Z=l},65352:function(e,t,n){"use strict";var a=n(87537),r=n.n(a),o=n(23645),l=n.n(o)()(r());l.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]),t.Z=l},72285:function(e,t,n){"use strict";var a=n(87537),r=n.n(a),o=n(23645),l=n.n(o)()(r());l.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]),t.Z=l},65947:function(e,t,n){"use strict";var a=n(87537),r=n.n(a),o=n(23645),l=n.n(o)()(r());l.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]),t.Z=l},90978:function(e,t,n){"use strict";var a=n(87537),r=n.n(a),o=n(23645),l=n.n(o)()(r());l.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]),t.Z=l}}]);
//# sourceMappingURL=common.04df0a591b27b9c6264b.js.map