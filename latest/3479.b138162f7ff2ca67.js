"use strict";(self.webpackChunk_terrestris_shogun_gis_client=self.webpackChunk_terrestris_shogun_gis_client||[]).push([["3479"],{52209:function(t,e,i){let r;i.d(e,{Co:function(){return d},aA:function(){return c},rX:function(){return h},sY:function(){return g}});var n=i(21915),o=i(85386),s=i(5374),a=i(21882);let h=[];function l(t,e,i,r,n){t.beginPath(),t.moveTo(0,0),t.lineTo(e,i),t.lineTo(r,n),t.closePath(),t.save(),t.clip(),t.fillRect(0,0,Math.max(e,r)+1,Math.max(i,n)),t.restore()}function u(t,e){return Math.abs(t[4*e]-210)>2||Math.abs(t[4*e+3]-191.25)>2}function c(t,e,i,r){let o=(0,s.transform)(i,e,t),a=(0,s.getPointResolution)(e,r,i),h=e.getMetersPerUnit();void 0!==h&&(a*=h);let l=t.getMetersPerUnit();void 0!==l&&(a/=l);let u=t.getExtent();if(!u||(0,n.containsCoordinate)(u,o)){let e=(0,s.getPointResolution)(t,a,o)/a;isFinite(e)&&e>0&&(a/=e)}return a}function d(t,e,i,r){let o=c(t,e,(0,n.getCenter)(i),r);return(!isFinite(o)||o<=0)&&(0,n.forEachCorner)(i,function(i){return isFinite(o=c(t,e,i,r))&&o>0}),o}function g(t,e,i,s,c,d,g,f,_,m,W,x,p,E){let M;let v=(0,o.E4)(Math.round(i*t),Math.round(i*e),h);if(!x&&(v.imageSmoothingEnabled=!1),0===_.length)return v.canvas;function T(t){return Math.round(t*i)/i}v.scale(i,i),v.globalCompositeOperation="lighter";let P=(0,n.createEmpty)();_.forEach(function(t,e,i){(0,n.extend)(P,t.extent)});let F=i/s,b=(x?1:1.0000000596046448)/F;if(!p||1!==_.length||0!==m){if(M=(0,o.E4)(Math.round((0,n.getWidth)(P)*F),Math.round((0,n.getHeight)(P)*F),h),!x&&(M.imageSmoothingEnabled=!1),c&&E){let t=(c[0]-P[0])*F,e=-(c[3]-P[3])*F,i=(0,n.getWidth)(c)*F,r=(0,n.getHeight)(c)*F;M.rect(t,e,i,r),M.clip()}_.forEach(function(t,e,i){if(t.image.width>0&&t.image.height>0){if(t.clipExtent){M.save();let e=(t.clipExtent[0]-P[0])*F,i=-(t.clipExtent[3]-P[3])*F,r=(0,n.getWidth)(t.clipExtent)*F,o=(0,n.getHeight)(t.clipExtent)*F;M.rect(x?e:Math.round(e),x?i:Math.round(i),x?r:Math.round(e+r)-Math.round(e),x?o:Math.round(i+o)-Math.round(i)),M.clip()}let e=(t.extent[0]-P[0])*F,i=-(t.extent[3]-P[3])*F,r=(0,n.getWidth)(t.extent)*F,o=(0,n.getHeight)(t.extent)*F;M.drawImage(t.image,m,m,t.image.width-2*m,t.image.height-2*m,x?e:Math.round(e),x?i:Math.round(i),x?r:Math.round(e+r)-Math.round(e),x?o:Math.round(i+o)-Math.round(i)),t.clipExtent&&M.restore()}})}let j=(0,n.getTopLeft)(g);return f.getTriangles().forEach(function(t,e,i){let s;let c=t.source,g=t.target,f=c[0][0],m=c[0][1],W=c[1][0],p=c[1][1],E=c[2][0],F=c[2][1],I=T((g[0][0]-j[0])/d),S=T(-(g[0][1]-j[1])/d),C=T((g[1][0]-j[0])/d),w=T(-(g[1][1]-j[1])/d),X=T((g[2][0]-j[0])/d),k=T(-(g[2][1]-j[1])/d),y=f,Q=m;f=0,m=0;let H=[[W-=y,p-=Q,0,0,C-I],[E-=y,F-=Q,0,0,X-I],[0,0,W,p,w-S],[0,0,E,F,k-S]],R=(0,a.SV)(H);if(!!R){if(v.save(),v.beginPath(),function(){if(void 0===r){let t=(0,o.E4)(6,6,h);t.globalCompositeOperation="lighter",t.fillStyle="rgba(210, 0, 0, 0.75)",l(t,4,5,4,0),l(t,4,5,0,5);let e=t.getImageData(0,0,3,3).data;r=u(e,0)||u(e,4)||u(e,8),(0,o.jy)(t),h.push(t.canvas)}return r}()||!x){v.moveTo(C,w);let t=I-C,e=S-w;for(let i=0;i<4;i++)v.lineTo(C+T((i+1)*t/4),w+T(i*e/3)),3!=i&&v.lineTo(C+T((i+1)*t/4),w+T((i+1)*e/3));v.lineTo(X,k)}else v.moveTo(C,w),v.lineTo(I,S),v.lineTo(X,k);if(v.clip(),v.transform(R[0],R[2],R[1],R[3],I,S),v.translate(P[0]-y,P[3]-Q),M)s=M.canvas,v.scale(b,-b);else{let t=_[0],e=t.extent;s=t.image,v.scale((0,n.getWidth)(e)/s.width,-(0,n.getHeight)(e)/s.height)}v.drawImage(s,0,0),v.restore()}}),M&&((0,o.jy)(M),h.push(M.canvas)),W&&(v.save(),v.globalCompositeOperation="source-over",v.strokeStyle="black",v.lineWidth=1,f.getTriangles().forEach(function(t,e,i){let r=t.target,n=(r[0][0]-j[0])/d,o=-(r[0][1]-j[1])/d,s=(r[1][0]-j[0])/d,a=-(r[1][1]-j[1])/d,h=(r[2][0]-j[0])/d,l=-(r[2][1]-j[1])/d;v.beginPath(),v.moveTo(s,a),v.lineTo(n,o),v.lineTo(h,l),v.closePath(),v.stroke()}),v.restore()),v.canvas}},56245:function(t,e,i){var r=i(82359),n=i(21915),o=i(5374),s=i(21882);e.Z=class t{constructor(t,e,i,s,a,h,l){this.sourceProj_=t,this.targetProj_=e;let u={},c=l?(0,o.createTransformFromCoordinateTransform)(t=>(0,r.nn)(l,(0,o.transform)(t,this.targetProj_,this.sourceProj_))):(0,o.getTransform)(this.targetProj_,this.sourceProj_);this.transformInv_=function(t){let e=t[0]+"/"+t[1];return!u[e]&&(u[e]=c(t)),u[e]},this.maxSourceExtent_=s,this.errorThresholdSquared_=a*a,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!s&&!!this.sourceProj_.getExtent()&&(0,n.getWidth)(s)>=(0,n.getWidth)(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?(0,n.getWidth)(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?(0,n.getWidth)(this.targetProj_.getExtent()):null;let d=(0,n.getTopLeft)(i),g=(0,n.getTopRight)(i),f=(0,n.getBottomRight)(i),_=(0,n.getBottomLeft)(i),m=this.transformInv_(d),W=this.transformInv_(g),x=this.transformInv_(f),p=this.transformInv_(_),E=10+(h?Math.max(0,Math.ceil(Math.log2((0,n.getArea)(i)/(h*h*65536)))):0);if(this.addQuad_(d,g,f,_,m,W,x,p,E),this.wrapsXInSource_){let t=1/0;this.triangles_.forEach(function(e,i,r){t=Math.min(t,e.source[0][0],e.source[1][0],e.source[2][0])}),this.triangles_.forEach(e=>{if(Math.max(e.source[0][0],e.source[1][0],e.source[2][0])-t>this.sourceWorldWidth_/2){let i=[[e.source[0][0],e.source[0][1]],[e.source[1][0],e.source[1][1]],[e.source[2][0],e.source[2][1]]];i[0][0]-t>this.sourceWorldWidth_/2&&(i[0][0]-=this.sourceWorldWidth_),i[1][0]-t>this.sourceWorldWidth_/2&&(i[1][0]-=this.sourceWorldWidth_),i[2][0]-t>this.sourceWorldWidth_/2&&(i[2][0]-=this.sourceWorldWidth_);let r=Math.min(i[0][0],i[1][0],i[2][0]);Math.max(i[0][0],i[1][0],i[2][0])-r<this.sourceWorldWidth_/2&&(e.source=i)}})}u={}}addTriangle_(t,e,i,r,n,o){this.triangles_.push({source:[r,n,o],target:[t,e,i]})}addQuad_(t,e,i,r,o,a,h,l,u){let c=(0,n.boundingExtent)([o,a,h,l]),d=this.sourceWorldWidth_?(0,n.getWidth)(c)/this.sourceWorldWidth_:null,g=this.sourceWorldWidth_,f=this.sourceProj_.canWrapX()&&d>.5&&d<1,_=!1;if(u>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){let o=(0,n.boundingExtent)([t,e,i,r]);_=(0,n.getWidth)(o)/this.targetWorldWidth_>.25||_}!f&&this.sourceProj_.isGlobal()&&d&&(_=d>.25||_)}if(!_&&this.maxSourceExtent_&&isFinite(c[0])&&isFinite(c[1])&&isFinite(c[2])&&isFinite(c[3])&&!(0,n.intersects)(c,this.maxSourceExtent_))return;let m=0;if(!_&&(!isFinite(o[0])||!isFinite(o[1])||!isFinite(a[0])||!isFinite(a[1])||!isFinite(h[0])||!isFinite(h[1])||!isFinite(l[0])||!isFinite(l[1]))){if(u>0)_=!0;else if(1!=(m=(isFinite(o[0])&&isFinite(o[1])?0:8)+(isFinite(a[0])&&isFinite(a[1])?0:4)+(isFinite(h[0])&&isFinite(h[1])?0:2)+(isFinite(l[0])&&isFinite(l[1])?0:1))&&2!=m&&4!=m&&8!=m)return}if(u>0){if(!_){let e;let r=[(t[0]+i[0])/2,(t[1]+i[1])/2],n=this.transformInv_(r);e=f?((0,s.$W)(o[0],g)+(0,s.$W)(h[0],g))/2-(0,s.$W)(n[0],g):(o[0]+h[0])/2-n[0];let a=(o[1]+h[1])/2-n[1];_=e*e+a*a>this.errorThresholdSquared_}if(_){if(Math.abs(t[0]-i[0])<=Math.abs(t[1]-i[1])){let n=[(e[0]+i[0])/2,(e[1]+i[1])/2],s=this.transformInv_(n),c=[(r[0]+t[0])/2,(r[1]+t[1])/2],d=this.transformInv_(c);this.addQuad_(t,e,n,c,o,a,s,d,u-1),this.addQuad_(c,n,i,r,d,s,h,l,u-1)}else{let n=[(t[0]+e[0])/2,(t[1]+e[1])/2],s=this.transformInv_(n),c=[(i[0]+r[0])/2,(i[1]+r[1])/2],d=this.transformInv_(c);this.addQuad_(t,n,c,r,o,s,d,l,u-1),this.addQuad_(n,e,i,c,s,a,h,d,u-1)}return}}if(f){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(11&m)==0&&this.addTriangle_(t,i,r,o,h,l),(14&m)==0&&this.addTriangle_(t,i,e,o,h,a),m&&((13&m)==0&&this.addTriangle_(e,r,t,a,l,o),(7&m)==0&&this.addTriangle_(e,r,i,a,l,h))}calculateSourceExtent(){let t=(0,n.createEmpty)();return this.triangles_.forEach(function(e,i,r){let o=e.source;(0,n.extendCoordinate)(t,o[0]),(0,n.extendCoordinate)(t,o[1]),(0,n.extendCoordinate)(t,o[2])}),t}getTriangles(){return this.triangles_}}},35211:function(t,e,i){i.d(e,{m:function(){return r}});let r=.5}}]);
//# sourceMappingURL=3479.b138162f7ff2ca67.js.map