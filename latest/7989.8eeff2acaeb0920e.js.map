{"version":3,"file":"7989.8eeff2acaeb0920e.js","sources":["webpack://@terrestris/shogun-gis-client/./node_modules/@terrestris/react-geo/dist/Field/ScaleCombo/ScaleCombo.js","webpack://@terrestris/shogun-gis-client/./node_modules/@terrestris/react-geo/dist/constants.js","webpack://@terrestris/shogun-gis-client/./node_modules/lodash/isInteger.js","webpack://@terrestris/shogun-gis-client/./node_modules/lodash/isNumber.js","webpack://@terrestris/shogun-gis-client/./node_modules/lodash/reverse.js"],"sourcesContent":["import './ScaleCombo.less';\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { Select } from 'antd';\nimport _clone from 'lodash/clone';\nimport _isEmpty from 'lodash/isEmpty';\nimport _isInteger from 'lodash/isInteger';\nimport _isNil from 'lodash/isNil';\nimport _isNumber from 'lodash/isNumber';\nimport _reverse from 'lodash/reverse';\nimport MapUtil from '@terrestris/ol-util/dist/MapUtil/MapUtil';\nimport useMap from '@terrestris/react-util/dist/Hooks/useMap/useMap';\nimport { CSS_PREFIX } from '../../constants';\nconst defaultClassName = `${CSS_PREFIX}scalecombo`;\nconst ScaleCombo = ({ resolutionsFilter = () => true, syncWithMap = true, scales = [], className, onZoomLevelSelect, \n// required for proper definition of passthrough\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nresolutions, ...passThroughProps }) => {\n    const [internalZoomLevel, setInternalZoomLevel] = useState();\n    const map = useMap();\n    const getOptionsFromMap = useCallback(() => {\n        if (!map) {\n            return [];\n        }\n        const optionScales = [];\n        const view = map.getView();\n        // use existing resolutions array if exists\n        const viewResolutions = view.getResolutions();\n        const pushScale = (s, r, v) => {\n            const scale = MapUtil.getScaleForResolution(r, v.getProjection().getUnits());\n            if (!scale) {\n                return;\n            }\n            const roundScale = MapUtil.roundScale(scale);\n            if (optionScales.includes(roundScale)) {\n                return;\n            }\n            optionScales.push(roundScale);\n        };\n        if (_isEmpty(viewResolutions) || _isNil(viewResolutions)) {\n            for (let currentZoomLevel = view.getMaxZoom(); currentZoomLevel >= view.getMinZoom(); currentZoomLevel--) {\n                const resolution = view.getResolutionForZoom(currentZoomLevel);\n                if (resolutionsFilter(resolution)) {\n                    pushScale(optionScales, resolution, view);\n                }\n            }\n        }\n        else {\n            const reversedResolutions = _reverse(_clone(viewResolutions));\n            reversedResolutions\n                .filter(resolutionsFilter)\n                .forEach(resolution => pushScale(scales, resolution, view));\n        }\n        return optionScales;\n    }, [map, resolutionsFilter, scales]);\n    const zoomListener = useCallback((evt) => {\n        const zoom = evt.target.getZoom();\n        let roundZoom = 0;\n        if (_isNumber(zoom)) {\n            roundZoom = Math.round(zoom);\n        }\n        setInternalZoomLevel(roundZoom);\n    }, []);\n    const internalScales = useMemo(() => {\n        return scales.length > 0 ? scales : getOptionsFromMap();\n    }, [scales, getOptionsFromMap]);\n    useEffect(() => {\n        if (!map) {\n            return;\n        }\n        if (syncWithMap) {\n            map.getView().on('change:resolution', zoomListener);\n        }\n        else {\n            map.getView().un('change:resolution', zoomListener);\n        }\n    }, [map, syncWithMap, zoomListener]);\n    useEffect(() => {\n        setInternalZoomLevel(map?.getView().getZoom());\n    }, [map]);\n    const onZoomLevelSelectInternal = (selectedScale) => {\n        if (!map) {\n            return;\n        }\n        if (onZoomLevelSelect) {\n            onZoomLevelSelect(selectedScale);\n        }\n        else {\n            // The default.\n            const mapView = map.getView();\n            const calculatedResolution = MapUtil.getResolutionForScale(parseInt(selectedScale, 10), mapView.getProjection().getUnits());\n            mapView.setResolution(calculatedResolution);\n        }\n    };\n    const determineOptionKeyForZoomLevel = (zoom) => {\n        if (!_isInteger(zoom) || (internalScales.length - 1 - zoom) < 0) {\n            return undefined;\n        }\n        return internalScales[internalScales.length - 1 - zoom].toString();\n    };\n    const finalClassName = className\n        ? `${className} ${defaultClassName}`\n        : defaultClassName;\n    return (React.createElement(Select, { showSearch: true, onChange: onZoomLevelSelectInternal, filterOption: (input, option) => option?.key?.toString().startsWith(input) ?? false, value: determineOptionKeyForZoomLevel(internalZoomLevel ?? 0), size: \"small\", className: finalClassName, options: internalScales.map(roundScale => ({\n            value: roundScale.toString(),\n            label: `1:${roundScale.toLocaleString()}`\n        })), ...passThroughProps }));\n};\nexport default ScaleCombo;\n//# sourceMappingURL=ScaleCombo.js.map","const CSS_PREFIX = 'react-geo-';\nexport { CSS_PREFIX };\n//# sourceMappingURL=constants.js.map","var toInteger = require('./toInteger');\n\n/**\n * Checks if `value` is an integer.\n *\n * **Note:** This method is based on\n * [`Number.isInteger`](https://mdn.io/Number/isInteger).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an integer, else `false`.\n * @example\n *\n * _.isInteger(3);\n * // => true\n *\n * _.isInteger(Number.MIN_VALUE);\n * // => false\n *\n * _.isInteger(Infinity);\n * // => false\n *\n * _.isInteger('3');\n * // => false\n */\nfunction isInteger(value) {\n  return typeof value == 'number' && value == toInteger(value);\n}\n\nmodule.exports = isInteger;\n","var baseGetTag = require('./_baseGetTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar numberTag = '[object Number]';\n\n/**\n * Checks if `value` is classified as a `Number` primitive or object.\n *\n * **Note:** To exclude `Infinity`, `-Infinity`, and `NaN`, which are\n * classified as numbers, use the `_.isFinite` method.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a number, else `false`.\n * @example\n *\n * _.isNumber(3);\n * // => true\n *\n * _.isNumber(Number.MIN_VALUE);\n * // => true\n *\n * _.isNumber(Infinity);\n * // => true\n *\n * _.isNumber('3');\n * // => false\n */\nfunction isNumber(value) {\n  return typeof value == 'number' ||\n    (isObjectLike(value) && baseGetTag(value) == numberTag);\n}\n\nmodule.exports = isNumber;\n","/** Used for built-in method references. */\nvar arrayProto = Array.prototype;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeReverse = arrayProto.reverse;\n\n/**\n * Reverses `array` so that the first element becomes the last, the second\n * element becomes the second to last, and so on.\n *\n * **Note:** This method mutates `array` and is based on\n * [`Array#reverse`](https://mdn.io/Array/reverse).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Array\n * @param {Array} array The array to modify.\n * @returns {Array} Returns `array`.\n * @example\n *\n * var array = [1, 2, 3];\n *\n * _.reverse(array);\n * // => [3, 2, 1]\n *\n * console.log(array);\n * // => [3, 2, 1]\n */\nfunction reverse(array) {\n  return array == null ? array : nativeReverse.call(array);\n}\n\nmodule.exports = reverse;\n"],"names":["r","e","Math","parseInt","Array"],"mappings":"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"}